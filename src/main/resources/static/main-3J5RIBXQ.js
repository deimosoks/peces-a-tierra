import{a as Ir}from"./chunk-FK6H3RFT.js";import{a as rf}from"./chunk-MPP7YJHR.js";import{a as no,b as S1,c as Kl}from"./chunk-W2JH4KPR.js";import{$ as u0,$a as ws,A as nr,Aa as Ft,Ab as nn,B as sl,Ba as wt,Bb as or,C as pa,Ca as Kd,Cb as an,D as c0,Da as _,Db as va,E as Ce,Ea as be,Eb as ef,F as $g,Fa as je,Fb as Vn,G as Xg,Ga as p0,Gb as xa,H as D,Ha as _a,Hb as Gl,I as N,Ia as ft,Ib as Cs,J as La,Ja as ut,Jb as Ss,K as gs,Ka as ht,Kb as Ii,L as Fn,La as vs,Lb as Fi,M as ma,Ma as i1,Mb as Di,N as ga,Na as a1,Nb as tf,O as ll,Oa as Cr,Ob as $l,P as d0,Pa as xs,Pb as Xl,Q as Ro,Qa as Qr,Qb as Yl,R as Yg,Ra as o1,Rb as ks,S as Yd,Sa as s1,Sb as on,T as pn,Ta as qr,Tb as Es,U as Kg,Ua as l1,Ub as ba,V as to,Va as c1,Vb as Ni,W as g,Wa as d1,X as Zg,Xa as Un,Y as f0,Ya as bs,Z as Nh,Za as f1,_ as Wl,_a as u1,a as il,aa as h0,ab as Tr,b as Do,ba as Rh,bb as rn,c as Bt,ca as ir,cb as mr,d as qd,da as cl,db as h1,e as Fh,ea as _s,eb as p1,f as zg,fa as fe,fb as m1,g as hs,ga as Jg,gb as Ji,h as No,ha as Qg,hb as g1,i as jg,ia as ql,ib as gr,j as Hg,ja as e1,jb as _1,k as Gd,ka as P,kb as Zd,l as $d,la as d,lb as v1,m as ps,ma as u,mb as dl,n as al,na as j,nb as x1,o as Dh,oa as Lh,ob as Ai,p as l0,pa as Ln,pb as b1,q as Ki,qa as Bn,qb as w1,r as eo,ra as Pe,rb as Jd,s as Oi,sa as L,sb as ro,t as Xd,ta as C,tb as Qd,u as Zi,ua as Bh,ub as y1,v as ms,va as Uh,vb as C1,w as Wg,wa as Vh,wb as Ti,x as qg,xa as t1,xb as fr,y as ol,ya as r1,yb as Kr,z as Gg,za as n1,zb as ys}from"./chunk-56PMMHJG.js";import{a as Yr,b as Pi,e as Cn}from"./chunk-FDERIQAA.js";var nf=!1,zh=new qd(null),k1=(t,r)=>{let e=Ce(fr),n=e.getAccessToken();if(t.url.includes("/auth/login")||t.url.includes("/auth/refresh"))return r(t);let i=t;return n&&(i=jh(t,n)),r(i).pipe(l0(a=>a instanceof x1&&a.status===401?cw(i,r,e):hs(()=>a)))},jh=(t,r)=>t.clone({setHeaders:{Authorization:`Bearer ${r}`}}),cw=(t,r,e)=>nf?zh.pipe(al(n=>n!==null),eo(1),Zi(n=>r(jh(t,n)))):(nf=!0,zh.next(null),e.refreshToken().pipe(Zi(n=>{nf=!1;let i=n.accessTokenDto.token;return zh.next(i),r(jh(t,i))}),l0(n=>(nf=!1,hs(()=>n)))));var E1=(t,r)=>{let e=Ce(Kr),n=Ce(fr);return r(t).pipe(l0(i=>{if(t.url.includes("/auth/login"))return hs(()=>i);if(i.status===403)return n.logout(),hs(()=>i);if(i.status===401)return hs(()=>i);let a="An unexpected error occurred";return i.error instanceof ErrorEvent?a=i.error.message:a=i.error?.message||i.message||a,e.error(a),hs(()=>i)}))};var Ri=class t{http=Ce(Ai);baseUrl=Ti.baseUrl;searchMembers(r,e){let n=new dl().set("page",e.toString());return this.http.post(`${this.baseUrl}/members/search`,r,{params:n})}toggleStatus(r,e){let n=new dl().set("active",e.toString());return this.http.patch(`${this.baseUrl}/members/${r}`,null,{params:n})}getMemberById(r){return this.http.get(`${this.baseUrl}/members/${r}`)}addIntegrante(r){return this.http.post(`${this.baseUrl}/members`,r)}updateIntegrante(r,e){return this.http.put(`${this.baseUrl}/members/${r}`,e)}deleteIntegrante(r){return this.http.delete(`${this.baseUrl}/members/${r}`)}exportMembers(r){return this.http.post(`${this.baseUrl}/members/export`,r)}createNote(r){return this.http.post(`${this.baseUrl}/members/notes`,r)}deleteNote(r){return this.http.delete(`${this.baseUrl}/members/notes/${r}`)}getNotes(r){return this.http.get(`${this.baseUrl}/members/${r}/notes`)}updateNote(r,e){return this.http.put(`${this.baseUrl}/members/notes/${r}`,{note:e})}static \u0275fac=function(e){return new(e||t)};static \u0275prov=nr({token:t,factory:t.\u0275fac,providedIn:"root"})};var wa=class t{http=Ce(Ai);baseUrl=Ti.baseUrl;getCategories(){return this.http.get(`${this.baseUrl}/member-category`)}createCategory(r){return this.http.post(`${this.baseUrl}/member-category`,r)}updateCategory(r,e){return this.http.put(`${this.baseUrl}/member-category/${r}`,e)}deleteCategory(r){return this.http.delete(`${this.baseUrl}/member-category/${r}`)}createSubCategory(r){return this.http.post(`${this.baseUrl}/member-sub-category`,r)}updateSubCategory(r,e){return this.http.put(`${this.baseUrl}/member-sub-category/${r}`,e)}deleteSubCategory(r){return this.http.delete(`${this.baseUrl}/member-sub-category/${r}`)}getTypes(){return this.http.get(`${this.baseUrl}/member-type`)}createType(r){return this.http.post(`${this.baseUrl}/member-type`,r)}updateType(r,e){return this.http.put(`${this.baseUrl}/member-type/${r}`,e)}deleteType(r){return this.http.delete(`${this.baseUrl}/member-type/${r}`)}static \u0275fac=function(e){return new(e||t)};static \u0275prov=nr({token:t,factory:t.\u0275fac,providedIn:"root"})};var C0={};C0.version="0.18.5";var ul=1200,sc=1252,fw=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],uw={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},h_=function(t){fw.indexOf(t)!=-1&&(sc=uw[0]=t)};function hw(){h_(1252)}var S0=function(t){ul=t,h_(t)};function pw(){S0(1200),hw()}function mw(t){for(var r=[],e=0;e<t.length>>1;++e)r[e]=String.fromCharCode(t.charCodeAt(2*e+1)+(t.charCodeAt(2*e)<<8));return r.join("")}var af=function(r){return String.fromCharCode(r)},M1=function(r){return String.fromCharCode(r)},Lr;var oo=null,m0=!0,Ps="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function k0(t){for(var r="",e=0,n=0,i=0,a=0,o=0,s=0,l=0,c=0;c<t.length;)e=t.charCodeAt(c++),a=e>>2,n=t.charCodeAt(c++),o=(e&3)<<4|n>>4,i=t.charCodeAt(c++),s=(n&15)<<2|i>>6,l=i&63,isNaN(n)?s=l=64:isNaN(i)&&(l=64),r+=Ps.charAt(a)+Ps.charAt(o)+Ps.charAt(s)+Ps.charAt(l);return r}function zo(t){var r="",e=0,n=0,i=0,a=0,o=0,s=0,l=0;t=t.replace(/[^\w\+\/\=]/g,"");for(var c=0;c<t.length;)a=Ps.indexOf(t.charAt(c++)),o=Ps.indexOf(t.charAt(c++)),e=a<<2|o>>4,r+=String.fromCharCode(e),s=Ps.indexOf(t.charAt(c++)),n=(o&15)<<4|s>>2,s!==64&&(r+=String.fromCharCode(n)),l=Ps.indexOf(t.charAt(c++)),i=(s&3)<<6|l,l!==64&&(r+=String.fromCharCode(i));return r}var vr=(function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node})(),Ho=(function(){if(typeof Buffer<"u"){var t=!Buffer.from;if(!t)try{Buffer.from("foo","utf8")}catch{t=!0}return t?function(r,e){return e?new Buffer(r,e):new Buffer(r)}:Buffer.from.bind(Buffer)}return function(){}})();function pl(t){return vr?Buffer.alloc?Buffer.alloc(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}function P1(t){return vr?Buffer.allocUnsafe?Buffer.allocUnsafe(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}var Va=function(r){return vr?Ho(r,"binary"):r.split("").map(function(e){return e.charCodeAt(0)&255})};function Mf(t){if(typeof ArrayBuffer>"u")return Va(t);for(var r=new ArrayBuffer(t.length),e=new Uint8Array(r),n=0;n!=t.length;++n)e[n]=t.charCodeAt(n)&255;return r}function A0(t){if(Array.isArray(t))return t.map(function(n){return String.fromCharCode(n)}).join("");for(var r=[],e=0;e<t.length;++e)r[e]=String.fromCharCode(t[e]);return r.join("")}function gw(t){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(t)}var ei=vr?function(t){return Buffer.concat(t.map(function(r){return Buffer.isBuffer(r)?r:Ho(r)}))}:function(t){if(typeof Uint8Array<"u"){var r=0,e=0;for(r=0;r<t.length;++r)e+=t[r].length;var n=new Uint8Array(e),i=0;for(r=0,e=0;r<t.length;e+=i,++r)if(i=t[r].length,t[r]instanceof Uint8Array)n.set(t[r],e);else{if(typeof t[r]=="string")throw"wtf";n.set(new Uint8Array(t[r]),e)}return n}return[].concat.apply([],t.map(function(a){return Array.isArray(a)?a:[].slice.call(a)}))};function _w(t){for(var r=[],e=0,n=t.length+250,i=pl(t.length+255),a=0;a<t.length;++a){var o=t.charCodeAt(a);if(o<128)i[e++]=o;else if(o<2048)i[e++]=192|o>>6&31,i[e++]=128|o&63;else if(o>=55296&&o<57344){o=(o&1023)+64;var s=t.charCodeAt(++a)&1023;i[e++]=240|o>>8&7,i[e++]=128|o>>2&63,i[e++]=128|s>>6&15|(o&3)<<4,i[e++]=128|s&63}else i[e++]=224|o>>12&15,i[e++]=128|o>>6&63,i[e++]=128|o&63;e>n&&(r.push(i.slice(0,e)),e=0,i=pl(65535),n=65530)}return r.push(i.slice(0,e)),ei(r)}var rc=/\u0000/g,of=/[\u0001-\u0006]/g;function nc(t){for(var r="",e=t.length-1;e>=0;)r+=t.charAt(e--);return r}function za(t,r){var e=""+t;return e.length>=r?e:sn("0",r-e.length)+e}function tp(t,r){var e=""+t;return e.length>=r?e:sn(" ",r-e.length)+e}function pf(t,r){var e=""+t;return e.length>=r?e:e+sn(" ",r-e.length)}function vw(t,r){var e=""+Math.round(t);return e.length>=r?e:sn("0",r-e.length)+e}function xw(t,r){var e=""+t;return e.length>=r?e:sn("0",r-e.length)+e}var O1=Math.pow(2,32);function Zl(t,r){if(t>O1||t<-O1)return vw(t,r);var e=Math.round(t);return xw(e,r)}function mf(t,r){return r=r||0,t.length>=7+r&&(t.charCodeAt(r)|32)===103&&(t.charCodeAt(r+1)|32)===101&&(t.charCodeAt(r+2)|32)===110&&(t.charCodeAt(r+3)|32)===101&&(t.charCodeAt(r+4)|32)===114&&(t.charCodeAt(r+5)|32)===97&&(t.charCodeAt(r+6)|32)===108}var A1=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Hh=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function bw(t){return t||(t={}),t[0]="General",t[1]="0",t[2]="0.00",t[3]="#,##0",t[4]="#,##0.00",t[9]="0%",t[10]="0.00%",t[11]="0.00E+00",t[12]="# ?/?",t[13]="# ??/??",t[14]="m/d/yy",t[15]="d-mmm-yy",t[16]="d-mmm",t[17]="mmm-yy",t[18]="h:mm AM/PM",t[19]="h:mm:ss AM/PM",t[20]="h:mm",t[21]="h:mm:ss",t[22]="m/d/yy h:mm",t[37]="#,##0 ;(#,##0)",t[38]="#,##0 ;[Red](#,##0)",t[39]="#,##0.00;(#,##0.00)",t[40]="#,##0.00;[Red](#,##0.00)",t[45]="mm:ss",t[46]="[h]:mm:ss",t[47]="mmss.0",t[48]="##0.0E+0",t[49]="@",t[56]='"\u4E0A\u5348/\u4E0B\u5348 "hh"\u6642"mm"\u5206"ss"\u79D2 "',t}var ln={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"\u4E0A\u5348/\u4E0B\u5348 "hh"\u6642"mm"\u5206"ss"\u79D2 "'},T1={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},ww={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function gf(t,r,e){for(var n=t<0?-1:1,i=t*n,a=0,o=1,s=0,l=1,c=0,f=0,v=Math.floor(i);c<r&&(v=Math.floor(i),s=v*o+a,f=v*c+l,!(i-v<5e-8));)i=1/(i-v),a=o,o=s,l=c,c=f;if(f>r&&(c>r?(f=l,s=a):(f=c,s=o)),!e)return[0,n*s,f];var x=Math.floor(n*s/f);return[x,n*s-x*f,f]}function sf(t,r,e){if(t>2958465||t<0)return null;var n=t|0,i=Math.floor(86400*(t-n)),a=0,o=[],s={D:n,T:i,u:86400*(t-n)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(s.u)<1e-6&&(s.u=0),r&&r.date1904&&(n+=1462),s.u>.9999&&(s.u=0,++i==86400&&(s.T=i=0,++n,++s.D)),n===60)o=e?[1317,10,29]:[1900,2,29],a=3;else if(n===0)o=e?[1317,8,29]:[1900,1,0],a=6;else{n>60&&--n;var l=new Date(1900,0,1);l.setDate(l.getDate()+n-1),o=[l.getFullYear(),l.getMonth()+1,l.getDate()],a=l.getDay(),n<60&&(a=(a+6)%7),e&&(a=Pw(l,o))}return s.y=o[0],s.m=o[1],s.d=o[2],s.S=i%60,i=Math.floor(i/60),s.M=i%60,i=Math.floor(i/60),s.H=i,s.q=a,s}var p_=new Date(1899,11,31,0,0,0),yw=p_.getTime(),Cw=new Date(1900,2,1,0,0,0);function m_(t,r){var e=t.getTime();return r?e-=1461*24*60*60*1e3:t>=Cw&&(e+=1440*60*1e3),(e-(yw+(t.getTimezoneOffset()-p_.getTimezoneOffset())*6e4))/(1440*60*1e3)}function rp(t){return t.indexOf(".")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function Sw(t){return t.indexOf("E")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function kw(t){var r=t<0?12:11,e=rp(t.toFixed(12));return e.length<=r||(e=t.toPrecision(10),e.length<=r)?e:t.toExponential(5)}function Ew(t){var r=rp(t.toFixed(11));return r.length>(t<0?12:11)||r==="0"||r==="-0"?t.toPrecision(6):r}function Mw(t){var r=Math.floor(Math.log(Math.abs(t))*Math.LOG10E),e;return r>=-4&&r<=-1?e=t.toPrecision(10+r):Math.abs(r)<=9?e=kw(t):r===10?e=t.toFixed(10).substr(0,12):e=Ew(t),rp(Sw(e.toUpperCase()))}function Zh(t,r){switch(typeof t){case"string":return t;case"boolean":return t?"TRUE":"FALSE";case"number":return(t|0)===t?t.toString(10):Mw(t);case"undefined":return"";case"object":if(t==null)return"";if(t instanceof Date)return As(14,m_(t,r&&r.date1904),r)}throw new Error("unsupported value in General format: "+t)}function Pw(t,r){r[0]-=581;var e=t.getDay();return t<60&&(e=(e+6)%7),e}function Ow(t,r,e,n){var i="",a=0,o=0,s=e.y,l,c=0;switch(t){case 98:s=e.y+543;case 121:switch(r.length){case 1:case 2:l=s%100,c=2;break;default:l=s%1e4,c=4;break}break;case 109:switch(r.length){case 1:case 2:l=e.m,c=r.length;break;case 3:return Hh[e.m-1][1];case 5:return Hh[e.m-1][0];default:return Hh[e.m-1][2]}break;case 100:switch(r.length){case 1:case 2:l=e.d,c=r.length;break;case 3:return A1[e.q][0];default:return A1[e.q][1]}break;case 104:switch(r.length){case 1:case 2:l=1+(e.H+11)%12,c=r.length;break;default:throw"bad hour format: "+r}break;case 72:switch(r.length){case 1:case 2:l=e.H,c=r.length;break;default:throw"bad hour format: "+r}break;case 77:switch(r.length){case 1:case 2:l=e.M,c=r.length;break;default:throw"bad minute format: "+r}break;case 115:if(r!="s"&&r!="ss"&&r!=".0"&&r!=".00"&&r!=".000")throw"bad second format: "+r;return e.u===0&&(r=="s"||r=="ss")?za(e.S,r.length):(n>=2?o=n===3?1e3:100:o=n===1?10:1,a=Math.round(o*(e.S+e.u)),a>=60*o&&(a=0),r==="s"?a===0?"0":""+a/o:(i=za(a,2+n),r==="ss"?i.substr(0,2):"."+i.substr(2,r.length-1)));case 90:switch(r){case"[h]":case"[hh]":l=e.D*24+e.H;break;case"[m]":case"[mm]":l=(e.D*24+e.H)*60+e.M;break;case"[s]":case"[ss]":l=((e.D*24+e.H)*60+e.M)*60+Math.round(e.S+e.u);break;default:throw"bad abstime format: "+r}c=r.length===3?1:2;break;case 101:l=s,c=1;break}var f=c>0?za(l,c):"";return f}function Os(t){var r=3;if(t.length<=r)return t;for(var e=t.length%r,n=t.substr(0,e);e!=t.length;e+=r)n+=(n.length>0?",":"")+t.substr(e,r);return n}var g_=/%/g;function Aw(t,r,e){var n=r.replace(g_,""),i=r.length-n.length;return Bo(t,n,e*Math.pow(10,2*i))+sn("%",i)}function Tw(t,r,e){for(var n=r.length-1;r.charCodeAt(n-1)===44;)--n;return Bo(t,r.substr(0,n),e/Math.pow(10,3*(r.length-n)))}function __(t,r){var e,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(r==0)return"0.0E+0";if(r<0)return"-"+__(t,-r);var i=t.indexOf(".");i===-1&&(i=t.indexOf("E"));var a=Math.floor(Math.log(r)*Math.LOG10E)%i;if(a<0&&(a+=i),e=(r/Math.pow(10,a)).toPrecision(n+1+(i+a)%i),e.indexOf("e")===-1){var o=Math.floor(Math.log(r)*Math.LOG10E);for(e.indexOf(".")===-1?e=e.charAt(0)+"."+e.substr(1)+"E+"+(o-e.length+a):e+="E+"+(o-a);e.substr(0,2)==="0.";)e=e.charAt(0)+e.substr(2,i)+"."+e.substr(2+i),e=e.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");e=e.replace(/\+-/,"-")}e=e.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(s,l,c,f){return l+c+f.substr(0,(i+a)%i)+"."+f.substr(a)+"E"})}else e=r.toExponential(n);return t.match(/E\+00$/)&&e.match(/e[+-]\d$/)&&(e=e.substr(0,e.length-1)+"0"+e.charAt(e.length-1)),t.match(/E\-/)&&e.match(/e\+/)&&(e=e.replace(/e\+/,"e")),e.replace("e","E")}var v_=/# (\?+)( ?)\/( ?)(\d+)/;function Iw(t,r,e){var n=parseInt(t[4],10),i=Math.round(r*n),a=Math.floor(i/n),o=i-a*n,s=n;return e+(a===0?"":""+a)+" "+(o===0?sn(" ",t[1].length+1+t[4].length):tp(o,t[1].length)+t[2]+"/"+t[3]+za(s,t[4].length))}function Fw(t,r,e){return e+(r===0?"":""+r)+sn(" ",t[1].length+2+t[4].length)}var x_=/^#*0*\.([0#]+)/,b_=/\).*[0#]/,w_=/\(###\) ###\\?-####/;function vi(t){for(var r="",e,n=0;n!=t.length;++n)switch(e=t.charCodeAt(n)){case 35:break;case 63:r+=" ";break;case 48:r+="0";break;default:r+=String.fromCharCode(e)}return r}function I1(t,r){var e=Math.pow(10,r);return""+Math.round(t*e)/e}function F1(t,r){var e=t-Math.floor(t),n=Math.pow(10,r);return r<(""+Math.round(e*n)).length?0:Math.round(e*n)}function Dw(t,r){return r<(""+Math.round((t-Math.floor(t))*Math.pow(10,r))).length?1:0}function Nw(t){return t<2147483647&&t>-2147483648?""+(t>=0?t|0:t-1|0):""+Math.floor(t)}function ya(t,r,e){if(t.charCodeAt(0)===40&&!r.match(b_)){var n=r.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return e>=0?ya("n",n,e):"("+ya("n",n,-e)+")"}if(r.charCodeAt(r.length-1)===44)return Tw(t,r,e);if(r.indexOf("%")!==-1)return Aw(t,r,e);if(r.indexOf("E")!==-1)return __(r,e);if(r.charCodeAt(0)===36)return"$"+ya(t,r.substr(r.charAt(1)==" "?2:1),e);var i,a,o,s,l=Math.abs(e),c=e<0?"-":"";if(r.match(/^00+$/))return c+Zl(l,r.length);if(r.match(/^[#?]+$/))return i=Zl(e,0),i==="0"&&(i=""),i.length>r.length?i:vi(r.substr(0,r.length-i.length))+i;if(a=r.match(v_))return Iw(a,l,c);if(r.match(/^#+0+$/))return c+Zl(l,r.length-r.indexOf("0"));if(a=r.match(x_))return i=I1(e,a[1].length).replace(/^([^\.]+)$/,"$1."+vi(a[1])).replace(/\.$/,"."+vi(a[1])).replace(/\.(\d*)$/,function(S,w){return"."+w+sn("0",vi(a[1]).length-w.length)}),r.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(r=r.replace(/^#+([0.])/,"$1"),a=r.match(/^(0*)\.(#*)$/))return c+I1(l,a[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=r.match(/^#{1,3},##0(\.?)$/))return c+Os(Zl(l,0));if(a=r.match(/^#,##0\.([#0]*0)$/))return e<0?"-"+ya(t,r,-e):Os(""+(Math.floor(e)+Dw(e,a[1].length)))+"."+za(F1(e,a[1].length),a[1].length);if(a=r.match(/^#,#*,#0/))return ya(t,r.replace(/^#,#*,/,""),e);if(a=r.match(/^([0#]+)(\\?-([0#]+))+$/))return i=nc(ya(t,r.replace(/[\\-]/g,""),e)),o=0,nc(nc(r.replace(/\\/g,"")).replace(/[0#]/g,function(S){return o<i.length?i.charAt(o++):S==="0"?"0":""}));if(r.match(w_))return i=ya(t,"##########",e),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var f="";if(a=r.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(a[4].length,7),s=gf(l,Math.pow(10,o)-1,!1),i=""+c,f=Bo("n",a[1],s[1]),f.charAt(f.length-1)==" "&&(f=f.substr(0,f.length-1)+"0"),i+=f+a[2]+"/"+a[3],f=pf(s[2],o),f.length<a[4].length&&(f=vi(a[4].substr(a[4].length-f.length))+f),i+=f,i;if(a=r.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(a[1].length,a[4].length),7),s=gf(l,Math.pow(10,o)-1,!0),c+(s[0]||(s[1]?"":"0"))+" "+(s[1]?tp(s[1],o)+a[2]+"/"+a[3]+pf(s[2],o):sn(" ",2*o+1+a[2].length+a[3].length));if(a=r.match(/^[#0?]+$/))return i=Zl(e,0),r.length<=i.length?i:vi(r.substr(0,r.length-i.length))+i;if(a=r.match(/^([#0?]+)\.([#0]+)$/)){i=""+e.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),o=i.indexOf(".");var v=r.indexOf(".")-o,x=r.length-i.length-v;return vi(r.substr(0,v)+i+r.substr(r.length-x))}if(a=r.match(/^00,000\.([#0]*0)$/))return o=F1(e,a[1].length),e<0?"-"+ya(t,r,-e):Os(Nw(e)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(S){return"00,"+(S.length<3?za(0,3-S.length):"")+S})+"."+za(o,a[1].length);switch(r){case"###,##0.00":return ya(t,"#,##0.00",e);case"###,###":case"##,###":case"#,###":var p=Os(Zl(l,0));return p!=="0"?c+p:"";case"###,###.00":return ya(t,"###,##0.00",e).replace(/^0\./,".");case"#,###.00":return ya(t,"#,##0.00",e).replace(/^0\./,".");default:}throw new Error("unsupported format |"+r+"|")}function Rw(t,r,e){for(var n=r.length-1;r.charCodeAt(n-1)===44;)--n;return Bo(t,r.substr(0,n),e/Math.pow(10,3*(r.length-n)))}function Lw(t,r,e){var n=r.replace(g_,""),i=r.length-n.length;return Bo(t,n,e*Math.pow(10,2*i))+sn("%",i)}function y_(t,r){var e,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(r==0)return"0.0E+0";if(r<0)return"-"+y_(t,-r);var i=t.indexOf(".");i===-1&&(i=t.indexOf("E"));var a=Math.floor(Math.log(r)*Math.LOG10E)%i;if(a<0&&(a+=i),e=(r/Math.pow(10,a)).toPrecision(n+1+(i+a)%i),!e.match(/[Ee]/)){var o=Math.floor(Math.log(r)*Math.LOG10E);e.indexOf(".")===-1?e=e.charAt(0)+"."+e.substr(1)+"E+"+(o-e.length+a):e+="E+"+(o-a),e=e.replace(/\+-/,"-")}e=e.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(s,l,c,f){return l+c+f.substr(0,(i+a)%i)+"."+f.substr(a)+"E"})}else e=r.toExponential(n);return t.match(/E\+00$/)&&e.match(/e[+-]\d$/)&&(e=e.substr(0,e.length-1)+"0"+e.charAt(e.length-1)),t.match(/E\-/)&&e.match(/e\+/)&&(e=e.replace(/e\+/,"e")),e.replace("e","E")}function io(t,r,e){if(t.charCodeAt(0)===40&&!r.match(b_)){var n=r.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return e>=0?io("n",n,e):"("+io("n",n,-e)+")"}if(r.charCodeAt(r.length-1)===44)return Rw(t,r,e);if(r.indexOf("%")!==-1)return Lw(t,r,e);if(r.indexOf("E")!==-1)return y_(r,e);if(r.charCodeAt(0)===36)return"$"+io(t,r.substr(r.charAt(1)==" "?2:1),e);var i,a,o,s,l=Math.abs(e),c=e<0?"-":"";if(r.match(/^00+$/))return c+za(l,r.length);if(r.match(/^[#?]+$/))return i=""+e,e===0&&(i=""),i.length>r.length?i:vi(r.substr(0,r.length-i.length))+i;if(a=r.match(v_))return Fw(a,l,c);if(r.match(/^#+0+$/))return c+za(l,r.length-r.indexOf("0"));if(a=r.match(x_))return i=(""+e).replace(/^([^\.]+)$/,"$1."+vi(a[1])).replace(/\.$/,"."+vi(a[1])),i=i.replace(/\.(\d*)$/,function(S,w){return"."+w+sn("0",vi(a[1]).length-w.length)}),r.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(r=r.replace(/^#+([0.])/,"$1"),a=r.match(/^(0*)\.(#*)$/))return c+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=r.match(/^#{1,3},##0(\.?)$/))return c+Os(""+l);if(a=r.match(/^#,##0\.([#0]*0)$/))return e<0?"-"+io(t,r,-e):Os(""+e)+"."+sn("0",a[1].length);if(a=r.match(/^#,#*,#0/))return io(t,r.replace(/^#,#*,/,""),e);if(a=r.match(/^([0#]+)(\\?-([0#]+))+$/))return i=nc(io(t,r.replace(/[\\-]/g,""),e)),o=0,nc(nc(r.replace(/\\/g,"")).replace(/[0#]/g,function(S){return o<i.length?i.charAt(o++):S==="0"?"0":""}));if(r.match(w_))return i=io(t,"##########",e),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var f="";if(a=r.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(a[4].length,7),s=gf(l,Math.pow(10,o)-1,!1),i=""+c,f=Bo("n",a[1],s[1]),f.charAt(f.length-1)==" "&&(f=f.substr(0,f.length-1)+"0"),i+=f+a[2]+"/"+a[3],f=pf(s[2],o),f.length<a[4].length&&(f=vi(a[4].substr(a[4].length-f.length))+f),i+=f,i;if(a=r.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(a[1].length,a[4].length),7),s=gf(l,Math.pow(10,o)-1,!0),c+(s[0]||(s[1]?"":"0"))+" "+(s[1]?tp(s[1],o)+a[2]+"/"+a[3]+pf(s[2],o):sn(" ",2*o+1+a[2].length+a[3].length));if(a=r.match(/^[#0?]+$/))return i=""+e,r.length<=i.length?i:vi(r.substr(0,r.length-i.length))+i;if(a=r.match(/^([#0]+)\.([#0]+)$/)){i=""+e.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),o=i.indexOf(".");var v=r.indexOf(".")-o,x=r.length-i.length-v;return vi(r.substr(0,v)+i+r.substr(r.length-x))}if(a=r.match(/^00,000\.([#0]*0)$/))return e<0?"-"+io(t,r,-e):Os(""+e).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(S){return"00,"+(S.length<3?za(0,3-S.length):"")+S})+"."+za(0,a[1].length);switch(r){case"###,###":case"##,###":case"#,###":var p=Os(""+l);return p!=="0"?c+p:"";default:if(r.match(/\.[0#?]*$/))return io(t,r.slice(0,r.lastIndexOf(".")),e)+vi(r.slice(r.lastIndexOf(".")))}throw new Error("unsupported format |"+r+"|")}function Bo(t,r,e){return(e|0)===e?io(t,r,e):ya(t,r,e)}function Bw(t){for(var r=[],e=!1,n=0,i=0;n<t.length;++n)switch(t.charCodeAt(n)){case 34:e=!e;break;case 95:case 42:case 92:++n;break;case 59:r[r.length]=t.substr(i,n-i),i=n+1}if(r[r.length]=t.substr(i),e===!0)throw new Error("Format |"+t+"| unterminated string ");return r}var C_=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function S_(t){for(var r=0,e="",n="";r<t.length;)switch(e=t.charAt(r)){case"G":mf(t,r)&&(r+=6),r++;break;case'"':for(;t.charCodeAt(++r)!==34&&r<t.length;);++r;break;case"\\":r+=2;break;case"_":r+=2;break;case"@":++r;break;case"B":case"b":if(t.charAt(r+1)==="1"||t.charAt(r+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"\u4E0A":if(t.substr(r,3).toUpperCase()==="A/P"||t.substr(r,5).toUpperCase()==="AM/PM"||t.substr(r,5).toUpperCase()==="\u4E0A\u5348/\u4E0B\u5348")return!0;++r;break;case"[":for(n=e;t.charAt(r++)!=="]"&&r<t.length;)n+=t.charAt(r);if(n.match(C_))return!0;break;case".":case"0":case"#":for(;r<t.length&&("0#?.,E+-%".indexOf(e=t.charAt(++r))>-1||e=="\\"&&t.charAt(r+1)=="-"&&"0#".indexOf(t.charAt(r+2))>-1););break;case"?":for(;t.charAt(++r)===e;);break;case"*":++r,(t.charAt(r)==" "||t.charAt(r)=="*")&&++r;break;case"(":case")":++r;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;r<t.length&&"0123456789".indexOf(t.charAt(++r))>-1;);break;case" ":++r;break;default:++r;break}return!1}function Uw(t,r,e,n){for(var i=[],a="",o=0,s="",l="t",c,f,v,x="H";o<t.length;)switch(s=t.charAt(o)){case"G":if(!mf(t,o))throw new Error("unrecognized character "+s+" in "+t);i[i.length]={t:"G",v:"General"},o+=7;break;case'"':for(a="";(v=t.charCodeAt(++o))!==34&&o<t.length;)a+=String.fromCharCode(v);i[i.length]={t:"t",v:a},++o;break;case"\\":var p=t.charAt(++o),S=p==="("||p===")"?p:"t";i[i.length]={t:S,v:p},++o;break;case"_":i[i.length]={t:"t",v:" "},o+=2;break;case"@":i[i.length]={t:"T",v:r},++o;break;case"B":case"b":if(t.charAt(o+1)==="1"||t.charAt(o+1)==="2"){if(c==null&&(c=sf(r,e,t.charAt(o+1)==="2"),c==null))return"";i[i.length]={t:"X",v:t.substr(o,2)},l=s,o+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":s=s.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(r<0||c==null&&(c=sf(r,e),c==null))return"";for(a=s;++o<t.length&&t.charAt(o).toLowerCase()===s;)a+=s;s==="m"&&l.toLowerCase()==="h"&&(s="M"),s==="h"&&(s=x),i[i.length]={t:s,v:a},l=s;break;case"A":case"a":case"\u4E0A":var w={t:s,v:s};if(c==null&&(c=sf(r,e)),t.substr(o,3).toUpperCase()==="A/P"?(c!=null&&(w.v=c.H>=12?"P":"A"),w.t="T",x="h",o+=3):t.substr(o,5).toUpperCase()==="AM/PM"?(c!=null&&(w.v=c.H>=12?"PM":"AM"),w.t="T",o+=5,x="h"):t.substr(o,5).toUpperCase()==="\u4E0A\u5348/\u4E0B\u5348"?(c!=null&&(w.v=c.H>=12?"\u4E0B\u5348":"\u4E0A\u5348"),w.t="T",o+=5,x="h"):(w.t="t",++o),c==null&&w.t==="T")return"";i[i.length]=w,l=s;break;case"[":for(a=s;t.charAt(o++)!=="]"&&o<t.length;)a+=t.charAt(o);if(a.slice(-1)!=="]")throw'unterminated "[" block: |'+a+"|";if(a.match(C_)){if(c==null&&(c=sf(r,e),c==null))return"";i[i.length]={t:"Z",v:a.toLowerCase()},l=a.charAt(1)}else a.indexOf("$")>-1&&(a=(a.match(/\$([^-\[\]]*)/)||[])[1]||"$",S_(t)||(i[i.length]={t:"t",v:a}));break;case".":if(c!=null){for(a=s;++o<t.length&&(s=t.charAt(o))==="0";)a+=s;i[i.length]={t:"s",v:a};break}case"0":case"#":for(a=s;++o<t.length&&"0#?.,E+-%".indexOf(s=t.charAt(o))>-1;)a+=s;i[i.length]={t:"n",v:a};break;case"?":for(a=s;t.charAt(++o)===s;)a+=s;i[i.length]={t:s,v:a},l=s;break;case"*":++o,(t.charAt(o)==" "||t.charAt(o)=="*")&&++o;break;case"(":case")":i[i.length]={t:n===1?"t":s,v:s},++o;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(a=s;o<t.length&&"0123456789".indexOf(t.charAt(++o))>-1;)a+=t.charAt(o);i[i.length]={t:"D",v:a};break;case" ":i[i.length]={t:s,v:s},++o;break;case"$":i[i.length]={t:"t",v:"$"},++o;break;default:if(",$-+/():!^&'~{}<>=\u20ACacfijklopqrtuvwxzP".indexOf(s)===-1)throw new Error("unrecognized character "+s+" in "+t);i[i.length]={t:"t",v:s},++o;break}var k=0,O=0,H;for(o=i.length-1,l="t";o>=0;--o)switch(i[o].t){case"h":case"H":i[o].t=x,l="h",k<1&&(k=1);break;case"s":(H=i[o].v.match(/\.0+$/))&&(O=Math.max(O,H[0].length-1)),k<3&&(k=3);case"d":case"y":case"M":case"e":l=i[o].t;break;case"m":l==="s"&&(i[o].t="M",k<2&&(k=2));break;case"X":break;case"Z":k<1&&i[o].v.match(/[Hh]/)&&(k=1),k<2&&i[o].v.match(/[Mm]/)&&(k=2),k<3&&i[o].v.match(/[Ss]/)&&(k=3)}switch(k){case 0:break;case 1:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M),c.M>=60&&(c.M=0,++c.H);break;case 2:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M);break}var q="",X;for(o=0;o<i.length;++o)switch(i[o].t){case"t":case"T":case" ":case"D":break;case"X":i[o].v="",i[o].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":i[o].v=Ow(i[o].t.charCodeAt(0),i[o].v,c,O),i[o].t="t";break;case"n":case"?":for(X=o+1;i[X]!=null&&((s=i[X].t)==="?"||s==="D"||(s===" "||s==="t")&&i[X+1]!=null&&(i[X+1].t==="?"||i[X+1].t==="t"&&i[X+1].v==="/")||i[o].t==="("&&(s===" "||s==="n"||s===")")||s==="t"&&(i[X].v==="/"||i[X].v===" "&&i[X+1]!=null&&i[X+1].t=="?"));)i[o].v+=i[X].v,i[X]={v:"",t:";"},++X;q+=i[o].v,o=X-1;break;case"G":i[o].t="t",i[o].v=Zh(r,e);break}var he="",ke,re;if(q.length>0){q.charCodeAt(0)==40?(ke=r<0&&q.charCodeAt(0)===45?-r:r,re=Bo("n",q,ke)):(ke=r<0&&n>1?-r:r,re=Bo("n",q,ke),ke<0&&i[0]&&i[0].t=="t"&&(re=re.substr(1),i[0].v="-"+i[0].v)),X=re.length-1;var ee=i.length;for(o=0;o<i.length;++o)if(i[o]!=null&&i[o].t!="t"&&i[o].v.indexOf(".")>-1){ee=o;break}var W=i.length;if(ee===i.length&&re.indexOf("E")===-1){for(o=i.length-1;o>=0;--o)i[o]==null||"n?".indexOf(i[o].t)===-1||(X>=i[o].v.length-1?(X-=i[o].v.length,i[o].v=re.substr(X+1,i[o].v.length)):X<0?i[o].v="":(i[o].v=re.substr(0,X+1),X=-1),i[o].t="t",W=o);X>=0&&W<i.length&&(i[W].v=re.substr(0,X+1)+i[W].v)}else if(ee!==i.length&&re.indexOf("E")===-1){for(X=re.indexOf(".")-1,o=ee;o>=0;--o)if(!(i[o]==null||"n?".indexOf(i[o].t)===-1)){for(f=i[o].v.indexOf(".")>-1&&o===ee?i[o].v.indexOf(".")-1:i[o].v.length-1,he=i[o].v.substr(f+1);f>=0;--f)X>=0&&(i[o].v.charAt(f)==="0"||i[o].v.charAt(f)==="#")&&(he=re.charAt(X--)+he);i[o].v=he,i[o].t="t",W=o}for(X>=0&&W<i.length&&(i[W].v=re.substr(0,X+1)+i[W].v),X=re.indexOf(".")+1,o=ee;o<i.length;++o)if(!(i[o]==null||"n?(".indexOf(i[o].t)===-1&&o!==ee)){for(f=i[o].v.indexOf(".")>-1&&o===ee?i[o].v.indexOf(".")+1:0,he=i[o].v.substr(0,f);f<i[o].v.length;++f)X<re.length&&(he+=re.charAt(X++));i[o].v=he,i[o].t="t",W=o}}}for(o=0;o<i.length;++o)i[o]!=null&&"n?".indexOf(i[o].t)>-1&&(ke=n>1&&r<0&&o>0&&i[o-1].v==="-"?-r:r,i[o].v=Bo(i[o].t,i[o].v,ke),i[o].t="t");var ae="";for(o=0;o!==i.length;++o)i[o]!=null&&(ae+=i[o].v);return ae}var D1=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function N1(t,r){if(r==null)return!1;var e=parseFloat(r[2]);switch(r[1]){case"=":if(t==e)return!0;break;case">":if(t>e)return!0;break;case"<":if(t<e)return!0;break;case"<>":if(t!=e)return!0;break;case">=":if(t>=e)return!0;break;case"<=":if(t<=e)return!0;break}return!1}function Vw(t,r){var e=Bw(t),n=e.length,i=e[n-1].indexOf("@");if(n<4&&i>-1&&--n,e.length>4)throw new Error("cannot find right format for |"+e.join("|")+"|");if(typeof r!="number")return[4,e.length===4||i>-1?e[e.length-1]:"@"];switch(e.length){case 1:e=i>-1?["General","General","General",e[0]]:[e[0],e[0],e[0],"@"];break;case 2:e=i>-1?[e[0],e[0],e[0],e[1]]:[e[0],e[1],e[0],"@"];break;case 3:e=i>-1?[e[0],e[1],e[0],e[2]]:[e[0],e[1],e[2],"@"];break;case 4:break}var a=r>0?e[0]:r<0?e[1]:e[2];if(e[0].indexOf("[")===-1&&e[1].indexOf("[")===-1)return[n,a];if(e[0].match(/\[[=<>]/)!=null||e[1].match(/\[[=<>]/)!=null){var o=e[0].match(D1),s=e[1].match(D1);return N1(r,o)?[n,e[0]]:N1(r,s)?[n,e[1]]:[n,e[o!=null&&s!=null?2:1]]}return[n,a]}function As(t,r,e){e==null&&(e={});var n="";switch(typeof t){case"string":t=="m/d/yy"&&e.dateNF?n=e.dateNF:n=t;break;case"number":t==14&&e.dateNF?n=e.dateNF:n=(e.table!=null?e.table:ln)[t],n==null&&(n=e.table&&e.table[T1[t]]||ln[T1[t]]),n==null&&(n=ww[t]||"General");break}if(mf(n,0))return Zh(r,e);r instanceof Date&&(r=m_(r,e.date1904));var i=Vw(n,r);if(mf(i[1]))return Zh(r,e);if(r===!0)r="TRUE";else if(r===!1)r="FALSE";else if(r===""||r==null)return"";return Uw(i[1],r,e,i[0])}function k_(t,r){if(typeof r!="number"){r=+r||-1;for(var e=0;e<392;++e){if(ln[e]==null){r<0&&(r=e);continue}if(ln[e]==t){r=e;break}}r<0&&(r=391)}return ln[r]=t,r}function Pf(t){for(var r=0;r!=392;++r)t[r]!==void 0&&k_(t[r],r)}function Of(){ln=bw()}var E_=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function zw(t){var r=typeof t=="number"?ln[t]:t;return r=r.replace(E_,"(\\d+)"),new RegExp("^"+r+"$")}function jw(t,r,e){var n=-1,i=-1,a=-1,o=-1,s=-1,l=-1;(r.match(E_)||[]).forEach(function(v,x){var p=parseInt(e[x+1],10);switch(v.toLowerCase().charAt(0)){case"y":n=p;break;case"d":a=p;break;case"h":o=p;break;case"s":l=p;break;case"m":o>=0?s=p:i=p;break}}),l>=0&&s==-1&&i>=0&&(s=i,i=-1);var c=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(i>=1?i:1)).slice(-2)+"-"+("00"+(a>=1?a:1)).slice(-2);c.length==7&&(c="0"+c),c.length==8&&(c="20"+c);var f=("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(s>=0?s:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return o==-1&&s==-1&&l==-1?c:n==-1&&i==-1&&a==-1?f:c+"T"+f}var Hw=(function(){var t={};t.version="1.2.0";function r(){for(var re=0,ee=new Array(256),W=0;W!=256;++W)re=W,re=re&1?-306674912^re>>>1:re>>>1,re=re&1?-306674912^re>>>1:re>>>1,re=re&1?-306674912^re>>>1:re>>>1,re=re&1?-306674912^re>>>1:re>>>1,re=re&1?-306674912^re>>>1:re>>>1,re=re&1?-306674912^re>>>1:re>>>1,re=re&1?-306674912^re>>>1:re>>>1,re=re&1?-306674912^re>>>1:re>>>1,ee[W]=re;return typeof Int32Array<"u"?new Int32Array(ee):ee}var e=r();function n(re){var ee=0,W=0,ae=0,A=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(ae=0;ae!=256;++ae)A[ae]=re[ae];for(ae=0;ae!=256;++ae)for(W=re[ae],ee=256+ae;ee<4096;ee+=256)W=A[ee]=W>>>8^re[W&255];var V=[];for(ae=1;ae!=16;++ae)V[ae-1]=typeof Int32Array<"u"?A.subarray(ae*256,ae*256+256):A.slice(ae*256,ae*256+256);return V}var i=n(e),a=i[0],o=i[1],s=i[2],l=i[3],c=i[4],f=i[5],v=i[6],x=i[7],p=i[8],S=i[9],w=i[10],k=i[11],O=i[12],H=i[13],q=i[14];function X(re,ee){for(var W=ee^-1,ae=0,A=re.length;ae<A;)W=W>>>8^e[(W^re.charCodeAt(ae++))&255];return~W}function he(re,ee){for(var W=ee^-1,ae=re.length-15,A=0;A<ae;)W=q[re[A++]^W&255]^H[re[A++]^W>>8&255]^O[re[A++]^W>>16&255]^k[re[A++]^W>>>24]^w[re[A++]]^S[re[A++]]^p[re[A++]]^x[re[A++]]^v[re[A++]]^f[re[A++]]^c[re[A++]]^l[re[A++]]^s[re[A++]]^o[re[A++]]^a[re[A++]]^e[re[A++]];for(ae+=15;A<ae;)W=W>>>8^e[(W^re[A++])&255];return~W}function ke(re,ee){for(var W=ee^-1,ae=0,A=re.length,V=0,de=0;ae<A;)V=re.charCodeAt(ae++),V<128?W=W>>>8^e[(W^V)&255]:V<2048?(W=W>>>8^e[(W^(192|V>>6&31))&255],W=W>>>8^e[(W^(128|V&63))&255]):V>=55296&&V<57344?(V=(V&1023)+64,de=re.charCodeAt(ae++)&1023,W=W>>>8^e[(W^(240|V>>8&7))&255],W=W>>>8^e[(W^(128|V>>2&63))&255],W=W>>>8^e[(W^(128|de>>6&15|(V&3)<<4))&255],W=W>>>8^e[(W^(128|de&63))&255]):(W=W>>>8^e[(W^(224|V>>12&15))&255],W=W>>>8^e[(W^(128|V>>6&63))&255],W=W>>>8^e[(W^(128|V&63))&255]);return~W}return t.table=e,t.bstr=X,t.buf=he,t.str=ke,t})(),Fr=(function(){var r={};r.version="1.2.1";function e(B,oe){for(var K=B.split("/"),J=oe.split("/"),se=0,ce=0,Oe=Math.min(K.length,J.length);se<Oe;++se){if(ce=K[se].length-J[se].length)return ce;if(K[se]!=J[se])return K[se]<J[se]?-1:1}return K.length-J.length}function n(B){if(B.charAt(B.length-1)=="/")return B.slice(0,-1).indexOf("/")===-1?B:n(B.slice(0,-1));var oe=B.lastIndexOf("/");return oe===-1?B:B.slice(0,oe+1)}function i(B){if(B.charAt(B.length-1)=="/")return i(B.slice(0,-1));var oe=B.lastIndexOf("/");return oe===-1?B:B.slice(oe+1)}function a(B,oe){typeof oe=="string"&&(oe=new Date(oe));var K=oe.getHours();K=K<<6|oe.getMinutes(),K=K<<5|oe.getSeconds()>>>1,B.write_shift(2,K);var J=oe.getFullYear()-1980;J=J<<4|oe.getMonth()+1,J=J<<5|oe.getDate(),B.write_shift(2,J)}function o(B){var oe=B.read_shift(2)&65535,K=B.read_shift(2)&65535,J=new Date,se=K&31;K>>>=5;var ce=K&15;K>>>=4,J.setMilliseconds(0),J.setFullYear(K+1980),J.setMonth(ce-1),J.setDate(se);var Oe=oe&31;oe>>>=5;var Le=oe&63;return oe>>>=6,J.setHours(oe),J.setMinutes(Le),J.setSeconds(Oe<<1),J}function s(B){ea(B,0);for(var oe={},K=0;B.l<=B.length-4;){var J=B.read_shift(2),se=B.read_shift(2),ce=B.l+se,Oe={};switch(J){case 21589:K=B.read_shift(1),K&1&&(Oe.mtime=B.read_shift(4)),se>5&&(K&2&&(Oe.atime=B.read_shift(4)),K&4&&(Oe.ctime=B.read_shift(4))),Oe.mtime&&(Oe.mt=new Date(Oe.mtime*1e3));break}B.l=ce,oe[J]=Oe}return oe}var l;function c(){return l||(l={})}function f(B,oe){if(B[0]==80&&B[1]==75)return Vt(B,oe);if((B[0]|32)==109&&(B[1]|32)==105)return Nt(B,oe);if(B.length<512)throw new Error("CFB file size "+B.length+" < 512");var K=3,J=512,se=0,ce=0,Oe=0,Le=0,Ie=0,Ae=[],De=B.slice(0,512);ea(De,0);var et=v(De);switch(K=et[0],K){case 3:J=512;break;case 4:J=4096;break;case 0:if(et[1]==0)return Vt(B,oe);default:throw new Error("Major Version: Expected 3 or 4 saw "+K)}J!==512&&(De=B.slice(0,J),ea(De,28));var it=B.slice(0,J);x(De,K);var mt=De.read_shift(4,"i");if(K===3&&mt!==0)throw new Error("# Directory Sectors: Expected 0 saw "+mt);De.l+=4,Oe=De.read_shift(4,"i"),De.l+=4,De.chk("00100000","Mini Stream Cutoff Size: "),Le=De.read_shift(4,"i"),se=De.read_shift(4,"i"),Ie=De.read_shift(4,"i"),ce=De.read_shift(4,"i");for(var ot=-1,lt=0;lt<109&&(ot=De.read_shift(4,"i"),!(ot<0));++lt)Ae[lt]=ot;var Rt=p(B,J);k(Ie,ce,Rt,J,Ae);var wr=H(Rt,Oe,Ae,J);wr[Oe].name="!Directory",se>0&&Le!==de&&(wr[Le].name="!MiniFAT"),wr[Ae[0]].name="!FAT",wr.fat_addrs=Ae,wr.ssz=J;var Dr={},zr=[],Rn=[],Ta=[];q(Oe,wr,Rt,zr,se,Dr,Rn,Le),S(Rn,Ta,zr),zr.shift();var Xa={FileIndex:Rn,FullPaths:Ta};return oe&&oe.raw&&(Xa.raw={header:it,sectors:Rt}),Xa}function v(B){if(B[B.l]==80&&B[B.l+1]==75)return[0,0];B.chk(ue,"Header Signature: "),B.l+=16;var oe=B.read_shift(2,"u");return[B.read_shift(2,"u"),oe]}function x(B,oe){var K=9;switch(B.l+=2,K=B.read_shift(2)){case 9:if(oe!=3)throw new Error("Sector Shift: Expected 9 saw "+K);break;case 12:if(oe!=4)throw new Error("Sector Shift: Expected 12 saw "+K);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+K)}B.chk("0600","Mini Sector Shift: "),B.chk("000000000000","Reserved: ")}function p(B,oe){for(var K=Math.ceil(B.length/oe)-1,J=[],se=1;se<K;++se)J[se-1]=B.slice(se*oe,(se+1)*oe);return J[K-1]=B.slice(K*oe),J}function S(B,oe,K){for(var J=0,se=0,ce=0,Oe=0,Le=0,Ie=K.length,Ae=[],De=[];J<Ie;++J)Ae[J]=De[J]=J,oe[J]=K[J];for(;Le<De.length;++Le)J=De[Le],se=B[J].L,ce=B[J].R,Oe=B[J].C,Ae[J]===J&&(se!==-1&&Ae[se]!==se&&(Ae[J]=Ae[se]),ce!==-1&&Ae[ce]!==ce&&(Ae[J]=Ae[ce])),Oe!==-1&&(Ae[Oe]=J),se!==-1&&J!=Ae[J]&&(Ae[se]=Ae[J],De.lastIndexOf(se)<Le&&De.push(se)),ce!==-1&&J!=Ae[J]&&(Ae[ce]=Ae[J],De.lastIndexOf(ce)<Le&&De.push(ce));for(J=1;J<Ie;++J)Ae[J]===J&&(ce!==-1&&Ae[ce]!==ce?Ae[J]=Ae[ce]:se!==-1&&Ae[se]!==se&&(Ae[J]=Ae[se]));for(J=1;J<Ie;++J)if(B[J].type!==0){if(Le=J,Le!=Ae[Le])do Le=Ae[Le],oe[J]=oe[Le]+"/"+oe[J];while(Le!==0&&Ae[Le]!==-1&&Le!=Ae[Le]);Ae[J]=-1}for(oe[0]+="/",J=1;J<Ie;++J)B[J].type!==2&&(oe[J]+="/")}function w(B,oe,K){for(var J=B.start,se=B.size,ce=[],Oe=J;K&&se>0&&Oe>=0;)ce.push(oe.slice(Oe*V,Oe*V+V)),se-=V,Oe=fl(K,Oe*4);return ce.length===0?Ue(0):ei(ce).slice(0,B.size)}function k(B,oe,K,J,se){var ce=de;if(B===de){if(oe!==0)throw new Error("DIFAT chain shorter than expected")}else if(B!==-1){var Oe=K[B],Le=(J>>>2)-1;if(!Oe)return;for(var Ie=0;Ie<Le&&(ce=fl(Oe,Ie*4))!==de;++Ie)se.push(ce);k(fl(Oe,J-4),oe-1,K,J,se)}}function O(B,oe,K,J,se){var ce=[],Oe=[];se||(se=[]);var Le=J-1,Ie=0,Ae=0;for(Ie=oe;Ie>=0;){se[Ie]=!0,ce[ce.length]=Ie,Oe.push(B[Ie]);var De=K[Math.floor(Ie*4/J)];if(Ae=Ie*4&Le,J<4+Ae)throw new Error("FAT boundary crossed: "+Ie+" 4 "+J);if(!B[De])break;Ie=fl(B[De],Ae)}return{nodes:ce,data:H1([Oe])}}function H(B,oe,K,J){var se=B.length,ce=[],Oe=[],Le=[],Ie=[],Ae=J-1,De=0,et=0,it=0,mt=0;for(De=0;De<se;++De)if(Le=[],it=De+oe,it>=se&&(it-=se),!Oe[it]){Ie=[];var ot=[];for(et=it;et>=0;){ot[et]=!0,Oe[et]=!0,Le[Le.length]=et,Ie.push(B[et]);var lt=K[Math.floor(et*4/J)];if(mt=et*4&Ae,J<4+mt)throw new Error("FAT boundary crossed: "+et+" 4 "+J);if(!B[lt]||(et=fl(B[lt],mt),ot[et]))break}ce[it]={nodes:Le,data:H1([Ie])}}return ce}function q(B,oe,K,J,se,ce,Oe,Le){for(var Ie=0,Ae=J.length?2:0,De=oe[B].data,et=0,it=0,mt;et<De.length;et+=128){var ot=De.slice(et,et+128);ea(ot,64),it=ot.read_shift(2),mt=If(ot,0,it-Ae),J.push(mt);var lt={name:mt,type:ot.read_shift(1),color:ot.read_shift(1),L:ot.read_shift(4,"i"),R:ot.read_shift(4,"i"),C:ot.read_shift(4,"i"),clsid:ot.read_shift(16),state:ot.read_shift(4,"i"),start:0,size:0},Rt=ot.read_shift(2)+ot.read_shift(2)+ot.read_shift(2)+ot.read_shift(2);Rt!==0&&(lt.ct=X(ot,ot.l-8));var wr=ot.read_shift(2)+ot.read_shift(2)+ot.read_shift(2)+ot.read_shift(2);wr!==0&&(lt.mt=X(ot,ot.l-8)),lt.start=ot.read_shift(4,"i"),lt.size=ot.read_shift(4,"i"),lt.size<0&&lt.start<0&&(lt.size=lt.type=0,lt.start=de,lt.name=""),lt.type===5?(Ie=lt.start,se>0&&Ie!==de&&(oe[Ie].name="!StreamData")):lt.size>=4096?(lt.storage="fat",oe[lt.start]===void 0&&(oe[lt.start]=O(K,lt.start,oe.fat_addrs,oe.ssz)),oe[lt.start].name=lt.name,lt.content=oe[lt.start].data.slice(0,lt.size)):(lt.storage="minifat",lt.size<0?lt.size=0:Ie!==de&&lt.start!==de&&oe[Ie]&&(lt.content=w(lt,oe[Ie].data,(oe[Le]||{}).data))),lt.content&&ea(lt.content,0),ce[mt]=lt,Oe.push(lt)}}function X(B,oe){return new Date((zn(B,oe+4)/1e7*Math.pow(2,32)+zn(B,oe)/1e7-11644473600)*1e3)}function he(B,oe){return c(),f(l.readFileSync(B),oe)}function ke(B,oe){var K=oe&&oe.type;switch(K||vr&&Buffer.isBuffer(B)&&(K="buffer"),K||"base64"){case"file":return he(B,oe);case"base64":return f(Va(zo(B)),oe);case"binary":return f(Va(B),oe)}return f(B,oe)}function re(B,oe){var K=oe||{},J=K.root||"Root Entry";if(B.FullPaths||(B.FullPaths=[]),B.FileIndex||(B.FileIndex=[]),B.FullPaths.length!==B.FileIndex.length)throw new Error("inconsistent CFB structure");B.FullPaths.length===0&&(B.FullPaths[0]=J+"/",B.FileIndex[0]={name:J,type:5}),K.CLSID&&(B.FileIndex[0].clsid=K.CLSID),ee(B)}function ee(B){var oe="Sh33tJ5";if(!Fr.find(B,"/"+oe)){var K=Ue(4);K[0]=55,K[1]=K[3]=50,K[2]=54,B.FileIndex.push({name:oe,type:2,content:K,size:4,L:69,R:69,C:69}),B.FullPaths.push(B.FullPaths[0]+oe),W(B)}}function W(B,oe){re(B);for(var K=!1,J=!1,se=B.FullPaths.length-1;se>=0;--se){var ce=B.FileIndex[se];switch(ce.type){case 0:J?K=!0:(B.FileIndex.pop(),B.FullPaths.pop());break;case 1:case 2:case 5:J=!0,isNaN(ce.R*ce.L*ce.C)&&(K=!0),ce.R>-1&&ce.L>-1&&ce.R==ce.L&&(K=!0);break;default:K=!0;break}}if(!(!K&&!oe)){var Oe=new Date(1987,1,19),Le=0,Ie=Object.create?Object.create(null):{},Ae=[];for(se=0;se<B.FullPaths.length;++se)Ie[B.FullPaths[se]]=!0,B.FileIndex[se].type!==0&&Ae.push([B.FullPaths[se],B.FileIndex[se]]);for(se=0;se<Ae.length;++se){var De=n(Ae[se][0]);J=Ie[De],J||(Ae.push([De,{name:i(De).replace("/",""),type:1,clsid:Ne,ct:Oe,mt:Oe,content:null}]),Ie[De]=!0)}for(Ae.sort(function(mt,ot){return e(mt[0],ot[0])}),B.FullPaths=[],B.FileIndex=[],se=0;se<Ae.length;++se)B.FullPaths[se]=Ae[se][0],B.FileIndex[se]=Ae[se][1];for(se=0;se<Ae.length;++se){var et=B.FileIndex[se],it=B.FullPaths[se];if(et.name=i(it).replace("/",""),et.L=et.R=et.C=-(et.color=1),et.size=et.content?et.content.length:0,et.start=0,et.clsid=et.clsid||Ne,se===0)et.C=Ae.length>1?1:-1,et.size=0,et.type=5;else if(it.slice(-1)=="/"){for(Le=se+1;Le<Ae.length&&n(B.FullPaths[Le])!=it;++Le);for(et.C=Le>=Ae.length?-1:Le,Le=se+1;Le<Ae.length&&n(B.FullPaths[Le])!=n(it);++Le);et.R=Le>=Ae.length?-1:Le,et.type=1}else n(B.FullPaths[se+1]||"")==n(it)&&(et.R=se+1),et.type=2}}}function ae(B,oe){var K=oe||{};if(K.fileType=="mad")return Oa(B,K);switch(W(B),K.fileType){case"zip":return er(B,K)}var J=(function(mt){for(var ot=0,lt=0,Rt=0;Rt<mt.FileIndex.length;++Rt){var wr=mt.FileIndex[Rt];if(wr.content){var Dr=wr.content.length;Dr>0&&(Dr<4096?ot+=Dr+63>>6:lt+=Dr+511>>9)}}for(var zr=mt.FullPaths.length+3>>2,Rn=ot+7>>3,Ta=ot+127>>7,Xa=Rn+lt+zr+Ta,la=Xa+127>>7,Zo=la<=109?0:Math.ceil((la-109)/127);Xa+la+Zo+127>>7>la;)Zo=++la<=109?0:Math.ceil((la-109)/127);var xn=[1,Zo,la,Ta,zr,lt,ot,0];return mt.FileIndex[0].size=ot<<6,xn[7]=(mt.FileIndex[0].start=xn[0]+xn[1]+xn[2]+xn[3]+xn[4]+xn[5])+(xn[6]+7>>3),xn})(B),se=Ue(J[7]<<9),ce=0,Oe=0;{for(ce=0;ce<8;++ce)se.write_shift(1,xe[ce]);for(ce=0;ce<8;++ce)se.write_shift(2,0);for(se.write_shift(2,62),se.write_shift(2,3),se.write_shift(2,65534),se.write_shift(2,9),se.write_shift(2,6),ce=0;ce<3;++ce)se.write_shift(2,0);for(se.write_shift(4,0),se.write_shift(4,J[2]),se.write_shift(4,J[0]+J[1]+J[2]+J[3]-1),se.write_shift(4,0),se.write_shift(4,4096),se.write_shift(4,J[3]?J[0]+J[1]+J[2]-1:de),se.write_shift(4,J[3]),se.write_shift(-4,J[1]?J[0]-1:de),se.write_shift(4,J[1]),ce=0;ce<109;++ce)se.write_shift(-4,ce<J[2]?J[1]+ce:-1)}if(J[1])for(Oe=0;Oe<J[1];++Oe){for(;ce<236+Oe*127;++ce)se.write_shift(-4,ce<J[2]?J[1]+ce:-1);se.write_shift(-4,Oe===J[1]-1?de:Oe+1)}var Le=function(mt){for(Oe+=mt;ce<Oe-1;++ce)se.write_shift(-4,ce+1);mt&&(++ce,se.write_shift(-4,de))};for(Oe=ce=0,Oe+=J[1];ce<Oe;++ce)se.write_shift(-4,Re.DIFSECT);for(Oe+=J[2];ce<Oe;++ce)se.write_shift(-4,Re.FATSECT);Le(J[3]),Le(J[4]);for(var Ie=0,Ae=0,De=B.FileIndex[0];Ie<B.FileIndex.length;++Ie)De=B.FileIndex[Ie],De.content&&(Ae=De.content.length,!(Ae<4096)&&(De.start=Oe,Le(Ae+511>>9)));for(Le(J[6]+7>>3);se.l&511;)se.write_shift(-4,Re.ENDOFCHAIN);for(Oe=ce=0,Ie=0;Ie<B.FileIndex.length;++Ie)De=B.FileIndex[Ie],De.content&&(Ae=De.content.length,!(!Ae||Ae>=4096)&&(De.start=Oe,Le(Ae+63>>6)));for(;se.l&511;)se.write_shift(-4,Re.ENDOFCHAIN);for(ce=0;ce<J[4]<<2;++ce){var et=B.FullPaths[ce];if(!et||et.length===0){for(Ie=0;Ie<17;++Ie)se.write_shift(4,0);for(Ie=0;Ie<3;++Ie)se.write_shift(4,-1);for(Ie=0;Ie<12;++Ie)se.write_shift(4,0);continue}De=B.FileIndex[ce],ce===0&&(De.start=De.size?De.start-1:de);var it=ce===0&&K.root||De.name;if(Ae=2*(it.length+1),se.write_shift(64,it,"utf16le"),se.write_shift(2,Ae),se.write_shift(1,De.type),se.write_shift(1,De.color),se.write_shift(-4,De.L),se.write_shift(-4,De.R),se.write_shift(-4,De.C),De.clsid)se.write_shift(16,De.clsid,"hex");else for(Ie=0;Ie<4;++Ie)se.write_shift(4,0);se.write_shift(4,De.state||0),se.write_shift(4,0),se.write_shift(4,0),se.write_shift(4,0),se.write_shift(4,0),se.write_shift(4,De.start),se.write_shift(4,De.size),se.write_shift(4,0)}for(ce=1;ce<B.FileIndex.length;++ce)if(De=B.FileIndex[ce],De.size>=4096)if(se.l=De.start+1<<9,vr&&Buffer.isBuffer(De.content))De.content.copy(se,se.l,0,De.size),se.l+=De.size+511&-512;else{for(Ie=0;Ie<De.size;++Ie)se.write_shift(1,De.content[Ie]);for(;Ie&511;++Ie)se.write_shift(1,0)}for(ce=1;ce<B.FileIndex.length;++ce)if(De=B.FileIndex[ce],De.size>0&&De.size<4096)if(vr&&Buffer.isBuffer(De.content))De.content.copy(se,se.l,0,De.size),se.l+=De.size+63&-64;else{for(Ie=0;Ie<De.size;++Ie)se.write_shift(1,De.content[Ie]);for(;Ie&63;++Ie)se.write_shift(1,0)}if(vr)se.l=se.length;else for(;se.l<se.length;)se.write_shift(1,0);return se}function A(B,oe){var K=B.FullPaths.map(function(Ie){return Ie.toUpperCase()}),J=K.map(function(Ie){var Ae=Ie.split("/");return Ae[Ae.length-(Ie.slice(-1)=="/"?2:1)]}),se=!1;oe.charCodeAt(0)===47?(se=!0,oe=K[0].slice(0,-1)+oe):se=oe.indexOf("/")!==-1;var ce=oe.toUpperCase(),Oe=se===!0?K.indexOf(ce):J.indexOf(ce);if(Oe!==-1)return B.FileIndex[Oe];var Le=!ce.match(of);for(ce=ce.replace(rc,""),Le&&(ce=ce.replace(of,"!")),Oe=0;Oe<K.length;++Oe)if((Le?K[Oe].replace(of,"!"):K[Oe]).replace(rc,"")==ce||(Le?J[Oe].replace(of,"!"):J[Oe]).replace(rc,"")==ce)return B.FileIndex[Oe];return null}var V=64,de=-2,ue="d0cf11e0a1b11ae1",xe=[208,207,17,224,161,177,26,225],Ne="00000000000000000000000000000000",Re={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:de,FREESECT:-1,HEADER_SIGNATURE:ue,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:Ne,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function Ee(B,oe,K){c();var J=ae(B,K);l.writeFileSync(oe,J)}function Be(B){for(var oe=new Array(B.length),K=0;K<B.length;++K)oe[K]=String.fromCharCode(B[K]);return oe.join("")}function Je(B,oe){var K=ae(B,oe);switch(oe&&oe.type||"buffer"){case"file":return c(),l.writeFileSync(oe.filename,K),K;case"binary":return typeof K=="string"?K:Be(K);case"base64":return k0(typeof K=="string"?K:Be(K));case"buffer":if(vr)return Buffer.isBuffer(K)?K:Ho(K);case"array":return typeof K=="string"?Va(K):K}return K}var qe;function E(B){try{var oe=B.InflateRaw,K=new oe;if(K._processChunk(new Uint8Array([3,0]),K._finishFlushFlag),K.bytesRead)qe=B;else throw new Error("zlib does not expose bytesRead")}catch(J){console.error("cannot use native zlib: "+(J.message||J))}}function U(B,oe){if(!qe)return Sr(B,oe);var K=qe.InflateRaw,J=new K,se=J._processChunk(B.slice(B.l),J._finishFlushFlag);return B.l+=J.bytesRead,se}function T(B){return qe?qe.deflateRawSync(B):jt(B)}var R=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],te=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],pe=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function ye(B){var oe=(B<<1|B<<11)&139536|(B<<5|B<<15)&558144;return(oe>>16|oe>>8|oe)&255}for(var ve=typeof Uint8Array<"u",_e=ve?new Uint8Array(256):[],He=0;He<256;++He)_e[He]=ye(He);function Ye(B,oe){var K=_e[B&255];return oe<=8?K>>>8-oe:(K=K<<8|_e[B>>8&255],oe<=16?K>>>16-oe:(K=K<<8|_e[B>>16&255],K>>>24-oe))}function nt(B,oe){var K=oe&7,J=oe>>>3;return(B[J]|(K<=6?0:B[J+1]<<8))>>>K&3}function at(B,oe){var K=oe&7,J=oe>>>3;return(B[J]|(K<=5?0:B[J+1]<<8))>>>K&7}function Q(B,oe){var K=oe&7,J=oe>>>3;return(B[J]|(K<=4?0:B[J+1]<<8))>>>K&15}function tt(B,oe){var K=oe&7,J=oe>>>3;return(B[J]|(K<=3?0:B[J+1]<<8))>>>K&31}function Qe(B,oe){var K=oe&7,J=oe>>>3;return(B[J]|(K<=1?0:B[J+1]<<8))>>>K&127}function _t(B,oe,K){var J=oe&7,se=oe>>>3,ce=(1<<K)-1,Oe=B[se]>>>J;return K<8-J||(Oe|=B[se+1]<<8-J,K<16-J)||(Oe|=B[se+2]<<16-J,K<24-J)||(Oe|=B[se+3]<<24-J),Oe&ce}function $e(B,oe,K){var J=oe&7,se=oe>>>3;return J<=5?B[se]|=(K&7)<<J:(B[se]|=K<<J&255,B[se+1]=(K&7)>>8-J),oe+3}function Et(B,oe,K){var J=oe&7,se=oe>>>3;return K=(K&1)<<J,B[se]|=K,oe+1}function pt(B,oe,K){var J=oe&7,se=oe>>>3;return K<<=J,B[se]|=K&255,K>>>=8,B[se+1]=K,oe+8}function At(B,oe,K){var J=oe&7,se=oe>>>3;return K<<=J,B[se]|=K&255,K>>>=8,B[se+1]=K&255,B[se+2]=K>>>8,oe+16}function Pt(B,oe){var K=B.length,J=2*K>oe?2*K:oe+5,se=0;if(K>=oe)return B;if(vr){var ce=P1(J);if(B.copy)B.copy(ce);else for(;se<B.length;++se)ce[se]=B[se];return ce}else if(ve){var Oe=new Uint8Array(J);if(Oe.set)Oe.set(B);else for(;se<K;++se)Oe[se]=B[se];return Oe}return B.length=J,B}function Kt(B){for(var oe=new Array(B),K=0;K<B;++K)oe[K]=0;return oe}function Zt(B,oe,K){var J=1,se=0,ce=0,Oe=0,Le=0,Ie=B.length,Ae=ve?new Uint16Array(32):Kt(32);for(ce=0;ce<32;++ce)Ae[ce]=0;for(ce=Ie;ce<K;++ce)B[ce]=0;Ie=B.length;var De=ve?new Uint16Array(Ie):Kt(Ie);for(ce=0;ce<Ie;++ce)Ae[se=B[ce]]++,J<se&&(J=se),De[ce]=0;for(Ae[0]=0,ce=1;ce<=J;++ce)Ae[ce+16]=Le=Le+Ae[ce-1]<<1;for(ce=0;ce<Ie;++ce)Le=B[ce],Le!=0&&(De[ce]=Ae[Le+16]++);var et=0;for(ce=0;ce<Ie;++ce)if(et=B[ce],et!=0)for(Le=Ye(De[ce],J)>>J-et,Oe=(1<<J+4-et)-1;Oe>=0;--Oe)oe[Le|Oe<<et]=et&15|ce<<4;return J}var Lt=ve?new Uint16Array(512):Kt(512),rr=ve?new Uint16Array(32):Kt(32);if(!ve){for(var Wt=0;Wt<512;++Wt)Lt[Wt]=0;for(Wt=0;Wt<32;++Wt)rr[Wt]=0}(function(){for(var B=[],oe=0;oe<32;oe++)B.push(5);Zt(B,rr,32);var K=[];for(oe=0;oe<=143;oe++)K.push(8);for(;oe<=255;oe++)K.push(9);for(;oe<=279;oe++)K.push(7);for(;oe<=287;oe++)K.push(8);Zt(K,Lt,288)})();var yt=(function(){for(var oe=ve?new Uint8Array(32768):[],K=0,J=0;K<pe.length-1;++K)for(;J<pe[K+1];++J)oe[J]=K;for(;J<32768;++J)oe[J]=29;var se=ve?new Uint8Array(259):[];for(K=0,J=0;K<te.length-1;++K)for(;J<te[K+1];++J)se[J]=K;function ce(Le,Ie){for(var Ae=0;Ae<Le.length;){var De=Math.min(65535,Le.length-Ae),et=Ae+De==Le.length;for(Ie.write_shift(1,+et),Ie.write_shift(2,De),Ie.write_shift(2,~De&65535);De-- >0;)Ie[Ie.l++]=Le[Ae++]}return Ie.l}function Oe(Le,Ie){for(var Ae=0,De=0,et=ve?new Uint16Array(32768):[];De<Le.length;){var it=Math.min(65535,Le.length-De);if(it<10){for(Ae=$e(Ie,Ae,+(De+it==Le.length)),Ae&7&&(Ae+=8-(Ae&7)),Ie.l=Ae/8|0,Ie.write_shift(2,it),Ie.write_shift(2,~it&65535);it-- >0;)Ie[Ie.l++]=Le[De++];Ae=Ie.l*8;continue}Ae=$e(Ie,Ae,+(De+it==Le.length)+2);for(var mt=0;it-- >0;){var ot=Le[De];mt=(mt<<5^ot)&32767;var lt=-1,Rt=0;if((lt=et[mt])&&(lt|=De&-32768,lt>De&&(lt-=32768),lt<De))for(;Le[lt+Rt]==Le[De+Rt]&&Rt<250;)++Rt;if(Rt>2){ot=se[Rt],ot<=22?Ae=pt(Ie,Ae,_e[ot+1]>>1)-1:(pt(Ie,Ae,3),Ae+=5,pt(Ie,Ae,_e[ot-23]>>5),Ae+=3);var wr=ot<8?0:ot-4>>2;wr>0&&(At(Ie,Ae,Rt-te[ot]),Ae+=wr),ot=oe[De-lt],Ae=pt(Ie,Ae,_e[ot]>>3),Ae-=3;var Dr=ot<4?0:ot-2>>1;Dr>0&&(At(Ie,Ae,De-lt-pe[ot]),Ae+=Dr);for(var zr=0;zr<Rt;++zr)et[mt]=De&32767,mt=(mt<<5^Le[De])&32767,++De;it-=Rt-1}else ot<=143?ot=ot+48:Ae=Et(Ie,Ae,1),Ae=pt(Ie,Ae,_e[ot]),et[mt]=De&32767,++De}Ae=pt(Ie,Ae,0)-1}return Ie.l=(Ae+7)/8|0,Ie.l}return function(Ie,Ae){return Ie.length<8?ce(Ie,Ae):Oe(Ie,Ae)}})();function jt(B){var oe=Ue(50+Math.floor(B.length*1.1)),K=yt(B,oe);return oe.slice(0,K)}var kt=ve?new Uint16Array(32768):Kt(32768),$r=ve?new Uint16Array(32768):Kt(32768),ar=ve?new Uint16Array(128):Kt(128),$t=1,Xt=1;function Ur(B,oe){var K=tt(B,oe)+257;oe+=5;var J=tt(B,oe)+1;oe+=5;var se=Q(B,oe)+4;oe+=4;for(var ce=0,Oe=ve?new Uint8Array(19):Kt(19),Le=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],Ie=1,Ae=ve?new Uint8Array(8):Kt(8),De=ve?new Uint8Array(8):Kt(8),et=Oe.length,it=0;it<se;++it)Oe[R[it]]=ce=at(B,oe),Ie<ce&&(Ie=ce),Ae[ce]++,oe+=3;var mt=0;for(Ae[0]=0,it=1;it<=Ie;++it)De[it]=mt=mt+Ae[it-1]<<1;for(it=0;it<et;++it)(mt=Oe[it])!=0&&(Le[it]=De[mt]++);var ot=0;for(it=0;it<et;++it)if(ot=Oe[it],ot!=0){mt=_e[Le[it]]>>8-ot;for(var lt=(1<<7-ot)-1;lt>=0;--lt)ar[mt|lt<<ot]=ot&7|it<<3}var Rt=[];for(Ie=1;Rt.length<K+J;)switch(mt=ar[Qe(B,oe)],oe+=mt&7,mt>>>=3){case 16:for(ce=3+nt(B,oe),oe+=2,mt=Rt[Rt.length-1];ce-- >0;)Rt.push(mt);break;case 17:for(ce=3+at(B,oe),oe+=3;ce-- >0;)Rt.push(0);break;case 18:for(ce=11+Qe(B,oe),oe+=7;ce-- >0;)Rt.push(0);break;default:Rt.push(mt),Ie<mt&&(Ie=mt);break}var wr=Rt.slice(0,K),Dr=Rt.slice(K);for(it=K;it<286;++it)wr[it]=0;for(it=J;it<30;++it)Dr[it]=0;return $t=Zt(wr,kt,286),Xt=Zt(Dr,$r,30),oe}function Tt(B,oe){if(B[0]==3&&!(B[1]&3))return[pl(oe),2];for(var K=0,J=0,se=P1(oe||1<<18),ce=0,Oe=se.length>>>0,Le=0,Ie=0;(J&1)==0;){if(J=at(B,K),K+=3,J>>>1)J>>1==1?(Le=9,Ie=5):(K=Ur(B,K),Le=$t,Ie=Xt);else{K&7&&(K+=8-(K&7));var Ae=B[K>>>3]|B[(K>>>3)+1]<<8;if(K+=32,Ae>0)for(!oe&&Oe<ce+Ae&&(se=Pt(se,ce+Ae),Oe=se.length);Ae-- >0;)se[ce++]=B[K>>>3],K+=8;continue}for(;;){!oe&&Oe<ce+32767&&(se=Pt(se,ce+32767),Oe=se.length);var De=_t(B,K,Le),et=J>>>1==1?Lt[De]:kt[De];if(K+=et&15,et>>>=4,(et>>>8&255)===0)se[ce++]=et;else{if(et==256)break;et-=257;var it=et<8?0:et-4>>2;it>5&&(it=0);var mt=ce+te[et];it>0&&(mt+=_t(B,K,it),K+=it),De=_t(B,K,Ie),et=J>>>1==1?rr[De]:$r[De],K+=et&15,et>>>=4;var ot=et<4?0:et-2>>1,lt=pe[et];for(ot>0&&(lt+=_t(B,K,ot),K+=ot),!oe&&Oe<mt&&(se=Pt(se,mt+100),Oe=se.length);ce<mt;)se[ce]=se[ce-lt],++ce}}}return oe?[se,K+7>>>3]:[se.slice(0,ce),K+7>>>3]}function Sr(B,oe){var K=B.slice(B.l||0),J=Tt(K,oe);return B.l+=J[1],J[0]}function Dt(B,oe){if(B)typeof console<"u"&&console.error(oe);else throw new Error(oe)}function Vt(B,oe){var K=B;ea(K,0);var J=[],se=[],ce={FileIndex:J,FullPaths:se};re(ce,{root:oe.root});for(var Oe=K.length-4;(K[Oe]!=80||K[Oe+1]!=75||K[Oe+2]!=5||K[Oe+3]!=6)&&Oe>=0;)--Oe;K.l=Oe+4,K.l+=4;var Le=K.read_shift(2);K.l+=6;var Ie=K.read_shift(4);for(K.l=Ie,Oe=0;Oe<Le;++Oe){K.l+=20;var Ae=K.read_shift(4),De=K.read_shift(4),et=K.read_shift(2),it=K.read_shift(2),mt=K.read_shift(2);K.l+=8;var ot=K.read_shift(4),lt=s(K.slice(K.l+et,K.l+et+it));K.l+=et+it+mt;var Rt=K.l;K.l=ot+4,Vr(K,Ae,De,ce,lt),K.l=Rt}return ce}function Vr(B,oe,K,J,se){B.l+=2;var ce=B.read_shift(2),Oe=B.read_shift(2),Le=o(B);if(ce&8257)throw new Error("Unsupported ZIP encryption");for(var Ie=B.read_shift(4),Ae=B.read_shift(4),De=B.read_shift(4),et=B.read_shift(2),it=B.read_shift(2),mt="",ot=0;ot<et;++ot)mt+=String.fromCharCode(B[B.l++]);if(it){var lt=s(B.slice(B.l,B.l+it));(lt[21589]||{}).mt&&(Le=lt[21589].mt),((se||{})[21589]||{}).mt&&(Le=se[21589].mt)}B.l+=it;var Rt=B.slice(B.l,B.l+Ae);switch(Oe){case 8:Rt=U(B,De);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+Oe)}var wr=!1;ce&8&&(Ie=B.read_shift(4),Ie==134695760&&(Ie=B.read_shift(4),wr=!0),Ae=B.read_shift(4),De=B.read_shift(4)),Ae!=oe&&Dt(wr,"Bad compressed size: "+oe+" != "+Ae),De!=K&&Dt(wr,"Bad uncompressed size: "+K+" != "+De),ai(J,mt,Rt,{unsafe:!0,mt:Le})}function er(B,oe){var K=oe||{},J=[],se=[],ce=Ue(1),Oe=K.compression?8:0,Le=0,Ie=!1;Ie&&(Le|=8);var Ae=0,De=0,et=0,it=0,mt=B.FullPaths[0],ot=mt,lt=B.FileIndex[0],Rt=[],wr=0;for(Ae=1;Ae<B.FullPaths.length;++Ae)if(ot=B.FullPaths[Ae].slice(mt.length),lt=B.FileIndex[Ae],!(!lt.size||!lt.content||ot=="Sh33tJ5")){var Dr=et,zr=Ue(ot.length);for(De=0;De<ot.length;++De)zr.write_shift(1,ot.charCodeAt(De)&127);zr=zr.slice(0,zr.l),Rt[it]=Hw.buf(lt.content,0);var Rn=lt.content;Oe==8&&(Rn=T(Rn)),ce=Ue(30),ce.write_shift(4,67324752),ce.write_shift(2,20),ce.write_shift(2,Le),ce.write_shift(2,Oe),lt.mt?a(ce,lt.mt):ce.write_shift(4,0),ce.write_shift(-4,Le&8?0:Rt[it]),ce.write_shift(4,Le&8?0:Rn.length),ce.write_shift(4,Le&8?0:lt.content.length),ce.write_shift(2,zr.length),ce.write_shift(2,0),et+=ce.length,J.push(ce),et+=zr.length,J.push(zr),et+=Rn.length,J.push(Rn),Le&8&&(ce=Ue(12),ce.write_shift(-4,Rt[it]),ce.write_shift(4,Rn.length),ce.write_shift(4,lt.content.length),et+=ce.l,J.push(ce)),ce=Ue(46),ce.write_shift(4,33639248),ce.write_shift(2,0),ce.write_shift(2,20),ce.write_shift(2,Le),ce.write_shift(2,Oe),ce.write_shift(4,0),ce.write_shift(-4,Rt[it]),ce.write_shift(4,Rn.length),ce.write_shift(4,lt.content.length),ce.write_shift(2,zr.length),ce.write_shift(2,0),ce.write_shift(2,0),ce.write_shift(2,0),ce.write_shift(2,0),ce.write_shift(4,0),ce.write_shift(4,Dr),wr+=ce.l,se.push(ce),wr+=zr.length,se.push(zr),++it}return ce=Ue(22),ce.write_shift(4,101010256),ce.write_shift(2,0),ce.write_shift(2,0),ce.write_shift(2,it),ce.write_shift(2,it),ce.write_shift(4,wr),ce.write_shift(4,et),ce.write_shift(2,0),ei([ei(J),ei(se),ce])}var It={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function pr(B,oe){if(B.ctype)return B.ctype;var K=B.name||"",J=K.match(/\.([^\.]+)$/);return J&&It[J[1]]||oe&&(J=(K=oe).match(/[\.\\]([^\.\\])+$/),J&&It[J[1]])?It[J[1]]:"application/octet-stream"}function vo(B){for(var oe=k0(B),K=[],J=0;J<oe.length;J+=76)K.push(oe.slice(J,J+76));return K.join(`\r
`)+`\r
`}function Nn(B){var oe=B.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(Ae){var De=Ae.charCodeAt(0).toString(16).toUpperCase();return"="+(De.length==1?"0"+De:De)});oe=oe.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),oe.charAt(0)==`
`&&(oe="=0D"+oe.slice(1)),oe=oe.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var K=[],J=oe.split(`\r
`),se=0;se<J.length;++se){var ce=J[se];if(ce.length==0){K.push("");continue}for(var Oe=0;Oe<ce.length;){var Le=76,Ie=ce.slice(Oe,Oe+Le);Ie.charAt(Le-1)=="="?Le--:Ie.charAt(Le-2)=="="?Le-=2:Ie.charAt(Le-3)=="="&&(Le-=3),Ie=ce.slice(Oe,Oe+Le),Oe+=Le,Oe<ce.length&&(Ie+="="),K.push(Ie)}}return K.join(`\r
`)}function Pa(B){for(var oe=[],K=0;K<B.length;++K){for(var J=B[K];K<=B.length&&J.charAt(J.length-1)=="=";)J=J.slice(0,J.length-1)+B[++K];oe.push(J)}for(var se=0;se<oe.length;++se)oe[se]=oe[se].replace(/[=][0-9A-Fa-f]{2}/g,function(ce){return String.fromCharCode(parseInt(ce.slice(1),16))});return Va(oe.join(`\r
`))}function sa(B,oe,K){for(var J="",se="",ce="",Oe,Le=0;Le<10;++Le){var Ie=oe[Le];if(!Ie||Ie.match(/^\s*$/))break;var Ae=Ie.match(/^(.*?):\s*([^\s].*)$/);if(Ae)switch(Ae[1].toLowerCase()){case"content-location":J=Ae[2].trim();break;case"content-type":ce=Ae[2].trim();break;case"content-transfer-encoding":se=Ae[2].trim();break}}switch(++Le,se.toLowerCase()){case"base64":Oe=Va(zo(oe.slice(Le).join("")));break;case"quoted-printable":Oe=Pa(oe.slice(Le));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+se)}var De=ai(B,J.slice(K.length),Oe,{unsafe:!0});ce&&(De.ctype=ce)}function Nt(B,oe){if(Be(B.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var K=oe&&oe.root||"",J=(vr&&Buffer.isBuffer(B)?B.toString("binary"):Be(B)).split(`\r
`),se=0,ce="";for(se=0;se<J.length;++se)if(ce=J[se],!!/^Content-Location:/i.test(ce)&&(ce=ce.slice(ce.indexOf("file")),K||(K=ce.slice(0,ce.lastIndexOf("/")+1)),ce.slice(0,K.length)!=K))for(;K.length>0&&(K=K.slice(0,K.length-1),K=K.slice(0,K.lastIndexOf("/")+1),ce.slice(0,K.length)!=K););var Oe=(J[1]||"").match(/boundary="(.*?)"/);if(!Oe)throw new Error("MAD cannot find boundary");var Le="--"+(Oe[1]||""),Ie=[],Ae=[],De={FileIndex:Ie,FullPaths:Ae};re(De);var et,it=0;for(se=0;se<J.length;++se){var mt=J[se];mt!==Le&&mt!==Le+"--"||(it++&&sa(De,J.slice(et,se),K),et=se)}return De}function Oa(B,oe){var K=oe||{},J=K.boundary||"SheetJS";J="------="+J;for(var se=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+J.slice(2)+'"',"","",""],ce=B.FullPaths[0],Oe=ce,Le=B.FileIndex[0],Ie=1;Ie<B.FullPaths.length;++Ie)if(Oe=B.FullPaths[Ie].slice(ce.length),Le=B.FileIndex[Ie],!(!Le.size||!Le.content||Oe=="Sh33tJ5")){Oe=Oe.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Rt){return"_x"+Rt.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Rt){return"_u"+Rt.charCodeAt(0).toString(16)+"_"});for(var Ae=Le.content,De=vr&&Buffer.isBuffer(Ae)?Ae.toString("binary"):Be(Ae),et=0,it=Math.min(1024,De.length),mt=0,ot=0;ot<=it;++ot)(mt=De.charCodeAt(ot))>=32&&mt<128&&++et;var lt=et>=it*4/5;se.push(J),se.push("Content-Location: "+(K.root||"file:///C:/SheetJS/")+Oe),se.push("Content-Transfer-Encoding: "+(lt?"quoted-printable":"base64")),se.push("Content-Type: "+pr(Le,Oe)),se.push(""),se.push(lt?Nn(De):vo(De))}return se.push(J+`--\r
`),se.join(`\r
`)}function Aa(B){var oe={};return re(oe,B),oe}function ai(B,oe,K,J){var se=J&&J.unsafe;se||re(B);var ce=!se&&Fr.find(B,oe);if(!ce){var Oe=B.FullPaths[0];oe.slice(0,Oe.length)==Oe?Oe=oe:(Oe.slice(-1)!="/"&&(Oe+="/"),Oe=(Oe+oe).replace("//","/")),ce={name:i(oe),type:2},B.FileIndex.push(ce),B.FullPaths.push(Oe),se||Fr.utils.cfb_gc(B)}return ce.content=K,ce.size=K?K.length:0,J&&(J.CLSID&&(ce.clsid=J.CLSID),J.mt&&(ce.mt=J.mt),J.ct&&(ce.ct=J.ct)),ce}function ki(B,oe){re(B);var K=Fr.find(B,oe);if(K){for(var J=0;J<B.FileIndex.length;++J)if(B.FileIndex[J]==K)return B.FileIndex.splice(J,1),B.FullPaths.splice(J,1),!0}return!1}function Xr(B,oe,K){re(B);var J=Fr.find(B,oe);if(J){for(var se=0;se<B.FileIndex.length;++se)if(B.FileIndex[se]==J)return B.FileIndex[se].name=i(K),B.FullPaths[se]=K,!0}return!1}function vn(B){W(B,!0)}return r.find=A,r.read=ke,r.parse=f,r.write=Je,r.writeFile=Ee,r.utils={cfb_new:Aa,cfb_add:ai,cfb_del:ki,cfb_mov:Xr,cfb_gc:vn,ReadShift:x0,CheckField:U_,prep_blob:ea,bconcat:ei,use_zlib:E,_deflateRaw:jt,_inflateRaw:Sr,consts:Re},r})(),lf;function Ww(t){return typeof t=="string"?Mf(t):Array.isArray(t)?gw(t):t}function T0(t,r,e){if(typeof lf<"u"&&lf.writeFileSync)return e?lf.writeFileSync(t,r,e):lf.writeFileSync(t,r);if(typeof Deno<"u"){if(e&&typeof r=="string")switch(e){case"utf8":r=new TextEncoder(e).encode(r);break;case"binary":r=Mf(r);break;default:throw new Error("Unsupported encoding "+e)}return Deno.writeFileSync(t,r)}var n=e=="utf8"?Lo(r):r;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,t);if(typeof Blob<"u"){var i=new Blob([Ww(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(i,t);if(typeof saveAs<"u")return saveAs(i,t);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var a=URL.createObjectURL(i);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(a)},6e4),chrome.downloads.download({url:a,filename:t,saveAs:!0});var o=document.createElement("a");if(o.download!=null)return o.download=t,o.href=a,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(a)},6e4),a}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var s=File(t);return s.open("w"),s.encoding="binary",Array.isArray(r)&&(r=A0(r)),s.write(r),s.close(),r}catch(l){if(!l.message||!l.message.match(/onstruct/))throw l}throw new Error("cannot save file "+t)}function ni(t){for(var r=Object.keys(t),e=[],n=0;n<r.length;++n)Object.prototype.hasOwnProperty.call(t,r[n])&&e.push(r[n]);return e}function R1(t,r){for(var e=[],n=ni(t),i=0;i!==n.length;++i)e[t[n[i]][r]]==null&&(e[t[n[i]][r]]=n[i]);return e}function np(t){for(var r=[],e=ni(t),n=0;n!==e.length;++n)r[t[e[n]]]=e[n];return r}function Af(t){for(var r=[],e=ni(t),n=0;n!==e.length;++n)r[t[e[n]]]=parseInt(e[n],10);return r}function qw(t){for(var r=[],e=ni(t),n=0;n!==e.length;++n)r[t[e[n]]]==null&&(r[t[e[n]]]=[]),r[t[e[n]]].push(e[n]);return r}var _f=new Date(1899,11,30,0,0,0);function Bi(t,r){var e=t.getTime();r&&(e-=1462*24*60*60*1e3);var n=_f.getTime()+(t.getTimezoneOffset()-_f.getTimezoneOffset())*6e4;return(e-n)/(1440*60*1e3)}var M_=new Date,Gw=_f.getTime()+(M_.getTimezoneOffset()-_f.getTimezoneOffset())*6e4,L1=M_.getTimezoneOffset();function P_(t){var r=new Date;return r.setTime(t*24*60*60*1e3+Gw),r.getTimezoneOffset()!==L1&&r.setTime(r.getTime()+(r.getTimezoneOffset()-L1)*6e4),r}var B1=new Date("2017-02-19T19:06:09.000Z"),O_=isNaN(B1.getFullYear())?new Date("2/19/17"):B1,$w=O_.getFullYear()==2017;function bi(t,r){var e=new Date(t);if($w)return r>0?e.setTime(e.getTime()+e.getTimezoneOffset()*60*1e3):r<0&&e.setTime(e.getTime()-e.getTimezoneOffset()*60*1e3),e;if(t instanceof Date)return t;if(O_.getFullYear()==1917&&!isNaN(e.getFullYear())){var n=e.getFullYear();return t.indexOf(""+n)>-1||e.setFullYear(e.getFullYear()+100),e}var i=t.match(/\d+/g)||["2017","2","19","0","0","0"],a=new Date(+i[0],+i[1]-1,+i[2],+i[3]||0,+i[4]||0,+i[5]||0);return t.indexOf("Z")>-1&&(a=new Date(a.getTime()-a.getTimezoneOffset()*60*1e3)),a}function Tf(t,r){if(vr&&Buffer.isBuffer(t)){if(r){if(t[0]==255&&t[1]==254)return Lo(t.slice(2).toString("utf16le"));if(t[1]==254&&t[2]==255)return Lo(mw(t.slice(2).toString("binary")))}return t.toString("binary")}if(typeof TextDecoder<"u")try{if(r){if(t[0]==255&&t[1]==254)return Lo(new TextDecoder("utf-16le").decode(t.slice(2)));if(t[0]==254&&t[1]==255)return Lo(new TextDecoder("utf-16be").decode(t.slice(2)))}var e={"\u20AC":"\x80","\u201A":"\x82",\u0192:"\x83","\u201E":"\x84","\u2026":"\x85","\u2020":"\x86","\u2021":"\x87","\u02C6":"\x88","\u2030":"\x89",\u0160:"\x8A","\u2039":"\x8B",\u0152:"\x8C",\u017D:"\x8E","\u2018":"\x91","\u2019":"\x92","\u201C":"\x93","\u201D":"\x94","\u2022":"\x95","\u2013":"\x96","\u2014":"\x97","\u02DC":"\x98","\u2122":"\x99",\u0161:"\x9A","\u203A":"\x9B",\u0153:"\x9C",\u017E:"\x9E",\u0178:"\x9F"};return Array.isArray(t)&&(t=new Uint8Array(t)),new TextDecoder("latin1").decode(t).replace(/[€‚ƒ„…†‡ˆ‰Š‹ŒŽ‘’“”•–—˜™š›œžŸ]/g,function(a){return e[a]||a})}catch{}for(var n=[],i=0;i!=t.length;++i)n.push(String.fromCharCode(t[i]));return n.join("")}function Ui(t){if(typeof JSON<"u"&&!Array.isArray(t))return JSON.parse(JSON.stringify(t));if(typeof t!="object"||t==null)return t;if(t instanceof Date)return new Date(t.getTime());var r={};for(var e in t)Object.prototype.hasOwnProperty.call(t,e)&&(r[e]=Ui(t[e]));return r}function sn(t,r){for(var e="";e.length<r;)e+=t;return e}function Uo(t){var r=Number(t);if(!isNaN(r))return isFinite(r)?r:NaN;if(!/\d/.test(t))return r;var e=1,n=t.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return e*=100,""});return!isNaN(r=Number(n))||(n=n.replace(/[(](.*)[)]/,function(i,a){return e=-e,a}),!isNaN(r=Number(n)))?r/e:r}var Xw=["january","february","march","april","may","june","july","august","september","october","november","december"];function E0(t){var r=new Date(t),e=new Date(NaN),n=r.getYear(),i=r.getMonth(),a=r.getDate();if(isNaN(a))return e;var o=t.toLowerCase();if(o.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(o=o.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),o.length>3&&Xw.indexOf(o)==-1)return e}else if(o.match(/[a-z]/))return e;return n<0||n>8099?e:(i>0||a>1)&&n!=101?r:t.match(/[^-0-9:,\/\\]/)?e:r}function tr(t,r,e){if(t.FullPaths){if(typeof e=="string"){var n;return vr?n=Ho(e):n=_w(e),Fr.utils.cfb_add(t,r,n)}Fr.utils.cfb_add(t,r,e)}else t.file(r,e)}function ip(){return Fr.utils.cfb_new()}var En=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`;var Yw={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},ap=np(Yw);var op=/[&<>'"]/g,Kw=/[\u0000-\u0008\u000b-\u001f]/g;function Or(t){var r=t+"";return r.replace(op,function(e){return ap[e]}).replace(Kw,function(e){return"_x"+("000"+e.charCodeAt(0).toString(16)).slice(-4)+"_"})}function U1(t){return Or(t).replace(/ /g,"_x0020_")}var A_=/[\u0000-\u001f]/g;function Zw(t){var r=t+"";return r.replace(op,function(e){return ap[e]}).replace(/\n/g,"<br/>").replace(A_,function(e){return"&#x"+("000"+e.charCodeAt(0).toString(16)).slice(-4)+";"})}function Jw(t){var r=t+"";return r.replace(op,function(e){return ap[e]}).replace(A_,function(e){return"&#x"+e.charCodeAt(0).toString(16).toUpperCase()+";"})}function Qw(t){return t.replace(/(\r\n|[\r\n])/g,"&#10;")}function ey(t){switch(t){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Wh(t){for(var r="",e=0,n=0,i=0,a=0,o=0,s=0;e<t.length;){if(n=t.charCodeAt(e++),n<128){r+=String.fromCharCode(n);continue}if(i=t.charCodeAt(e++),n>191&&n<224){o=(n&31)<<6,o|=i&63,r+=String.fromCharCode(o);continue}if(a=t.charCodeAt(e++),n<240){r+=String.fromCharCode((n&15)<<12|(i&63)<<6|a&63);continue}o=t.charCodeAt(e++),s=((n&7)<<18|(i&63)<<12|(a&63)<<6|o&63)-65536,r+=String.fromCharCode(55296+(s>>>10&1023)),r+=String.fromCharCode(56320+(s&1023))}return r}function V1(t){var r=pl(2*t.length),e,n,i=1,a=0,o=0,s;for(n=0;n<t.length;n+=i)i=1,(s=t.charCodeAt(n))<128?e=s:s<224?(e=(s&31)*64+(t.charCodeAt(n+1)&63),i=2):s<240?(e=(s&15)*4096+(t.charCodeAt(n+1)&63)*64+(t.charCodeAt(n+2)&63),i=3):(i=4,e=(s&7)*262144+(t.charCodeAt(n+1)&63)*4096+(t.charCodeAt(n+2)&63)*64+(t.charCodeAt(n+3)&63),e-=65536,o=55296+(e>>>10&1023),e=56320+(e&1023)),o!==0&&(r[a++]=o&255,r[a++]=o>>>8,o=0),r[a++]=e%256,r[a++]=e>>>8;return r.slice(0,a).toString("ucs2")}function z1(t){return Ho(t,"binary").toString("utf8")}var cf="foo bar baz\xE2\x98\x83\xF0\x9F\x8D\xA3",v0=vr&&(z1(cf)==Wh(cf)&&z1||V1(cf)==Wh(cf)&&V1)||Wh,Lo=vr?function(t){return Ho(t,"utf8").toString("binary")}:function(t){for(var r=[],e=0,n=0,i=0;e<t.length;)switch(n=t.charCodeAt(e++),!0){case n<128:r.push(String.fromCharCode(n));break;case n<2048:r.push(String.fromCharCode(192+(n>>6))),r.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,i=t.charCodeAt(e++)-56320+(n<<10),r.push(String.fromCharCode(240+(i>>18&7))),r.push(String.fromCharCode(144+(i>>12&63))),r.push(String.fromCharCode(128+(i>>6&63))),r.push(String.fromCharCode(128+(i&63)));break;default:r.push(String.fromCharCode(224+(n>>12))),r.push(String.fromCharCode(128+(n>>6&63))),r.push(String.fromCharCode(128+(n&63)))}return r.join("")};var ty=(function(){var t=[["nbsp"," "],["middot","\xB7"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(r){return[new RegExp("&"+r[0]+";","ig"),r[1]]});return function(e){for(var n=e.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),i=0;i<t.length;++i)n=n.replace(t[i][0],t[i][1]);return n}})();var T_=/(^\s|\s$|\n)/;function ti(t,r){return"<"+t+(r.match(T_)?' xml:space="preserve"':"")+">"+r+"</"+t+">"}function M0(t){return ni(t).map(function(r){return" "+r+'="'+t[r]+'"'}).join("")}function st(t,r,e){return"<"+t+(e!=null?M0(e):"")+(r!=null?(r.match(T_)?' xml:space="preserve"':"")+">"+r+"</"+t:"/")+">"}function Jh(t,r){try{return t.toISOString().replace(/\.\d*/,"")}catch(e){if(r)throw e}return""}function ry(t,r){switch(typeof t){case"string":var e=st("vt:lpwstr",Or(t));return r&&(e=e.replace(/&quot;/g,"_x0022_")),e;case"number":return st((t|0)==t?"vt:i4":"vt:r8",Or(String(t)));case"boolean":return st("vt:bool",t?"true":"false")}if(t instanceof Date)return st("vt:filetime",Jh(t));throw new Error("Unable to serialize "+t)}var jn={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",mx:"http://schemas.microsoft.com/office/mac/excel/2008/main",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",sjs:"http://schemas.openxmlformats.org/package/2006/sheetjs/core-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},cc=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],ta={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function ny(t,r){for(var e=1-2*(t[r+7]>>>7),n=((t[r+7]&127)<<4)+(t[r+6]>>>4&15),i=t[r+6]&15,a=5;a>=0;--a)i=i*256+t[r+a];return n==2047?i==0?e*(1/0):NaN:(n==0?n=-1022:(n-=1023,i+=Math.pow(2,52)),e*Math.pow(2,n-52)*i)}function iy(t,r,e){var n=(r<0||1/r==-1/0?1:0)<<7,i=0,a=0,o=n?-r:r;isFinite(o)?o==0?i=a=0:(i=Math.floor(Math.log(o)/Math.LN2),a=o*Math.pow(2,52-i),i<=-1023&&(!isFinite(a)||a<Math.pow(2,52))?i=-1022:(a-=Math.pow(2,52),i+=1023)):(i=2047,a=isNaN(r)?26985:0);for(var s=0;s<=5;++s,a/=256)t[e+s]=a&255;t[e+6]=(i&15)<<4|a&15,t[e+7]=i>>4|n}var j1=function(t){for(var r=[],e=10240,n=0;n<t[0].length;++n)if(t[0][n])for(var i=0,a=t[0][n].length;i<a;i+=e)r.push.apply(r,t[0][n].slice(i,i+e));return r},H1=vr?function(t){return t[0].length>0&&Buffer.isBuffer(t[0][0])?Buffer.concat(t[0].map(function(r){return Buffer.isBuffer(r)?r:Ho(r)})):j1(t)}:j1,W1=function(t,r,e){for(var n=[],i=r;i<e;i+=2)n.push(String.fromCharCode(_0(t,i)));return n.join("").replace(rc,"")},If=vr?function(t,r,e){return Buffer.isBuffer(t)?t.toString("utf16le",r,e).replace(rc,""):W1(t,r,e)}:W1,q1=function(t,r,e){for(var n=[],i=r;i<r+e;++i)n.push(("0"+t[i].toString(16)).slice(-2));return n.join("")},I_=vr?function(t,r,e){return Buffer.isBuffer(t)?t.toString("hex",r,r+e):q1(t,r,e)}:q1,G1=function(t,r,e){for(var n=[],i=r;i<e;i++)n.push(String.fromCharCode(ec(t,i)));return n.join("")},dc=vr?function(r,e,n){return Buffer.isBuffer(r)?r.toString("utf8",e,n):G1(r,e,n)}:G1,F_=function(t,r){var e=zn(t,r);return e>0?dc(t,r+4,r+4+e-1):""},sp=F_,D_=function(t,r){var e=zn(t,r);return e>0?dc(t,r+4,r+4+e-1):""},lp=D_,N_=function(t,r){var e=2*zn(t,r);return e>0?dc(t,r+4,r+4+e-1):""},cp=N_,R_=function(r,e){var n=zn(r,e);return n>0?If(r,e+4,e+4+n):""},dp=R_,L_=function(t,r){var e=zn(t,r);return e>0?dc(t,r+4,r+4+e):""},fp=L_,B_=function(t,r){return ny(t,r)},vf=B_,up=function(r){return Array.isArray(r)||typeof Uint8Array<"u"&&r instanceof Uint8Array};vr&&(sp=function(r,e){if(!Buffer.isBuffer(r))return F_(r,e);var n=r.readUInt32LE(e);return n>0?r.toString("utf8",e+4,e+4+n-1):""},lp=function(r,e){if(!Buffer.isBuffer(r))return D_(r,e);var n=r.readUInt32LE(e);return n>0?r.toString("utf8",e+4,e+4+n-1):""},cp=function(r,e){if(!Buffer.isBuffer(r))return N_(r,e);var n=2*r.readUInt32LE(e);return r.toString("utf16le",e+4,e+4+n-1)},dp=function(r,e){if(!Buffer.isBuffer(r))return R_(r,e);var n=r.readUInt32LE(e);return r.toString("utf16le",e+4,e+4+n)},fp=function(r,e){if(!Buffer.isBuffer(r))return L_(r,e);var n=r.readUInt32LE(e);return r.toString("utf8",e+4,e+4+n)},vf=function(r,e){return Buffer.isBuffer(r)?r.readDoubleLE(e):B_(r,e)},up=function(r){return Buffer.isBuffer(r)||Array.isArray(r)||typeof Uint8Array<"u"&&r instanceof Uint8Array});function ay(){If=function(t,r,e){return Lr.utils.decode(1200,t.slice(r,e)).replace(rc,"")},dc=function(t,r,e){return Lr.utils.decode(65001,t.slice(r,e))},sp=function(t,r){var e=zn(t,r);return e>0?Lr.utils.decode(sc,t.slice(r+4,r+4+e-1)):""},lp=function(t,r){var e=zn(t,r);return e>0?Lr.utils.decode(ul,t.slice(r+4,r+4+e-1)):""},cp=function(t,r){var e=2*zn(t,r);return e>0?Lr.utils.decode(1200,t.slice(r+4,r+4+e-1)):""},dp=function(t,r){var e=zn(t,r);return e>0?Lr.utils.decode(1200,t.slice(r+4,r+4+e)):""},fp=function(t,r){var e=zn(t,r);return e>0?Lr.utils.decode(65001,t.slice(r+4,r+4+e)):""}}typeof Lr<"u"&&ay();var ec=function(t,r){return t[r]},_0=function(t,r){return t[r+1]*256+t[r]},oy=function(t,r){var e=t[r+1]*256+t[r];return e<32768?e:(65535-e+1)*-1},zn=function(t,r){return t[r+3]*(1<<24)+(t[r+2]<<16)+(t[r+1]<<8)+t[r]},fl=function(t,r){return t[r+3]<<24|t[r+2]<<16|t[r+1]<<8|t[r]},sy=function(t,r){return t[r]<<24|t[r+1]<<16|t[r+2]<<8|t[r+3]};function x0(t,r){var e="",n,i,a=[],o,s,l,c;switch(r){case"dbcs":if(c=this.l,vr&&Buffer.isBuffer(this))e=this.slice(this.l,this.l+2*t).toString("utf16le");else for(l=0;l<t;++l)e+=String.fromCharCode(_0(this,c)),c+=2;t*=2;break;case"utf8":e=dc(this,this.l,this.l+t);break;case"utf16le":t*=2,e=If(this,this.l,this.l+t);break;case"wstr":if(typeof Lr<"u")e=Lr.utils.decode(ul,this.slice(this.l,this.l+2*t));else return x0.call(this,t,"dbcs");t=2*t;break;case"lpstr-ansi":e=sp(this,this.l),t=4+zn(this,this.l);break;case"lpstr-cp":e=lp(this,this.l),t=4+zn(this,this.l);break;case"lpwstr":e=cp(this,this.l),t=4+2*zn(this,this.l);break;case"lpp4":t=4+zn(this,this.l),e=dp(this,this.l),t&2&&(t+=2);break;case"8lpp4":t=4+zn(this,this.l),e=fp(this,this.l),t&3&&(t+=4-(t&3));break;case"cstr":for(t=0,e="";(o=ec(this,this.l+t++))!==0;)a.push(af(o));e=a.join("");break;case"_wstr":for(t=0,e="";(o=_0(this,this.l+t))!==0;)a.push(af(o)),t+=2;t+=2,e=a.join("");break;case"dbcs-cont":for(e="",c=this.l,l=0;l<t;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return o=ec(this,c),this.l=c+1,s=x0.call(this,t-l,o?"dbcs-cont":"sbcs-cont"),a.join("")+s;a.push(af(_0(this,c))),c+=2}e=a.join(""),t*=2;break;case"cpstr":if(typeof Lr<"u"){e=Lr.utils.decode(ul,this.slice(this.l,this.l+t));break}case"sbcs-cont":for(e="",c=this.l,l=0;l!=t;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return o=ec(this,c),this.l=c+1,s=x0.call(this,t-l,o?"dbcs-cont":"sbcs-cont"),a.join("")+s;a.push(af(ec(this,c))),c+=1}e=a.join("");break;default:switch(t){case 1:return n=ec(this,this.l),this.l++,n;case 2:return n=(r==="i"?oy:_0)(this,this.l),this.l+=2,n;case 4:case-4:return r==="i"||(this[this.l+3]&128)===0?(n=(t>0?fl:sy)(this,this.l),this.l+=4,n):(i=zn(this,this.l),this.l+=4,i);case 8:case-8:if(r==="f")return t==8?i=vf(this,this.l):i=vf([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,i;t=8;case 16:e=I_(this,this.l,t);break}}return this.l+=t,e}var ly=function(t,r,e){t[e]=r&255,t[e+1]=r>>>8&255,t[e+2]=r>>>16&255,t[e+3]=r>>>24&255},cy=function(t,r,e){t[e]=r&255,t[e+1]=r>>8&255,t[e+2]=r>>16&255,t[e+3]=r>>24&255},dy=function(t,r,e){t[e]=r&255,t[e+1]=r>>>8&255};function fy(t,r,e){var n=0,i=0;if(e==="dbcs"){for(i=0;i!=r.length;++i)dy(this,r.charCodeAt(i),this.l+2*i);n=2*r.length}else if(e==="sbcs"){if(typeof Lr<"u"&&sc==874)for(i=0;i!=r.length;++i){var a=Lr.utils.encode(sc,r.charAt(i));this[this.l+i]=a[0]}else for(r=r.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=r.length;++i)this[this.l+i]=r.charCodeAt(i)&255;n=r.length}else if(e==="hex"){for(;i<t;++i)this[this.l++]=parseInt(r.slice(2*i,2*i+2),16)||0;return this}else if(e==="utf16le"){var o=Math.min(this.l+t,this.length);for(i=0;i<Math.min(r.length,t);++i){var s=r.charCodeAt(i);this[this.l++]=s&255,this[this.l++]=s>>8}for(;this.l<o;)this[this.l++]=0;return this}else switch(t){case 1:n=1,this[this.l]=r&255;break;case 2:n=2,this[this.l]=r&255,r>>>=8,this[this.l+1]=r&255;break;case 3:n=3,this[this.l]=r&255,r>>>=8,this[this.l+1]=r&255,r>>>=8,this[this.l+2]=r&255;break;case 4:n=4,ly(this,r,this.l);break;case 8:if(n=8,e==="f"){iy(this,r,this.l);break}case 16:break;case-4:n=4,cy(this,r,this.l);break}return this.l+=n,this}function U_(t,r){var e=I_(this,this.l,t.length>>1);if(e!==t)throw new Error(r+"Expected "+t+" saw "+e);this.l+=t.length>>1}function ea(t,r){t.l=r,t.read_shift=x0,t.chk=U_,t.write_shift=fy}function so(t,r){t.l+=r}function Ue(t){var r=pl(t);return ea(r,0),r}function Li(){var t=[],r=vr?256:2048,e=function(c){var f=Ue(c);return ea(f,0),f},n=e(r),i=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&t.push(n),n=null)},a=function(c){return n&&c<n.length-n.l?n:(i(),n=e(Math.max(c+1,r)))},o=function(){return i(),ei(t)},s=function(c){i(),n=c,n.l==null&&(n.l=n.length),a(r)};return{next:a,push:s,end:o,_bufs:t}}function Xe(t,r,e,n){var i=+r,a;if(!isNaN(i)){n||(n=iE[i].p||(e||[]).length||0),a=1+(i>=128?1:0)+1,n>=128&&++a,n>=16384&&++a,n>=2097152&&++a;var o=t.next(a);i<=127?o.write_shift(1,i):(o.write_shift(1,(i&127)+128),o.write_shift(1,i>>7));for(var s=0;s!=4;++s)if(n>=128)o.write_shift(1,(n&127)+128),n>>=7;else{o.write_shift(1,n);break}n>0&&up(e)&&t.push(e)}}function b0(t,r,e){var n=Ui(t);if(r.s?(n.cRel&&(n.c+=r.s.c),n.rRel&&(n.r+=r.s.r)):(n.cRel&&(n.c+=r.c),n.rRel&&(n.r+=r.r)),!e||e.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function $1(t,r,e){var n=Ui(t);return n.s=b0(n.s,r.s,e),n.e=b0(n.e,r.s,e),n}function w0(t,r){if(t.cRel&&t.c<0)for(t=Ui(t);t.c<0;)t.c+=r>8?16384:256;if(t.rRel&&t.r<0)for(t=Ui(t);t.r<0;)t.r+=r>8?1048576:r>5?65536:16384;var e=Ar(t);return!t.cRel&&t.cRel!=null&&(e=py(e)),!t.rRel&&t.rRel!=null&&(e=uy(e)),e}function qh(t,r){return t.s.r==0&&!t.s.rRel&&t.e.r==(r.biff>=12?1048575:r.biff>=8?65536:16384)&&!t.e.rRel?(t.s.cRel?"":"$")+si(t.s.c)+":"+(t.e.cRel?"":"$")+si(t.e.c):t.s.c==0&&!t.s.cRel&&t.e.c==(r.biff>=12?16383:255)&&!t.e.cRel?(t.s.rRel?"":"$")+ri(t.s.r)+":"+(t.e.rRel?"":"$")+ri(t.e.r):w0(t.s,r.biff)+":"+w0(t.e,r.biff)}function hp(t){return parseInt(hy(t),10)-1}function ri(t){return""+(t+1)}function uy(t){return t.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function hy(t){return t.replace(/\$(\d+)$/,"$1")}function pp(t){for(var r=my(t),e=0,n=0;n!==r.length;++n)e=26*e+r.charCodeAt(n)-64;return e-1}function si(t){if(t<0)throw new Error("invalid column "+t);var r="";for(++t;t;t=Math.floor((t-1)/26))r=String.fromCharCode((t-1)%26+65)+r;return r}function py(t){return t.replace(/^([A-Z])/,"$$$1")}function my(t){return t.replace(/^\$([A-Z])/,"$1")}function gy(t){return t.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Hn(t){for(var r=0,e=0,n=0;n<t.length;++n){var i=t.charCodeAt(n);i>=48&&i<=57?r=10*r+(i-48):i>=65&&i<=90&&(e=26*e+(i-64))}return{c:e-1,r:r-1}}function Ar(t){for(var r=t.c+1,e="";r;r=(r-1)/26|0)e=String.fromCharCode((r-1)%26+65)+e;return e+(t.r+1)}function ra(t){var r=t.indexOf(":");return r==-1?{s:Hn(t),e:Hn(t)}:{s:Hn(t.slice(0,r)),e:Hn(t.slice(r+1))}}function kn(t,r){return typeof r>"u"||typeof r=="number"?kn(t.s,t.e):(typeof t!="string"&&(t=Ar(t)),typeof r!="string"&&(r=Ar(r)),t==r?t:t+":"+r)}function Gr(t){var r={s:{c:0,r:0},e:{c:0,r:0}},e=0,n=0,i=0,a=t.length;for(e=0;n<a&&!((i=t.charCodeAt(n)-64)<1||i>26);++n)e=26*e+i;for(r.s.c=--e,e=0;n<a&&!((i=t.charCodeAt(n)-48)<0||i>9);++n)e=10*e+i;if(r.s.r=--e,n===a||i!=10)return r.e.c=r.s.c,r.e.r=r.s.r,r;for(++n,e=0;n!=a&&!((i=t.charCodeAt(n)-64)<1||i>26);++n)e=26*e+i;for(r.e.c=--e,e=0;n!=a&&!((i=t.charCodeAt(n)-48)<0||i>9);++n)e=10*e+i;return r.e.r=--e,r}function X1(t,r){var e=t.t=="d"&&r instanceof Date;if(t.z!=null)try{return t.w=As(t.z,e?Bi(r):r)}catch{}try{return t.w=As((t.XF||{}).numFmtId||(e?14:0),e?Bi(r):r)}catch{return""+r}}function jo(t,r,e){return t==null||t.t==null||t.t=="z"?"":t.w!==void 0?t.w:(t.t=="d"&&!t.z&&e&&e.dateNF&&(t.z=e.dateNF),t.t=="e"?I0[t.v]||t.v:r==null?X1(t,t.v):X1(t,r))}function _l(t,r){var e=r&&r.sheet?r.sheet:"Sheet1",n={};return n[e]=t,{SheetNames:[e],Sheets:n}}function V_(t,r,e){var n=e||{},i=t?Array.isArray(t):n.dense;oo!=null&&i==null&&(i=oo);var a=t||(i?[]:{}),o=0,s=0;if(a&&n.origin!=null){if(typeof n.origin=="number")o=n.origin;else{var l=typeof n.origin=="string"?Hn(n.origin):n.origin;o=l.r,s=l.c}a["!ref"]||(a["!ref"]="A1:A1")}var c={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(a["!ref"]){var f=Gr(a["!ref"]);c.s.c=f.s.c,c.s.r=f.s.r,c.e.c=Math.max(c.e.c,f.e.c),c.e.r=Math.max(c.e.r,f.e.r),o==-1&&(c.e.r=o=f.e.r+1)}for(var v=0;v!=r.length;++v)if(r[v]){if(!Array.isArray(r[v]))throw new Error("aoa_to_sheet expects an array of arrays");for(var x=0;x!=r[v].length;++x)if(!(typeof r[v][x]>"u")){var p={v:r[v][x]},S=o+v,w=s+x;if(c.s.r>S&&(c.s.r=S),c.s.c>w&&(c.s.c=w),c.e.r<S&&(c.e.r=S),c.e.c<w&&(c.e.c=w),r[v][x]&&typeof r[v][x]=="object"&&!Array.isArray(r[v][x])&&!(r[v][x]instanceof Date))p=r[v][x];else if(Array.isArray(p.v)&&(p.f=r[v][x][1],p.v=p.v[0]),p.v===null)if(p.f)p.t="n";else if(n.nullError)p.t="e",p.v=0;else if(n.sheetStubs)p.t="z";else continue;else typeof p.v=="number"?p.t="n":typeof p.v=="boolean"?p.t="b":p.v instanceof Date?(p.z=n.dateNF||ln[14],n.cellDates?(p.t="d",p.w=As(p.z,Bi(p.v))):(p.t="n",p.v=Bi(p.v),p.w=As(p.z,p.v))):p.t="s";if(i)a[S]||(a[S]=[]),a[S][w]&&a[S][w].z&&(p.z=a[S][w].z),a[S][w]=p;else{var k=Ar({c:w,r:S});a[k]&&a[k].z&&(p.z=a[k].z),a[k]=p}}}return c.s.c<1e7&&(a["!ref"]=kn(c)),a}function fc(t,r){return V_(null,t,r)}function _y(t){return t.read_shift(4,"i")}function ja(t,r){return r||(r=Ue(4)),r.write_shift(4,t),r}function li(t){var r=t.read_shift(4);return r===0?"":t.read_shift(r,"dbcs")}function Wn(t,r){var e=!1;return r==null&&(e=!0,r=Ue(4+2*t.length)),r.write_shift(4,t.length),t.length>0&&r.write_shift(0,t,"dbcs"),e?r.slice(0,r.l):r}function vy(t){return{ich:t.read_shift(2),ifnt:t.read_shift(2)}}function xy(t,r){return r||(r=Ue(4)),r.write_shift(2,t.ich||0),r.write_shift(2,t.ifnt||0),r}function mp(t,r){var e=t.l,n=t.read_shift(1),i=li(t),a=[],o={t:i,h:i};if((n&1)!==0){for(var s=t.read_shift(4),l=0;l!=s;++l)a.push(vy(t));o.r=a}else o.r=[{ich:0,ifnt:0}];return t.l=e+r,o}function by(t,r){var e=!1;return r==null&&(e=!0,r=Ue(15+4*t.t.length)),r.write_shift(1,0),Wn(t.t,r),e?r.slice(0,r.l):r}var wy=mp;function yy(t,r){var e=!1;return r==null&&(e=!0,r=Ue(23+4*t.t.length)),r.write_shift(1,1),Wn(t.t,r),r.write_shift(4,1),xy({ich:0,ifnt:0},r),e?r.slice(0,r.l):r}function Sa(t){var r=t.read_shift(4),e=t.read_shift(2);return e+=t.read_shift(1)<<16,t.l++,{c:r,iStyleRef:e}}function vl(t,r){return r==null&&(r=Ue(8)),r.write_shift(-4,t.c),r.write_shift(3,t.iStyleRef||t.s),r.write_shift(1,0),r}function xl(t){var r=t.read_shift(2);return r+=t.read_shift(1)<<16,t.l++,{c:-1,iStyleRef:r}}function bl(t,r){return r==null&&(r=Ue(4)),r.write_shift(3,t.iStyleRef||t.s),r.write_shift(1,0),r}var Cy=li,z_=Wn;function gp(t){var r=t.read_shift(4);return r===0||r===4294967295?"":t.read_shift(r,"dbcs")}function xf(t,r){var e=!1;return r==null&&(e=!0,r=Ue(127)),r.write_shift(4,t.length>0?t.length:4294967295),t.length>0&&r.write_shift(0,t,"dbcs"),e?r.slice(0,r.l):r}var Sy=li,Qh=gp,_p=xf;function j_(t){var r=t.slice(t.l,t.l+4),e=r[0]&1,n=r[0]&2;t.l+=4;var i=n===0?vf([0,0,0,0,r[0]&252,r[1],r[2],r[3]],0):fl(r,0)>>2;return e?i/100:i}function H_(t,r){r==null&&(r=Ue(4));var e=0,n=0,i=t*100;if(t==(t|0)&&t>=-(1<<29)&&t<1<<29?n=1:i==(i|0)&&i>=-(1<<29)&&i<1<<29&&(n=1,e=1),n)r.write_shift(-4,((e?i:t)<<2)+(e+2));else throw new Error("unsupported RkNumber "+t)}function W_(t){var r={s:{},e:{}};return r.s.r=t.read_shift(4),r.e.r=t.read_shift(4),r.s.c=t.read_shift(4),r.e.c=t.read_shift(4),r}function ky(t,r){return r||(r=Ue(16)),r.write_shift(4,t.s.r),r.write_shift(4,t.e.r),r.write_shift(4,t.s.c),r.write_shift(4,t.e.c),r}var wl=W_,uc=ky;function hc(t){if(t.length-t.l<8)throw"XLS Xnum Buffer underflow";return t.read_shift(8,"f")}function ml(t,r){return(r||Ue(8)).write_shift(8,t,"f")}function Ey(t){var r={},e=t.read_shift(1),n=e>>>1,i=t.read_shift(1),a=t.read_shift(2,"i"),o=t.read_shift(1),s=t.read_shift(1),l=t.read_shift(1);switch(t.l++,n){case 0:r.auto=1;break;case 1:r.index=i;var c=Ny[i];c&&(r.rgb=a_(c));break;case 2:r.rgb=a_([o,s,l]);break;case 3:r.theme=i;break}return a!=0&&(r.tint=a>0?a/32767:a/32768),r}function bf(t,r){if(r||(r=Ue(8)),!t||t.auto)return r.write_shift(4,0),r.write_shift(4,0),r;t.index!=null?(r.write_shift(1,2),r.write_shift(1,t.index)):t.theme!=null?(r.write_shift(1,6),r.write_shift(1,t.theme)):(r.write_shift(1,5),r.write_shift(1,0));var e=t.tint||0;if(e>0?e*=32767:e<0&&(e*=32768),r.write_shift(2,e),!t.rgb||t.theme!=null)r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);else{var n=t.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),r.write_shift(1,parseInt(n.slice(0,2),16)),r.write_shift(1,parseInt(n.slice(2,4),16)),r.write_shift(1,parseInt(n.slice(4,6),16)),r.write_shift(1,255)}return r}function My(t){var r=t.read_shift(1);t.l++;var e={fBold:r&1,fItalic:r&2,fUnderline:r&4,fStrikeout:r&8,fOutline:r&16,fShadow:r&32,fCondense:r&64,fExtend:r&128};return e}function Py(t,r){r||(r=Ue(2));var e=(t.italic?2:0)|(t.strike?8:0)|(t.outline?16:0)|(t.shadow?32:0)|(t.condense?64:0)|(t.extend?128:0);return r.write_shift(1,e),r.write_shift(1,0),r}var q_=2,Qi=3,df=11;var wf=19;var ff=64,Oy=65,Ay=71;var Ty=4108,Iy=4126,Qn=80;var Y1={1:{n:"CodePage",t:q_},2:{n:"Category",t:Qn},3:{n:"PresentationFormat",t:Qn},4:{n:"ByteCount",t:Qi},5:{n:"LineCount",t:Qi},6:{n:"ParagraphCount",t:Qi},7:{n:"SlideCount",t:Qi},8:{n:"NoteCount",t:Qi},9:{n:"HiddenCount",t:Qi},10:{n:"MultimediaClipCount",t:Qi},11:{n:"ScaleCrop",t:df},12:{n:"HeadingPairs",t:Ty},13:{n:"TitlesOfParts",t:Iy},14:{n:"Manager",t:Qn},15:{n:"Company",t:Qn},16:{n:"LinksUpToDate",t:df},17:{n:"CharacterCount",t:Qi},19:{n:"SharedDoc",t:df},22:{n:"HyperlinksChanged",t:df},23:{n:"AppVersion",t:Qi,p:"version"},24:{n:"DigSig",t:Oy},26:{n:"ContentType",t:Qn},27:{n:"ContentStatus",t:Qn},28:{n:"Language",t:Qn},29:{n:"Version",t:Qn},255:{},2147483648:{n:"Locale",t:wf},2147483651:{n:"Behavior",t:wf},1919054434:{}},K1={1:{n:"CodePage",t:q_},2:{n:"Title",t:Qn},3:{n:"Subject",t:Qn},4:{n:"Author",t:Qn},5:{n:"Keywords",t:Qn},6:{n:"Comments",t:Qn},7:{n:"Template",t:Qn},8:{n:"LastAuthor",t:Qn},9:{n:"RevNumber",t:Qn},10:{n:"EditTime",t:ff},11:{n:"LastPrinted",t:ff},12:{n:"CreatedDate",t:ff},13:{n:"ModifiedDate",t:ff},14:{n:"PageCount",t:Qi},15:{n:"WordCount",t:Qi},16:{n:"CharCount",t:Qi},17:{n:"Thumbnail",t:Ay},18:{n:"Application",t:Qn},19:{n:"DocSecurity",t:Qi},255:{},2147483648:{n:"Locale",t:wf},2147483651:{n:"Behavior",t:wf},1919054434:{}};function Fy(t){return t.map(function(r){return[r>>16&255,r>>8&255,r&255]})}var Dy=Fy([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Ny=Ui(Dy),I0={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"};var Ry={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},uf={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function G_(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function $_(t,r){var e=qw(Ry),n=[],i;n[n.length]=En,n[n.length]=st("Types",null,{xmlns:jn.CT,"xmlns:xsd":jn.xsd,"xmlns:xsi":jn.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(l){return st("Default",null,{Extension:l[0],ContentType:l[1]})}));var a=function(l){t[l]&&t[l].length>0&&(i=t[l][0],n[n.length]=st("Override",null,{PartName:(i[0]=="/"?"":"/")+i,ContentType:uf[l][r.bookType]||uf[l].xlsx}))},o=function(l){(t[l]||[]).forEach(function(c){n[n.length]=st("Override",null,{PartName:(c[0]=="/"?"":"/")+c,ContentType:uf[l][r.bookType]||uf[l].xlsx})})},s=function(l){(t[l]||[]).forEach(function(c){n[n.length]=st("Override",null,{PartName:(c[0]=="/"?"":"/")+c,ContentType:e[l][0]})})};return a("workbooks"),o("sheets"),o("charts"),s("themes"),["strs","styles"].forEach(a),["coreprops","extprops","custprops"].forEach(s),s("vba"),s("comments"),s("threadedcomments"),s("drawings"),o("metadata"),s("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var _r={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function X_(t){var r=t.lastIndexOf("/");return t.slice(0,r+1)+"_rels/"+t.slice(r+1)+".rels"}function ic(t){var r=[En,st("Relationships",null,{xmlns:jn.RELS})];return ni(t["!id"]).forEach(function(e){r[r.length]=st("Relationship",null,t["!id"][e])}),r.length>2&&(r[r.length]="</Relationships>",r[1]=r[1].replace("/>",">")),r.join("")}function Pr(t,r,e,n,i,a){if(i||(i={}),t["!id"]||(t["!id"]={}),t["!idx"]||(t["!idx"]=1),r<0)for(r=t["!idx"];t["!id"]["rId"+r];++r);if(t["!idx"]=r+1,i.Id="rId"+r,i.Type=n,i.Target=e,a?i.TargetMode=a:[_r.HLINK,_r.XPATH,_r.XMISS].indexOf(i.Type)>-1&&(i.TargetMode="External"),t["!id"][i.Id])throw new Error("Cannot rewrite rId "+r);return t["!id"][i.Id]=i,t[("/"+i.Target).replace("//","/")]=i,r}function Ly(t){var r=[En];r.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),r.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var e=0;e<t.length;++e)r.push('  <manifest:file-entry manifest:full-path="'+t[e][0]+'" manifest:media-type="'+t[e][1]+`"/>
`);return r.push("</manifest:manifest>"),r.join("")}function Z1(t,r,e){return['  <rdf:Description rdf:about="'+t+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(e||"odf")+"#"+r+`"/>
`,`  </rdf:Description>
`].join("")}function By(t,r){return['  <rdf:Description rdf:about="'+t+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+r+`"/>
`,`  </rdf:Description>
`].join("")}function Uy(t){var r=[En];r.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var e=0;e!=t.length;++e)r.push(Z1(t[e][0],t[e][1])),r.push(By("",t[e][0]));return r.push(Z1("","Document","pkg")),r.push("</rdf:RDF>"),r.join("")}function Y_(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+C0.version+"</meta:generator></office:meta></office:document-meta>"}var hl=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]];function Gh(t,r,e,n,i){i[t]!=null||r==null||r===""||(i[t]=r,r=Or(r),n[n.length]=e?st(t,r,e):ti(t,r))}function K_(t,r){var e=r||{},n=[En,st("cp:coreProperties",null,{"xmlns:cp":jn.CORE_PROPS,"xmlns:dc":jn.dc,"xmlns:dcterms":jn.dcterms,"xmlns:dcmitype":jn.dcmitype,"xmlns:xsi":jn.xsi})],i={};if(!t&&!e.Props)return n.join("");t&&(t.CreatedDate!=null&&Gh("dcterms:created",typeof t.CreatedDate=="string"?t.CreatedDate:Jh(t.CreatedDate,e.WTF),{"xsi:type":"dcterms:W3CDTF"},n,i),t.ModifiedDate!=null&&Gh("dcterms:modified",typeof t.ModifiedDate=="string"?t.ModifiedDate:Jh(t.ModifiedDate,e.WTF),{"xsi:type":"dcterms:W3CDTF"},n,i));for(var a=0;a!=hl.length;++a){var o=hl[a],s=e.Props&&e.Props[o[1]]!=null?e.Props[o[1]]:t?t[o[1]]:null;s===!0?s="1":s===!1?s="0":typeof s=="number"&&(s=String(s)),s!=null&&Gh(o[0],s,null,n,i)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var ac=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],Z_=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function J_(t){var r=[],e=st;return t||(t={}),t.Application="SheetJS",r[r.length]=En,r[r.length]=st("Properties",null,{xmlns:jn.EXT_PROPS,"xmlns:vt":jn.vt}),ac.forEach(function(n){if(t[n[1]]!==void 0){var i;switch(n[2]){case"string":i=Or(String(t[n[1]]));break;case"bool":i=t[n[1]]?"true":"false";break}i!==void 0&&(r[r.length]=e(n[0],i))}}),r[r.length]=e("HeadingPairs",e("vt:vector",e("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+e("vt:variant",e("vt:i4",String(t.Worksheets))),{size:2,baseType:"variant"})),r[r.length]=e("TitlesOfParts",e("vt:vector",t.SheetNames.map(function(n){return"<vt:lpstr>"+Or(n)+"</vt:lpstr>"}).join(""),{size:t.Worksheets,baseType:"lpstr"})),r.length>2&&(r[r.length]="</Properties>",r[1]=r[1].replace("/>",">")),r.join("")}function Q_(t){var r=[En,st("Properties",null,{xmlns:jn.CUST_PROPS,"xmlns:vt":jn.vt})];if(!t)return r.join("");var e=1;return ni(t).forEach(function(i){++e,r[r.length]=st("property",ry(t[i],!0),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:e,name:Or(i)})}),r.length>2&&(r[r.length]="</Properties>",r[1]=r[1].replace("/>",">")),r.join("")}var J1={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function Vy(t,r){var e=[];return ni(J1).map(function(n){for(var i=0;i<hl.length;++i)if(hl[i][1]==n)return hl[i];for(i=0;i<ac.length;++i)if(ac[i][1]==n)return ac[i];throw n}).forEach(function(n){if(t[n[1]]!=null){var i=r&&r.Props&&r.Props[n[1]]!=null?r.Props[n[1]]:t[n[1]];switch(n[2]){case"date":i=new Date(i).toISOString().replace(/\.\d*Z/,"Z");break}typeof i=="number"?i=String(i):i===!0||i===!1?i=i?"1":"0":i instanceof Date&&(i=new Date(i).toISOString().replace(/\.\d*Z/,"")),e.push(ti(J1[n[1]]||n[1],i))}}),st("DocumentProperties",e.join(""),{xmlns:ta.o})}function zy(t,r){var e=["Worksheets","SheetNames"],n="CustomDocumentProperties",i=[];return t&&ni(t).forEach(function(a){if(Object.prototype.hasOwnProperty.call(t,a)){for(var o=0;o<hl.length;++o)if(a==hl[o][1])return;for(o=0;o<ac.length;++o)if(a==ac[o][1])return;for(o=0;o<e.length;++o)if(a==e[o])return;var s=t[a],l="string";typeof s=="number"?(l="float",s=String(s)):s===!0||s===!1?(l="boolean",s=s?"1":"0"):s=String(s),i.push(st(U1(a),s,{"dt:dt":l}))}}),r&&ni(r).forEach(function(a){if(Object.prototype.hasOwnProperty.call(r,a)&&!(t&&Object.prototype.hasOwnProperty.call(t,a))){var o=r[a],s="string";typeof o=="number"?(s="float",o=String(o)):o===!0||o===!1?(s="boolean",o=o?"1":"0"):o instanceof Date?(s="dateTime.tz",o=o.toISOString()):o=String(o),i.push(st(U1(a),o,{"dt:dt":s}))}}),"<"+n+' xmlns="'+ta.o+'">'+i.join("")+"</"+n+">"}function jy(t){var r=typeof t=="string"?new Date(Date.parse(t)):t,e=r.getTime()/1e3+11644473600,n=e%Math.pow(2,32),i=(e-n)/Math.pow(2,32);n*=1e7,i*=1e7;var a=n/Math.pow(2,32)|0;a>0&&(n=n%Math.pow(2,32),i+=a);var o=Ue(8);return o.write_shift(4,n),o.write_shift(4,i),o}function Q1(t,r){var e=Ue(4),n=Ue(4);switch(e.write_shift(4,t==80?31:t),t){case 3:n.write_shift(-4,r);break;case 5:n=Ue(8),n.write_shift(8,r,"f");break;case 11:n.write_shift(4,r?1:0);break;case 64:n=jy(r);break;case 31:case 80:for(n=Ue(4+2*(r.length+1)+(r.length%2?0:2)),n.write_shift(4,r.length+1),n.write_shift(0,r,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+r)}return ei([e,n])}var ev=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function Hy(t){switch(typeof t){case"boolean":return 11;case"number":return(t|0)==t?3:5;case"string":return 31;case"object":if(t instanceof Date)return 64;break}return-1}function e_(t,r,e){var n=Ue(8),i=[],a=[],o=8,s=0,l=Ue(8),c=Ue(8);if(l.write_shift(4,2),l.write_shift(4,1200),c.write_shift(4,1),a.push(l),i.push(c),o+=8+l.length,!r){c=Ue(8),c.write_shift(4,0),i.unshift(c);var f=[Ue(4)];for(f[0].write_shift(4,t.length),s=0;s<t.length;++s){var v=t[s][0];for(l=Ue(8+2*(v.length+1)+(v.length%2?0:2)),l.write_shift(4,s+2),l.write_shift(4,v.length+1),l.write_shift(0,v,"dbcs");l.l!=l.length;)l.write_shift(1,0);f.push(l)}l=ei(f),a.unshift(l),o+=8+l.length}for(s=0;s<t.length;++s)if(!(r&&!r[t[s][0]])&&!(ev.indexOf(t[s][0])>-1||Z_.indexOf(t[s][0])>-1)&&t[s][1]!=null){var x=t[s][1],p=0;if(r){p=+r[t[s][0]];var S=e[p];if(S.p=="version"&&typeof x=="string"){var w=x.split(".");x=(+w[0]<<16)+(+w[1]||0)}l=Q1(S.t,x)}else{var k=Hy(x);k==-1&&(k=31,x=String(x)),l=Q1(k,x)}a.push(l),c=Ue(8),c.write_shift(4,r?p:2+s),i.push(c),o+=8+l.length}var O=8*(a.length+1);for(s=0;s<a.length;++s)i[s].write_shift(4,O),O+=a[s].length;return n.write_shift(4,o),n.write_shift(4,a.length),ei([n].concat(i).concat(a))}function t_(t,r,e,n,i,a){var o=Ue(i?68:48),s=[o];o.write_shift(2,65534),o.write_shift(2,0),o.write_shift(4,842412599),o.write_shift(16,Fr.utils.consts.HEADER_CLSID,"hex"),o.write_shift(4,i?2:1),o.write_shift(16,r,"hex"),o.write_shift(4,i?68:48);var l=e_(t,e,n);if(s.push(l),i){var c=e_(i,null,null);o.write_shift(16,a,"hex"),o.write_shift(4,68+l.length),s.push(c)}return ei(s)}function Wy(t,r){r||(r=Ue(t));for(var e=0;e<t;++e)r.write_shift(1,0);return r}function qy(t,r){return t.read_shift(r)===1}function xi(t,r){return r||(r=Ue(2)),r.write_shift(2,+!!t),r}function tv(t){return t.read_shift(2,"u")}function Ca(t,r){return r||(r=Ue(2)),r.write_shift(2,t),r}function rv(t,r,e){return e||(e=Ue(2)),e.write_shift(1,r=="e"?+t:+!!t),e.write_shift(1,r=="e"?1:0),e}function nv(t,r,e){var n=t.read_shift(e&&e.biff>=12?2:1),i="sbcs-cont",a=ul;if(e&&e.biff>=8&&(ul=1200),!e||e.biff==8){var o=t.read_shift(1);o&&(i="dbcs-cont")}else e.biff==12&&(i="wstr");e.biff>=2&&e.biff<=5&&(i="cpstr");var s=n?t.read_shift(n,i):"";return ul=a,s}function Gy(t){var r=t.t||"",e=1,n=Ue(3+(e>1?2:0));n.write_shift(2,r.length),n.write_shift(1,(e>1?8:0)|1),e>1&&n.write_shift(2,e);var i=Ue(2*r.length);i.write_shift(2*r.length,r,"utf16le");var a=[n,i];return ei(a)}function $y(t,r,e){var n;if(e){if(e.biff>=2&&e.biff<=5)return t.read_shift(r,"cpstr");if(e.biff>=12)return t.read_shift(r,"dbcs-cont")}var i=t.read_shift(1);return i===0?n=t.read_shift(r,"sbcs-cont"):n=t.read_shift(r,"dbcs-cont"),n}function Xy(t,r,e){var n=t.read_shift(e&&e.biff==2?1:2);return n===0?(t.l++,""):$y(t,n,e)}function Yy(t,r,e){if(e.biff>5)return Xy(t,r,e);var n=t.read_shift(1);return n===0?(t.l++,""):t.read_shift(n,e.biff<=4||!t.lens?"cpstr":"sbcs-cont")}function iv(t,r,e){return e||(e=Ue(3+2*t.length)),e.write_shift(2,t.length),e.write_shift(1,1),e.write_shift(31,t,"utf16le"),e}function r_(t,r){r||(r=Ue(6+t.length*2)),r.write_shift(4,1+t.length);for(var e=0;e<t.length;++e)r.write_shift(2,t.charCodeAt(e));return r.write_shift(2,0),r}function Ky(t){var r=Ue(512),e=0,n=t.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var i=n.indexOf("#"),a=i>-1?31:23;switch(n.charAt(0)){case"#":a=28;break;case".":a&=-3;break}r.write_shift(4,2),r.write_shift(4,a);var o=[8,6815827,6619237,4849780,83];for(e=0;e<o.length;++e)r.write_shift(4,o[e]);if(a==28)n=n.slice(1),r_(n,r);else if(a&2){for(o="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),e=0;e<o.length;++e)r.write_shift(1,parseInt(o[e],16));var s=i>-1?n.slice(0,i):n;for(r.write_shift(4,2*(s.length+1)),e=0;e<s.length;++e)r.write_shift(2,s.charCodeAt(e));r.write_shift(2,0),a&8&&r_(i>-1?n.slice(i+1):"",r)}else{for(o="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),e=0;e<o.length;++e)r.write_shift(1,parseInt(o[e],16));for(var l=0;n.slice(l*3,l*3+3)=="../"||n.slice(l*3,l*3+3)=="..\\";)++l;for(r.write_shift(2,l),r.write_shift(4,n.length-3*l+1),e=0;e<n.length-3*l;++e)r.write_shift(1,n.charCodeAt(e+3*l)&255);for(r.write_shift(1,0),r.write_shift(2,65535),r.write_shift(2,57005),e=0;e<6;++e)r.write_shift(4,0)}return r.slice(0,r.l)}function gl(t,r,e,n){return n||(n=Ue(6)),n.write_shift(2,t),n.write_shift(2,r),n.write_shift(2,e||0),n}function Zy(t,r,e){var n=e.biff>8?4:2,i=t.read_shift(n),a=t.read_shift(n,"i"),o=t.read_shift(n,"i");return[i,a,o]}function Jy(t){var r=t.read_shift(2),e=t.read_shift(2),n=t.read_shift(2),i=t.read_shift(2);return{s:{c:n,r},e:{c:i,r:e}}}function av(t,r){return r||(r=Ue(8)),r.write_shift(2,t.s.r),r.write_shift(2,t.e.r),r.write_shift(2,t.s.c),r.write_shift(2,t.e.c),r}function vp(t,r,e){var n=1536,i=16;switch(e.bookType){case"biff8":break;case"biff5":n=1280,i=8;break;case"biff4":n=4,i=6;break;case"biff3":n=3,i=6;break;case"biff2":n=2,i=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var a=Ue(i);return a.write_shift(2,n),a.write_shift(2,r),i>4&&a.write_shift(2,29282),i>6&&a.write_shift(2,1997),i>8&&(a.write_shift(2,49161),a.write_shift(2,1),a.write_shift(2,1798),a.write_shift(2,0)),a}function Qy(t,r){var e=!r||r.biff==8,n=Ue(e?112:54);for(n.write_shift(r.biff==8?2:1,7),e&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(e?0:536870912));n.l<n.length;)n.write_shift(1,e?0:32);return n}function eC(t,r){var e=!r||r.biff>=8?2:1,n=Ue(8+e*t.name.length);n.write_shift(4,t.pos),n.write_shift(1,t.hs||0),n.write_shift(1,t.dt),n.write_shift(1,t.name.length),r.biff>=8&&n.write_shift(1,1),n.write_shift(e*t.name.length,t.name,r.biff<8?"sbcs":"utf16le");var i=n.slice(0,n.l);return i.l=n.l,i}function tC(t,r){var e=Ue(8);e.write_shift(4,t.Count),e.write_shift(4,t.Unique);for(var n=[],i=0;i<t.length;++i)n[i]=Gy(t[i],r);var a=ei([e].concat(n));return a.parts=[e.length].concat(n.map(function(o){return o.length})),a}function rC(){var t=Ue(18);return t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,29280),t.write_shift(2,17600),t.write_shift(2,56),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,1),t.write_shift(2,500),t}function nC(t){var r=Ue(18),e=1718;return t&&t.RTL&&(e|=64),r.write_shift(2,e),r.write_shift(4,0),r.write_shift(4,64),r.write_shift(4,0),r.write_shift(4,0),r}function iC(t,r){var e=t.name||"Arial",n=r&&r.biff==5,i=n?15+e.length:16+2*e.length,a=Ue(i);return a.write_shift(2,(t.sz||12)*20),a.write_shift(4,0),a.write_shift(2,400),a.write_shift(4,0),a.write_shift(2,0),a.write_shift(1,e.length),n||a.write_shift(1,1),a.write_shift((n?1:2)*e.length,e,n?"sbcs":"utf16le"),a}function aC(t,r,e,n){var i=Ue(10);return gl(t,r,n,i),i.write_shift(4,e),i}function oC(t,r,e,n,i){var a=!i||i.biff==8,o=Ue(8+ +a+(1+a)*e.length);return gl(t,r,n,o),o.write_shift(2,e.length),a&&o.write_shift(1,1),o.write_shift((1+a)*e.length,e,a?"utf16le":"sbcs"),o}function sC(t,r,e,n){var i=e&&e.biff==5;n||(n=Ue(i?3+r.length:5+2*r.length)),n.write_shift(2,t),n.write_shift(i?1:2,r.length),i||n.write_shift(1,1),n.write_shift((i?1:2)*r.length,r,i?"sbcs":"utf16le");var a=n.length>n.l?n.slice(0,n.l):n;return a.l==null&&(a.l=a.length),a}function lC(t,r){var e=r.biff==8||!r.biff?4:2,n=Ue(2*e+6);return n.write_shift(e,t.s.r),n.write_shift(e,t.e.r+1),n.write_shift(2,t.s.c),n.write_shift(2,t.e.c+1),n.write_shift(2,0),n}function n_(t,r,e,n){var i=e&&e.biff==5;n||(n=Ue(i?16:20)),n.write_shift(2,0),t.style?(n.write_shift(2,t.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,t.numFmtId||0),n.write_shift(2,r<<4));var a=0;return t.numFmtId>0&&i&&(a|=1024),n.write_shift(4,a),n.write_shift(4,0),i||n.write_shift(4,0),n.write_shift(2,0),n}function cC(t){var r=Ue(8);return r.write_shift(4,0),r.write_shift(2,t[0]?t[0]+1:0),r.write_shift(2,t[1]?t[1]+1:0),r}function dC(t,r,e,n,i,a){var o=Ue(8);return gl(t,r,n,o),rv(e,a,o),o}function fC(t,r,e,n){var i=Ue(14);return gl(t,r,n,i),ml(e,i),i}function uC(t,r,e){if(e.biff<8)return hC(t,r,e);for(var n=[],i=t.l+r,a=t.read_shift(e.biff>8?4:2);a--!==0;)n.push(Zy(t,e.biff>8?12:6,e));if(t.l!=i)throw new Error("Bad ExternSheet: "+t.l+" != "+i);return n}function hC(t,r,e){t[t.l+1]==3&&t[t.l]++;var n=nv(t,r,e);return n.charCodeAt(0)==3?n.slice(1):n}function pC(t){var r=Ue(2+t.length*8);r.write_shift(2,t.length);for(var e=0;e<t.length;++e)av(t[e],r);return r}function mC(t){var r=Ue(24),e=Hn(t[0]);r.write_shift(2,e.r),r.write_shift(2,e.r),r.write_shift(2,e.c),r.write_shift(2,e.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),i=0;i<16;++i)r.write_shift(1,parseInt(n[i],16));return ei([r,Ky(t[1])])}function gC(t){var r=t[1].Tooltip,e=Ue(10+2*(r.length+1));e.write_shift(2,2048);var n=Hn(t[0]);e.write_shift(2,n.r),e.write_shift(2,n.r),e.write_shift(2,n.c),e.write_shift(2,n.c);for(var i=0;i<r.length;++i)e.write_shift(2,r.charCodeAt(i));return e.write_shift(2,0),e}function _C(t){return t||(t=Ue(4)),t.write_shift(2,1),t.write_shift(2,1),t}function vC(t,r,e){if(!e.cellStyles)return so(t,r);var n=e&&e.biff>=12?4:2,i=t.read_shift(n),a=t.read_shift(n),o=t.read_shift(n),s=t.read_shift(n),l=t.read_shift(2);n==2&&(t.l+=2);var c={s:i,e:a,w:o,ixfe:s,flags:l};return(e.biff>=5||!e.biff)&&(c.level=l>>8&7),c}function xC(t,r){var e=Ue(12);e.write_shift(2,r),e.write_shift(2,r),e.write_shift(2,t.width*256),e.write_shift(2,0);var n=0;return t.hidden&&(n|=1),e.write_shift(1,n),n=t.level||0,e.write_shift(1,n),e.write_shift(2,0),e}function bC(t){for(var r=Ue(2*t),e=0;e<t;++e)r.write_shift(2,e+1);return r}function wC(t,r,e){var n=Ue(15);return D0(n,t,r),n.write_shift(8,e,"f"),n}function yC(t,r,e){var n=Ue(9);return D0(n,t,r),n.write_shift(2,e),n}var CC=(function(){var t={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},r=np({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function e(s,l){var c=[],f=pl(1);switch(l.type){case"base64":f=Va(zo(s));break;case"binary":f=Va(s);break;case"buffer":case"array":f=s;break}ea(f,0);var v=f.read_shift(1),x=!!(v&136),p=!1,S=!1;switch(v){case 2:break;case 3:break;case 48:p=!0,x=!0;break;case 49:p=!0,x=!0;break;case 131:break;case 139:break;case 140:S=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+v.toString(16))}var w=0,k=521;v==2&&(w=f.read_shift(2)),f.l+=3,v!=2&&(w=f.read_shift(4)),w>1048576&&(w=1e6),v!=2&&(k=f.read_shift(2));var O=f.read_shift(2),H=l.codepage||1252;v!=2&&(f.l+=16,f.read_shift(1),f[f.l]!==0&&(H=t[f[f.l]]),f.l+=1,f.l+=2),S&&(f.l+=36);for(var q=[],X={},he=Math.min(f.length,v==2?521:k-10-(p?264:0)),ke=S?32:11;f.l<he&&f[f.l]!=13;)switch(X={},X.name=Lr.utils.decode(H,f.slice(f.l,f.l+ke)).replace(/[\u0000\r\n].*$/g,""),f.l+=ke,X.type=String.fromCharCode(f.read_shift(1)),v!=2&&!S&&(X.offset=f.read_shift(4)),X.len=f.read_shift(1),v==2&&(X.offset=f.read_shift(2)),X.dec=f.read_shift(1),X.name.length&&q.push(X),v!=2&&(f.l+=S?13:14),X.type){case"B":(!p||X.len!=8)&&l.WTF&&console.log("Skipping "+X.name+":"+X.type);break;case"G":case"P":l.WTF&&console.log("Skipping "+X.name+":"+X.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+X.type)}if(f[f.l]!==13&&(f.l=k-1),f.read_shift(1)!==13)throw new Error("DBF Terminator not found "+f.l+" "+f[f.l]);f.l=k;var re=0,ee=0;for(c[0]=[],ee=0;ee!=q.length;++ee)c[0][ee]=q[ee].name;for(;w-- >0;){if(f[f.l]===42){f.l+=O;continue}for(++f.l,c[++re]=[],ee=0,ee=0;ee!=q.length;++ee){var W=f.slice(f.l,f.l+q[ee].len);f.l+=q[ee].len,ea(W,0);var ae=Lr.utils.decode(H,W);switch(q[ee].type){case"C":ae.trim().length&&(c[re][ee]=ae.replace(/\s+$/,""));break;case"D":ae.length===8?c[re][ee]=new Date(+ae.slice(0,4),+ae.slice(4,6)-1,+ae.slice(6,8)):c[re][ee]=ae;break;case"F":c[re][ee]=parseFloat(ae.trim());break;case"+":case"I":c[re][ee]=S?W.read_shift(-4,"i")^2147483648:W.read_shift(4,"i");break;case"L":switch(ae.trim().toUpperCase()){case"Y":case"T":c[re][ee]=!0;break;case"N":case"F":c[re][ee]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+ae+"|")}break;case"M":if(!x)throw new Error("DBF Unexpected MEMO for type "+v.toString(16));c[re][ee]="##MEMO##"+(S?parseInt(ae.trim(),10):W.read_shift(4));break;case"N":ae=ae.replace(/\u0000/g,"").trim(),ae&&ae!="."&&(c[re][ee]=+ae||0);break;case"@":c[re][ee]=new Date(W.read_shift(-8,"f")-621356832e5);break;case"T":c[re][ee]=new Date((W.read_shift(4)-2440588)*864e5+W.read_shift(4));break;case"Y":c[re][ee]=W.read_shift(4,"i")/1e4+W.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":c[re][ee]=-W.read_shift(-8,"f");break;case"B":if(p&&q[ee].len==8){c[re][ee]=W.read_shift(8,"f");break}case"G":case"P":W.l+=q[ee].len;break;case"0":if(q[ee].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+q[ee].type)}}}if(v!=2&&f.l<f.length&&f[f.l++]!=26)throw new Error("DBF EOF Marker missing "+(f.l-1)+" of "+f.length+" "+f[f.l-1].toString(16));return l&&l.sheetRows&&(c=c.slice(0,l.sheetRows)),l.DBF=q,c}function n(s,l){var c=l||{};c.dateNF||(c.dateNF="yyyymmdd");var f=fc(e(s,c),c);return f["!cols"]=c.DBF.map(function(v){return{wch:v.len,DBF:v}}),delete c.DBF,f}function i(s,l){try{return _l(n(s,l),l)}catch(c){if(l&&l.WTF)throw c}return{SheetNames:[],Sheets:{}}}var a={B:8,C:250,L:1,D:8,"?":0,"":0};function o(s,l){var c=l||{};if(+c.codepage>=0&&S0(+c.codepage),c.type=="string")throw new Error("Cannot write DBF to JS string");var f=Li(),v=Ef(s,{header:1,raw:!0,cellDates:!0}),x=v[0],p=v.slice(1),S=s["!cols"]||[],w=0,k=0,O=0,H=1;for(w=0;w<x.length;++w){if(((S[w]||{}).DBF||{}).name){x[w]=S[w].DBF.name,++O;continue}if(x[w]!=null){if(++O,typeof x[w]=="number"&&(x[w]=x[w].toString(10)),typeof x[w]!="string")throw new Error("DBF Invalid column name "+x[w]+" |"+typeof x[w]+"|");if(x.indexOf(x[w])!==w){for(k=0;k<1024;++k)if(x.indexOf(x[w]+"_"+k)==-1){x[w]+="_"+k;break}}}}var q=Gr(s["!ref"]),X=[],he=[],ke=[];for(w=0;w<=q.e.c-q.s.c;++w){var re="",ee="",W=0,ae=[];for(k=0;k<p.length;++k)p[k][w]!=null&&ae.push(p[k][w]);if(ae.length==0||x[w]==null){X[w]="?";continue}for(k=0;k<ae.length;++k){switch(typeof ae[k]){case"number":ee="B";break;case"string":ee="C";break;case"boolean":ee="L";break;case"object":ee=ae[k]instanceof Date?"D":"C";break;default:ee="C"}W=Math.max(W,String(ae[k]).length),re=re&&re!=ee?"C":ee}W>250&&(W=250),ee=((S[w]||{}).DBF||{}).type,ee=="C"&&S[w].DBF.len>W&&(W=S[w].DBF.len),re=="B"&&ee=="N"&&(re="N",ke[w]=S[w].DBF.dec,W=S[w].DBF.len),he[w]=re=="C"||ee=="N"?W:a[re]||0,H+=he[w],X[w]=re}var A=f.next(32);for(A.write_shift(4,318902576),A.write_shift(4,p.length),A.write_shift(2,296+32*O),A.write_shift(2,H),w=0;w<4;++w)A.write_shift(4,0);for(A.write_shift(4,0|(+r[sc]||3)<<8),w=0,k=0;w<x.length;++w)if(x[w]!=null){var V=f.next(32),de=(x[w].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);V.write_shift(1,de,"sbcs"),V.write_shift(1,X[w]=="?"?"C":X[w],"sbcs"),V.write_shift(4,k),V.write_shift(1,he[w]||a[X[w]]||0),V.write_shift(1,ke[w]||0),V.write_shift(1,2),V.write_shift(4,0),V.write_shift(1,0),V.write_shift(4,0),V.write_shift(4,0),k+=he[w]||a[X[w]]||0}var ue=f.next(264);for(ue.write_shift(4,13),w=0;w<65;++w)ue.write_shift(4,0);for(w=0;w<p.length;++w){var xe=f.next(H);for(xe.write_shift(1,0),k=0;k<x.length;++k)if(x[k]!=null)switch(X[k]){case"L":xe.write_shift(1,p[w][k]==null?63:p[w][k]?84:70);break;case"B":xe.write_shift(8,p[w][k]||0,"f");break;case"N":var Ne="0";for(typeof p[w][k]=="number"&&(Ne=p[w][k].toFixed(ke[k]||0)),O=0;O<he[k]-Ne.length;++O)xe.write_shift(1,32);xe.write_shift(1,Ne,"sbcs");break;case"D":p[w][k]?(xe.write_shift(4,("0000"+p[w][k].getFullYear()).slice(-4),"sbcs"),xe.write_shift(2,("00"+(p[w][k].getMonth()+1)).slice(-2),"sbcs"),xe.write_shift(2,("00"+p[w][k].getDate()).slice(-2),"sbcs")):xe.write_shift(8,"00000000","sbcs");break;case"C":var Re=String(p[w][k]!=null?p[w][k]:"").slice(0,he[k]);for(xe.write_shift(1,Re,"sbcs"),O=0;O<he[k]-Re.length;++O)xe.write_shift(1,32);break}}return f.next(1).write_shift(1,26),f.end()}return{to_workbook:i,to_sheet:n,from_sheet:o}})(),SC=(function(){var t={AA:"\xC0",BA:"\xC1",CA:"\xC2",DA:195,HA:"\xC4",JA:197,AE:"\xC8",BE:"\xC9",CE:"\xCA",HE:"\xCB",AI:"\xCC",BI:"\xCD",CI:"\xCE",HI:"\xCF",AO:"\xD2",BO:"\xD3",CO:"\xD4",DO:213,HO:"\xD6",AU:"\xD9",BU:"\xDA",CU:"\xDB",HU:"\xDC",Aa:"\xE0",Ba:"\xE1",Ca:"\xE2",Da:227,Ha:"\xE4",Ja:229,Ae:"\xE8",Be:"\xE9",Ce:"\xEA",He:"\xEB",Ai:"\xEC",Bi:"\xED",Ci:"\xEE",Hi:"\xEF",Ao:"\xF2",Bo:"\xF3",Co:"\xF4",Do:245,Ho:"\xF6",Au:"\xF9",Bu:"\xFA",Cu:"\xFB",Hu:"\xFC",KC:"\xC7",Kc:"\xE7",q:"\xE6",z:"\u0153",a:"\xC6",j:"\u0152",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},r=new RegExp("\x1BN("+ni(t).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),e=function(x,p){var S=t[p];return typeof S=="number"?M1(S):S},n=function(x,p,S){var w=p.charCodeAt(0)-32<<4|S.charCodeAt(0)-48;return w==59?x:M1(w)};t["|"]=254;function i(x,p){switch(p.type){case"base64":return a(zo(x),p);case"binary":return a(x,p);case"buffer":return a(vr&&Buffer.isBuffer(x)?x.toString("binary"):A0(x),p);case"array":return a(Tf(x),p)}throw new Error("Unrecognized type "+p.type)}function a(x,p){var S=x.split(/[\n\r]+/),w=-1,k=-1,O=0,H=0,q=[],X=[],he=null,ke={},re=[],ee=[],W=[],ae=0,A;for(+p.codepage>=0&&S0(+p.codepage);O!==S.length;++O){ae=0;var V=S[O].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(r,e),de=V.replace(/;;/g,"\0").split(";").map(function(R){return R.replace(/\u0000/g,";")}),ue=de[0],xe;if(V.length>0)switch(ue){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":de[1].charAt(0)=="P"&&X.push(V.slice(3).replace(/;;/g,";"));break;case"C":var Ne=!1,Re=!1,Ee=!1,Be=!1,Je=-1,qe=-1;for(H=1;H<de.length;++H)switch(de[H].charAt(0)){case"A":break;case"X":k=parseInt(de[H].slice(1))-1,Re=!0;break;case"Y":for(w=parseInt(de[H].slice(1))-1,Re||(k=0),A=q.length;A<=w;++A)q[A]=[];break;case"K":xe=de[H].slice(1),xe.charAt(0)==='"'?xe=xe.slice(1,xe.length-1):xe==="TRUE"?xe=!0:xe==="FALSE"?xe=!1:isNaN(Uo(xe))?isNaN(E0(xe).getDate())||(xe=bi(xe)):(xe=Uo(xe),he!==null&&S_(he)&&(xe=P_(xe))),typeof Lr<"u"&&typeof xe=="string"&&(p||{}).type!="string"&&(p||{}).codepage&&(xe=Lr.utils.decode(p.codepage,xe)),Ne=!0;break;case"E":Be=!0;var E=y3(de[H].slice(1),{r:w,c:k});q[w][k]=[q[w][k],E];break;case"S":Ee=!0,q[w][k]=[q[w][k],"S5S"];break;case"G":break;case"R":Je=parseInt(de[H].slice(1))-1;break;case"C":qe=parseInt(de[H].slice(1))-1;break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+V)}if(Ne&&(q[w][k]&&q[w][k].length==2?q[w][k][0]=xe:q[w][k]=xe,he=null),Ee){if(Be)throw new Error("SYLK shared formula cannot have own formula");var U=Je>-1&&q[Je][qe];if(!U||!U[1])throw new Error("SYLK shared formula cannot find base");q[w][k][1]=C3(U[1],{r:w-Je,c:k-qe})}break;case"F":var T=0;for(H=1;H<de.length;++H)switch(de[H].charAt(0)){case"X":k=parseInt(de[H].slice(1))-1,++T;break;case"Y":for(w=parseInt(de[H].slice(1))-1,A=q.length;A<=w;++A)q[A]=[];break;case"M":ae=parseInt(de[H].slice(1))/20;break;case"F":break;case"G":break;case"P":he=X[parseInt(de[H].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(W=de[H].slice(1).split(" "),A=parseInt(W[0],10);A<=parseInt(W[1],10);++A)ae=parseInt(W[2],10),ee[A-1]=ae===0?{hidden:!0}:{wch:ae},xp(ee[A-1]);break;case"C":k=parseInt(de[H].slice(1))-1,ee[k]||(ee[k]={});break;case"R":w=parseInt(de[H].slice(1))-1,re[w]||(re[w]={}),ae>0?(re[w].hpt=ae,re[w].hpx=dv(ae)):ae===0&&(re[w].hidden=!0);break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+V)}T<1&&(he=null);break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+V)}}return re.length>0&&(ke["!rows"]=re),ee.length>0&&(ke["!cols"]=ee),p&&p.sheetRows&&(q=q.slice(0,p.sheetRows)),[q,ke]}function o(x,p){var S=i(x,p),w=S[0],k=S[1],O=fc(w,p);return ni(k).forEach(function(H){O[H]=k[H]}),O}function s(x,p){return _l(o(x,p),p)}function l(x,p,S,w){var k="C;Y"+(S+1)+";X"+(w+1)+";K";switch(x.t){case"n":k+=x.v||0,x.f&&!x.F&&(k+=";E"+wp(x.f,{r:S,c:w}));break;case"b":k+=x.v?"TRUE":"FALSE";break;case"e":k+=x.w||x.v;break;case"d":k+='"'+(x.w||x.v)+'"';break;case"s":k+='"'+x.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return k}function c(x,p){p.forEach(function(S,w){var k="F;W"+(w+1)+" "+(w+1)+" ";S.hidden?k+="0":(typeof S.width=="number"&&!S.wpx&&(S.wpx=yf(S.width)),typeof S.wpx=="number"&&!S.wch&&(S.wch=Cf(S.wpx)),typeof S.wch=="number"&&(k+=Math.round(S.wch))),k.charAt(k.length-1)!=" "&&x.push(k)})}function f(x,p){p.forEach(function(S,w){var k="F;";S.hidden?k+="M0;":S.hpt?k+="M"+20*S.hpt+";":S.hpx&&(k+="M"+20*Sf(S.hpx)+";"),k.length>2&&x.push(k+"R"+(w+1))})}function v(x,p){var S=["ID;PWXL;N;E"],w=[],k=Gr(x["!ref"]),O,H=Array.isArray(x),q=`\r
`;S.push("P;PGeneral"),S.push("F;P0;DG0G8;M255"),x["!cols"]&&c(S,x["!cols"]),x["!rows"]&&f(S,x["!rows"]),S.push("B;Y"+(k.e.r-k.s.r+1)+";X"+(k.e.c-k.s.c+1)+";D"+[k.s.c,k.s.r,k.e.c,k.e.r].join(" "));for(var X=k.s.r;X<=k.e.r;++X)for(var he=k.s.c;he<=k.e.c;++he){var ke=Ar({r:X,c:he});O=H?(x[X]||[])[he]:x[ke],!(!O||O.v==null&&(!O.f||O.F))&&w.push(l(O,x,X,he,p))}return S.join(q)+q+w.join(q)+q+"E"+q}return{to_workbook:s,to_sheet:o,from_sheet:v}})(),kC=(function(){function t(a,o){switch(o.type){case"base64":return r(zo(a),o);case"binary":return r(a,o);case"buffer":return r(vr&&Buffer.isBuffer(a)?a.toString("binary"):A0(a),o);case"array":return r(Tf(a),o)}throw new Error("Unrecognized type "+o.type)}function r(a,o){for(var s=a.split(`
`),l=-1,c=-1,f=0,v=[];f!==s.length;++f){if(s[f].trim()==="BOT"){v[++l]=[],c=0;continue}if(!(l<0)){var x=s[f].trim().split(","),p=x[0],S=x[1];++f;for(var w=s[f]||"";(w.match(/["]/g)||[]).length&1&&f<s.length-1;)w+=`
`+s[++f];switch(w=w.trim(),+p){case-1:if(w==="BOT"){v[++l]=[],c=0;continue}else if(w!=="EOD")throw new Error("Unrecognized DIF special command "+w);break;case 0:w==="TRUE"?v[l][c]=!0:w==="FALSE"?v[l][c]=!1:isNaN(Uo(S))?isNaN(E0(S).getDate())?v[l][c]=S:v[l][c]=bi(S):v[l][c]=Uo(S),++c;break;case 1:w=w.slice(1,w.length-1),w=w.replace(/""/g,'"'),m0&&w&&w.match(/^=".*"$/)&&(w=w.slice(2,-1)),v[l][c++]=w!==""?w:null;break}if(w==="EOD")break}}return o&&o.sheetRows&&(v=v.slice(0,o.sheetRows)),v}function e(a,o){return fc(t(a,o),o)}function n(a,o){return _l(e(a,o),o)}var i=(function(){var a=function(l,c,f,v,x){l.push(c),l.push(f+","+v),l.push('"'+x.replace(/"/g,'""')+'"')},o=function(l,c,f,v){l.push(c+","+f),l.push(c==1?'"'+v.replace(/"/g,'""')+'"':v)};return function(l){var c=[],f=Gr(l["!ref"]),v,x=Array.isArray(l);a(c,"TABLE",0,1,"sheetjs"),a(c,"VECTORS",0,f.e.r-f.s.r+1,""),a(c,"TUPLES",0,f.e.c-f.s.c+1,""),a(c,"DATA",0,0,"");for(var p=f.s.r;p<=f.e.r;++p){o(c,-1,0,"BOT");for(var S=f.s.c;S<=f.e.c;++S){var w=Ar({r:p,c:S});if(v=x?(l[p]||[])[S]:l[w],!v){o(c,1,0,"");continue}switch(v.t){case"n":var k=m0?v.w:v.v;!k&&v.v!=null&&(k=v.v),k==null?m0&&v.f&&!v.F?o(c,1,0,"="+v.f):o(c,1,0,""):o(c,0,k,"V");break;case"b":o(c,0,v.v?1:0,v.v?"TRUE":"FALSE");break;case"s":o(c,1,0,!m0||isNaN(v.v)?v.v:'="'+v.v+'"');break;case"d":v.w||(v.w=As(v.z||ln[14],Bi(bi(v.v)))),m0?o(c,0,v.w,"V"):o(c,1,0,v.w);break;default:o(c,1,0,"")}}}o(c,-1,0,"EOD");var O=`\r
`,H=c.join(O);return H}})();return{to_workbook:n,to_sheet:e,from_sheet:i}})(),ov=(function(){function t(v){return v.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function r(v){return v.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function e(v,x){for(var p=v.split(`
`),S=-1,w=-1,k=0,O=[];k!==p.length;++k){var H=p[k].trim().split(":");if(H[0]==="cell"){var q=Hn(H[1]);if(O.length<=q.r)for(S=O.length;S<=q.r;++S)O[S]||(O[S]=[]);switch(S=q.r,w=q.c,H[2]){case"t":O[S][w]=t(H[3]);break;case"v":O[S][w]=+H[3];break;case"vtf":var X=H[H.length-1];case"vtc":switch(H[3]){case"nl":O[S][w]=!!+H[4];break;default:O[S][w]=+H[4];break}H[2]=="vtf"&&(O[S][w]=[O[S][w],X])}}}return x&&x.sheetRows&&(O=O.slice(0,x.sheetRows)),O}function n(v,x){return fc(e(v,x),x)}function i(v,x){return _l(n(v,x),x)}var a=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),o=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,s=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),l="--SocialCalcSpreadsheetControlSave--";function c(v){if(!v||!v["!ref"])return"";for(var x=[],p=[],S,w="",k=ra(v["!ref"]),O=Array.isArray(v),H=k.s.r;H<=k.e.r;++H)for(var q=k.s.c;q<=k.e.c;++q)if(w=Ar({r:H,c:q}),S=O?(v[H]||[])[q]:v[w],!(!S||S.v==null||S.t==="z")){switch(p=["cell",w,"t"],S.t){case"s":case"str":p.push(r(S.v));break;case"n":S.f?(p[2]="vtf",p[3]="n",p[4]=S.v,p[5]=r(S.f)):(p[2]="v",p[3]=S.v);break;case"b":p[2]="vt"+(S.f?"f":"c"),p[3]="nl",p[4]=S.v?"1":"0",p[5]=r(S.f||(S.v?"TRUE":"FALSE"));break;case"d":var X=Bi(bi(S.v));p[2]="vtc",p[3]="nd",p[4]=""+X,p[5]=S.w||As(S.z||ln[14],X);break;case"e":continue}x.push(p.join(":"))}return x.push("sheet:c:"+(k.e.c-k.s.c+1)+":r:"+(k.e.r-k.s.r+1)+":tvf:1"),x.push("valueformat:1:text-wiki"),x.join(`
`)}function f(v){return[a,o,s,o,c(v),l].join(`
`)}return{to_workbook:i,to_sheet:n,from_sheet:f}})(),EC=(function(){function t(f,v,x,p,S){S.raw?v[x][p]=f:f===""||(f==="TRUE"?v[x][p]=!0:f==="FALSE"?v[x][p]=!1:isNaN(Uo(f))?isNaN(E0(f).getDate())?v[x][p]=f:v[x][p]=bi(f):v[x][p]=Uo(f))}function r(f,v){var x=v||{},p=[];if(!f||f.length===0)return p;for(var S=f.split(/[\r\n]/),w=S.length-1;w>=0&&S[w].length===0;)--w;for(var k=10,O=0,H=0;H<=w;++H)O=S[H].indexOf(" "),O==-1?O=S[H].length:O++,k=Math.max(k,O);for(H=0;H<=w;++H){p[H]=[];var q=0;for(t(S[H].slice(0,k).trim(),p,H,q,x),q=1;q<=(S[H].length-k)/10+1;++q)t(S[H].slice(k+(q-1)*10,k+q*10).trim(),p,H,q,x)}return x.sheetRows&&(p=p.slice(0,x.sheetRows)),p}var e={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function i(f){for(var v={},x=!1,p=0,S=0;p<f.length;++p)(S=f.charCodeAt(p))==34?x=!x:!x&&S in e&&(v[S]=(v[S]||0)+1);S=[];for(p in v)Object.prototype.hasOwnProperty.call(v,p)&&S.push([v[p],p]);if(!S.length){v=n;for(p in v)Object.prototype.hasOwnProperty.call(v,p)&&S.push([v[p],p])}return S.sort(function(w,k){return w[0]-k[0]||n[w[1]]-n[k[1]]}),e[S.pop()[1]]||44}function a(f,v){var x=v||{},p="";oo!=null&&x.dense==null&&(x.dense=oo);var S=x.dense?[]:{},w={s:{c:0,r:0},e:{c:0,r:0}};f.slice(0,4)=="sep="?f.charCodeAt(5)==13&&f.charCodeAt(6)==10?(p=f.charAt(4),f=f.slice(7)):f.charCodeAt(5)==13||f.charCodeAt(5)==10?(p=f.charAt(4),f=f.slice(6)):p=i(f.slice(0,1024)):x&&x.FS?p=x.FS:p=i(f.slice(0,1024));var k=0,O=0,H=0,q=0,X=0,he=p.charCodeAt(0),ke=!1,re=0,ee=f.charCodeAt(0);f=f.replace(/\r\n/mg,`
`);var W=x.dateNF!=null?zw(x.dateNF):null;function ae(){var A=f.slice(q,X),V={};if(A.charAt(0)=='"'&&A.charAt(A.length-1)=='"'&&(A=A.slice(1,-1).replace(/""/g,'"')),A.length===0)V.t="z";else if(x.raw)V.t="s",V.v=A;else if(A.trim().length===0)V.t="s",V.v=A;else if(A.charCodeAt(0)==61)A.charCodeAt(1)==34&&A.charCodeAt(A.length-1)==34?(V.t="s",V.v=A.slice(2,-1).replace(/""/g,'"')):S3(A)?(V.t="n",V.f=A.slice(1)):(V.t="s",V.v=A);else if(A=="TRUE")V.t="b",V.v=!0;else if(A=="FALSE")V.t="b",V.v=!1;else if(!isNaN(H=Uo(A)))V.t="n",x.cellText!==!1&&(V.w=A),V.v=H;else if(!isNaN(E0(A).getDate())||W&&A.match(W)){V.z=x.dateNF||ln[14];var de=0;W&&A.match(W)&&(A=jw(A,x.dateNF,A.match(W)||[]),de=1),x.cellDates?(V.t="d",V.v=bi(A,de)):(V.t="n",V.v=Bi(bi(A,de))),x.cellText!==!1&&(V.w=As(V.z,V.v instanceof Date?Bi(V.v):V.v)),x.cellNF||delete V.z}else V.t="s",V.v=A;if(V.t=="z"||(x.dense?(S[k]||(S[k]=[]),S[k][O]=V):S[Ar({c:O,r:k})]=V),q=X+1,ee=f.charCodeAt(q),w.e.c<O&&(w.e.c=O),w.e.r<k&&(w.e.r=k),re==he)++O;else if(O=0,++k,x.sheetRows&&x.sheetRows<=k)return!0}e:for(;X<f.length;++X)switch(re=f.charCodeAt(X)){case 34:ee===34&&(ke=!ke);break;case he:case 10:case 13:if(!ke&&ae())break e;break;default:break}return X-q>0&&ae(),S["!ref"]=kn(w),S}function o(f,v){return!(v&&v.PRN)||v.FS||f.slice(0,4)=="sep="||f.indexOf("	")>=0||f.indexOf(",")>=0||f.indexOf(";")>=0?a(f,v):fc(r(f,v),v)}function s(f,v){var x="",p=v.type=="string"?[0,0,0,0]:BE(f,v);switch(v.type){case"base64":x=zo(f);break;case"binary":x=f;break;case"buffer":v.codepage==65001?x=f.toString("utf8"):v.codepage&&typeof Lr<"u"?x=Lr.utils.decode(v.codepage,f):x=vr&&Buffer.isBuffer(f)?f.toString("binary"):A0(f);break;case"array":x=Tf(f);break;case"string":x=f;break;default:throw new Error("Unrecognized type "+v.type)}return p[0]==239&&p[1]==187&&p[2]==191?x=v0(x.slice(3)):v.type!="string"&&v.type!="buffer"&&v.codepage==65001?x=v0(x):v.type=="binary"&&typeof Lr<"u"&&v.codepage&&(x=Lr.utils.decode(v.codepage,Lr.utils.encode(28591,x))),x.slice(0,19)=="socialcalc:version:"?ov.to_sheet(v.type=="string"?x:v0(x),v):o(x,v)}function l(f,v){return _l(s(f,v),v)}function c(f){for(var v=[],x=Gr(f["!ref"]),p,S=Array.isArray(f),w=x.s.r;w<=x.e.r;++w){for(var k=[],O=x.s.c;O<=x.e.c;++O){var H=Ar({r:w,c:O});if(p=S?(f[w]||[])[O]:f[H],!p||p.v==null){k.push("          ");continue}for(var q=(p.w||(jo(p),p.w)||"").slice(0,10);q.length<10;)q+=" ";k.push(q+(O===0?" ":""))}v.push(k.join(""))}return v.join(`
`)}return{to_workbook:l,to_sheet:s,from_sheet:c}})();var i_=(function(){function t(E,U,T){if(E){ea(E,E.l||0);for(var R=T.Enum||Je;E.l<E.length;){var te=E.read_shift(2),pe=R[te]||R[65535],ye=E.read_shift(2),ve=E.l+ye,_e=pe.f&&pe.f(E,ye,T);if(E.l=ve,U(_e,pe,te))return}}}function r(E,U){switch(U.type){case"base64":return e(Va(zo(E)),U);case"binary":return e(Va(E),U);case"buffer":case"array":return e(E,U)}throw"Unsupported type "+U.type}function e(E,U){if(!E)return E;var T=U||{};oo!=null&&T.dense==null&&(T.dense=oo);var R=T.dense?[]:{},te="Sheet1",pe="",ye=0,ve={},_e=[],He=[],Ye={s:{r:0,c:0},e:{r:0,c:0}},nt=T.sheetRows||0;if(E[2]==0&&(E[3]==8||E[3]==9)&&E.length>=16&&E[14]==5&&E[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(E[2]==2)T.Enum=Je,t(E,function(Qe,_t,$e){switch($e){case 0:T.vers=Qe,Qe>=4096&&(T.qpro=!0);break;case 6:Ye=Qe;break;case 204:Qe&&(pe=Qe);break;case 222:pe=Qe;break;case 15:case 51:T.qpro||(Qe[1].v=Qe[1].v.slice(1));case 13:case 14:case 16:$e==14&&(Qe[2]&112)==112&&(Qe[2]&15)>1&&(Qe[2]&15)<15&&(Qe[1].z=T.dateNF||ln[14],T.cellDates&&(Qe[1].t="d",Qe[1].v=P_(Qe[1].v))),T.qpro&&Qe[3]>ye&&(R["!ref"]=kn(Ye),ve[te]=R,_e.push(te),R=T.dense?[]:{},Ye={s:{r:0,c:0},e:{r:0,c:0}},ye=Qe[3],te=pe||"Sheet"+(ye+1),pe="");var Et=T.dense?(R[Qe[0].r]||[])[Qe[0].c]:R[Ar(Qe[0])];if(Et){Et.t=Qe[1].t,Et.v=Qe[1].v,Qe[1].z!=null&&(Et.z=Qe[1].z),Qe[1].f!=null&&(Et.f=Qe[1].f);break}T.dense?(R[Qe[0].r]||(R[Qe[0].r]=[]),R[Qe[0].r][Qe[0].c]=Qe[1]):R[Ar(Qe[0])]=Qe[1];break;default:}},T);else if(E[2]==26||E[2]==14)T.Enum=qe,E[2]==14&&(T.qpro=!0,E.l=0),t(E,function(Qe,_t,$e){switch($e){case 204:te=Qe;break;case 22:Qe[1].v=Qe[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Qe[3]>ye&&(R["!ref"]=kn(Ye),ve[te]=R,_e.push(te),R=T.dense?[]:{},Ye={s:{r:0,c:0},e:{r:0,c:0}},ye=Qe[3],te="Sheet"+(ye+1)),nt>0&&Qe[0].r>=nt)break;T.dense?(R[Qe[0].r]||(R[Qe[0].r]=[]),R[Qe[0].r][Qe[0].c]=Qe[1]):R[Ar(Qe[0])]=Qe[1],Ye.e.c<Qe[0].c&&(Ye.e.c=Qe[0].c),Ye.e.r<Qe[0].r&&(Ye.e.r=Qe[0].r);break;case 27:Qe[14e3]&&(He[Qe[14e3][0]]=Qe[14e3][1]);break;case 1537:He[Qe[0]]=Qe[1],Qe[0]==ye&&(te=Qe[1]);break;default:break}},T);else throw new Error("Unrecognized LOTUS BOF "+E[2]);if(R["!ref"]=kn(Ye),ve[pe||te]=R,_e.push(pe||te),!He.length)return{SheetNames:_e,Sheets:ve};for(var at={},Q=[],tt=0;tt<He.length;++tt)ve[_e[tt]]?(Q.push(He[tt]||_e[tt]),at[He[tt]]=ve[He[tt]]||ve[_e[tt]]):(Q.push(He[tt]),at[He[tt]]={"!ref":"A1"});return{SheetNames:Q,Sheets:at}}function n(E,U){var T=U||{};if(+T.codepage>=0&&S0(+T.codepage),T.type=="string")throw new Error("Cannot write WK1 to JS string");var R=Li(),te=Gr(E["!ref"]),pe=Array.isArray(E),ye=[];ct(R,0,a(1030)),ct(R,6,l(te));for(var ve=Math.min(te.e.r,8191),_e=te.s.r;_e<=ve;++_e)for(var He=ri(_e),Ye=te.s.c;Ye<=te.e.c;++Ye){_e===te.s.r&&(ye[Ye]=si(Ye));var nt=ye[Ye]+He,at=pe?(E[_e]||[])[Ye]:E[nt];if(!(!at||at.t=="z"))if(at.t=="n")(at.v|0)==at.v&&at.v>=-32768&&at.v<=32767?ct(R,13,p(_e,Ye,at.v)):ct(R,14,w(_e,Ye,at.v));else{var Q=jo(at);ct(R,15,v(_e,Ye,Q.slice(0,239)))}}return ct(R,1),R.end()}function i(E,U){var T=U||{};if(+T.codepage>=0&&S0(+T.codepage),T.type=="string")throw new Error("Cannot write WK3 to JS string");var R=Li();ct(R,0,o(E));for(var te=0,pe=0;te<E.SheetNames.length;++te)(E.Sheets[E.SheetNames[te]]||{})["!ref"]&&ct(R,27,Be(E.SheetNames[te],pe++));var ye=0;for(te=0;te<E.SheetNames.length;++te){var ve=E.Sheets[E.SheetNames[te]];if(!(!ve||!ve["!ref"])){for(var _e=Gr(ve["!ref"]),He=Array.isArray(ve),Ye=[],nt=Math.min(_e.e.r,8191),at=_e.s.r;at<=nt;++at)for(var Q=ri(at),tt=_e.s.c;tt<=_e.e.c;++tt){at===_e.s.r&&(Ye[tt]=si(tt));var Qe=Ye[tt]+Q,_t=He?(ve[at]||[])[tt]:ve[Qe];if(!(!_t||_t.t=="z"))if(_t.t=="n")ct(R,23,ae(at,tt,ye,_t.v));else{var $e=jo(_t);ct(R,22,re(at,tt,ye,$e.slice(0,239)))}}++ye}}return ct(R,1),R.end()}function a(E){var U=Ue(2);return U.write_shift(2,E),U}function o(E){var U=Ue(26);U.write_shift(2,4096),U.write_shift(2,4),U.write_shift(4,0);for(var T=0,R=0,te=0,pe=0;pe<E.SheetNames.length;++pe){var ye=E.SheetNames[pe],ve=E.Sheets[ye];if(!(!ve||!ve["!ref"])){++te;var _e=ra(ve["!ref"]);T<_e.e.r&&(T=_e.e.r),R<_e.e.c&&(R=_e.e.c)}}return T>8191&&(T=8191),U.write_shift(2,T),U.write_shift(1,te),U.write_shift(1,R),U.write_shift(2,0),U.write_shift(2,0),U.write_shift(1,1),U.write_shift(1,2),U.write_shift(4,0),U.write_shift(4,0),U}function s(E,U,T){var R={s:{c:0,r:0},e:{c:0,r:0}};return U==8&&T.qpro?(R.s.c=E.read_shift(1),E.l++,R.s.r=E.read_shift(2),R.e.c=E.read_shift(1),E.l++,R.e.r=E.read_shift(2),R):(R.s.c=E.read_shift(2),R.s.r=E.read_shift(2),U==12&&T.qpro&&(E.l+=2),R.e.c=E.read_shift(2),R.e.r=E.read_shift(2),U==12&&T.qpro&&(E.l+=2),R.s.c==65535&&(R.s.c=R.e.c=R.s.r=R.e.r=0),R)}function l(E){var U=Ue(8);return U.write_shift(2,E.s.c),U.write_shift(2,E.s.r),U.write_shift(2,E.e.c),U.write_shift(2,E.e.r),U}function c(E,U,T){var R=[{c:0,r:0},{t:"n",v:0},0,0];return T.qpro&&T.vers!=20768?(R[0].c=E.read_shift(1),R[3]=E.read_shift(1),R[0].r=E.read_shift(2),E.l+=2):(R[2]=E.read_shift(1),R[0].c=E.read_shift(2),R[0].r=E.read_shift(2)),R}function f(E,U,T){var R=E.l+U,te=c(E,U,T);if(te[1].t="s",T.vers==20768){E.l++;var pe=E.read_shift(1);return te[1].v=E.read_shift(pe,"utf8"),te}return T.qpro&&E.l++,te[1].v=E.read_shift(R-E.l,"cstr"),te}function v(E,U,T){var R=Ue(7+T.length);R.write_shift(1,255),R.write_shift(2,U),R.write_shift(2,E),R.write_shift(1,39);for(var te=0;te<R.length;++te){var pe=T.charCodeAt(te);R.write_shift(1,pe>=128?95:pe)}return R.write_shift(1,0),R}function x(E,U,T){var R=c(E,U,T);return R[1].v=E.read_shift(2,"i"),R}function p(E,U,T){var R=Ue(7);return R.write_shift(1,255),R.write_shift(2,U),R.write_shift(2,E),R.write_shift(2,T,"i"),R}function S(E,U,T){var R=c(E,U,T);return R[1].v=E.read_shift(8,"f"),R}function w(E,U,T){var R=Ue(13);return R.write_shift(1,255),R.write_shift(2,U),R.write_shift(2,E),R.write_shift(8,T,"f"),R}function k(E,U,T){var R=E.l+U,te=c(E,U,T);if(te[1].v=E.read_shift(8,"f"),T.qpro)E.l=R;else{var pe=E.read_shift(2);X(E.slice(E.l,E.l+pe),te),E.l+=pe}return te}function O(E,U,T){var R=U&32768;return U&=-32769,U=(R?E:0)+(U>=8192?U-16384:U),(R?"":"$")+(T?si(U):ri(U))}var H={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},q=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function X(E,U){ea(E,0);for(var T=[],R=0,te="",pe="",ye="",ve="";E.l<E.length;){var _e=E[E.l++];switch(_e){case 0:T.push(E.read_shift(8,"f"));break;case 1:pe=O(U[0].c,E.read_shift(2),!0),te=O(U[0].r,E.read_shift(2),!1),T.push(pe+te);break;case 2:{var He=O(U[0].c,E.read_shift(2),!0),Ye=O(U[0].r,E.read_shift(2),!1);pe=O(U[0].c,E.read_shift(2),!0),te=O(U[0].r,E.read_shift(2),!1),T.push(He+Ye+":"+pe+te)}break;case 3:if(E.l<E.length){console.error("WK1 premature formula end");return}break;case 4:T.push("("+T.pop()+")");break;case 5:T.push(E.read_shift(2));break;case 6:{for(var nt="";_e=E[E.l++];)nt+=String.fromCharCode(_e);T.push('"'+nt.replace(/"/g,'""')+'"')}break;case 8:T.push("-"+T.pop());break;case 23:T.push("+"+T.pop());break;case 22:T.push("NOT("+T.pop()+")");break;case 20:case 21:ve=T.pop(),ye=T.pop(),T.push(["AND","OR"][_e-20]+"("+ye+","+ve+")");break;default:if(_e<32&&q[_e])ve=T.pop(),ye=T.pop(),T.push(ye+q[_e]+ve);else if(H[_e]){if(R=H[_e][1],R==69&&(R=E[E.l++]),R>T.length){console.error("WK1 bad formula parse 0x"+_e.toString(16)+":|"+T.join("|")+"|");return}var at=T.slice(-R);T.length-=R,T.push(H[_e][0]+"("+at.join(",")+")")}else return _e<=7?console.error("WK1 invalid opcode "+_e.toString(16)):_e<=24?console.error("WK1 unsupported op "+_e.toString(16)):_e<=30?console.error("WK1 invalid opcode "+_e.toString(16)):_e<=115?console.error("WK1 unsupported function opcode "+_e.toString(16)):console.error("WK1 unrecognized opcode "+_e.toString(16))}}T.length==1?U[1].f=""+T[0]:console.error("WK1 bad formula parse |"+T.join("|")+"|")}function he(E){var U=[{c:0,r:0},{t:"n",v:0},0];return U[0].r=E.read_shift(2),U[3]=E[E.l++],U[0].c=E[E.l++],U}function ke(E,U){var T=he(E,U);return T[1].t="s",T[1].v=E.read_shift(U-4,"cstr"),T}function re(E,U,T,R){var te=Ue(6+R.length);te.write_shift(2,E),te.write_shift(1,T),te.write_shift(1,U),te.write_shift(1,39);for(var pe=0;pe<R.length;++pe){var ye=R.charCodeAt(pe);te.write_shift(1,ye>=128?95:ye)}return te.write_shift(1,0),te}function ee(E,U){var T=he(E,U);T[1].v=E.read_shift(2);var R=T[1].v>>1;if(T[1].v&1)switch(R&7){case 0:R=(R>>3)*5e3;break;case 1:R=(R>>3)*500;break;case 2:R=(R>>3)/20;break;case 3:R=(R>>3)/200;break;case 4:R=(R>>3)/2e3;break;case 5:R=(R>>3)/2e4;break;case 6:R=(R>>3)/16;break;case 7:R=(R>>3)/64;break}return T[1].v=R,T}function W(E,U){var T=he(E,U),R=E.read_shift(4),te=E.read_shift(4),pe=E.read_shift(2);if(pe==65535)return R===0&&te===3221225472?(T[1].t="e",T[1].v=15):R===0&&te===3489660928?(T[1].t="e",T[1].v=42):T[1].v=0,T;var ye=pe&32768;return pe=(pe&32767)-16446,T[1].v=(1-ye*2)*(te*Math.pow(2,pe+32)+R*Math.pow(2,pe)),T}function ae(E,U,T,R){var te=Ue(14);if(te.write_shift(2,E),te.write_shift(1,T),te.write_shift(1,U),R==0)return te.write_shift(4,0),te.write_shift(4,0),te.write_shift(2,65535),te;var pe=0,ye=0,ve=0,_e=0;return R<0&&(pe=1,R=-R),ye=Math.log2(R)|0,R/=Math.pow(2,ye-31),_e=R>>>0,(_e&2147483648)==0&&(R/=2,++ye,_e=R>>>0),R-=_e,_e|=2147483648,_e>>>=0,R*=Math.pow(2,32),ve=R>>>0,te.write_shift(4,ve),te.write_shift(4,_e),ye+=16383+(pe?32768:0),te.write_shift(2,ye),te}function A(E,U){var T=W(E,14);return E.l+=U-14,T}function V(E,U){var T=he(E,U),R=E.read_shift(4);return T[1].v=R>>6,T}function de(E,U){var T=he(E,U),R=E.read_shift(8,"f");return T[1].v=R,T}function ue(E,U){var T=de(E,14);return E.l+=U-10,T}function xe(E,U){return E[E.l+U-1]==0?E.read_shift(U,"cstr"):""}function Ne(E,U){var T=E[E.l++];T>U-1&&(T=U-1);for(var R="";R.length<T;)R+=String.fromCharCode(E[E.l++]);return R}function Re(E,U,T){if(!(!T.qpro||U<21)){var R=E.read_shift(1);E.l+=17,E.l+=1,E.l+=2;var te=E.read_shift(U-21,"cstr");return[R,te]}}function Ee(E,U){for(var T={},R=E.l+U;E.l<R;){var te=E.read_shift(2);if(te==14e3){for(T[te]=[0,""],T[te][0]=E.read_shift(2);E[E.l];)T[te][1]+=String.fromCharCode(E[E.l]),E.l++;E.l++}}return T}function Be(E,U){var T=Ue(5+E.length);T.write_shift(2,14e3),T.write_shift(2,U);for(var R=0;R<E.length;++R){var te=E.charCodeAt(R);T[T.l++]=te>127?95:te}return T[T.l++]=0,T}var Je={0:{n:"BOF",f:tv},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:s},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:x},14:{n:"NUMBER",f:S},15:{n:"LABEL",f},16:{n:"FORMULA",f:k},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:xe},222:{n:"SHEETNAMELP",f:Ne},65535:{n:""}},qe={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:ke},23:{n:"NUMBER17",f:W},24:{n:"NUMBER18",f:ee},25:{n:"FORMULA19",f:A},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:Ee},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:V},38:{n:"??"},39:{n:"NUMBER27",f:de},40:{n:"FORMULA28",f:ue},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:xe},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:Re},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:i,to_workbook:r}})();var MC=/^\s|\s$|[\t\n\r]/;function sv(t,r){if(!r.bookSST)return"";var e=[En];e[e.length]=st("sst",null,{xmlns:cc[0],count:t.Count,uniqueCount:t.Unique});for(var n=0;n!=t.length;++n)if(t[n]!=null){var i=t[n],a="<si>";i.r?a+=i.r:(a+="<t",i.t||(i.t=""),i.t.match(MC)&&(a+=' xml:space="preserve"'),a+=">"+Or(i.t)+"</t>"),a+="</si>",e[e.length]=a}return e.length>2&&(e[e.length]="</sst>",e[1]=e[1].replace("/>",">")),e.join("")}function PC(t){return[t.read_shift(4),t.read_shift(4)]}function OC(t,r){return r||(r=Ue(8)),r.write_shift(4,t.Count),r.write_shift(4,t.Unique),r}var AC=by;function TC(t){var r=Li();Xe(r,159,OC(t));for(var e=0;e<t.length;++e)Xe(r,19,AC(t[e]));return Xe(r,160),r.end()}function IC(t){if(typeof Lr<"u")return Lr.utils.encode(sc,t);for(var r=[],e=t.split(""),n=0;n<e.length;++n)r[n]=e[n].charCodeAt(0);return r}function lv(t){var r=0,e,n=IC(t),i=n.length+1,a,o,s,l,c;for(e=pl(i),e[0]=n.length,a=1;a!=i;++a)e[a]=n[a-1];for(a=i-1;a>=0;--a)o=e[a],s=(r&16384)===0?0:1,l=r<<1&32767,c=s|l,r=c^o;return r^52811}var FC=(function(){function t(i,a){switch(a.type){case"base64":return r(zo(i),a);case"binary":return r(i,a);case"buffer":return r(vr&&Buffer.isBuffer(i)?i.toString("binary"):A0(i),a);case"array":return r(Tf(i),a)}throw new Error("Unrecognized type "+a.type)}function r(i,a){var o=a||{},s=o.dense?[]:{},l=i.match(/\\trowd.*?\\row\b/g);if(!l.length)throw new Error("RTF missing table");var c={s:{c:0,r:0},e:{c:0,r:l.length-1}};return l.forEach(function(f,v){Array.isArray(s)&&(s[v]=[]);for(var x=/\\\w+\b/g,p=0,S,w=-1;S=x.exec(f);){switch(S[0]){case"\\cell":var k=f.slice(p,x.lastIndex-S[0].length);if(k[0]==" "&&(k=k.slice(1)),++w,k.length){var O={v:k,t:"s"};Array.isArray(s)?s[v][w]=O:s[Ar({r:v,c:w})]=O}break}p=x.lastIndex}w>c.e.c&&(c.e.c=w)}),s["!ref"]=kn(c),s}function e(i,a){return _l(t(i,a),a)}function n(i){for(var a=["{\\rtf1\\ansi"],o=Gr(i["!ref"]),s,l=Array.isArray(i),c=o.s.r;c<=o.e.r;++c){a.push("\\trowd\\trautofit1");for(var f=o.s.c;f<=o.e.c;++f)a.push("\\cellx"+(f+1));for(a.push("\\pard\\intbl"),f=o.s.c;f<=o.e.c;++f){var v=Ar({r:c,c:f});s=l?(i[c]||[])[f]:i[v],!(!s||s.v==null&&(!s.f||s.F))&&(a.push(" "+(s.w||(jo(s),s.w))),a.push("\\cell"))}a.push("\\pard\\intbl\\row")}return a.join("")+"}"}return{to_workbook:e,to_sheet:t,from_sheet:n}})();function a_(t){for(var r=0,e=1;r!=3;++r)e=e*256+(t[r]>255?255:t[r]<0?0:t[r]);return e.toString(16).toUpperCase().slice(1)}var DC=6;var Vo=DC;function yf(t){return Math.floor((t+Math.round(128/Vo)/256)*Vo)}function Cf(t){return Math.floor((t-5)/Vo*100+.5)/100}function ep(t){return Math.round((t*Vo+5)/Vo*256)/256}function xp(t){t.width?(t.wpx=yf(t.width),t.wch=Cf(t.wpx),t.MDW=Vo):t.wpx?(t.wch=Cf(t.wpx),t.width=ep(t.wch),t.MDW=Vo):typeof t.wch=="number"&&(t.width=ep(t.wch),t.wpx=yf(t.width),t.MDW=Vo),t.customWidth&&delete t.customWidth}var NC=96,cv=NC;function Sf(t){return t*96/cv}function dv(t){return t*cv/96}function RC(t){var r=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(e){for(var n=e[0];n<=e[1];++n)t[n]!=null&&(r[r.length]=st("numFmt",null,{numFmtId:n,formatCode:Or(t[n])}))}),r.length===1?"":(r[r.length]="</numFmts>",r[0]=st("numFmts",null,{count:r.length-2}).replace("/>",">"),r.join(""))}function LC(t){var r=[];return r[r.length]=st("cellXfs",null),t.forEach(function(e){r[r.length]=st("xf",null,e)}),r[r.length]="</cellXfs>",r.length===2?"":(r[0]=st("cellXfs",null,{count:r.length-2}).replace("/>",">"),r.join(""))}function fv(t,r){var e=[En,st("styleSheet",null,{xmlns:cc[0],"xmlns:vt":jn.vt})],n;return t.SSF&&(n=RC(t.SSF))!=null&&(e[e.length]=n),e[e.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',e[e.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',e[e.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',e[e.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=LC(r.cellXfs))&&(e[e.length]=n),e[e.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',e[e.length]='<dxfs count="0"/>',e[e.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',e.length>2&&(e[e.length]="</styleSheet>",e[1]=e[1].replace("/>",">")),e.join("")}function BC(t,r){var e=t.read_shift(2),n=li(t,r-2);return[e,n]}function UC(t,r,e){e||(e=Ue(6+4*r.length)),e.write_shift(2,t),Wn(r,e);var n=e.length>e.l?e.slice(0,e.l):e;return e.l==null&&(e.l=e.length),n}function VC(t,r,e){var n={};n.sz=t.read_shift(2)/20;var i=My(t,2,e);i.fItalic&&(n.italic=1),i.fCondense&&(n.condense=1),i.fExtend&&(n.extend=1),i.fShadow&&(n.shadow=1),i.fOutline&&(n.outline=1),i.fStrikeout&&(n.strike=1);var a=t.read_shift(2);switch(a===700&&(n.bold=1),t.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var o=t.read_shift(1);o!=0&&(n.underline=o);var s=t.read_shift(1);s>0&&(n.family=s);var l=t.read_shift(1);switch(l>0&&(n.charset=l),t.l++,n.color=Ey(t,8),t.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=li(t,r-21),n}function zC(t,r){r||(r=Ue(153)),r.write_shift(2,t.sz*20),Py(t,r),r.write_shift(2,t.bold?700:400);var e=0;t.vertAlign=="superscript"?e=1:t.vertAlign=="subscript"&&(e=2),r.write_shift(2,e),r.write_shift(1,t.underline||0),r.write_shift(1,t.family||0),r.write_shift(1,t.charset||0),r.write_shift(1,0),bf(t.color,r);var n=0;return t.scheme=="major"&&(n=1),t.scheme=="minor"&&(n=2),r.write_shift(1,n),Wn(t.name,r),r.length>r.l?r.slice(0,r.l):r}var jC=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],$h,HC=so;function o_(t,r){r||(r=Ue(84)),$h||($h=np(jC));var e=$h[t.patternType];e==null&&(e=40),r.write_shift(4,e);var n=0;if(e!=40)for(bf({auto:1},r),bf({auto:1},r);n<12;++n)r.write_shift(4,0);else{for(;n<4;++n)r.write_shift(4,0);for(;n<12;++n)r.write_shift(4,0)}return r.length>r.l?r.slice(0,r.l):r}function WC(t,r){var e=t.l+r,n=t.read_shift(2),i=t.read_shift(2);return t.l=e,{ixfe:n,numFmtId:i}}function uv(t,r,e){e||(e=Ue(16)),e.write_shift(2,r||0),e.write_shift(2,t.numFmtId||0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(1,0),e.write_shift(1,0);var n=0;return e.write_shift(1,n),e.write_shift(1,0),e.write_shift(1,0),e.write_shift(1,0),e}function g0(t,r){return r||(r=Ue(10)),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(4,0),r}var qC=so;function GC(t,r){return r||(r=Ue(51)),r.write_shift(1,0),g0(null,r),g0(null,r),g0(null,r),g0(null,r),g0(null,r),r.length>r.l?r.slice(0,r.l):r}function $C(t,r){return r||(r=Ue(52)),r.write_shift(4,t.xfId),r.write_shift(2,1),r.write_shift(1,+t.builtinId),r.write_shift(1,0),xf(t.name||"",r),r.length>r.l?r.slice(0,r.l):r}function XC(t,r,e){var n=Ue(2052);return n.write_shift(4,t),xf(r,n),xf(e,n),n.length>n.l?n.slice(0,n.l):n}function YC(t,r){if(r){var e=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)r[i]!=null&&++e}),e!=0&&(Xe(t,615,ja(e)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)r[i]!=null&&Xe(t,44,UC(i,r[i]))}),Xe(t,616))}}function KC(t){var r=1;r!=0&&(Xe(t,611,ja(r)),Xe(t,43,zC({sz:12,color:{theme:1},name:"Calibri",family:2,scheme:"minor"})),Xe(t,612))}function ZC(t){var r=2;r!=0&&(Xe(t,603,ja(r)),Xe(t,45,o_({patternType:"none"})),Xe(t,45,o_({patternType:"gray125"})),Xe(t,604))}function JC(t){var r=1;r!=0&&(Xe(t,613,ja(r)),Xe(t,46,GC({})),Xe(t,614))}function QC(t){var r=1;Xe(t,626,ja(r)),Xe(t,47,uv({numFmtId:0,fontId:0,fillId:0,borderId:0},65535)),Xe(t,627)}function e3(t,r){Xe(t,617,ja(r.length)),r.forEach(function(e){Xe(t,47,uv(e,0))}),Xe(t,618)}function t3(t){var r=1;Xe(t,619,ja(r)),Xe(t,48,$C({xfId:0,builtinId:0,name:"Normal"})),Xe(t,620)}function r3(t){var r=0;Xe(t,505,ja(r)),Xe(t,506)}function n3(t){var r=0;Xe(t,508,XC(r,"TableStyleMedium9","PivotStyleMedium4")),Xe(t,509)}function i3(t,r){var e=Li();return Xe(e,278),YC(e,t.SSF),KC(e,t),ZC(e,t),JC(e,t),QC(e,t),e3(e,r.cellXfs),t3(e,t),r3(e,t),n3(e,t),Xe(e,279),e.end()}function hv(t,r){if(r&&r.themeXLSX)return r.themeXLSX;if(t&&typeof t.raw=="string")return t.raw;var e=[En];return e[e.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',e[e.length]="<a:themeElements>",e[e.length]='<a:clrScheme name="Office">',e[e.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',e[e.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',e[e.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',e[e.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',e[e.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',e[e.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',e[e.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',e[e.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',e[e.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',e[e.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',e[e.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',e[e.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',e[e.length]="</a:clrScheme>",e[e.length]='<a:fontScheme name="Office">',e[e.length]="<a:majorFont>",e[e.length]='<a:latin typeface="Cambria"/>',e[e.length]='<a:ea typeface=""/>',e[e.length]='<a:cs typeface=""/>',e[e.length]='<a:font script="Jpan" typeface="\uFF2D\uFF33 \uFF30\u30B4\u30B7\u30C3\u30AF"/>',e[e.length]='<a:font script="Hang" typeface="\uB9D1\uC740 \uACE0\uB515"/>',e[e.length]='<a:font script="Hans" typeface="\u5B8B\u4F53"/>',e[e.length]='<a:font script="Hant" typeface="\u65B0\u7D30\u660E\u9AD4"/>',e[e.length]='<a:font script="Arab" typeface="Times New Roman"/>',e[e.length]='<a:font script="Hebr" typeface="Times New Roman"/>',e[e.length]='<a:font script="Thai" typeface="Tahoma"/>',e[e.length]='<a:font script="Ethi" typeface="Nyala"/>',e[e.length]='<a:font script="Beng" typeface="Vrinda"/>',e[e.length]='<a:font script="Gujr" typeface="Shruti"/>',e[e.length]='<a:font script="Khmr" typeface="MoolBoran"/>',e[e.length]='<a:font script="Knda" typeface="Tunga"/>',e[e.length]='<a:font script="Guru" typeface="Raavi"/>',e[e.length]='<a:font script="Cans" typeface="Euphemia"/>',e[e.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',e[e.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',e[e.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',e[e.length]='<a:font script="Thaa" typeface="MV Boli"/>',e[e.length]='<a:font script="Deva" typeface="Mangal"/>',e[e.length]='<a:font script="Telu" typeface="Gautami"/>',e[e.length]='<a:font script="Taml" typeface="Latha"/>',e[e.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',e[e.length]='<a:font script="Orya" typeface="Kalinga"/>',e[e.length]='<a:font script="Mlym" typeface="Kartika"/>',e[e.length]='<a:font script="Laoo" typeface="DokChampa"/>',e[e.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',e[e.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',e[e.length]='<a:font script="Viet" typeface="Times New Roman"/>',e[e.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',e[e.length]='<a:font script="Geor" typeface="Sylfaen"/>',e[e.length]="</a:majorFont>",e[e.length]="<a:minorFont>",e[e.length]='<a:latin typeface="Calibri"/>',e[e.length]='<a:ea typeface=""/>',e[e.length]='<a:cs typeface=""/>',e[e.length]='<a:font script="Jpan" typeface="\uFF2D\uFF33 \uFF30\u30B4\u30B7\u30C3\u30AF"/>',e[e.length]='<a:font script="Hang" typeface="\uB9D1\uC740 \uACE0\uB515"/>',e[e.length]='<a:font script="Hans" typeface="\u5B8B\u4F53"/>',e[e.length]='<a:font script="Hant" typeface="\u65B0\u7D30\u660E\u9AD4"/>',e[e.length]='<a:font script="Arab" typeface="Arial"/>',e[e.length]='<a:font script="Hebr" typeface="Arial"/>',e[e.length]='<a:font script="Thai" typeface="Tahoma"/>',e[e.length]='<a:font script="Ethi" typeface="Nyala"/>',e[e.length]='<a:font script="Beng" typeface="Vrinda"/>',e[e.length]='<a:font script="Gujr" typeface="Shruti"/>',e[e.length]='<a:font script="Khmr" typeface="DaunPenh"/>',e[e.length]='<a:font script="Knda" typeface="Tunga"/>',e[e.length]='<a:font script="Guru" typeface="Raavi"/>',e[e.length]='<a:font script="Cans" typeface="Euphemia"/>',e[e.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',e[e.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',e[e.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',e[e.length]='<a:font script="Thaa" typeface="MV Boli"/>',e[e.length]='<a:font script="Deva" typeface="Mangal"/>',e[e.length]='<a:font script="Telu" typeface="Gautami"/>',e[e.length]='<a:font script="Taml" typeface="Latha"/>',e[e.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',e[e.length]='<a:font script="Orya" typeface="Kalinga"/>',e[e.length]='<a:font script="Mlym" typeface="Kartika"/>',e[e.length]='<a:font script="Laoo" typeface="DokChampa"/>',e[e.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',e[e.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',e[e.length]='<a:font script="Viet" typeface="Arial"/>',e[e.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',e[e.length]='<a:font script="Geor" typeface="Sylfaen"/>',e[e.length]="</a:minorFont>",e[e.length]="</a:fontScheme>",e[e.length]='<a:fmtScheme name="Office">',e[e.length]="<a:fillStyleLst>",e[e.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',e[e.length]='<a:gradFill rotWithShape="1">',e[e.length]="<a:gsLst>",e[e.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',e[e.length]="</a:gsLst>",e[e.length]='<a:lin ang="16200000" scaled="1"/>',e[e.length]="</a:gradFill>",e[e.length]='<a:gradFill rotWithShape="1">',e[e.length]="<a:gsLst>",e[e.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',e[e.length]="</a:gsLst>",e[e.length]='<a:lin ang="16200000" scaled="0"/>',e[e.length]="</a:gradFill>",e[e.length]="</a:fillStyleLst>",e[e.length]="<a:lnStyleLst>",e[e.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',e[e.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',e[e.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',e[e.length]="</a:lnStyleLst>",e[e.length]="<a:effectStyleLst>",e[e.length]="<a:effectStyle>",e[e.length]="<a:effectLst>",e[e.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',e[e.length]="</a:effectLst>",e[e.length]="</a:effectStyle>",e[e.length]="<a:effectStyle>",e[e.length]="<a:effectLst>",e[e.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',e[e.length]="</a:effectLst>",e[e.length]="</a:effectStyle>",e[e.length]="<a:effectStyle>",e[e.length]="<a:effectLst>",e[e.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',e[e.length]="</a:effectLst>",e[e.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',e[e.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',e[e.length]="</a:effectStyle>",e[e.length]="</a:effectStyleLst>",e[e.length]="<a:bgFillStyleLst>",e[e.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',e[e.length]='<a:gradFill rotWithShape="1">',e[e.length]="<a:gsLst>",e[e.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',e[e.length]="</a:gsLst>",e[e.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',e[e.length]="</a:gradFill>",e[e.length]='<a:gradFill rotWithShape="1">',e[e.length]="<a:gsLst>",e[e.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',e[e.length]="</a:gsLst>",e[e.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',e[e.length]="</a:gradFill>",e[e.length]="</a:bgFillStyleLst>",e[e.length]="</a:fmtScheme>",e[e.length]="</a:themeElements>",e[e.length]="<a:objectDefaults>",e[e.length]="<a:spDef>",e[e.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',e[e.length]="</a:spDef>",e[e.length]="<a:lnDef>",e[e.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',e[e.length]="</a:lnDef>",e[e.length]="</a:objectDefaults>",e[e.length]="<a:extraClrSchemeLst/>",e[e.length]="</a:theme>",e.join("")}function a3(t,r){return{flags:t.read_shift(4),version:t.read_shift(4),name:li(t,r-8)}}function o3(t){var r=Ue(12+2*t.name.length);return r.write_shift(4,t.flags),r.write_shift(4,t.version),Wn(t.name,r),r.slice(0,r.l)}function s3(t){for(var r=[],e=t.read_shift(4);e-- >0;)r.push([t.read_shift(4),t.read_shift(4)]);return r}function l3(t){var r=Ue(4+8*t.length);r.write_shift(4,t.length);for(var e=0;e<t.length;++e)r.write_shift(4,t[e][0]),r.write_shift(4,t[e][1]);return r}function c3(t,r){var e=Ue(8+2*r.length);return e.write_shift(4,t),Wn(r,e),e.slice(0,e.l)}function d3(t){return t.l+=4,t.read_shift(4)!=0}function f3(t,r){var e=Ue(8);return e.write_shift(4,t),e.write_shift(4,r?1:0),e}function u3(){var t=Li();return Xe(t,332),Xe(t,334,ja(1)),Xe(t,335,o3({name:"XLDAPR",version:12e4,flags:3496657072})),Xe(t,336),Xe(t,339,c3(1,"XLDAPR")),Xe(t,52),Xe(t,35,ja(514)),Xe(t,4096,ja(0)),Xe(t,4097,Ca(1)),Xe(t,36),Xe(t,53),Xe(t,340),Xe(t,337,f3(1,!0)),Xe(t,51,l3([[1,0]])),Xe(t,338),Xe(t,333),t.end()}function pv(){var t=[En];return t.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),t.join("")}function h3(t){var r={};r.i=t.read_shift(4);var e={};e.r=t.read_shift(4),e.c=t.read_shift(4),r.r=Ar(e);var n=t.read_shift(1);return n&2&&(r.l="1"),n&8&&(r.a="1"),r}var tc=1024;function mv(t,r){for(var e=[21600,21600],n=["m0,0l0",e[1],e[0],e[1],e[0],"0xe"].join(","),i=[st("xml",null,{"xmlns:v":ta.v,"xmlns:o":ta.o,"xmlns:x":ta.x,"xmlns:mv":ta.mv}).replace(/\/>/,">"),st("o:shapelayout",st("o:idmap",null,{"v:ext":"edit",data:t}),{"v:ext":"edit"}),st("v:shapetype",[st("v:stroke",null,{joinstyle:"miter"}),st("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:e.join(","),path:n})];tc<t*1e3;)tc+=1e3;return r.forEach(function(a){var o=Hn(a[0]),s={color2:"#BEFF82",type:"gradient"};s.type=="gradient"&&(s.angle="-180");var l=s.type=="gradient"?st("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,c=st("v:fill",l,s),f={on:"t",obscured:"t"};++tc,i=i.concat(["<v:shape"+M0({id:"_x0000_s"+tc,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(a[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",c,st("v:shadow",null,f),st("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",ti("x:Anchor",[o.c+1,0,o.r+1,0,o.c+3,20,o.r+5,20].join(",")),ti("x:AutoFill","False"),ti("x:Row",String(o.r)),ti("x:Column",String(o.c)),a[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),i.push("</xml>"),i.join("")}function gv(t){var r=[En,st("comments",null,{xmlns:cc[0]})],e=[];return r.push("<authors>"),t.forEach(function(n){n[1].forEach(function(i){var a=Or(i.a);e.indexOf(a)==-1&&(e.push(a),r.push("<author>"+a+"</author>")),i.T&&i.ID&&e.indexOf("tc="+i.ID)==-1&&(e.push("tc="+i.ID),r.push("<author>tc="+i.ID+"</author>"))})}),e.length==0&&(e.push("SheetJ5"),r.push("<author>SheetJ5</author>")),r.push("</authors>"),r.push("<commentList>"),t.forEach(function(n){var i=0,a=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?i=e.indexOf("tc="+n[1][0].ID):n[1].forEach(function(l){l.a&&(i=e.indexOf(Or(l.a))),a.push(l.t||"")}),r.push('<comment ref="'+n[0]+'" authorId="'+i+'"><text>'),a.length<=1)r.push(ti("t",Or(a[0]||"")));else{for(var o=`Comment:
    `+a[0]+`
`,s=1;s<a.length;++s)o+=`Reply:
    `+a[s]+`
`;r.push(ti("t",Or(o)))}r.push("</text></comment>")}),r.push("</commentList>"),r.length>2&&(r[r.length]="</comments>",r[1]=r[1].replace("/>",">")),r.join("")}function p3(t,r,e){var n=[En,st("ThreadedComments",null,{xmlns:jn.TCMNT}).replace(/[\/]>/,">")];return t.forEach(function(i){var a="";(i[1]||[]).forEach(function(o,s){if(!o.T){delete o.ID;return}o.a&&r.indexOf(o.a)==-1&&r.push(o.a);var l={ref:i[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+e.tcid++).slice(-12)+"}"};s==0?a=l.id:l.parentId=a,o.ID=l.id,o.a&&(l.personId="{54EE7950-7262-4200-6969-"+("000000000000"+r.indexOf(o.a)).slice(-12)+"}"),n.push(st("threadedComment",ti("text",o.t||""),l))})}),n.push("</ThreadedComments>"),n.join("")}function m3(t){var r=[En,st("personList",null,{xmlns:jn.TCMNT,"xmlns:x":cc[0]}).replace(/[\/]>/,">")];return t.forEach(function(e,n){r.push(st("person",null,{displayName:e,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:e,providerId:"None"}))}),r.push("</personList>"),r.join("")}function g3(t){var r={};r.iauthor=t.read_shift(4);var e=wl(t,16);return r.rfx=e.s,r.ref=Ar(e.s),t.l+=16,r}function _3(t,r){return r==null&&(r=Ue(36)),r.write_shift(4,t[1].iauthor),uc(t[0],r),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r}var v3=li;function x3(t){return Wn(t.slice(0,54))}function b3(t){var r=Li(),e=[];return Xe(r,628),Xe(r,630),t.forEach(function(n){n[1].forEach(function(i){e.indexOf(i.a)>-1||(e.push(i.a.slice(0,54)),Xe(r,632,x3(i.a)))})}),Xe(r,631),Xe(r,633),t.forEach(function(n){n[1].forEach(function(i){i.iauthor=e.indexOf(i.a);var a={s:Hn(n[0]),e:Hn(n[0])};Xe(r,635,_3([a,i])),i.t&&i.t.length>0&&Xe(r,637,yy(i)),Xe(r,636),delete i.iauthor})}),Xe(r,634),Xe(r,629),r.end()}function w3(t,r){r.FullPaths.forEach(function(e,n){if(n!=0){var i=e.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");i.slice(-1)!=="/"&&Fr.utils.cfb_add(t,i,r.FileIndex[n].content)}})}var _v=["xlsb","xlsm","xlam","biff8","xla"];var y3=(function(){var t=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,r={r:0,c:0};function e(n,i,a,o){var s=!1,l=!1;a.length==0?l=!0:a.charAt(0)=="["&&(l=!0,a=a.slice(1,-1)),o.length==0?s=!0:o.charAt(0)=="["&&(s=!0,o=o.slice(1,-1));var c=a.length>0?parseInt(a,10)|0:0,f=o.length>0?parseInt(o,10)|0:0;return s?f+=r.c:--f,l?c+=r.r:--c,i+(s?"":"$")+si(f)+(l?"":"$")+ri(c)}return function(i,a){return r=a,i.replace(t,e)}})(),bp=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,wp=(function(){return function(r,e){return r.replace(bp,function(n,i,a,o,s,l){var c=pp(o)-(a?0:e.c),f=hp(l)-(s?0:e.r),v=f==0?"":s?f+1:"["+f+"]",x=c==0?"":a?c+1:"["+c+"]";return i+"R"+v+"C"+x})}})();function C3(t,r){return t.replace(bp,function(e,n,i,a,o,s){return n+(i=="$"?i+a:si(pp(a)+r.c))+(o=="$"?o+s:ri(hp(s)+r.r))})}function S3(t){return t.length!=1}function Sn(t){t.l+=1}function Ts(t,r){var e=t.read_shift(r==1?1:2);return[e&16383,e>>14&1,e>>15&1]}function vv(t,r,e){var n=2;if(e){if(e.biff>=2&&e.biff<=5)return xv(t,r,e);e.biff==12&&(n=4)}var i=t.read_shift(n),a=t.read_shift(n),o=Ts(t,2),s=Ts(t,2);return{s:{r:i,c:o[0],cRel:o[1],rRel:o[2]},e:{r:a,c:s[0],cRel:s[1],rRel:s[2]}}}function xv(t){var r=Ts(t,2),e=Ts(t,2),n=t.read_shift(1),i=t.read_shift(1);return{s:{r:r[0],c:n,cRel:r[1],rRel:r[2]},e:{r:e[0],c:i,cRel:e[1],rRel:e[2]}}}function k3(t,r,e){if(e.biff<8)return xv(t,r,e);var n=t.read_shift(e.biff==12?4:2),i=t.read_shift(e.biff==12?4:2),a=Ts(t,2),o=Ts(t,2);return{s:{r:n,c:a[0],cRel:a[1],rRel:a[2]},e:{r:i,c:o[0],cRel:o[1],rRel:o[2]}}}function bv(t,r,e){if(e&&e.biff>=2&&e.biff<=5)return E3(t,r,e);var n=t.read_shift(e&&e.biff==12?4:2),i=Ts(t,2);return{r:n,c:i[0],cRel:i[1],rRel:i[2]}}function E3(t){var r=Ts(t,2),e=t.read_shift(1);return{r:r[0],c:e,cRel:r[1],rRel:r[2]}}function M3(t){var r=t.read_shift(2),e=t.read_shift(2);return{r,c:e&255,fQuoted:!!(e&16384),cRel:e>>15,rRel:e>>15}}function P3(t,r,e){var n=e&&e.biff?e.biff:8;if(n>=2&&n<=5)return O3(t,r,e);var i=t.read_shift(n>=12?4:2),a=t.read_shift(2),o=(a&16384)>>14,s=(a&32768)>>15;if(a&=16383,s==1)for(;i>524287;)i-=1048576;if(o==1)for(;a>8191;)a=a-16384;return{r:i,c:a,cRel:o,rRel:s}}function O3(t){var r=t.read_shift(2),e=t.read_shift(1),n=(r&32768)>>15,i=(r&16384)>>14;return r&=16383,n==1&&r>=8192&&(r=r-16384),i==1&&e>=128&&(e=e-256),{r,c:e,cRel:i,rRel:n}}function A3(t,r,e){var n=(t[t.l++]&96)>>5,i=vv(t,e.biff>=2&&e.biff<=5?6:8,e);return[n,i]}function T3(t,r,e){var n=(t[t.l++]&96)>>5,i=t.read_shift(2,"i"),a=8;if(e)switch(e.biff){case 5:t.l+=12,a=6;break;case 12:a=12;break}var o=vv(t,a,e);return[n,i,o]}function I3(t,r,e){var n=(t[t.l++]&96)>>5;return t.l+=e&&e.biff>8?12:e.biff<8?6:8,[n]}function F3(t,r,e){var n=(t[t.l++]&96)>>5,i=t.read_shift(2),a=8;if(e)switch(e.biff){case 5:t.l+=12,a=6;break;case 12:a=12;break}return t.l+=a,[n,i]}function D3(t,r,e){var n=(t[t.l++]&96)>>5,i=k3(t,r-1,e);return[n,i]}function N3(t,r,e){var n=(t[t.l++]&96)>>5;return t.l+=e.biff==2?6:e.biff==12?14:7,[n]}function s_(t){var r=t[t.l+1]&1,e=1;return t.l+=4,[r,e]}function R3(t,r,e){t.l+=2;for(var n=t.read_shift(e&&e.biff==2?1:2),i=[],a=0;a<=n;++a)i.push(t.read_shift(e&&e.biff==2?1:2));return i}function L3(t,r,e){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(e&&e.biff==2?1:2)]}function B3(t,r,e){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(e&&e.biff==2?1:2)]}function U3(t){var r=t[t.l+1]&255?1:0;return t.l+=2,[r,t.read_shift(2)]}function V3(t,r,e){var n=t[t.l+1]&255?1:0;return t.l+=e&&e.biff==2?3:4,[n]}function wv(t){var r=t.read_shift(1),e=t.read_shift(1);return[r,e]}function z3(t){return t.read_shift(2),wv(t,2)}function j3(t){return t.read_shift(2),wv(t,2)}function H3(t,r,e){var n=(t[t.l]&96)>>5;t.l+=1;var i=bv(t,0,e);return[n,i]}function W3(t,r,e){var n=(t[t.l]&96)>>5;t.l+=1;var i=P3(t,0,e);return[n,i]}function q3(t,r,e){var n=(t[t.l]&96)>>5;t.l+=1;var i=t.read_shift(2);e&&e.biff==5&&(t.l+=12);var a=bv(t,0,e);return[n,i,a]}function G3(t,r,e){var n=(t[t.l]&96)>>5;t.l+=1;var i=t.read_shift(e&&e.biff<=3?1:2);return[G4[i],Sv[i],n]}function $3(t,r,e){var n=t[t.l++],i=t.read_shift(1),a=e&&e.biff<=3?[n==88?-1:0,t.read_shift(1)]:X3(t);return[i,(a[0]===0?Sv:q4)[a[1]]]}function X3(t){return[t[t.l+1]>>7,t.read_shift(2)&32767]}function Y3(t,r,e){t.l+=e&&e.biff==2?3:4}function K3(t,r,e){if(t.l++,e&&e.biff==12)return[t.read_shift(4,"i"),0];var n=t.read_shift(2),i=t.read_shift(e&&e.biff==2?1:2);return[n,i]}function Z3(t){return t.l++,I0[t.read_shift(1)]}function J3(t){return t.l++,t.read_shift(2)}function Q3(t){return t.l++,t.read_shift(1)!==0}function e4(t){return t.l++,hc(t,8)}function t4(t,r,e){return t.l++,nv(t,r-1,e)}function r4(t,r){var e=[t.read_shift(1)];if(r==12)switch(e[0]){case 2:e[0]=4;break;case 4:e[0]=16;break;case 0:e[0]=1;break;case 1:e[0]=2;break}switch(e[0]){case 4:e[1]=qy(t,1)?"TRUE":"FALSE",r!=12&&(t.l+=7);break;case 37:case 16:e[1]=I0[t[t.l]],t.l+=r==12?4:8;break;case 0:t.l+=8;break;case 1:e[1]=hc(t,8);break;case 2:e[1]=Yy(t,0,{biff:r>0&&r<8?2:r});break;default:throw new Error("Bad SerAr: "+e[0])}return e}function n4(t,r,e){for(var n=t.read_shift(e.biff==12?4:2),i=[],a=0;a!=n;++a)i.push((e.biff==12?wl:Jy)(t,8));return i}function i4(t,r,e){var n=0,i=0;e.biff==12?(n=t.read_shift(4),i=t.read_shift(4)):(i=1+t.read_shift(1),n=1+t.read_shift(2)),e.biff>=2&&e.biff<8&&(--n,--i==0&&(i=256));for(var a=0,o=[];a!=n&&(o[a]=[]);++a)for(var s=0;s!=i;++s)o[a][s]=r4(t,e.biff);return o}function a4(t,r,e){var n=t.read_shift(1)>>>5&3,i=!e||e.biff>=8?4:2,a=t.read_shift(i);switch(e.biff){case 2:t.l+=5;break;case 3:case 4:t.l+=8;break;case 5:t.l+=12;break}return[n,0,a]}function o4(t,r,e){if(e.biff==5)return s4(t,r,e);var n=t.read_shift(1)>>>5&3,i=t.read_shift(2),a=t.read_shift(4);return[n,i,a]}function s4(t){var r=t.read_shift(1)>>>5&3,e=t.read_shift(2,"i");t.l+=8;var n=t.read_shift(2);return t.l+=12,[r,e,n]}function l4(t,r,e){var n=t.read_shift(1)>>>5&3;t.l+=e&&e.biff==2?3:4;var i=t.read_shift(e&&e.biff==2?1:2);return[n,i]}function c4(t,r,e){var n=t.read_shift(1)>>>5&3,i=t.read_shift(e&&e.biff==2?1:2);return[n,i]}function d4(t,r,e){var n=t.read_shift(1)>>>5&3;return t.l+=4,e.biff<8&&t.l--,e.biff==12&&(t.l+=2),[n]}function f4(t,r,e){var n=(t[t.l++]&96)>>5,i=t.read_shift(2),a=4;if(e)switch(e.biff){case 5:a=15;break;case 12:a=6;break}return t.l+=a,[n,i]}var u4=so,h4=so,p4=so;function F0(t,r,e){return t.l+=2,[M3(t,4,e)]}function yp(t){return t.l+=6,[]}var m4=F0,g4=yp,_4=yp,v4=F0;function yv(t){return t.l+=2,[tv(t),t.read_shift(2)&1]}var x4=F0,b4=yv,w4=yp,y4=F0,C4=F0,S4=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function k4(t){t.l+=2;var r=t.read_shift(2),e=t.read_shift(2),n=t.read_shift(4),i=t.read_shift(2),a=t.read_shift(2),o=S4[e>>2&31];return{ixti:r,coltype:e&3,rt:o,idx:n,c:i,C:a}}function E4(t){return t.l+=2,[t.read_shift(4)]}function M4(t,r,e){return t.l+=5,t.l+=2,t.l+=e.biff==2?1:4,["PTGSHEET"]}function P4(t,r,e){return t.l+=e.biff==2?4:5,["PTGENDSHEET"]}function O4(t){var r=t.read_shift(1)>>>5&3,e=t.read_shift(2);return[r,e]}function A4(t){var r=t.read_shift(1)>>>5&3,e=t.read_shift(2);return[r,e]}function T4(t){return t.l+=4,[0,0]}var l_={1:{n:"PtgExp",f:K3},2:{n:"PtgTbl",f:p4},3:{n:"PtgAdd",f:Sn},4:{n:"PtgSub",f:Sn},5:{n:"PtgMul",f:Sn},6:{n:"PtgDiv",f:Sn},7:{n:"PtgPower",f:Sn},8:{n:"PtgConcat",f:Sn},9:{n:"PtgLt",f:Sn},10:{n:"PtgLe",f:Sn},11:{n:"PtgEq",f:Sn},12:{n:"PtgGe",f:Sn},13:{n:"PtgGt",f:Sn},14:{n:"PtgNe",f:Sn},15:{n:"PtgIsect",f:Sn},16:{n:"PtgUnion",f:Sn},17:{n:"PtgRange",f:Sn},18:{n:"PtgUplus",f:Sn},19:{n:"PtgUminus",f:Sn},20:{n:"PtgPercent",f:Sn},21:{n:"PtgParen",f:Sn},22:{n:"PtgMissArg",f:Sn},23:{n:"PtgStr",f:t4},26:{n:"PtgSheet",f:M4},27:{n:"PtgEndSheet",f:P4},28:{n:"PtgErr",f:Z3},29:{n:"PtgBool",f:Q3},30:{n:"PtgInt",f:J3},31:{n:"PtgNum",f:e4},32:{n:"PtgArray",f:N3},33:{n:"PtgFunc",f:G3},34:{n:"PtgFuncVar",f:$3},35:{n:"PtgName",f:a4},36:{n:"PtgRef",f:H3},37:{n:"PtgArea",f:A3},38:{n:"PtgMemArea",f:l4},39:{n:"PtgMemErr",f:u4},40:{n:"PtgMemNoMem",f:h4},41:{n:"PtgMemFunc",f:c4},42:{n:"PtgRefErr",f:d4},43:{n:"PtgAreaErr",f:I3},44:{n:"PtgRefN",f:W3},45:{n:"PtgAreaN",f:D3},46:{n:"PtgMemAreaN",f:O4},47:{n:"PtgMemNoMemN",f:A4},57:{n:"PtgNameX",f:o4},58:{n:"PtgRef3d",f:q3},59:{n:"PtgArea3d",f:T3},60:{n:"PtgRefErr3d",f:f4},61:{n:"PtgAreaErr3d",f:F3},255:{}},I4={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},F4={1:{n:"PtgElfLel",f:yv},2:{n:"PtgElfRw",f:y4},3:{n:"PtgElfCol",f:m4},6:{n:"PtgElfRwV",f:C4},7:{n:"PtgElfColV",f:v4},10:{n:"PtgElfRadical",f:x4},11:{n:"PtgElfRadicalS",f:w4},13:{n:"PtgElfColS",f:g4},15:{n:"PtgElfColSV",f:_4},16:{n:"PtgElfRadicalLel",f:b4},25:{n:"PtgList",f:k4},29:{n:"PtgSxName",f:E4},255:{}},D4={0:{n:"PtgAttrNoop",f:T4},1:{n:"PtgAttrSemi",f:V3},2:{n:"PtgAttrIf",f:B3},4:{n:"PtgAttrChoose",f:R3},8:{n:"PtgAttrGoto",f:L3},16:{n:"PtgAttrSum",f:Y3},32:{n:"PtgAttrBaxcel",f:s_},33:{n:"PtgAttrBaxcel",f:s_},64:{n:"PtgAttrSpace",f:z3},65:{n:"PtgAttrSpaceSemi",f:j3},128:{n:"PtgAttrIfError",f:U3},255:{}};function N4(t,r,e,n){if(n.biff<8)return so(t,r);for(var i=t.l+r,a=[],o=0;o!==e.length;++o)switch(e[o][0]){case"PtgArray":e[o][1]=i4(t,0,n),a.push(e[o][1]);break;case"PtgMemArea":e[o][2]=n4(t,e[o][1],n),a.push(e[o][2]);break;case"PtgExp":n&&n.biff==12&&(e[o][1][1]=t.read_shift(4),a.push(e[o][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+e[o][0];default:break}return r=i-t.l,r!==0&&a.push(so(t,r)),a}function R4(t,r,e){for(var n=t.l+r,i,a,o=[];n!=t.l;)r=n-t.l,a=t[t.l],i=l_[a]||l_[I4[a]],(a===24||a===25)&&(i=(a===24?F4:D4)[t[t.l+1]]),!i||!i.f?so(t,r):o.push([i.n,i.f(t,r,e)]);return o}function L4(t){for(var r=[],e=0;e<t.length;++e){for(var n=t[e],i=[],a=0;a<n.length;++a){var o=n[a];if(o)switch(o[0]){case 2:i.push('"'+o[1].replace(/"/g,'""')+'"');break;default:i.push(o[1])}else i.push("")}r.push(i.join(","))}return r.join(";")}var B4={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function U4(t,r){if(!t&&!(r&&r.biff<=5&&r.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(t)?"'"+t+"'":t}function Cv(t,r,e){if(!t)return"SH33TJSERR0";if(e.biff>8&&(!t.XTI||!t.XTI[r]))return t.SheetNames[r];if(!t.XTI)return"SH33TJSERR6";var n=t.XTI[r];if(e.biff<8)return r>1e4&&(r-=65536),r<0&&(r=-r),r==0?"":t.XTI[r-1];if(!n)return"SH33TJSERR1";var i="";if(e.biff>8)switch(t[n[0]][0]){case 357:return i=n[1]==-1?"#REF":t.SheetNames[n[1]],n[1]==n[2]?i:i+":"+t.SheetNames[n[2]];case 358:return e.SID!=null?t.SheetNames[e.SID]:"SH33TJSSAME"+t[n[0]][0];case 355:default:return"SH33TJSSRC"+t[n[0]][0]}switch(t[n[0]][0][0]){case 1025:return i=n[1]==-1?"#REF":t.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?i:i+":"+t.SheetNames[n[2]];case 14849:return t[n[0]].slice(1).map(function(a){return a.Name}).join(";;");default:return t[n[0]][0][3]?(i=n[1]==-1?"#REF":t[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?i:i+":"+t[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function c_(t,r,e){var n=Cv(t,r,e);return n=="#REF"?n:U4(n,e)}function lc(t,r,e,n,i){var a=i&&i.biff||8,o={s:{c:0,r:0},e:{c:0,r:0}},s=[],l,c,f,v=0,x=0,p,S="";if(!t[0]||!t[0][0])return"";for(var w=-1,k="",O=0,H=t[0].length;O<H;++O){var q=t[0][O];switch(q[0]){case"PtgUminus":s.push("-"+s.pop());break;case"PtgUplus":s.push("+"+s.pop());break;case"PtgPercent":s.push(s.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(l=s.pop(),c=s.pop(),w>=0){switch(t[0][w][1][0]){case 0:k=sn(" ",t[0][w][1][1]);break;case 1:k=sn("\r",t[0][w][1][1]);break;default:if(k="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][w][1][0])}c=c+k,w=-1}s.push(c+B4[q[0]]+l);break;case"PtgIsect":l=s.pop(),c=s.pop(),s.push(c+" "+l);break;case"PtgUnion":l=s.pop(),c=s.pop(),s.push(c+","+l);break;case"PtgRange":l=s.pop(),c=s.pop(),s.push(c+":"+l);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":f=b0(q[1][1],o,i),s.push(w0(f,a));break;case"PtgRefN":f=e?b0(q[1][1],e,i):q[1][1],s.push(w0(f,a));break;case"PtgRef3d":v=q[1][1],f=b0(q[1][2],o,i),S=c_(n,v,i);var X=S;s.push(S+"!"+w0(f,a));break;case"PtgFunc":case"PtgFuncVar":var he=q[1][0],ke=q[1][1];he||(he=0),he&=127;var re=he==0?[]:s.slice(-he);s.length-=he,ke==="User"&&(ke=re.shift()),s.push(ke+"("+re.join(",")+")");break;case"PtgBool":s.push(q[1]?"TRUE":"FALSE");break;case"PtgInt":s.push(q[1]);break;case"PtgNum":s.push(String(q[1]));break;case"PtgStr":s.push('"'+q[1].replace(/"/g,'""')+'"');break;case"PtgErr":s.push(q[1]);break;case"PtgAreaN":p=$1(q[1][1],e?{s:e}:o,i),s.push(qh(p,i));break;case"PtgArea":p=$1(q[1][1],o,i),s.push(qh(p,i));break;case"PtgArea3d":v=q[1][1],p=q[1][2],S=c_(n,v,i),s.push(S+"!"+qh(p,i));break;case"PtgAttrSum":s.push("SUM("+s.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":x=q[1][2];var ee=(n.names||[])[x-1]||(n[0]||[])[x],W=ee?ee.Name:"SH33TJSNAME"+String(x);W&&W.slice(0,6)=="_xlfn."&&!i.xlfn&&(W=W.slice(6)),s.push(W);break;case"PtgNameX":var ae=q[1][1];x=q[1][2];var A;if(i.biff<=5)ae<0&&(ae=-ae),n[ae]&&(A=n[ae][x]);else{var V="";if(((n[ae]||[])[0]||[])[0]==14849||(((n[ae]||[])[0]||[])[0]==1025?n[ae][x]&&n[ae][x].itab>0&&(V=n.SheetNames[n[ae][x].itab-1]+"!"):V=n.SheetNames[x-1]+"!"),n[ae]&&n[ae][x])V+=n[ae][x].Name;else if(n[0]&&n[0][x])V+=n[0][x].Name;else{var de=(Cv(n,ae,i)||"").split(";;");de[x-1]?V=de[x-1]:V+="SH33TJSERRX"}s.push(V);break}A||(A={Name:"SH33TJSERRY"}),s.push(A.Name);break;case"PtgParen":var ue="(",xe=")";if(w>=0){switch(k="",t[0][w][1][0]){case 2:ue=sn(" ",t[0][w][1][1])+ue;break;case 3:ue=sn("\r",t[0][w][1][1])+ue;break;case 4:xe=sn(" ",t[0][w][1][1])+xe;break;case 5:xe=sn("\r",t[0][w][1][1])+xe;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][w][1][0])}w=-1}s.push(ue+s.pop()+xe);break;case"PtgRefErr":s.push("#REF!");break;case"PtgRefErr3d":s.push("#REF!");break;case"PtgExp":f={c:q[1][1],r:q[1][0]};var Ne={c:e.c,r:e.r};if(n.sharedf[Ar(f)]){var Re=n.sharedf[Ar(f)];s.push(lc(Re,o,Ne,n,i))}else{var Ee=!1;for(l=0;l!=n.arrayf.length;++l)if(c=n.arrayf[l],!(f.c<c[0].s.c||f.c>c[0].e.c)&&!(f.r<c[0].s.r||f.r>c[0].e.r)){s.push(lc(c[1],o,Ne,n,i)),Ee=!0;break}Ee||s.push(q[1])}break;case"PtgArray":s.push("{"+L4(q[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":w=O;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":s.push("");break;case"PtgAreaErr":s.push("#REF!");break;case"PtgAreaErr3d":s.push("#REF!");break;case"PtgList":s.push("Table"+q[1].idx+"[#"+q[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(q));default:throw new Error("Unrecognized Formula Token: "+String(q))}var Be=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(i.biff!=3&&w>=0&&Be.indexOf(t[0][O][0])==-1){q=t[0][w];var Je=!0;switch(q[1][0]){case 4:Je=!1;case 0:k=sn(" ",q[1][1]);break;case 5:Je=!1;case 1:k=sn("\r",q[1][1]);break;default:if(k="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+q[1][0])}s.push((Je?k:"")+s.pop()+(Je?"":k)),w=-1}}if(s.length>1&&i.WTF)throw new Error("bad formula stack");return s[0]}function V4(t){if(t==null){var r=Ue(8);return r.write_shift(1,3),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,65535),r}else if(typeof t=="number")return ml(t);return ml(0)}function z4(t,r,e,n,i){var a=gl(r,e,i),o=V4(t.v),s=Ue(6),l=33;s.write_shift(2,l),s.write_shift(4,0);for(var c=Ue(t.bf.length),f=0;f<t.bf.length;++f)c[f]=t.bf[f];var v=ei([a,o,s,c]);return v}function Ff(t,r,e){var n=t.read_shift(4),i=R4(t,n,e),a=t.read_shift(4),o=a>0?N4(t,a,i,e):null;return[i,o]}var j4=Ff,Df=Ff,H4=Ff,W4=Ff,q4={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},Sv={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},G4={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function $4(t){var r="of:="+t.replace(bp,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return r.replace(/;/g,"|").replace(/,/g,";")}function X4(t){return t.replace(/\./,"!")}var y0=typeof Map<"u";function Cp(t,r,e){var n=0,i=t.length;if(e){if(y0?e.has(r):Object.prototype.hasOwnProperty.call(e,r)){for(var a=y0?e.get(r):e[r];n<a.length;++n)if(t[a[n]].t===r)return t.Count++,a[n]}}else for(;n<i;++n)if(t[n].t===r)return t.Count++,n;return t[i]={t:r},t.Count++,t.Unique++,e&&(y0?(e.has(r)||e.set(r,[]),e.get(r).push(i)):(Object.prototype.hasOwnProperty.call(e,r)||(e[r]=[]),e[r].push(i))),i}function Nf(t,r){var e={min:t+1,max:t+1},n=-1;return r.MDW&&(Vo=r.MDW),r.width!=null?e.customWidth=1:r.wpx!=null?n=Cf(r.wpx):r.wch!=null&&(n=r.wch),n>-1?(e.width=ep(n),e.customWidth=1):r.width!=null&&(e.width=r.width),r.hidden&&(e.hidden=!0),r.level!=null&&(e.outlineLevel=e.level=r.level),e}function kv(t,r){if(t){var e=[.7,.7,.75,.75,.3,.3];r=="xlml"&&(e=[1,1,1,1,.5,.5]),t.left==null&&(t.left=e[0]),t.right==null&&(t.right=e[1]),t.top==null&&(t.top=e[2]),t.bottom==null&&(t.bottom=e[3]),t.header==null&&(t.header=e[4]),t.footer==null&&(t.footer=e[5])}}function Fs(t,r,e){var n=e.revssf[r.z!=null?r.z:"General"],i=60,a=t.length;if(n==null&&e.ssf){for(;i<392;++i)if(e.ssf[i]==null){k_(r.z,i),e.ssf[i]=r.z,e.revssf[r.z]=n=i;break}}for(i=0;i!=a;++i)if(t[i].numFmtId===n)return i;return t[a]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},a}function Y4(t,r,e){if(t&&t["!ref"]){var n=Gr(t["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+e+"): "+t["!ref"])}}function K4(t){if(t.length===0)return"";for(var r='<mergeCells count="'+t.length+'">',e=0;e!=t.length;++e)r+='<mergeCell ref="'+kn(t[e])+'"/>';return r+"</mergeCells>"}function Z4(t,r,e,n,i){var a=!1,o={},s=null;if(n.bookType!=="xlsx"&&r.vbaraw){var l=r.SheetNames[e];try{r.Workbook&&(l=r.Workbook.Sheets[e].CodeName||l)}catch{}a=!0,o.codeName=Lo(Or(l))}if(t&&t["!outline"]){var c={summaryBelow:1,summaryRight:1};t["!outline"].above&&(c.summaryBelow=0),t["!outline"].left&&(c.summaryRight=0),s=(s||"")+st("outlinePr",null,c)}!a&&!s||(i[i.length]=st("sheetPr",s,o))}var J4=["objects","scenarios","selectLockedCells","selectUnlockedCells"],Q4=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function eS(t){var r={sheet:1};return J4.forEach(function(e){t[e]!=null&&t[e]&&(r[e]="1")}),Q4.forEach(function(e){t[e]!=null&&!t[e]&&(r[e]="0")}),t.password&&(r.password=lv(t.password).toString(16).toUpperCase()),st("sheetProtection",null,r)}function tS(t){return kv(t),st("pageMargins",null,t)}function rS(t,r){for(var e=["<cols>"],n,i=0;i!=r.length;++i)(n=r[i])&&(e[e.length]=st("col",null,Nf(i,n)));return e[e.length]="</cols>",e.join("")}function nS(t,r,e,n){var i=typeof t.ref=="string"?t.ref:kn(t.ref);e.Workbook||(e.Workbook={Sheets:[]}),e.Workbook.Names||(e.Workbook.Names=[]);var a=e.Workbook.Names,o=ra(i);o.s.r==o.e.r&&(o.e.r=ra(r["!ref"]).e.r,i=kn(o));for(var s=0;s<a.length;++s){var l=a[s];if(l.Name=="_xlnm._FilterDatabase"&&l.Sheet==n){l.Ref="'"+e.SheetNames[n]+"'!"+i;break}}return s==a.length&&a.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+e.SheetNames[n]+"'!"+i}),st("autoFilter",null,{ref:i})}function iS(t,r,e,n){var i={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(i.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),st("sheetViews",st("sheetView",null,i),{})}function aS(t,r,e,n){if(t.c&&e["!comments"].push([r,t.c]),t.v===void 0&&typeof t.f!="string"||t.t==="z"&&!t.f)return"";var i="",a=t.t,o=t.v;if(t.t!=="z")switch(t.t){case"b":i=t.v?"1":"0";break;case"n":i=""+t.v;break;case"e":i=I0[t.v];break;case"d":n&&n.cellDates?i=bi(t.v,-1).toISOString():(t=Ui(t),t.t="n",i=""+(t.v=Bi(bi(t.v)))),typeof t.z>"u"&&(t.z=ln[14]);break;default:i=t.v;break}var s=ti("v",Or(i)),l={r},c=Fs(n.cellXfs,t,n);switch(c!==0&&(l.s=c),t.t){case"n":break;case"d":l.t="d";break;case"b":l.t="b";break;case"e":l.t="e";break;case"z":break;default:if(t.v==null){delete t.t;break}if(t.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){s=ti("v",""+Cp(n.Strings,t.v,n.revStrings)),l.t="s";break}l.t="str";break}if(t.t!=a&&(t.t=a,t.v=o),typeof t.f=="string"&&t.f){var f=t.F&&t.F.slice(0,r.length)==r?{t:"array",ref:t.F}:null;s=st("f",Or(t.f),f)+(t.v!=null?s:"")}return t.l&&e["!links"].push([r,t.l]),t.D&&(l.cm=1),st("c",s,l)}function oS(t,r,e,n){var i=[],a=[],o=Gr(t["!ref"]),s="",l,c="",f=[],v=0,x=0,p=t["!rows"],S=Array.isArray(t),w={r:c},k,O=-1;for(x=o.s.c;x<=o.e.c;++x)f[x]=si(x);for(v=o.s.r;v<=o.e.r;++v){for(a=[],c=ri(v),x=o.s.c;x<=o.e.c;++x){l=f[x]+c;var H=S?(t[v]||[])[x]:t[l];H!==void 0&&(s=aS(H,l,t,r,e,n))!=null&&a.push(s)}(a.length>0||p&&p[v])&&(w={r:c},p&&p[v]&&(k=p[v],k.hidden&&(w.hidden=1),O=-1,k.hpx?O=Sf(k.hpx):k.hpt&&(O=k.hpt),O>-1&&(w.ht=O,w.customHeight=1),k.level&&(w.outlineLevel=k.level)),i[i.length]=st("row",a.join(""),w))}if(p)for(;v<p.length;++v)p&&p[v]&&(w={r:v+1},k=p[v],k.hidden&&(w.hidden=1),O=-1,k.hpx?O=Sf(k.hpx):k.hpt&&(O=k.hpt),O>-1&&(w.ht=O,w.customHeight=1),k.level&&(w.outlineLevel=k.level),i[i.length]=st("row","",w));return i.join("")}function Ev(t,r,e,n){var i=[En,st("worksheet",null,{xmlns:cc[0],"xmlns:r":jn.r})],a=e.SheetNames[t],o=0,s="",l=e.Sheets[a];l==null&&(l={});var c=l["!ref"]||"A1",f=Gr(c);if(f.e.c>16383||f.e.r>1048575){if(r.WTF)throw new Error("Range "+c+" exceeds format limit A1:XFD1048576");f.e.c=Math.min(f.e.c,16383),f.e.r=Math.min(f.e.c,1048575),c=kn(f)}n||(n={}),l["!comments"]=[];var v=[];Z4(l,e,t,r,i),i[i.length]=st("dimension",null,{ref:c}),i[i.length]=iS(l,r,t,e),r.sheetFormat&&(i[i.length]=st("sheetFormatPr",null,{defaultRowHeight:r.sheetFormat.defaultRowHeight||"16",baseColWidth:r.sheetFormat.baseColWidth||"10",outlineLevelRow:r.sheetFormat.outlineLevelRow||"7"})),l["!cols"]!=null&&l["!cols"].length>0&&(i[i.length]=rS(l,l["!cols"])),i[o=i.length]="<sheetData/>",l["!links"]=[],l["!ref"]!=null&&(s=oS(l,r,t,e,n),s.length>0&&(i[i.length]=s)),i.length>o+1&&(i[i.length]="</sheetData>",i[o]=i[o].replace("/>",">")),l["!protect"]&&(i[i.length]=eS(l["!protect"])),l["!autofilter"]!=null&&(i[i.length]=nS(l["!autofilter"],l,e,t)),l["!merges"]!=null&&l["!merges"].length>0&&(i[i.length]=K4(l["!merges"]));var x=-1,p,S=-1;return l["!links"].length>0&&(i[i.length]="<hyperlinks>",l["!links"].forEach(function(w){w[1].Target&&(p={ref:w[0]},w[1].Target.charAt(0)!="#"&&(S=Pr(n,-1,Or(w[1].Target).replace(/#.*$/,""),_r.HLINK),p["r:id"]="rId"+S),(x=w[1].Target.indexOf("#"))>-1&&(p.location=Or(w[1].Target.slice(x+1))),w[1].Tooltip&&(p.tooltip=Or(w[1].Tooltip)),i[i.length]=st("hyperlink",null,p))}),i[i.length]="</hyperlinks>"),delete l["!links"],l["!margins"]!=null&&(i[i.length]=tS(l["!margins"])),(!r||r.ignoreEC||r.ignoreEC==null)&&(i[i.length]=ti("ignoredErrors",st("ignoredError",null,{numberStoredAsText:1,sqref:c}))),v.length>0&&(S=Pr(n,-1,"../drawings/drawing"+(t+1)+".xml",_r.DRAW),i[i.length]=st("drawing",null,{"r:id":"rId"+S}),l["!drawing"]=v),l["!comments"].length>0&&(S=Pr(n,-1,"../drawings/vmlDrawing"+(t+1)+".vml",_r.VML),i[i.length]=st("legacyDrawing",null,{"r:id":"rId"+S}),l["!legacy"]=S),i.length>1&&(i[i.length]="</worksheet>",i[1]=i[1].replace("/>",">")),i.join("")}function sS(t,r){var e={},n=t.l+r;e.r=t.read_shift(4),t.l+=4;var i=t.read_shift(2);t.l+=1;var a=t.read_shift(1);return t.l=n,a&7&&(e.level=a&7),a&16&&(e.hidden=!0),a&32&&(e.hpt=i/20),e}function lS(t,r,e){var n=Ue(145),i=(e["!rows"]||[])[t]||{};n.write_shift(4,t),n.write_shift(4,0);var a=320;i.hpx?a=Sf(i.hpx)*20:i.hpt&&(a=i.hpt*20),n.write_shift(2,a),n.write_shift(1,0);var o=0;i.level&&(o|=i.level),i.hidden&&(o|=16),(i.hpx||i.hpt)&&(o|=32),n.write_shift(1,o),n.write_shift(1,0);var s=0,l=n.l;n.l+=4;for(var c={r:t,c:0},f=0;f<16;++f)if(!(r.s.c>f+1<<10||r.e.c<f<<10)){for(var v=-1,x=-1,p=f<<10;p<f+1<<10;++p){c.c=p;var S=Array.isArray(e)?(e[c.r]||[])[c.c]:e[Ar(c)];S&&(v<0&&(v=p),x=p)}v<0||(++s,n.write_shift(4,v),n.write_shift(4,x))}var w=n.l;return n.l=l,n.write_shift(4,s),n.l=w,n.length>n.l?n.slice(0,n.l):n}function cS(t,r,e,n){var i=lS(n,e,r);(i.length>17||(r["!rows"]||[])[n])&&Xe(t,0,i)}var dS=wl,fS=uc;function uS(){}function hS(t,r){var e={},n=t[t.l];return++t.l,e.above=!(n&64),e.left=!(n&128),t.l+=18,e.name=Cy(t,r-19),e}function pS(t,r,e){e==null&&(e=Ue(84+4*t.length));var n=192;r&&(r.above&&(n&=-65),r.left&&(n&=-129)),e.write_shift(1,n);for(var i=1;i<3;++i)e.write_shift(1,0);return bf({auto:1},e),e.write_shift(-4,-1),e.write_shift(-4,-1),z_(t,e),e.slice(0,e.l)}function mS(t){var r=Sa(t);return[r]}function gS(t,r,e){return e==null&&(e=Ue(8)),vl(r,e)}function _S(t){var r=xl(t);return[r]}function vS(t,r,e){return e==null&&(e=Ue(4)),bl(r,e)}function xS(t){var r=Sa(t),e=t.read_shift(1);return[r,e,"b"]}function bS(t,r,e){return e==null&&(e=Ue(9)),vl(r,e),e.write_shift(1,t.v?1:0),e}function wS(t){var r=xl(t),e=t.read_shift(1);return[r,e,"b"]}function yS(t,r,e){return e==null&&(e=Ue(5)),bl(r,e),e.write_shift(1,t.v?1:0),e}function CS(t){var r=Sa(t),e=t.read_shift(1);return[r,e,"e"]}function SS(t,r,e){return e==null&&(e=Ue(9)),vl(r,e),e.write_shift(1,t.v),e}function kS(t){var r=xl(t),e=t.read_shift(1);return[r,e,"e"]}function ES(t,r,e){return e==null&&(e=Ue(8)),bl(r,e),e.write_shift(1,t.v),e.write_shift(2,0),e.write_shift(1,0),e}function MS(t){var r=Sa(t),e=t.read_shift(4);return[r,e,"s"]}function PS(t,r,e){return e==null&&(e=Ue(12)),vl(r,e),e.write_shift(4,r.v),e}function OS(t){var r=xl(t),e=t.read_shift(4);return[r,e,"s"]}function AS(t,r,e){return e==null&&(e=Ue(8)),bl(r,e),e.write_shift(4,r.v),e}function TS(t){var r=Sa(t),e=hc(t);return[r,e,"n"]}function IS(t,r,e){return e==null&&(e=Ue(16)),vl(r,e),ml(t.v,e),e}function FS(t){var r=xl(t),e=hc(t);return[r,e,"n"]}function DS(t,r,e){return e==null&&(e=Ue(12)),bl(r,e),ml(t.v,e),e}function NS(t){var r=Sa(t),e=j_(t);return[r,e,"n"]}function RS(t,r,e){return e==null&&(e=Ue(12)),vl(r,e),H_(t.v,e),e}function LS(t){var r=xl(t),e=j_(t);return[r,e,"n"]}function BS(t,r,e){return e==null&&(e=Ue(8)),bl(r,e),H_(t.v,e),e}function US(t){var r=Sa(t),e=mp(t);return[r,e,"is"]}function VS(t){var r=Sa(t),e=li(t);return[r,e,"str"]}function zS(t,r,e){return e==null&&(e=Ue(12+4*t.v.length)),vl(r,e),Wn(t.v,e),e.length>e.l?e.slice(0,e.l):e}function jS(t){var r=xl(t),e=li(t);return[r,e,"str"]}function HS(t,r,e){return e==null&&(e=Ue(8+4*t.v.length)),bl(r,e),Wn(t.v,e),e.length>e.l?e.slice(0,e.l):e}function WS(t,r,e){var n=t.l+r,i=Sa(t);i.r=e["!row"];var a=t.read_shift(1),o=[i,a,"b"];if(e.cellFormula){t.l+=2;var s=Df(t,n-t.l,e);o[3]=lc(s,null,i,e.supbooks,e)}else t.l=n;return o}function qS(t,r,e){var n=t.l+r,i=Sa(t);i.r=e["!row"];var a=t.read_shift(1),o=[i,a,"e"];if(e.cellFormula){t.l+=2;var s=Df(t,n-t.l,e);o[3]=lc(s,null,i,e.supbooks,e)}else t.l=n;return o}function GS(t,r,e){var n=t.l+r,i=Sa(t);i.r=e["!row"];var a=hc(t),o=[i,a,"n"];if(e.cellFormula){t.l+=2;var s=Df(t,n-t.l,e);o[3]=lc(s,null,i,e.supbooks,e)}else t.l=n;return o}function $S(t,r,e){var n=t.l+r,i=Sa(t);i.r=e["!row"];var a=li(t),o=[i,a,"str"];if(e.cellFormula){t.l+=2;var s=Df(t,n-t.l,e);o[3]=lc(s,null,i,e.supbooks,e)}else t.l=n;return o}var XS=wl,YS=uc;function KS(t,r){return r==null&&(r=Ue(4)),r.write_shift(4,t),r}function ZS(t,r){var e=t.l+r,n=wl(t,16),i=gp(t),a=li(t),o=li(t),s=li(t);t.l=e;var l={rfx:n,relId:i,loc:a,display:s};return o&&(l.Tooltip=o),l}function JS(t,r){var e=Ue(50+4*(t[1].Target.length+(t[1].Tooltip||"").length));uc({s:Hn(t[0]),e:Hn(t[0])},e),_p("rId"+r,e);var n=t[1].Target.indexOf("#"),i=n==-1?"":t[1].Target.slice(n+1);return Wn(i||"",e),Wn(t[1].Tooltip||"",e),Wn("",e),e.slice(0,e.l)}function QS(){}function ek(t,r,e){var n=t.l+r,i=W_(t,16),a=t.read_shift(1),o=[i];if(o[2]=a,e.cellFormula){var s=j4(t,n-t.l,e);o[1]=s}else t.l=n;return o}function tk(t,r,e){var n=t.l+r,i=wl(t,16),a=[i];if(e.cellFormula){var o=W4(t,n-t.l,e);a[1]=o,t.l=n}else t.l=n;return a}function rk(t,r,e){e==null&&(e=Ue(18));var n=Nf(t,r);e.write_shift(-4,t),e.write_shift(-4,t),e.write_shift(4,(n.width||10)*256),e.write_shift(4,0);var i=0;return r.hidden&&(i|=1),typeof n.width=="number"&&(i|=2),r.level&&(i|=r.level<<8),e.write_shift(2,i),e}var Mv=["left","right","top","bottom","header","footer"];function nk(t){var r={};return Mv.forEach(function(e){r[e]=hc(t,8)}),r}function ik(t,r){return r==null&&(r=Ue(48)),kv(t),Mv.forEach(function(e){ml(t[e],r)}),r}function ak(t){var r=t.read_shift(2);return t.l+=28,{RTL:r&32}}function ok(t,r,e){e==null&&(e=Ue(30));var n=924;return(((r||{}).Views||[])[0]||{}).RTL&&(n|=32),e.write_shift(2,n),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(1,0),e.write_shift(1,0),e.write_shift(2,0),e.write_shift(2,100),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(4,0),e}function sk(t){var r=Ue(24);return r.write_shift(4,4),r.write_shift(4,1),uc(t,r),r}function lk(t,r){return r==null&&(r=Ue(66)),r.write_shift(2,t.password?lv(t.password):0),r.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(e){e[1]?r.write_shift(4,t[e[0]]!=null&&!t[e[0]]?1:0):r.write_shift(4,t[e[0]]!=null&&t[e[0]]?0:1)}),r}function ck(){}function dk(){}function fk(t,r,e,n,i,a,o){if(r.v===void 0)return!1;var s="";switch(r.t){case"b":s=r.v?"1":"0";break;case"d":r=Ui(r),r.z=r.z||ln[14],r.v=Bi(bi(r.v)),r.t="n";break;case"n":case"e":s=""+r.v;break;default:s=r.v;break}var l={r:e,c:n};switch(l.s=Fs(i.cellXfs,r,i),r.l&&a["!links"].push([Ar(l),r.l]),r.c&&a["!comments"].push([Ar(l),r.c]),r.t){case"s":case"str":return i.bookSST?(s=Cp(i.Strings,r.v,i.revStrings),l.t="s",l.v=s,o?Xe(t,18,AS(r,l)):Xe(t,7,PS(r,l))):(l.t="str",o?Xe(t,17,HS(r,l)):Xe(t,6,zS(r,l))),!0;case"n":return r.v==(r.v|0)&&r.v>-1e3&&r.v<1e3?o?Xe(t,13,BS(r,l)):Xe(t,2,RS(r,l)):o?Xe(t,16,DS(r,l)):Xe(t,5,IS(r,l)),!0;case"b":return l.t="b",o?Xe(t,15,yS(r,l)):Xe(t,4,bS(r,l)),!0;case"e":return l.t="e",o?Xe(t,14,ES(r,l)):Xe(t,3,SS(r,l)),!0}return o?Xe(t,12,vS(r,l)):Xe(t,1,gS(r,l)),!0}function uk(t,r,e,n){var i=Gr(r["!ref"]||"A1"),a,o="",s=[];Xe(t,145);var l=Array.isArray(r),c=i.e.r;r["!rows"]&&(c=Math.max(i.e.r,r["!rows"].length-1));for(var f=i.s.r;f<=c;++f){o=ri(f),cS(t,r,i,f);var v=!1;if(f<=i.e.r)for(var x=i.s.c;x<=i.e.c;++x){f===i.s.r&&(s[x]=si(x)),a=s[x]+o;var p=l?(r[f]||[])[x]:r[a];if(!p){v=!1;continue}v=fk(t,p,f,x,n,r,v)}}Xe(t,146)}function hk(t,r){!r||!r["!merges"]||(Xe(t,177,KS(r["!merges"].length)),r["!merges"].forEach(function(e){Xe(t,176,YS(e))}),Xe(t,178))}function pk(t,r){!r||!r["!cols"]||(Xe(t,390),r["!cols"].forEach(function(e,n){e&&Xe(t,60,rk(n,e))}),Xe(t,391))}function mk(t,r){!r||!r["!ref"]||(Xe(t,648),Xe(t,649,sk(Gr(r["!ref"]))),Xe(t,650))}function gk(t,r,e){r["!links"].forEach(function(n){if(n[1].Target){var i=Pr(e,-1,n[1].Target.replace(/#.*$/,""),_r.HLINK);Xe(t,494,JS(n,i))}}),delete r["!links"]}function _k(t,r,e,n){if(r["!comments"].length>0){var i=Pr(n,-1,"../drawings/vmlDrawing"+(e+1)+".vml",_r.VML);Xe(t,551,_p("rId"+i)),r["!legacy"]=i}}function vk(t,r,e,n){if(r["!autofilter"]){var i=r["!autofilter"],a=typeof i.ref=="string"?i.ref:kn(i.ref);e.Workbook||(e.Workbook={Sheets:[]}),e.Workbook.Names||(e.Workbook.Names=[]);var o=e.Workbook.Names,s=ra(a);s.s.r==s.e.r&&(s.e.r=ra(r["!ref"]).e.r,a=kn(s));for(var l=0;l<o.length;++l){var c=o[l];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==n){c.Ref="'"+e.SheetNames[n]+"'!"+a;break}}l==o.length&&o.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+e.SheetNames[n]+"'!"+a}),Xe(t,161,uc(Gr(a))),Xe(t,162)}}function xk(t,r,e){Xe(t,133),Xe(t,137,ok(r,e)),Xe(t,138),Xe(t,134)}function bk(t,r){r["!protect"]&&Xe(t,535,lk(r["!protect"]))}function wk(t,r,e,n){var i=Li(),a=e.SheetNames[t],o=e.Sheets[a]||{},s=a;try{e&&e.Workbook&&(s=e.Workbook.Sheets[t].CodeName||s)}catch{}var l=Gr(o["!ref"]||"A1");if(l.e.c>16383||l.e.r>1048575){if(r.WTF)throw new Error("Range "+(o["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");l.e.c=Math.min(l.e.c,16383),l.e.r=Math.min(l.e.c,1048575)}return o["!links"]=[],o["!comments"]=[],Xe(i,129),(e.vbaraw||o["!outline"])&&Xe(i,147,pS(s,o["!outline"])),Xe(i,148,fS(l)),xk(i,o,e.Workbook),pk(i,o,t,r,e),uk(i,o,t,r,e),bk(i,o),vk(i,o,e,t),hk(i,o),gk(i,o,n),o["!margins"]&&Xe(i,476,ik(o["!margins"])),(!r||r.ignoreEC||r.ignoreEC==null)&&mk(i,o),_k(i,o,t,n),Xe(i,130),i.end()}function yk(t,r){t.l+=10;var e=li(t,r-10);return{name:e}}var Ck=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]];function Sk(t){return!t.Workbook||!t.Workbook.WBProps?"false":ey(t.Workbook.WBProps.date1904)?"true":"false"}var kk="][*?/\\".split("");function Pv(t,r){if(t.length>31){if(r)return!1;throw new Error("Sheet names cannot exceed 31 chars")}var e=!0;return kk.forEach(function(n){if(t.indexOf(n)!=-1){if(!r)throw new Error("Sheet name cannot contain : \\ / ? * [ ]");e=!1}}),e}function Ek(t,r,e){t.forEach(function(n,i){Pv(n);for(var a=0;a<i;++a)if(n==t[a])throw new Error("Duplicate Sheet Name: "+n);if(e){var o=r&&r[i]&&r[i].CodeName||n;if(o.charCodeAt(0)==95&&o.length>22)throw new Error("Bad Code Name: Worksheet"+o)}})}function Mk(t){if(!t||!t.SheetNames||!t.Sheets)throw new Error("Invalid Workbook");if(!t.SheetNames.length)throw new Error("Workbook is empty");var r=t.Workbook&&t.Workbook.Sheets||[];Ek(t.SheetNames,r,!!t.vbaraw);for(var e=0;e<t.SheetNames.length;++e)Y4(t.Sheets[t.SheetNames[e]],t.SheetNames[e],e)}function Ov(t){var r=[En];r[r.length]=st("workbook",null,{xmlns:cc[0],"xmlns:r":jn.r});var e=t.Workbook&&(t.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};t.Workbook&&t.Workbook.WBProps&&(Ck.forEach(function(s){t.Workbook.WBProps[s[0]]!=null&&t.Workbook.WBProps[s[0]]!=s[1]&&(n[s[0]]=t.Workbook.WBProps[s[0]])}),t.Workbook.WBProps.CodeName&&(n.codeName=t.Workbook.WBProps.CodeName,delete n.CodeName)),r[r.length]=st("workbookPr",null,n);var i=t.Workbook&&t.Workbook.Sheets||[],a=0;if(i&&i[0]&&i[0].Hidden){for(r[r.length]="<bookViews>",a=0;a!=t.SheetNames.length&&!(!i[a]||!i[a].Hidden);++a);a==t.SheetNames.length&&(a=0),r[r.length]='<workbookView firstSheet="'+a+'" activeTab="'+a+'"/>',r[r.length]="</bookViews>"}for(r[r.length]="<sheets>",a=0;a!=t.SheetNames.length;++a){var o={name:Or(t.SheetNames[a].slice(0,31))};if(o.sheetId=""+(a+1),o["r:id"]="rId"+(a+1),i[a])switch(i[a].Hidden){case 1:o.state="hidden";break;case 2:o.state="veryHidden";break}r[r.length]=st("sheet",null,o)}return r[r.length]="</sheets>",e&&(r[r.length]="<definedNames>",t.Workbook&&t.Workbook.Names&&t.Workbook.Names.forEach(function(s){var l={name:s.Name};s.Comment&&(l.comment=s.Comment),s.Sheet!=null&&(l.localSheetId=""+s.Sheet),s.Hidden&&(l.hidden="1"),s.Ref&&(r[r.length]=st("definedName",Or(s.Ref),l))}),r[r.length]="</definedNames>"),r.length>2&&(r[r.length]="</workbook>",r[1]=r[1].replace("/>",">")),r.join("")}function Pk(t,r){var e={};return e.Hidden=t.read_shift(4),e.iTabID=t.read_shift(4),e.strRelID=Qh(t,r-8),e.name=li(t),e}function Ok(t,r){return r||(r=Ue(127)),r.write_shift(4,t.Hidden),r.write_shift(4,t.iTabID),_p(t.strRelID,r),Wn(t.name.slice(0,31),r),r.length>r.l?r.slice(0,r.l):r}function Ak(t,r){var e={},n=t.read_shift(4);e.defaultThemeVersion=t.read_shift(4);var i=r>8?li(t):"";return i.length>0&&(e.CodeName=i),e.autoCompressPictures=!!(n&65536),e.backupFile=!!(n&64),e.checkCompatibility=!!(n&4096),e.date1904=!!(n&1),e.filterPrivacy=!!(n&8),e.hidePivotFieldList=!!(n&1024),e.promptedSolutions=!!(n&16),e.publishItems=!!(n&2048),e.refreshAllConnections=!!(n&262144),e.saveExternalLinkValues=!!(n&128),e.showBorderUnselectedTables=!!(n&4),e.showInkAnnotation=!!(n&32),e.showObjects=["all","placeholders","none"][n>>13&3],e.showPivotChartFilter=!!(n&32768),e.updateLinks=["userSet","never","always"][n>>8&3],e}function Tk(t,r){r||(r=Ue(72));var e=0;return t&&t.filterPrivacy&&(e|=8),r.write_shift(4,e),r.write_shift(4,0),z_(t&&t.CodeName||"ThisWorkbook",r),r.slice(0,r.l)}function Ik(t,r,e){var n=t.l+r;t.l+=4,t.l+=1;var i=t.read_shift(4),a=Sy(t),o=H4(t,0,e),s=gp(t);t.l=n;var l={Name:a,Ptg:o};return i<268435455&&(l.Sheet=i),s&&(l.Comment=s),l}function Fk(t,r){Xe(t,143);for(var e=0;e!=r.SheetNames.length;++e){var n=r.Workbook&&r.Workbook.Sheets&&r.Workbook.Sheets[e]&&r.Workbook.Sheets[e].Hidden||0,i={Hidden:n,iTabID:e+1,strRelID:"rId"+(e+1),name:r.SheetNames[e]};Xe(t,156,Ok(i))}Xe(t,144)}function Dk(t,r){r||(r=Ue(127));for(var e=0;e!=4;++e)r.write_shift(4,0);return Wn("SheetJS",r),Wn(C0.version,r),Wn(C0.version,r),Wn("7262",r),r.length>r.l?r.slice(0,r.l):r}function Nk(t,r){r||(r=Ue(29)),r.write_shift(-4,0),r.write_shift(-4,460),r.write_shift(4,28800),r.write_shift(4,17600),r.write_shift(4,500),r.write_shift(4,t),r.write_shift(4,t);var e=120;return r.write_shift(1,e),r.length>r.l?r.slice(0,r.l):r}function Rk(t,r){if(!(!r.Workbook||!r.Workbook.Sheets)){for(var e=r.Workbook.Sheets,n=0,i=-1,a=-1;n<e.length;++n)!e[n]||!e[n].Hidden&&i==-1?i=n:e[n].Hidden==1&&a==-1&&(a=n);a>i||(Xe(t,135),Xe(t,158,Nk(i)),Xe(t,136))}}function Lk(t,r){var e=Li();return Xe(e,131),Xe(e,128,Dk()),Xe(e,153,Tk(t.Workbook&&t.Workbook.WBProps||null)),Rk(e,t,r),Fk(e,t,r),Xe(e,132),e.end()}function Bk(t,r,e){return(r.slice(-4)===".bin"?Lk:Ov)(t,e)}function Uk(t,r,e,n,i){return(r.slice(-4)===".bin"?wk:Ev)(t,e,n,i)}function Vk(t,r,e){return(r.slice(-4)===".bin"?i3:fv)(t,e)}function zk(t,r,e){return(r.slice(-4)===".bin"?TC:sv)(t,e)}function jk(t,r,e){return(r.slice(-4)===".bin"?b3:gv)(t,e)}function Hk(t){return(t.slice(-4)===".bin"?u3:pv)()}function Wk(t,r){var e=[];return t.Props&&e.push(Vy(t.Props,r)),t.Custprops&&e.push(zy(t.Props,t.Custprops,r)),e.join("")}function qk(){return""}function Gk(t,r){var e=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return r.cellXfs.forEach(function(n,i){var a=[];a.push(st("NumberFormat",null,{"ss:Format":Or(ln[n.numFmtId])}));var o={"ss:ID":"s"+(21+i)};e.push(st("Style",a.join(""),o))}),st("Styles",e.join(""))}function Av(t){return st("NamedRange",null,{"ss:Name":t.Name,"ss:RefersTo":"="+wp(t.Ref,{r:0,c:0})})}function $k(t){if(!((t||{}).Workbook||{}).Names)return"";for(var r=t.Workbook.Names,e=[],n=0;n<r.length;++n){var i=r[n];i.Sheet==null&&(i.Name.match(/^_xlfn\./)||e.push(Av(i)))}return st("Names",e.join(""))}function Xk(t,r,e,n){if(!t||!((n||{}).Workbook||{}).Names)return"";for(var i=n.Workbook.Names,a=[],o=0;o<i.length;++o){var s=i[o];s.Sheet==e&&(s.Name.match(/^_xlfn\./)||a.push(Av(s)))}return a.join("")}function Yk(t,r,e,n){if(!t)return"";var i=[];if(t["!margins"]&&(i.push("<PageSetup>"),t["!margins"].header&&i.push(st("Header",null,{"x:Margin":t["!margins"].header})),t["!margins"].footer&&i.push(st("Footer",null,{"x:Margin":t["!margins"].footer})),i.push(st("PageMargins",null,{"x:Bottom":t["!margins"].bottom||"0.75","x:Left":t["!margins"].left||"0.7","x:Right":t["!margins"].right||"0.7","x:Top":t["!margins"].top||"0.75"})),i.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[e])if(n.Workbook.Sheets[e].Hidden)i.push(st("Visible",n.Workbook.Sheets[e].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var a=0;a<e&&!(n.Workbook.Sheets[a]&&!n.Workbook.Sheets[a].Hidden);++a);a==e&&i.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&i.push("<DisplayRightToLeft/>"),t["!protect"]&&(i.push(ti("ProtectContents","True")),t["!protect"].objects&&i.push(ti("ProtectObjects","True")),t["!protect"].scenarios&&i.push(ti("ProtectScenarios","True")),t["!protect"].selectLockedCells!=null&&!t["!protect"].selectLockedCells?i.push(ti("EnableSelection","NoSelection")):t["!protect"].selectUnlockedCells!=null&&!t["!protect"].selectUnlockedCells&&i.push(ti("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(o){t["!protect"][o[0]]&&i.push("<"+o[1]+"/>")})),i.length==0?"":st("WorksheetOptions",i.join(""),{xmlns:ta.x})}function Kk(t){return t.map(function(r){var e=Qw(r.t||""),n=st("ss:Data",e,{xmlns:"http://www.w3.org/TR/REC-html40"});return st("Comment",n,{"ss:Author":r.a})}).join("")}function Zk(t,r,e,n,i,a,o){if(!t||t.v==null&&t.f==null)return"";var s={};if(t.f&&(s["ss:Formula"]="="+Or(wp(t.f,o))),t.F&&t.F.slice(0,r.length)==r){var l=Hn(t.F.slice(r.length+1));s["ss:ArrayRange"]="RC:R"+(l.r==o.r?"":"["+(l.r-o.r)+"]")+"C"+(l.c==o.c?"":"["+(l.c-o.c)+"]")}if(t.l&&t.l.Target&&(s["ss:HRef"]=Or(t.l.Target),t.l.Tooltip&&(s["x:HRefScreenTip"]=Or(t.l.Tooltip))),e["!merges"])for(var c=e["!merges"],f=0;f!=c.length;++f)c[f].s.c!=o.c||c[f].s.r!=o.r||(c[f].e.c>c[f].s.c&&(s["ss:MergeAcross"]=c[f].e.c-c[f].s.c),c[f].e.r>c[f].s.r&&(s["ss:MergeDown"]=c[f].e.r-c[f].s.r));var v="",x="";switch(t.t){case"z":if(!n.sheetStubs)return"";break;case"n":v="Number",x=String(t.v);break;case"b":v="Boolean",x=t.v?"1":"0";break;case"e":v="Error",x=I0[t.v];break;case"d":v="DateTime",x=new Date(t.v).toISOString(),t.z==null&&(t.z=t.z||ln[14]);break;case"s":v="String",x=Jw(t.v||"");break}var p=Fs(n.cellXfs,t,n);s["ss:StyleID"]="s"+(21+p),s["ss:Index"]=o.c+1;var S=t.v!=null?x:"",w=t.t=="z"?"":'<Data ss:Type="'+v+'">'+S+"</Data>";return(t.c||[]).length>0&&(w+=Kk(t.c)),st("Cell",w,s)}function Jk(t,r){var e='<Row ss:Index="'+(t+1)+'"';return r&&(r.hpt&&!r.hpx&&(r.hpx=dv(r.hpt)),r.hpx&&(e+=' ss:AutoFitHeight="0" ss:Height="'+r.hpx+'"'),r.hidden&&(e+=' ss:Hidden="1"')),e+">"}function Qk(t,r,e,n){if(!t["!ref"])return"";var i=Gr(t["!ref"]),a=t["!merges"]||[],o=0,s=[];t["!cols"]&&t["!cols"].forEach(function(k,O){xp(k);var H=!!k.width,q=Nf(O,k),X={"ss:Index":O+1};H&&(X["ss:Width"]=yf(q.width)),k.hidden&&(X["ss:Hidden"]="1"),s.push(st("Column",null,X))});for(var l=Array.isArray(t),c=i.s.r;c<=i.e.r;++c){for(var f=[Jk(c,(t["!rows"]||[])[c])],v=i.s.c;v<=i.e.c;++v){var x=!1;for(o=0;o!=a.length;++o)if(!(a[o].s.c>v)&&!(a[o].s.r>c)&&!(a[o].e.c<v)&&!(a[o].e.r<c)){(a[o].s.c!=v||a[o].s.r!=c)&&(x=!0);break}if(!x){var p={r:c,c:v},S=Ar(p),w=l?(t[c]||[])[v]:t[S];f.push(Zk(w,S,t,r,e,n,p))}}f.push("</Row>"),f.length>2&&s.push(f.join(""))}return s.join("")}function eE(t,r,e){var n=[],i=e.SheetNames[t],a=e.Sheets[i],o=a?Xk(a,r,t,e):"";return o.length>0&&n.push("<Names>"+o+"</Names>"),o=a?Qk(a,r,t,e):"",o.length>0&&n.push("<Table>"+o+"</Table>"),n.push(Yk(a,r,t,e)),n.join("")}function tE(t,r){r||(r={}),t.SSF||(t.SSF=Ui(ln)),t.SSF&&(Of(),Pf(t.SSF),r.revssf=Af(t.SSF),r.revssf[t.SSF[65535]]=0,r.ssf=t.SSF,r.cellXfs=[],Fs(r.cellXfs,{},{revssf:{General:0}}));var e=[];e.push(Wk(t,r)),e.push(qk(t,r)),e.push(""),e.push("");for(var n=0;n<t.SheetNames.length;++n)e.push(st("Worksheet",eE(n,r,t),{"ss:Name":Or(t.SheetNames[n])}));return e[2]=Gk(t,r),e[3]=$k(t,r),En+st("Workbook",e.join(""),{xmlns:ta.ss,"xmlns:o":ta.o,"xmlns:x":ta.x,"xmlns:ss":ta.ss,"xmlns:dt":ta.dt,"xmlns:html":ta.html})}var Xh={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function rE(t,r){var e=[],n=[],i=[],a=0,o,s=R1(Y1,"n"),l=R1(K1,"n");if(t.Props)for(o=ni(t.Props),a=0;a<o.length;++a)(Object.prototype.hasOwnProperty.call(s,o[a])?e:Object.prototype.hasOwnProperty.call(l,o[a])?n:i).push([o[a],t.Props[o[a]]]);if(t.Custprops)for(o=ni(t.Custprops),a=0;a<o.length;++a)Object.prototype.hasOwnProperty.call(t.Props||{},o[a])||(Object.prototype.hasOwnProperty.call(s,o[a])?e:Object.prototype.hasOwnProperty.call(l,o[a])?n:i).push([o[a],t.Custprops[o[a]]]);var c=[];for(a=0;a<i.length;++a)ev.indexOf(i[a][0])>-1||Z_.indexOf(i[a][0])>-1||i[a][1]!=null&&c.push(i[a]);n.length&&Fr.utils.cfb_add(r,"/SummaryInformation",t_(n,Xh.SI,l,K1)),(e.length||c.length)&&Fr.utils.cfb_add(r,"/DocumentSummaryInformation",t_(e,Xh.DSI,s,Y1,c.length?c:null,Xh.UDI))}function nE(t,r){var e=r||{},n=Fr.utils.cfb_new({root:"R"}),i="/Workbook";switch(e.bookType||"xls"){case"xls":e.bookType="biff8";case"xla":e.bookType||(e.bookType="xla");case"biff8":i="/Workbook",e.biff=8;break;case"biff5":i="/Book",e.biff=5;break;default:throw new Error("invalid type "+e.bookType+" for XLS CFB")}return Fr.utils.cfb_add(n,i,Tv(t,e)),e.biff==8&&(t.Props||t.Custprops)&&rE(t,n),e.biff==8&&t.vbaraw&&w3(n,Fr.read(t.vbaraw,{type:typeof t.vbaraw=="string"?"binary":"buffer"})),n}var iE={0:{f:sS},1:{f:mS},2:{f:NS},3:{f:CS},4:{f:xS},5:{f:TS},6:{f:VS},7:{f:MS},8:{f:$S},9:{f:GS},10:{f:WS},11:{f:qS},12:{f:_S},13:{f:LS},14:{f:kS},15:{f:wS},16:{f:FS},17:{f:jS},18:{f:OS},19:{f:mp},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:Ik},40:{},42:{},43:{f:VC},44:{f:BC},45:{f:HC},46:{f:qC},47:{f:WC},48:{},49:{f:_y},50:{},51:{f:s3},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:vC},62:{f:US},63:{f:h3},64:{f:ck},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:so,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:ak},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:hS},148:{f:dS,p:16},151:{f:QS},152:{},153:{f:Ak},154:{},155:{},156:{f:Pk},157:{},158:{},159:{T:1,f:PC},160:{T:-1},161:{T:1,f:wl},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:XS},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:a3},336:{T:-1},337:{f:d3,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Qh},357:{},358:{},359:{},360:{T:1},361:{},362:{f:uC},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:ek},427:{f:tk},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:nk},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:uS},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:ZS},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Qh},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:v3},633:{T:1},634:{T:-1},635:{T:1,f:g3},636:{T:-1},637:{f:wy},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:yk},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:dk},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}};function ct(t,r,e,n){var i=r;if(!isNaN(i)){var a=n||(e||[]).length||0,o=t.next(4);o.write_shift(2,i),o.write_shift(2,a),a>0&&up(e)&&t.push(e)}}function aE(t,r,e,n){var i=n||(e||[]).length||0;if(i<=8224)return ct(t,r,e,i);var a=r;if(!isNaN(a)){for(var o=e.parts||[],s=0,l=0,c=0;c+(o[s]||8224)<=8224;)c+=o[s]||8224,s++;var f=t.next(4);for(f.write_shift(2,a),f.write_shift(2,c),t.push(e.slice(l,l+c)),l+=c;l<i;){for(f=t.next(4),f.write_shift(2,60),c=0;c+(o[s]||8224)<=8224;)c+=o[s]||8224,s++;f.write_shift(2,c),t.push(e.slice(l,l+c)),l+=c}}}function D0(t,r,e){return t||(t=Ue(7)),t.write_shift(2,r),t.write_shift(2,e),t.write_shift(2,0),t.write_shift(1,0),t}function oE(t,r,e,n){var i=Ue(9);return D0(i,t,r),rv(e,n||"b",i),i}function sE(t,r,e){var n=Ue(8+2*e.length);return D0(n,t,r),n.write_shift(1,e.length),n.write_shift(e.length,e,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function lE(t,r,e,n){if(r.v!=null)switch(r.t){case"d":case"n":var i=r.t=="d"?Bi(bi(r.v)):r.v;i==(i|0)&&i>=0&&i<65536?ct(t,2,yC(e,n,i)):ct(t,3,wC(e,n,i));return;case"b":case"e":ct(t,5,oE(e,n,r.v,r.t));return;case"s":case"str":ct(t,4,sE(e,n,(r.v||"").slice(0,255)));return}ct(t,1,D0(null,e,n))}function cE(t,r,e,n){var i=Array.isArray(r),a=Gr(r["!ref"]||"A1"),o,s="",l=[];if(a.e.c>255||a.e.r>16383){if(n.WTF)throw new Error("Range "+(r["!ref"]||"A1")+" exceeds format limit A1:IV16384");a.e.c=Math.min(a.e.c,255),a.e.r=Math.min(a.e.c,16383),o=kn(a)}for(var c=a.s.r;c<=a.e.r;++c){s=ri(c);for(var f=a.s.c;f<=a.e.c;++f){c===a.s.r&&(l[f]=si(f)),o=l[f]+s;var v=i?(r[c]||[])[f]:r[o];v&&lE(t,v,c,f,n)}}}function dE(t,r){var e=r||{};oo!=null&&e.dense==null&&(e.dense=oo);for(var n=Li(),i=0,a=0;a<t.SheetNames.length;++a)t.SheetNames[a]==e.sheet&&(i=a);if(i==0&&e.sheet&&t.SheetNames[0]!=e.sheet)throw new Error("Sheet not found: "+e.sheet);return ct(n,e.biff==4?1033:e.biff==3?521:9,vp(t,16,e)),cE(n,t.Sheets[t.SheetNames[i]],i,e,t),ct(n,10),n.end()}function fE(t,r,e){ct(t,49,iC({sz:12,color:{theme:1},name:"Arial",family:2,scheme:"minor"},e))}function uE(t,r,e){r&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)r[i]!=null&&ct(t,1054,sC(i,r[i],e))})}function hE(t,r){var e=Ue(19);e.write_shift(4,2151),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(2,3),e.write_shift(1,1),e.write_shift(4,0),ct(t,2151,e),e=Ue(39),e.write_shift(4,2152),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(2,3),e.write_shift(1,0),e.write_shift(4,0),e.write_shift(2,1),e.write_shift(4,4),e.write_shift(2,0),av(Gr(r["!ref"]||"A1"),e),e.write_shift(4,4),ct(t,2152,e)}function pE(t,r){for(var e=0;e<16;++e)ct(t,224,n_({numFmtId:0,style:!0},0,r));r.cellXfs.forEach(function(n){ct(t,224,n_(n,0,r))})}function mE(t,r){for(var e=0;e<r["!links"].length;++e){var n=r["!links"][e];ct(t,440,mC(n)),n[1].Tooltip&&ct(t,2048,gC(n))}delete r["!links"]}function gE(t,r){if(r){var e=0;r.forEach(function(n,i){++e<=256&&n&&ct(t,125,xC(Nf(i,n),i))})}}function _E(t,r,e,n,i){var a=16+Fs(i.cellXfs,r,i);if(r.v==null&&!r.bf){ct(t,513,gl(e,n,a));return}if(r.bf)ct(t,6,z4(r,e,n,i,a));else switch(r.t){case"d":case"n":var o=r.t=="d"?Bi(bi(r.v)):r.v;ct(t,515,fC(e,n,o,a,i));break;case"b":case"e":ct(t,517,dC(e,n,r.v,a,i,r.t));break;case"s":case"str":if(i.bookSST){var s=Cp(i.Strings,r.v,i.revStrings);ct(t,253,aC(e,n,s,a,i))}else ct(t,516,oC(e,n,(r.v||"").slice(0,255),a,i));break;default:ct(t,513,gl(e,n,a))}}function vE(t,r,e){var n=Li(),i=e.SheetNames[t],a=e.Sheets[i]||{},o=(e||{}).Workbook||{},s=(o.Sheets||[])[t]||{},l=Array.isArray(a),c=r.biff==8,f,v="",x=[],p=Gr(a["!ref"]||"A1"),S=c?65536:16384;if(p.e.c>255||p.e.r>=S){if(r.WTF)throw new Error("Range "+(a["!ref"]||"A1")+" exceeds format limit A1:IV16384");p.e.c=Math.min(p.e.c,255),p.e.r=Math.min(p.e.c,S-1)}ct(n,2057,vp(e,16,r)),ct(n,13,Ca(1)),ct(n,12,Ca(100)),ct(n,15,xi(!0)),ct(n,17,xi(!1)),ct(n,16,ml(.001)),ct(n,95,xi(!0)),ct(n,42,xi(!1)),ct(n,43,xi(!1)),ct(n,130,Ca(1)),ct(n,128,cC([0,0])),ct(n,131,xi(!1)),ct(n,132,xi(!1)),c&&gE(n,a["!cols"]),ct(n,512,lC(p,r)),c&&(a["!links"]=[]);for(var w=p.s.r;w<=p.e.r;++w){v=ri(w);for(var k=p.s.c;k<=p.e.c;++k){w===p.s.r&&(x[k]=si(k)),f=x[k]+v;var O=l?(a[w]||[])[k]:a[f];O&&(_E(n,O,w,k,r),c&&O.l&&a["!links"].push([f,O.l]))}}var H=s.CodeName||s.name||i;return c&&ct(n,574,nC((o.Views||[])[0])),c&&(a["!merges"]||[]).length&&ct(n,229,pC(a["!merges"])),c&&mE(n,a),ct(n,442,iv(H,r)),c&&hE(n,a),ct(n,10),n.end()}function xE(t,r,e){var n=Li(),i=(t||{}).Workbook||{},a=i.Sheets||[],o=i.WBProps||{},s=e.biff==8,l=e.biff==5;if(ct(n,2057,vp(t,5,e)),e.bookType=="xla"&&ct(n,135),ct(n,225,s?Ca(1200):null),ct(n,193,Wy(2)),l&&ct(n,191),l&&ct(n,192),ct(n,226),ct(n,92,Qy("SheetJS",e)),ct(n,66,Ca(s?1200:1252)),s&&ct(n,353,Ca(0)),s&&ct(n,448),ct(n,317,bC(t.SheetNames.length)),s&&t.vbaraw&&ct(n,211),s&&t.vbaraw){var c=o.CodeName||"ThisWorkbook";ct(n,442,iv(c,e))}ct(n,156,Ca(17)),ct(n,25,xi(!1)),ct(n,18,xi(!1)),ct(n,19,Ca(0)),s&&ct(n,431,xi(!1)),s&&ct(n,444,Ca(0)),ct(n,61,rC(e)),ct(n,64,xi(!1)),ct(n,141,Ca(0)),ct(n,34,xi(Sk(t)=="true")),ct(n,14,xi(!0)),s&&ct(n,439,xi(!1)),ct(n,218,Ca(0)),fE(n,t,e),uE(n,t.SSF,e),pE(n,e),s&&ct(n,352,xi(!1));var f=n.end(),v=Li();s&&ct(v,140,_C()),s&&e.Strings&&aE(v,252,tC(e.Strings,e)),ct(v,10);var x=v.end(),p=Li(),S=0,w=0;for(w=0;w<t.SheetNames.length;++w)S+=(s?12:11)+(s?2:1)*t.SheetNames[w].length;var k=f.length+S+x.length;for(w=0;w<t.SheetNames.length;++w){var O=a[w]||{};ct(p,133,eC({pos:k,hs:O.Hidden||0,dt:0,name:t.SheetNames[w]},e)),k+=r[w].length}var H=p.end();if(S!=H.length)throw new Error("BS8 "+S+" != "+H.length);var q=[];return f.length&&q.push(f),H.length&&q.push(H),x.length&&q.push(x),ei(q)}function bE(t,r){var e=r||{},n=[];t&&!t.SSF&&(t.SSF=Ui(ln)),t&&t.SSF&&(Of(),Pf(t.SSF),e.revssf=Af(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,Sp(e),e.cellXfs=[],Fs(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={});for(var i=0;i<t.SheetNames.length;++i)n[n.length]=vE(i,e,t);return n.unshift(xE(t,n,e)),ei(n)}function Tv(t,r){for(var e=0;e<=t.SheetNames.length;++e){var n=t.Sheets[t.SheetNames[e]];if(!(!n||!n["!ref"])){var i=ra(n["!ref"]);i.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+t.SheetNames[e]+"' extends beyond column IV (255).  Data may be lost.")}}var a=r||{};switch(a.biff||2){case 8:case 5:return bE(t,r);case 4:case 3:case 2:return dE(t,r)}throw new Error("invalid type "+a.bookType+" for BIFF")}function wE(t,r,e,n){for(var i=t["!merges"]||[],a=[],o=r.s.c;o<=r.e.c;++o){for(var s=0,l=0,c=0;c<i.length;++c)if(!(i[c].s.r>e||i[c].s.c>o)&&!(i[c].e.r<e||i[c].e.c<o)){if(i[c].s.r<e||i[c].s.c<o){s=-1;break}s=i[c].e.r-i[c].s.r+1,l=i[c].e.c-i[c].s.c+1;break}if(!(s<0)){var f=Ar({r:e,c:o}),v=n.dense?(t[e]||[])[o]:t[f],x=v&&v.v!=null&&(v.h||Zw(v.w||(jo(v),v.w)||""))||"",p={};s>1&&(p.rowspan=s),l>1&&(p.colspan=l),n.editable?x='<span contenteditable="true">'+x+"</span>":v&&(p["data-t"]=v&&v.t||"z",v.v!=null&&(p["data-v"]=v.v),v.z!=null&&(p["data-z"]=v.z),v.l&&(v.l.Target||"#").charAt(0)!="#"&&(x='<a href="'+v.l.Target+'">'+x+"</a>")),p.id=(n.id||"sjs")+"-"+f,a.push(st("td",x,p))}}var S="<tr>";return S+a.join("")+"</tr>"}var yE='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',CE="</body></html>";function SE(t,r,e){var n=[];return n.join("")+"<table"+(e&&e.id?' id="'+e.id+'"':"")+">"}function Iv(t,r){var e=r||{},n=e.header!=null?e.header:yE,i=e.footer!=null?e.footer:CE,a=[n],o=ra(t["!ref"]);e.dense=Array.isArray(t),a.push(SE(t,o,e));for(var s=o.s.r;s<=o.e.r;++s)a.push(wE(t,o,s,e));return a.push("</table>"+i),a.join("")}function Fv(t,r,e){var n=e||{};oo!=null&&(n.dense=oo);var i=0,a=0;if(n.origin!=null)if(typeof n.origin=="number")i=n.origin;else{var o=typeof n.origin=="string"?Hn(n.origin):n.origin;i=o.r,a=o.c}var s=r.getElementsByTagName("tr"),l=Math.min(n.sheetRows||1e7,s.length),c={s:{r:0,c:0},e:{r:i,c:a}};if(t["!ref"]){var f=ra(t["!ref"]);c.s.r=Math.min(c.s.r,f.s.r),c.s.c=Math.min(c.s.c,f.s.c),c.e.r=Math.max(c.e.r,f.e.r),c.e.c=Math.max(c.e.c,f.e.c),i==-1&&(c.e.r=i=f.e.r+1)}var v=[],x=0,p=t["!rows"]||(t["!rows"]=[]),S=0,w=0,k=0,O=0,H=0,q=0;for(t["!cols"]||(t["!cols"]=[]);S<s.length&&w<l;++S){var X=s[S];if(d_(X)){if(n.display)continue;p[w]={hidden:!0}}var he=X.children;for(k=O=0;k<he.length;++k){var ke=he[k];if(!(n.display&&d_(ke))){var re=ke.hasAttribute("data-v")?ke.getAttribute("data-v"):ke.hasAttribute("v")?ke.getAttribute("v"):ty(ke.innerHTML),ee=ke.getAttribute("data-z")||ke.getAttribute("z");for(x=0;x<v.length;++x){var W=v[x];W.s.c==O+a&&W.s.r<w+i&&w+i<=W.e.r&&(O=W.e.c+1-a,x=-1)}q=+ke.getAttribute("colspan")||1,((H=+ke.getAttribute("rowspan")||1)>1||q>1)&&v.push({s:{r:w+i,c:O+a},e:{r:w+i+(H||1)-1,c:O+a+(q||1)-1}});var ae={t:"s",v:re},A=ke.getAttribute("data-t")||ke.getAttribute("t")||"";re!=null&&(re.length==0?ae.t=A||"z":n.raw||re.trim().length==0||A=="s"||(re==="TRUE"?ae={t:"b",v:!0}:re==="FALSE"?ae={t:"b",v:!1}:isNaN(Uo(re))?isNaN(E0(re).getDate())||(ae={t:"d",v:bi(re)},n.cellDates||(ae={t:"n",v:Bi(ae.v)}),ae.z=n.dateNF||ln[14]):ae={t:"n",v:Uo(re)})),ae.z===void 0&&ee!=null&&(ae.z=ee);var V="",de=ke.getElementsByTagName("A");if(de&&de.length)for(var ue=0;ue<de.length&&!(de[ue].hasAttribute("href")&&(V=de[ue].getAttribute("href"),V.charAt(0)!="#"));++ue);V&&V.charAt(0)!="#"&&(ae.l={Target:V}),n.dense?(t[w+i]||(t[w+i]=[]),t[w+i][O+a]=ae):t[Ar({c:O+a,r:w+i})]=ae,c.e.c<O+a&&(c.e.c=O+a),O+=q}}++w}return v.length&&(t["!merges"]=(t["!merges"]||[]).concat(v)),c.e.r=Math.max(c.e.r,w-1+i),t["!ref"]=kn(c),w>=l&&(t["!fullref"]=kn((c.e.r=s.length-S+w-1+i,c))),t}function Dv(t,r){var e=r||{},n=e.dense?[]:{};return Fv(n,t,r)}function kE(t,r){return _l(Dv(t,r),r)}function d_(t){var r="",e=EE(t);return e&&(r=e(t).getPropertyValue("display")),r||(r=t.style&&t.style.display),r==="none"}function EE(t){return t.ownerDocument.defaultView&&typeof t.ownerDocument.defaultView.getComputedStyle=="function"?t.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}var ME=(function(){var t=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),r="<office:document-styles "+M0({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+t+"</office:document-styles>";return function(){return En+r}})(),f_=(function(){var t=function(a){return Or(a).replace(/  +/g,function(o){return'<text:s text:c="'+o.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},r=`          <table:table-cell />
`,e=`          <table:covered-table-cell/>
`,n=function(a,o,s){var l=[];l.push('      <table:table table:name="'+Or(o.SheetNames[s])+`" table:style-name="ta1">
`);var c=0,f=0,v=ra(a["!ref"]||"A1"),x=a["!merges"]||[],p=0,S=Array.isArray(a);if(a["!cols"])for(f=0;f<=v.e.c;++f)l.push("        <table:table-column"+(a["!cols"][f]?' table:style-name="co'+a["!cols"][f].ods+'"':"")+`></table:table-column>
`);var w="",k=a["!rows"]||[];for(c=0;c<v.s.r;++c)w=k[c]?' table:style-name="ro'+k[c].ods+'"':"",l.push("        <table:table-row"+w+`></table:table-row>
`);for(;c<=v.e.r;++c){for(w=k[c]?' table:style-name="ro'+k[c].ods+'"':"",l.push("        <table:table-row"+w+`>
`),f=0;f<v.s.c;++f)l.push(r);for(;f<=v.e.c;++f){var O=!1,H={},q="";for(p=0;p!=x.length;++p)if(!(x[p].s.c>f)&&!(x[p].s.r>c)&&!(x[p].e.c<f)&&!(x[p].e.r<c)){(x[p].s.c!=f||x[p].s.r!=c)&&(O=!0),H["table:number-columns-spanned"]=x[p].e.c-x[p].s.c+1,H["table:number-rows-spanned"]=x[p].e.r-x[p].s.r+1;break}if(O){l.push(e);continue}var X=Ar({r:c,c:f}),he=S?(a[c]||[])[f]:a[X];if(he&&he.f&&(H["table:formula"]=Or($4(he.f)),he.F&&he.F.slice(0,X.length)==X)){var ke=ra(he.F);H["table:number-matrix-columns-spanned"]=ke.e.c-ke.s.c+1,H["table:number-matrix-rows-spanned"]=ke.e.r-ke.s.r+1}if(!he){l.push(r);continue}switch(he.t){case"b":q=he.v?"TRUE":"FALSE",H["office:value-type"]="boolean",H["office:boolean-value"]=he.v?"true":"false";break;case"n":q=he.w||String(he.v||0),H["office:value-type"]="float",H["office:value"]=he.v||0;break;case"s":case"str":q=he.v==null?"":he.v,H["office:value-type"]="string";break;case"d":q=he.w||bi(he.v).toISOString(),H["office:value-type"]="date",H["office:date-value"]=bi(he.v).toISOString(),H["table:style-name"]="ce1";break;default:l.push(r);continue}var re=t(q);if(he.l&&he.l.Target){var ee=he.l.Target;ee=ee.charAt(0)=="#"?"#"+X4(ee.slice(1)):ee,ee.charAt(0)!="#"&&!ee.match(/^\w+:/)&&(ee="../"+ee),re=st("text:a",re,{"xlink:href":ee.replace(/&/g,"&amp;")})}l.push("          "+st("table:table-cell",st("text:p",re,{}),H)+`
`)}l.push(`        </table:table-row>
`)}return l.push(`      </table:table>
`),l.join("")},i=function(a,o){a.push(` <office:automatic-styles>
`),a.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),a.push(`   <number:month number:style="long"/>
`),a.push(`   <number:text>/</number:text>
`),a.push(`   <number:day number:style="long"/>
`),a.push(`   <number:text>/</number:text>
`),a.push(`   <number:year/>
`),a.push(`  </number:date-style>
`);var s=0;o.SheetNames.map(function(c){return o.Sheets[c]}).forEach(function(c){if(c&&c["!cols"]){for(var f=0;f<c["!cols"].length;++f)if(c["!cols"][f]){var v=c["!cols"][f];if(v.width==null&&v.wpx==null&&v.wch==null)continue;xp(v),v.ods=s;var x=c["!cols"][f].wpx+"px";a.push('  <style:style style:name="co'+s+`" style:family="table-column">
`),a.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+x+`"/>
`),a.push(`  </style:style>
`),++s}}});var l=0;o.SheetNames.map(function(c){return o.Sheets[c]}).forEach(function(c){if(c&&c["!rows"]){for(var f=0;f<c["!rows"].length;++f)if(c["!rows"][f]){c["!rows"][f].ods=l;var v=c["!rows"][f].hpx+"px";a.push('  <style:style style:name="ro'+l+`" style:family="table-row">
`),a.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+v+`"/>
`),a.push(`  </style:style>
`),++l}}}),a.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),a.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),a.push(`  </style:style>
`),a.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),a.push(` </office:automatic-styles>
`)};return function(o,s){var l=[En],c=M0({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),f=M0({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});s.bookType=="fods"?(l.push("<office:document"+c+f+`>
`),l.push(Y_().replace(/office:document-meta/g,"office:meta"))):l.push("<office:document-content"+c+`>
`),i(l,o),l.push(`  <office:body>
`),l.push(`    <office:spreadsheet>
`);for(var v=0;v!=o.SheetNames.length;++v)l.push(n(o.Sheets[o.SheetNames[v]],o,v,s));return l.push(`    </office:spreadsheet>
`),l.push(`  </office:body>
`),s.bookType=="fods"?l.push("</office:document>"):l.push("</office:document-content>"),l.join("")}})();function Nv(t,r){if(r.bookType=="fods")return f_(t,r);var e=ip(),n="",i=[],a=[];return n="mimetype",tr(e,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",tr(e,n,f_(t,r)),i.push([n,"text/xml"]),a.push([n,"ContentFile"]),n="styles.xml",tr(e,n,ME(t,r)),i.push([n,"text/xml"]),a.push([n,"StylesFile"]),n="meta.xml",tr(e,n,En+Y_()),i.push([n,"text/xml"]),a.push([n,"MetadataFile"]),n="manifest.rdf",tr(e,n,Uy(a)),i.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",tr(e,n,Ly(i)),e}function kf(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function PE(t){return typeof TextEncoder<"u"?new TextEncoder().encode(t):Va(Lo(t))}function OE(t,r){e:for(var e=0;e<=t.length-r.length;++e){for(var n=0;n<r.length;++n)if(t[e+n]!=r[n])continue e;return!0}return!1}function Is(t){var r=t.reduce(function(i,a){return i+a.length},0),e=new Uint8Array(r),n=0;return t.forEach(function(i){e.set(i,n),n+=i.length}),e}function AE(t,r,e){var n=Math.floor(e==0?0:Math.LOG10E*Math.log(Math.abs(e)))+6176-20,i=e/Math.pow(10,n-6176);t[r+15]|=n>>7,t[r+14]|=(n&127)<<1;for(var a=0;i>=1;++a,i/=256)t[r+a]=i&255;t[r+15]|=e>=0?0:128}function P0(t,r){var e=r?r[0]:0,n=t[e]&127;e:if(t[e++]>=128&&(n|=(t[e]&127)<<7,t[e++]<128||(n|=(t[e]&127)<<14,t[e++]<128)||(n|=(t[e]&127)<<21,t[e++]<128)||(n+=(t[e]&127)*Math.pow(2,28),++e,t[e++]<128)||(n+=(t[e]&127)*Math.pow(2,35),++e,t[e++]<128)||(n+=(t[e]&127)*Math.pow(2,42),++e,t[e++]<128)))break e;return r&&(r[0]=e),n}function Mr(t){var r=new Uint8Array(7);r[0]=t&127;var e=1;e:if(t>127){if(r[e-1]|=128,r[e]=t>>7&127,++e,t<=16383||(r[e-1]|=128,r[e]=t>>14&127,++e,t<=2097151)||(r[e-1]|=128,r[e]=t>>21&127,++e,t<=268435455)||(r[e-1]|=128,r[e]=t/256>>>21&127,++e,t<=34359738367)||(r[e-1]|=128,r[e]=t/65536>>>21&127,++e,t<=4398046511103))break e;r[e-1]|=128,r[e]=t/16777216>>>21&127,++e}return r.slice(0,e)}function oc(t){var r=0,e=t[r]&127;e:if(t[r++]>=128){if(e|=(t[r]&127)<<7,t[r++]<128||(e|=(t[r]&127)<<14,t[r++]<128)||(e|=(t[r]&127)<<21,t[r++]<128))break e;e|=(t[r]&127)<<28}return e}function Dn(t){for(var r=[],e=[0];e[0]<t.length;){var n=e[0],i=P0(t,e),a=i&7;i=Math.floor(i/8);var o=0,s;if(i==0)break;switch(a){case 0:{for(var l=e[0];t[e[0]++]>=128;);s=t.slice(l,e[0])}break;case 5:o=4,s=t.slice(e[0],e[0]+o),e[0]+=o;break;case 1:o=8,s=t.slice(e[0],e[0]+o),e[0]+=o;break;case 2:o=P0(t,e),s=t.slice(e[0],e[0]+o),e[0]+=o;break;case 3:case 4:default:throw new Error("PB Type ".concat(a," for Field ").concat(i," at offset ").concat(n))}var c={data:s,type:a};r[i]==null?r[i]=[c]:r[i].push(c)}return r}function Jn(t){var r=[];return t.forEach(function(e,n){e.forEach(function(i){i.data&&(r.push(Mr(n*8+i.type)),i.type==2&&r.push(Mr(i.data.length)),r.push(i.data))})}),Is(r)}function Ba(t){for(var r,e=[],n=[0];n[0]<t.length;){var i=P0(t,n),a=Dn(t.slice(n[0],n[0]+i));n[0]+=i;var o={id:oc(a[1][0].data),messages:[]};a[2].forEach(function(s){var l=Dn(s.data),c=oc(l[3][0].data);o.messages.push({meta:l,data:t.slice(n[0],n[0]+c)}),n[0]+=c}),(r=a[3])!=null&&r[0]&&(o.merge=oc(a[3][0].data)>>>0>0),e.push(o)}return e}function Jl(t){var r=[];return t.forEach(function(e){var n=[];n[1]=[{data:Mr(e.id),type:0}],n[2]=[],e.merge!=null&&(n[3]=[{data:Mr(+!!e.merge),type:0}]);var i=[];e.messages.forEach(function(o){i.push(o.data),o.meta[3]=[{type:0,data:Mr(o.data.length)}],n[2].push({data:Jn(o.meta),type:2})});var a=Jn(n);r.push(Mr(a.length)),r.push(a),i.forEach(function(o){return r.push(o)})}),Is(r)}function TE(t,r){if(t!=0)throw new Error("Unexpected Snappy chunk type ".concat(t));for(var e=[0],n=P0(r,e),i=[];e[0]<r.length;){var a=r[e[0]]&3;if(a==0){var o=r[e[0]++]>>2;if(o<60)++o;else{var s=o-59;o=r[e[0]],s>1&&(o|=r[e[0]+1]<<8),s>2&&(o|=r[e[0]+2]<<16),s>3&&(o|=r[e[0]+3]<<24),o>>>=0,o++,e[0]+=s}i.push(r.slice(e[0],e[0]+o)),e[0]+=o;continue}else{var l=0,c=0;if(a==1?(c=(r[e[0]]>>2&7)+4,l=(r[e[0]++]&224)<<3,l|=r[e[0]++]):(c=(r[e[0]++]>>2)+1,a==2?(l=r[e[0]]|r[e[0]+1]<<8,e[0]+=2):(l=(r[e[0]]|r[e[0]+1]<<8|r[e[0]+2]<<16|r[e[0]+3]<<24)>>>0,e[0]+=4)),i=[Is(i)],l==0)throw new Error("Invalid offset 0");if(l>i[0].length)throw new Error("Invalid offset beyond length");if(c>=l)for(i.push(i[0].slice(-l)),c-=l;c>=i[i.length-1].length;)i.push(i[i.length-1]),c-=i[i.length-1].length;i.push(i[0].slice(-l,-l+c))}}var f=Is(i);if(f.length!=n)throw new Error("Unexpected length: ".concat(f.length," != ").concat(n));return f}function Ua(t){for(var r=[],e=0;e<t.length;){var n=t[e++],i=t[e]|t[e+1]<<8|t[e+2]<<16;e+=3,r.push(TE(n,t.slice(e,e+i))),e+=i}if(e!==t.length)throw new Error("data is not a valid framed stream!");return Is(r)}function Ql(t){for(var r=[],e=0;e<t.length;){var n=Math.min(t.length-e,268435455),i=new Uint8Array(4);r.push(i);var a=Mr(n),o=a.length;r.push(a),n<=60?(o++,r.push(new Uint8Array([n-1<<2]))):n<=256?(o+=2,r.push(new Uint8Array([240,n-1&255]))):n<=65536?(o+=3,r.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(o+=4,r.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(o+=5,r.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),r.push(t.slice(e,e+n)),o+=n,i[0]=0,i[1]=o&255,i[2]=o>>8&255,i[3]=o>>16&255,e+=n}return Is(r)}function Yh(t,r){var e=new Uint8Array(32),n=kf(e),i=12,a=0;switch(e[0]=5,t.t){case"n":e[1]=2,AE(e,i,t.v),a|=1,i+=16;break;case"b":e[1]=6,n.setFloat64(i,t.v?1:0,!0),a|=2,i+=8;break;case"s":if(r.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));e[1]=3,n.setUint32(i,r.indexOf(t.v),!0),a|=8,i+=4;break;default:throw"unsupported cell type "+t.t}return n.setUint32(8,a,!0),e.slice(0,i)}function Kh(t,r){var e=new Uint8Array(32),n=kf(e),i=12,a=0;switch(e[0]=3,t.t){case"n":e[2]=2,n.setFloat64(i,t.v,!0),a|=32,i+=8;break;case"b":e[2]=6,n.setFloat64(i,t.v?1:0,!0),a|=32,i+=8;break;case"s":if(r.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));e[2]=3,n.setUint32(i,r.indexOf(t.v),!0),a|=16,i+=4;break;default:throw"unsupported cell type "+t.t}return n.setUint32(4,a,!0),e.slice(0,i)}function Ms(t){var r=Dn(t);return P0(r[1][0].data)}function IE(t,r,e){var n,i,a,o;if(!((n=t[6])!=null&&n[0])||!((i=t[7])!=null&&i[0]))throw"Mutation only works on post-BNC storages!";var s=((o=(a=t[8])==null?void 0:a[0])==null?void 0:o.data)&&oc(t[8][0].data)>0||!1;if(s)throw"Math only works with normal offsets";for(var l=0,c=kf(t[7][0].data),f=0,v=[],x=kf(t[4][0].data),p=0,S=[],w=0;w<r.length;++w){if(r[w]==null){c.setUint16(w*2,65535,!0),x.setUint16(w*2,65535);continue}c.setUint16(w*2,f,!0),x.setUint16(w*2,p,!0);var k,O;switch(typeof r[w]){case"string":k=Yh({t:"s",v:r[w]},e),O=Kh({t:"s",v:r[w]},e);break;case"number":k=Yh({t:"n",v:r[w]},e),O=Kh({t:"n",v:r[w]},e);break;case"boolean":k=Yh({t:"b",v:r[w]},e),O=Kh({t:"b",v:r[w]},e);break;default:throw new Error("Unsupported value "+r[w])}v.push(k),f+=k.length,S.push(O),p+=O.length,++l}for(t[2][0].data=Mr(l);w<t[7][0].data.length/2;++w)c.setUint16(w*2,65535,!0),x.setUint16(w*2,65535,!0);return t[6][0].data=Is(v),t[3][0].data=Is(S),l}function FE(t,r){if(!r||!r.numbers)throw new Error("Must pass a `numbers` option -- check the README");var e=t.Sheets[t.SheetNames[0]];t.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=ra(e["!ref"]);n.s.r=n.s.c=0;var i=!1;n.e.c>9&&(i=!0,n.e.c=9),n.e.r>49&&(i=!0,n.e.r=49),i&&console.error("The Numbers writer is currently limited to ".concat(kn(n)));var a=Ef(e,{range:n,header:1}),o=["~Sh33tJ5~"];a.forEach(function(T){return T.forEach(function(R){typeof R=="string"&&o.push(R)})});var s={},l=[],c=Fr.read(r.numbers,{type:"base64"});c.FileIndex.map(function(T,R){return[T,c.FullPaths[R]]}).forEach(function(T){var R=T[0],te=T[1];if(R.type==2&&R.name.match(/\.iwa/)){var pe=R.content,ye=Ua(pe),ve=Ba(ye);ve.forEach(function(_e){l.push(_e.id),s[_e.id]={deps:[],location:te,type:oc(_e.messages[0].meta[1][0].data)}})}}),l.sort(function(T,R){return T-R});var f=l.filter(function(T){return T>1}).map(function(T){return[T,Mr(T)]});c.FileIndex.map(function(T,R){return[T,c.FullPaths[R]]}).forEach(function(T){var R=T[0],te=T[1];if(R.name.match(/\.iwa/)){var pe=Ba(Ua(R.content));pe.forEach(function(ye){ye.messages.forEach(function(ve){f.forEach(function(_e){ye.messages.some(function(He){return oc(He.meta[1][0].data)!=11006&&OE(He.data,_e[1])})&&s[_e[0]].deps.push(ye.id)})})})}});function v(){for(var T=927262;T<2e6;++T)if(!s[T])return T;throw new Error("Too many messages")}for(var x=Fr.find(c,s[1].location),p=Ba(Ua(x.content)),S,w=0;w<p.length;++w){var k=p[w];k.id==1&&(S=k)}var O=Ms(Dn(S.messages[0].data)[1][0].data);for(x=Fr.find(c,s[O].location),p=Ba(Ua(x.content)),w=0;w<p.length;++w)k=p[w],k.id==O&&(S=k);for(O=Ms(Dn(S.messages[0].data)[2][0].data),x=Fr.find(c,s[O].location),p=Ba(Ua(x.content)),w=0;w<p.length;++w)k=p[w],k.id==O&&(S=k);for(O=Ms(Dn(S.messages[0].data)[2][0].data),x=Fr.find(c,s[O].location),p=Ba(Ua(x.content)),w=0;w<p.length;++w)k=p[w],k.id==O&&(S=k);var H=Dn(S.messages[0].data);{H[6][0].data=Mr(n.e.r+1),H[7][0].data=Mr(n.e.c+1);var q=Ms(H[46][0].data),X=Fr.find(c,s[q].location),he=Ba(Ua(X.content));{for(var ke=0;ke<he.length&&he[ke].id!=q;++ke);if(he[ke].id!=q)throw"Bad ColumnRowUIDMapArchive";var re=Dn(he[ke].messages[0].data);re[1]=[],re[2]=[],re[3]=[];for(var ee=0;ee<=n.e.c;++ee){var W=[];W[1]=W[2]=[{type:0,data:Mr(ee+420690)}],re[1].push({type:2,data:Jn(W)}),re[2].push({type:0,data:Mr(ee)}),re[3].push({type:0,data:Mr(ee)})}re[4]=[],re[5]=[],re[6]=[];for(var ae=0;ae<=n.e.r;++ae)W=[],W[1]=W[2]=[{type:0,data:Mr(ae+726270)}],re[4].push({type:2,data:Jn(W)}),re[5].push({type:0,data:Mr(ae)}),re[6].push({type:0,data:Mr(ae)});he[ke].messages[0].data=Jn(re)}X.content=Ql(Jl(he)),X.size=X.content.length,delete H[46];var A=Dn(H[4][0].data);{A[7][0].data=Mr(n.e.r+1);var V=Dn(A[1][0].data),de=Ms(V[2][0].data);X=Fr.find(c,s[de].location),he=Ba(Ua(X.content));{if(he[0].id!=de)throw"Bad HeaderStorageBucket";var ue=Dn(he[0].messages[0].data);for(ae=0;ae<a.length;++ae){var xe=Dn(ue[2][0].data);xe[1][0].data=Mr(ae),xe[4][0].data=Mr(a[ae].length),ue[2][ae]={type:ue[2][0].type,data:Jn(xe)}}he[0].messages[0].data=Jn(ue)}X.content=Ql(Jl(he)),X.size=X.content.length;var Ne=Ms(A[2][0].data);X=Fr.find(c,s[Ne].location),he=Ba(Ua(X.content));{if(he[0].id!=Ne)throw"Bad HeaderStorageBucket";for(ue=Dn(he[0].messages[0].data),ee=0;ee<=n.e.c;++ee)xe=Dn(ue[2][0].data),xe[1][0].data=Mr(ee),xe[4][0].data=Mr(n.e.r+1),ue[2][ee]={type:ue[2][0].type,data:Jn(xe)};he[0].messages[0].data=Jn(ue)}X.content=Ql(Jl(he)),X.size=X.content.length;var Re=Ms(A[4][0].data);(function(){for(var T=Fr.find(c,s[Re].location),R=Ba(Ua(T.content)),te,pe=0;pe<R.length;++pe){var ye=R[pe];ye.id==Re&&(te=ye)}var ve=Dn(te.messages[0].data);{ve[3]=[];var _e=[];o.forEach(function(nt,at){_e[1]=[{type:0,data:Mr(at)}],_e[2]=[{type:0,data:Mr(1)}],_e[3]=[{type:2,data:PE(nt)}],ve[3].push({type:2,data:Jn(_e)})})}te.messages[0].data=Jn(ve);var He=Jl(R),Ye=Ql(He);T.content=Ye,T.size=T.content.length})();var Ee=Dn(A[3][0].data);{var Be=Ee[1][0];delete Ee[2];var Je=Dn(Be.data);{var qe=Ms(Je[2][0].data);(function(){for(var T=Fr.find(c,s[qe].location),R=Ba(Ua(T.content)),te,pe=0;pe<R.length;++pe){var ye=R[pe];ye.id==qe&&(te=ye)}var ve=Dn(te.messages[0].data);{delete ve[6],delete Ee[7];var _e=new Uint8Array(ve[5][0].data);ve[5]=[];for(var He=0,Ye=0;Ye<=n.e.r;++Ye){var nt=Dn(_e);He+=IE(nt,a[Ye],o),nt[1][0].data=Mr(Ye),ve[5].push({data:Jn(nt),type:2})}ve[1]=[{type:0,data:Mr(n.e.c+1)}],ve[2]=[{type:0,data:Mr(n.e.r+1)}],ve[3]=[{type:0,data:Mr(He)}],ve[4]=[{type:0,data:Mr(n.e.r+1)}]}te.messages[0].data=Jn(ve);var at=Jl(R),Q=Ql(at);T.content=Q,T.size=T.content.length})()}Be.data=Jn(Je)}A[3][0].data=Jn(Ee)}H[4][0].data=Jn(A)}S.messages[0].data=Jn(H);var E=Jl(p),U=Ql(E);return x.content=U,x.size=x.content.length,c}function DE(t){return function(e){for(var n=0;n!=t.length;++n){var i=t[n];e[i[0]]===void 0&&(e[i[0]]=i[1]),i[2]==="n"&&(e[i[0]]=Number(e[i[0]]))}}}function Sp(t){DE([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(t)}function NE(t,r){return r.bookType=="ods"?Nv(t,r):r.bookType=="numbers"?FE(t,r):r.bookType=="xlsb"?RE(t,r):LE(t,r)}function RE(t,r){tc=1024,t&&!t.SSF&&(t.SSF=Ui(ln)),t&&t.SSF&&(Of(),Pf(t.SSF),r.revssf=Af(t.SSF),r.revssf[t.SSF[65535]]=0,r.ssf=t.SSF),r.rels={},r.wbrels={},r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,y0?r.revStrings=new Map:(r.revStrings={},r.revStrings.foo=[],delete r.revStrings.foo);var e=r.bookType=="xlsb"?"bin":"xml",n=_v.indexOf(r.bookType)>-1,i=G_();Sp(r=r||{});var a=ip(),o="",s=0;if(r.cellXfs=[],Fs(r.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),o="docProps/core.xml",tr(a,o,K_(t.Props,r)),i.coreprops.push(o),Pr(r.rels,2,o,_r.CORE_PROPS),o="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var l=[],c=0;c<t.SheetNames.length;++c)(t.Workbook.Sheets[c]||{}).Hidden!=2&&l.push(t.SheetNames[c]);t.Props.SheetNames=l}for(t.Props.Worksheets=t.Props.SheetNames.length,tr(a,o,J_(t.Props,r)),i.extprops.push(o),Pr(r.rels,3,o,_r.EXT_PROPS),t.Custprops!==t.Props&&ni(t.Custprops||{}).length>0&&(o="docProps/custom.xml",tr(a,o,Q_(t.Custprops,r)),i.custprops.push(o),Pr(r.rels,4,o,_r.CUST_PROPS)),s=1;s<=t.SheetNames.length;++s){var f={"!id":{}},v=t.Sheets[t.SheetNames[s-1]],x=(v||{})["!type"]||"sheet";switch(x){case"chart":default:o="xl/worksheets/sheet"+s+"."+e,tr(a,o,Uk(s-1,o,r,t,f)),i.sheets.push(o),Pr(r.wbrels,-1,"worksheets/sheet"+s+"."+e,_r.WS[0])}if(v){var p=v["!comments"],S=!1,w="";p&&p.length>0&&(w="xl/comments"+s+"."+e,tr(a,w,jk(p,w,r)),i.comments.push(w),Pr(f,-1,"../comments"+s+"."+e,_r.CMNT),S=!0),v["!legacy"]&&S&&tr(a,"xl/drawings/vmlDrawing"+s+".vml",mv(s,v["!comments"])),delete v["!comments"],delete v["!legacy"]}f["!id"].rId1&&tr(a,X_(o),ic(f))}return r.Strings!=null&&r.Strings.length>0&&(o="xl/sharedStrings."+e,tr(a,o,zk(r.Strings,o,r)),i.strs.push(o),Pr(r.wbrels,-1,"sharedStrings."+e,_r.SST)),o="xl/workbook."+e,tr(a,o,Bk(t,o,r)),i.workbooks.push(o),Pr(r.rels,1,o,_r.WB),o="xl/theme/theme1.xml",tr(a,o,hv(t.Themes,r)),i.themes.push(o),Pr(r.wbrels,-1,"theme/theme1.xml",_r.THEME),o="xl/styles."+e,tr(a,o,Vk(t,o,r)),i.styles.push(o),Pr(r.wbrels,-1,"styles."+e,_r.STY),t.vbaraw&&n&&(o="xl/vbaProject.bin",tr(a,o,t.vbaraw),i.vba.push(o),Pr(r.wbrels,-1,"vbaProject.bin",_r.VBA)),o="xl/metadata."+e,tr(a,o,Hk(o)),i.metadata.push(o),Pr(r.wbrels,-1,"metadata."+e,_r.XLMETA),tr(a,"[Content_Types].xml",$_(i,r)),tr(a,"_rels/.rels",ic(r.rels)),tr(a,"xl/_rels/workbook."+e+".rels",ic(r.wbrels)),delete r.revssf,delete r.ssf,a}function LE(t,r){tc=1024,t&&!t.SSF&&(t.SSF=Ui(ln)),t&&t.SSF&&(Of(),Pf(t.SSF),r.revssf=Af(t.SSF),r.revssf[t.SSF[65535]]=0,r.ssf=t.SSF),r.rels={},r.wbrels={},r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,y0?r.revStrings=new Map:(r.revStrings={},r.revStrings.foo=[],delete r.revStrings.foo);var e="xml",n=_v.indexOf(r.bookType)>-1,i=G_();Sp(r=r||{});var a=ip(),o="",s=0;if(r.cellXfs=[],Fs(r.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),o="docProps/core.xml",tr(a,o,K_(t.Props,r)),i.coreprops.push(o),Pr(r.rels,2,o,_r.CORE_PROPS),o="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var l=[],c=0;c<t.SheetNames.length;++c)(t.Workbook.Sheets[c]||{}).Hidden!=2&&l.push(t.SheetNames[c]);t.Props.SheetNames=l}t.Props.Worksheets=t.Props.SheetNames.length,tr(a,o,J_(t.Props,r)),i.extprops.push(o),Pr(r.rels,3,o,_r.EXT_PROPS),t.Custprops!==t.Props&&ni(t.Custprops||{}).length>0&&(o="docProps/custom.xml",tr(a,o,Q_(t.Custprops,r)),i.custprops.push(o),Pr(r.rels,4,o,_r.CUST_PROPS));var f=["SheetJ5"];for(r.tcid=0,s=1;s<=t.SheetNames.length;++s){var v={"!id":{}},x=t.Sheets[t.SheetNames[s-1]],p=(x||{})["!type"]||"sheet";switch(p){case"chart":default:o="xl/worksheets/sheet"+s+"."+e,tr(a,o,Ev(s-1,r,t,v)),i.sheets.push(o),Pr(r.wbrels,-1,"worksheets/sheet"+s+"."+e,_r.WS[0])}if(x){var S=x["!comments"],w=!1,k="";if(S&&S.length>0){var O=!1;S.forEach(function(H){H[1].forEach(function(q){q.T==!0&&(O=!0)})}),O&&(k="xl/threadedComments/threadedComment"+s+"."+e,tr(a,k,p3(S,f,r)),i.threadedcomments.push(k),Pr(v,-1,"../threadedComments/threadedComment"+s+"."+e,_r.TCMNT)),k="xl/comments"+s+"."+e,tr(a,k,gv(S,r)),i.comments.push(k),Pr(v,-1,"../comments"+s+"."+e,_r.CMNT),w=!0}x["!legacy"]&&w&&tr(a,"xl/drawings/vmlDrawing"+s+".vml",mv(s,x["!comments"])),delete x["!comments"],delete x["!legacy"]}v["!id"].rId1&&tr(a,X_(o),ic(v))}return r.Strings!=null&&r.Strings.length>0&&(o="xl/sharedStrings."+e,tr(a,o,sv(r.Strings,r)),i.strs.push(o),Pr(r.wbrels,-1,"sharedStrings."+e,_r.SST)),o="xl/workbook."+e,tr(a,o,Ov(t,r)),i.workbooks.push(o),Pr(r.rels,1,o,_r.WB),o="xl/theme/theme1.xml",tr(a,o,hv(t.Themes,r)),i.themes.push(o),Pr(r.wbrels,-1,"theme/theme1.xml",_r.THEME),o="xl/styles."+e,tr(a,o,fv(t,r)),i.styles.push(o),Pr(r.wbrels,-1,"styles."+e,_r.STY),t.vbaraw&&n&&(o="xl/vbaProject.bin",tr(a,o,t.vbaraw),i.vba.push(o),Pr(r.wbrels,-1,"vbaProject.bin",_r.VBA)),o="xl/metadata."+e,tr(a,o,pv()),i.metadata.push(o),Pr(r.wbrels,-1,"metadata."+e,_r.XLMETA),f.length>1&&(o="xl/persons/person.xml",tr(a,o,m3(f,r)),i.people.push(o),Pr(r.wbrels,-1,"persons/person.xml",_r.PEOPLE)),tr(a,"[Content_Types].xml",$_(i,r)),tr(a,"_rels/.rels",ic(r.rels)),tr(a,"xl/_rels/workbook."+e+".rels",ic(r.wbrels)),delete r.revssf,delete r.ssf,a}function BE(t,r){var e="";switch((r||{}).type||"base64"){case"buffer":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];case"base64":e=zo(t.slice(0,12));break;case"binary":e=t;break;case"array":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];default:throw new Error("Unrecognized type "+(r&&r.type||"undefined"))}return[e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3),e.charCodeAt(4),e.charCodeAt(5),e.charCodeAt(6),e.charCodeAt(7)]}function Rv(t,r){switch(r.type){case"base64":case"binary":break;case"buffer":case"array":r.type="";break;case"file":return T0(r.file,Fr.write(t,{type:vr?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+r.bookType+"' files");default:throw new Error("Unrecognized type "+r.type)}return Fr.write(t,r)}function UE(t,r){var e=Ui(r||{}),n=NE(t,e);return VE(n,e)}function VE(t,r){var e={},n=vr?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(r.compression&&(e.compression="DEFLATE"),r.password)e.type=n;else switch(r.type){case"base64":e.type="base64";break;case"binary":e.type="string";break;case"string":throw new Error("'string' output type invalid for '"+r.bookType+"' files");case"buffer":case"file":e.type=n;break;default:throw new Error("Unrecognized type "+r.type)}var i=t.FullPaths?Fr.write(t,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[e.type]||e.type,compression:!!r.compression}):t.generate(e);if(typeof Deno<"u"&&typeof i=="string"){if(r.type=="binary"||r.type=="base64")return i;i=new Uint8Array(Mf(i))}return r.password&&typeof encrypt_agile<"u"?Rv(encrypt_agile(i,r.password),r):r.type==="file"?T0(r.file,i):r.type=="string"?v0(i):i}function zE(t,r){var e=r||{},n=nE(t,e);return Rv(n,e)}function ao(t,r,e){e||(e="");var n=e+t;switch(r.type){case"base64":return k0(Lo(n));case"binary":return Lo(n);case"string":return t;case"file":return T0(r.file,n,"utf8");case"buffer":return vr?Ho(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):ao(n,{type:"binary"}).split("").map(function(i){return i.charCodeAt(0)})}throw new Error("Unrecognized type "+r.type)}function jE(t,r){switch(r.type){case"base64":return k0(t);case"binary":return t;case"string":return t;case"file":return T0(r.file,t,"binary");case"buffer":return vr?Ho(t,"binary"):t.split("").map(function(e){return e.charCodeAt(0)})}throw new Error("Unrecognized type "+r.type)}function hf(t,r){switch(r.type){case"string":case"base64":case"binary":for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return r.type=="base64"?k0(e):r.type=="string"?v0(e):e;case"file":return T0(r.file,t);case"buffer":return t;default:throw new Error("Unrecognized type "+r.type)}}function Lv(t,r){pw(),Mk(t);var e=Ui(r||{});if(e.cellStyles&&(e.cellNF=!0,e.sheetStubs=!0),e.type=="array"){e.type="binary";var n=Lv(t,e);return e.type="array",Mf(n)}var i=0;if(e.sheet&&(typeof e.sheet=="number"?i=e.sheet:i=t.SheetNames.indexOf(e.sheet),!t.SheetNames[i]))throw new Error("Sheet not found: "+e.sheet+" : "+typeof e.sheet);switch(e.bookType||"xlsb"){case"xml":case"xlml":return ao(tE(t,e),e);case"slk":case"sylk":return ao(SC.from_sheet(t.Sheets[t.SheetNames[i]],e),e);case"htm":case"html":return ao(Iv(t.Sheets[t.SheetNames[i]],e),e);case"txt":return jE(Bv(t.Sheets[t.SheetNames[i]],e),e);case"csv":return ao(kp(t.Sheets[t.SheetNames[i]],e),e,"\uFEFF");case"dif":return ao(kC.from_sheet(t.Sheets[t.SheetNames[i]],e),e);case"dbf":return hf(CC.from_sheet(t.Sheets[t.SheetNames[i]],e),e);case"prn":return ao(EC.from_sheet(t.Sheets[t.SheetNames[i]],e),e);case"rtf":return ao(FC.from_sheet(t.Sheets[t.SheetNames[i]],e),e);case"eth":return ao(ov.from_sheet(t.Sheets[t.SheetNames[i]],e),e);case"fods":return ao(Nv(t,e),e);case"wk1":return hf(i_.sheet_to_wk1(t.Sheets[t.SheetNames[i]],e),e);case"wk3":return hf(i_.book_to_wk3(t,e),e);case"biff2":e.biff||(e.biff=2);case"biff3":e.biff||(e.biff=3);case"biff4":return e.biff||(e.biff=4),hf(Tv(t,e),e);case"biff5":e.biff||(e.biff=5);case"biff8":case"xla":case"xls":return e.biff||(e.biff=8),zE(t,e);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return UE(t,e);default:throw new Error("Unrecognized bookType |"+e.bookType+"|")}}function HE(t){if(!t.bookType){var r={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},e=t.file.slice(t.file.lastIndexOf(".")).toLowerCase();e.match(/^\.[a-z]+$/)&&(t.bookType=e.slice(1)),t.bookType=r[t.bookType]||t.bookType}}function Rf(t,r,e){var n=e||{};return n.type="file",n.file=r,HE(n),Lv(t,n)}function WE(t,r,e,n,i,a,o,s){var l=ri(e),c=s.defval,f=s.raw||!Object.prototype.hasOwnProperty.call(s,"raw"),v=!0,x=i===1?[]:{};if(i!==1)if(Object.defineProperty)try{Object.defineProperty(x,"__rowNum__",{value:e,enumerable:!1})}catch{x.__rowNum__=e}else x.__rowNum__=e;if(!o||t[e])for(var p=r.s.c;p<=r.e.c;++p){var S=o?t[e][p]:t[n[p]+l];if(S===void 0||S.t===void 0){if(c===void 0)continue;a[p]!=null&&(x[a[p]]=c);continue}var w=S.v;switch(S.t){case"z":if(w==null)break;continue;case"e":w=w==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+S.t)}if(a[p]!=null){if(w==null)if(S.t=="e"&&w===null)x[a[p]]=null;else if(c!==void 0)x[a[p]]=c;else if(f&&w===null)x[a[p]]=null;else continue;else x[a[p]]=f&&(S.t!=="n"||S.t==="n"&&s.rawNumbers!==!1)?w:jo(S,w,s);w!=null&&(v=!1)}}return{row:x,isempty:v}}function Ef(t,r){if(t==null||t["!ref"]==null)return[];var e={t:"n",v:0},n=0,i=1,a=[],o=0,s="",l={s:{r:0,c:0},e:{r:0,c:0}},c=r||{},f=c.range!=null?c.range:t["!ref"];switch(c.header===1?n=1:c.header==="A"?n=2:Array.isArray(c.header)?n=3:c.header==null&&(n=0),typeof f){case"string":l=Gr(f);break;case"number":l=Gr(t["!ref"]),l.s.r=f;break;default:l=f}n>0&&(i=0);var v=ri(l.s.r),x=[],p=[],S=0,w=0,k=Array.isArray(t),O=l.s.r,H=0,q={};k&&!t[O]&&(t[O]=[]);var X=c.skipHidden&&t["!cols"]||[],he=c.skipHidden&&t["!rows"]||[];for(H=l.s.c;H<=l.e.c;++H)if(!(X[H]||{}).hidden)switch(x[H]=si(H),e=k?t[O][H]:t[x[H]+v],n){case 1:a[H]=H-l.s.c;break;case 2:a[H]=x[H];break;case 3:a[H]=c.header[H-l.s.c];break;default:if(e==null&&(e={w:"__EMPTY",t:"s"}),s=o=jo(e,null,c),w=q[o]||0,!w)q[o]=1;else{do s=o+"_"+w++;while(q[s]);q[o]=w,q[s]=1}a[H]=s}for(O=l.s.r+i;O<=l.e.r;++O)if(!(he[O]||{}).hidden){var ke=WE(t,l,O,x,n,a,k,c);(ke.isempty===!1||(n===1?c.blankrows!==!1:c.blankrows))&&(p[S++]=ke.row)}return p.length=S,p}var u_=/"/g;function qE(t,r,e,n,i,a,o,s){for(var l=!0,c=[],f="",v=ri(e),x=r.s.c;x<=r.e.c;++x)if(n[x]){var p=s.dense?(t[e]||[])[x]:t[n[x]+v];if(p==null)f="";else if(p.v!=null){l=!1,f=""+(s.rawNumbers&&p.t=="n"?p.v:jo(p,null,s));for(var S=0,w=0;S!==f.length;++S)if((w=f.charCodeAt(S))===i||w===a||w===34||s.forceQuotes){f='"'+f.replace(u_,'""')+'"';break}f=="ID"&&(f='"ID"')}else p.f!=null&&!p.F?(l=!1,f="="+p.f,f.indexOf(",")>=0&&(f='"'+f.replace(u_,'""')+'"')):f="";c.push(f)}return s.blankrows===!1&&l?null:c.join(o)}function kp(t,r){var e=[],n=r??{};if(t==null||t["!ref"]==null)return"";var i=Gr(t["!ref"]),a=n.FS!==void 0?n.FS:",",o=a.charCodeAt(0),s=n.RS!==void 0?n.RS:`
`,l=s.charCodeAt(0),c=new RegExp((a=="|"?"\\|":a)+"+$"),f="",v=[];n.dense=Array.isArray(t);for(var x=n.skipHidden&&t["!cols"]||[],p=n.skipHidden&&t["!rows"]||[],S=i.s.c;S<=i.e.c;++S)(x[S]||{}).hidden||(v[S]=si(S));for(var w=0,k=i.s.r;k<=i.e.r;++k)(p[k]||{}).hidden||(f=qE(t,i,k,v,o,l,a,n),f!=null&&(n.strip&&(f=f.replace(c,"")),(f||n.blankrows!==!1)&&e.push((w++?s:"")+f)));return delete n.dense,e.join("")}function Bv(t,r){r||(r={}),r.FS="	",r.RS=`
`;var e=kp(t,r);if(typeof Lr>"u"||r.type=="string")return e;var n=Lr.utils.encode(1200,e,"str");return"\xFF\xFE"+n}function GE(t){var r="",e,n="";if(t==null||t["!ref"]==null)return[];var i=Gr(t["!ref"]),a="",o=[],s,l=[],c=Array.isArray(t);for(s=i.s.c;s<=i.e.c;++s)o[s]=si(s);for(var f=i.s.r;f<=i.e.r;++f)for(a=ri(f),s=i.s.c;s<=i.e.c;++s)if(r=o[s]+a,e=c?(t[f]||[])[s]:t[r],n="",e!==void 0){if(e.F!=null){if(r=e.F,!e.f)continue;n=e.f,r.indexOf(":")==-1&&(r=r+":"+r)}if(e.f!=null)n=e.f;else{if(e.t=="z")continue;if(e.t=="n"&&e.v!=null)n=""+e.v;else if(e.t=="b")n=e.v?"TRUE":"FALSE";else if(e.w!==void 0)n="'"+e.w;else{if(e.v===void 0)continue;e.t=="s"?n="'"+e.v:n=""+e.v}}l[l.length]=r+"="+n}return l}function Uv(t,r,e){var n=e||{},i=+!n.skipHeader,a=t||{},o=0,s=0;if(a&&n.origin!=null)if(typeof n.origin=="number")o=n.origin;else{var l=typeof n.origin=="string"?Hn(n.origin):n.origin;o=l.r,s=l.c}var c,f={s:{c:0,r:0},e:{c:s,r:o+r.length-1+i}};if(a["!ref"]){var v=Gr(a["!ref"]);f.e.c=Math.max(f.e.c,v.e.c),f.e.r=Math.max(f.e.r,v.e.r),o==-1&&(o=v.e.r+1,f.e.r=o+r.length-1+i)}else o==-1&&(o=0,f.e.r=r.length-1+i);var x=n.header||[],p=0;r.forEach(function(w,k){ni(w).forEach(function(O){(p=x.indexOf(O))==-1&&(x[p=x.length]=O);var H=w[O],q="z",X="",he=Ar({c:s+p,r:o+k+i});c=O0(a,he),H&&typeof H=="object"&&!(H instanceof Date)?a[he]=H:(typeof H=="number"?q="n":typeof H=="boolean"?q="b":typeof H=="string"?q="s":H instanceof Date?(q="d",n.cellDates||(q="n",H=Bi(H)),X=n.dateNF||ln[14]):H===null&&n.nullError&&(q="e",H=0),c?(c.t=q,c.v=H,delete c.w,delete c.R,X&&(c.z=X)):a[he]=c={t:q,v:H},X&&(c.z=X))})}),f.e.c=Math.max(f.e.c,s+x.length-1);var S=ri(o);if(i)for(p=0;p<x.length;++p)a[si(p+s)+S]={t:"s",v:x[p]};return a["!ref"]=kn(f),a}function $E(t,r){return Uv(null,t,r)}function O0(t,r,e){if(typeof r=="string"){if(Array.isArray(t)){var n=Hn(r);return t[n.r]||(t[n.r]=[]),t[n.r][n.c]||(t[n.r][n.c]={t:"z"})}return t[r]||(t[r]={t:"z"})}return typeof r!="number"?O0(t,Ar(r)):O0(t,Ar({r,c:e||0}))}function XE(t,r){if(typeof r=="number"){if(r>=0&&t.SheetNames.length>r)return r;throw new Error("Cannot find sheet # "+r)}else if(typeof r=="string"){var e=t.SheetNames.indexOf(r);if(e>-1)return e;throw new Error("Cannot find sheet name |"+r+"|")}else throw new Error("Cannot find sheet |"+r+"|")}function YE(){return{SheetNames:[],Sheets:{}}}function KE(t,r,e,n){var i=1;if(!e)for(;i<=65535&&t.SheetNames.indexOf(e="Sheet"+i)!=-1;++i,e=void 0);if(!e||t.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&t.SheetNames.indexOf(e)>=0){var a=e.match(/(^.*?)(\d+)$/);i=a&&+a[2]||0;var o=a&&a[1]||e;for(++i;i<=65535&&t.SheetNames.indexOf(e=o+i)!=-1;++i);}if(Pv(e),t.SheetNames.indexOf(e)>=0)throw new Error("Worksheet with name |"+e+"| already exists!");return t.SheetNames.push(e),t.Sheets[e]=r,e}function ZE(t,r,e){t.Workbook||(t.Workbook={}),t.Workbook.Sheets||(t.Workbook.Sheets=[]);var n=XE(t,r);switch(t.Workbook.Sheets[n]||(t.Workbook.Sheets[n]={}),e){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+e)}t.Workbook.Sheets[n].Hidden=e}function JE(t,r){return t.z=r,t}function Vv(t,r,e){return r?(t.l={Target:r},e&&(t.l.Tooltip=e)):delete t.l,t}function QE(t,r,e){return Vv(t,"#"+r,e)}function e6(t,r,e){t.c||(t.c=[]),t.c.push({t:r,a:e||"SheetJS"})}function t6(t,r,e,n){for(var i=typeof r!="string"?r:Gr(r),a=typeof r=="string"?r:kn(r),o=i.s.r;o<=i.e.r;++o)for(var s=i.s.c;s<=i.e.c;++s){var l=O0(t,o,s);l.t="n",l.F=a,delete l.v,o==i.s.r&&s==i.s.c&&(l.f=e,n&&(l.D=!0))}return t}var lo={encode_col:si,encode_row:ri,encode_cell:Ar,encode_range:kn,decode_col:pp,decode_row:hp,split_cell:gy,decode_cell:Hn,decode_range:ra,format_cell:jo,sheet_add_aoa:V_,sheet_add_json:Uv,sheet_add_dom:Fv,aoa_to_sheet:fc,json_to_sheet:$E,table_to_sheet:Dv,table_to_book:kE,sheet_to_csv:kp,sheet_to_txt:Bv,sheet_to_json:Ef,sheet_to_html:Iv,sheet_to_formulae:GE,sheet_to_row_object_array:Ef,sheet_get_cell:O0,book_new:YE,book_append_sheet:KE,book_set_sheet_visibility:ZE,cell_set_number_format:JE,cell_set_hyperlink:Vv,cell_set_internal_link:QE,cell_add_comment:e6,sheet_set_array_formula:t6,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};var qN=C0.version;var Ha=Uint8Array,na=Uint16Array,Ap=Int32Array,Tp=new Ha([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),Ip=new Ha([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),jv=new Ha([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Gv=function(t,r){for(var e=new na(31),n=0;n<31;++n)e[n]=r+=1<<t[n-1];for(var i=new Ap(e[30]),n=1;n<30;++n)for(var a=e[n];a<e[n+1];++a)i[a]=a-e[n]<<5|n;return{b:e,r:i}},$v=Gv(Tp,2),r6=$v.b,Mp=$v.r;r6[28]=258,Mp[258]=28;var Xv=Gv(Ip,0),GN=Xv.b,Hv=Xv.r,Pp=new na(32768);for(xr=0;xr<32768;++xr)Wo=(xr&43690)>>1|(xr&21845)<<1,Wo=(Wo&52428)>>2|(Wo&13107)<<2,Wo=(Wo&61680)>>4|(Wo&3855)<<4,Pp[xr]=((Wo&65280)>>8|(Wo&255)<<8)>>1;var Wo,xr,L0=function(t,r,e){for(var n=t.length,i=0,a=new na(r);i<n;++i)t[i]&&++a[t[i]-1];var o=new na(r);for(i=1;i<r;++i)o[i]=o[i-1]+a[i-1]<<1;var s;if(e){s=new na(1<<r);var l=15-r;for(i=0;i<n;++i)if(t[i])for(var c=i<<4|t[i],f=r-t[i],v=o[t[i]-1]++<<f,x=v|(1<<f)-1;v<=x;++v)s[Pp[v]>>l]=c}else for(s=new na(n),i=0;i<n;++i)t[i]&&(s[i]=Pp[o[t[i]-1]++]>>15-t[i]);return s},yl=new Ha(288);for(xr=0;xr<144;++xr)yl[xr]=8;var xr;for(xr=144;xr<256;++xr)yl[xr]=9;var xr;for(xr=256;xr<280;++xr)yl[xr]=7;var xr;for(xr=280;xr<288;++xr)yl[xr]=8;var xr,Lf=new Ha(32);for(xr=0;xr<32;++xr)Lf[xr]=5;var xr,n6=L0(yl,9,0);var i6=L0(Lf,5,0);var Yv=function(t){return(t+7)/8|0},a6=function(t,r,e){return(r==null||r<0)&&(r=0),(e==null||e>t.length)&&(e=t.length),new Ha(t.subarray(r,e))};var qo=function(t,r,e){e<<=r&7;var n=r/8|0;t[n]|=e,t[n+1]|=e>>8},N0=function(t,r,e){e<<=r&7;var n=r/8|0;t[n]|=e,t[n+1]|=e>>8,t[n+2]|=e>>16},Ep=function(t,r){for(var e=[],n=0;n<t.length;++n)t[n]&&e.push({s:n,f:t[n]});var i=e.length,a=e.slice();if(!i)return{t:Zv,l:0};if(i==1){var o=new Ha(e[0].s+1);return o[e[0].s]=1,{t:o,l:1}}e.sort(function(he,ke){return he.f-ke.f}),e.push({s:-1,f:25001});var s=e[0],l=e[1],c=0,f=1,v=2;for(e[0]={s:-1,f:s.f+l.f,l:s,r:l};f!=i-1;)s=e[e[c].f<e[v].f?c++:v++],l=e[c!=f&&e[c].f<e[v].f?c++:v++],e[f++]={s:-1,f:s.f+l.f,l:s,r:l};for(var x=a[0].s,n=1;n<i;++n)a[n].s>x&&(x=a[n].s);var p=new na(x+1),S=Op(e[f-1],p,0);if(S>r){var n=0,w=0,k=S-r,O=1<<k;for(a.sort(function(ke,re){return p[re.s]-p[ke.s]||ke.f-re.f});n<i;++n){var H=a[n].s;if(p[H]>r)w+=O-(1<<S-p[H]),p[H]=r;else break}for(w>>=k;w>0;){var q=a[n].s;p[q]<r?w-=1<<r-p[q]++-1:++n}for(;n>=0&&w;--n){var X=a[n].s;p[X]==r&&(--p[X],++w)}S=r}return{t:new Ha(p),l:S}},Op=function(t,r,e){return t.s==-1?Math.max(Op(t.l,r,e+1),Op(t.r,r,e+1)):r[t.s]=e},Wv=function(t){for(var r=t.length;r&&!t[--r];);for(var e=new na(++r),n=0,i=t[0],a=1,o=function(l){e[n++]=l},s=1;s<=r;++s)if(t[s]==i&&s!=r)++a;else{if(!i&&a>2){for(;a>138;a-=138)o(32754);a>2&&(o(a>10?a-11<<5|28690:a-3<<5|12305),a=0)}else if(a>3){for(o(i),--a;a>6;a-=6)o(8304);a>2&&(o(a-3<<5|8208),a=0)}for(;a--;)o(i);a=1,i=t[s]}return{c:e.subarray(0,n),n:r}},R0=function(t,r){for(var e=0,n=0;n<r.length;++n)e+=t[n]*r[n];return e},Kv=function(t,r,e){var n=e.length,i=Yv(r+2);t[i]=n&255,t[i+1]=n>>8,t[i+2]=t[i]^255,t[i+3]=t[i+1]^255;for(var a=0;a<n;++a)t[i+a+4]=e[a];return(i+4+n)*8},qv=function(t,r,e,n,i,a,o,s,l,c,f){qo(r,f++,e),++i[256];for(var v=Ep(i,15),x=v.t,p=v.l,S=Ep(a,15),w=S.t,k=S.l,O=Wv(x),H=O.c,q=O.n,X=Wv(w),he=X.c,ke=X.n,re=new na(19),ee=0;ee<H.length;++ee)++re[H[ee]&31];for(var ee=0;ee<he.length;++ee)++re[he[ee]&31];for(var W=Ep(re,7),ae=W.t,A=W.l,V=19;V>4&&!ae[jv[V-1]];--V);var de=c+5<<3,ue=R0(i,yl)+R0(a,Lf)+o,xe=R0(i,x)+R0(a,w)+o+14+3*V+R0(re,ae)+2*re[16]+3*re[17]+7*re[18];if(l>=0&&de<=ue&&de<=xe)return Kv(r,f,t.subarray(l,l+c));var Ne,Re,Ee,Be;if(qo(r,f,1+(xe<ue)),f+=2,xe<ue){Ne=L0(x,p,0),Re=x,Ee=L0(w,k,0),Be=w;var Je=L0(ae,A,0);qo(r,f,q-257),qo(r,f+5,ke-1),qo(r,f+10,V-4),f+=14;for(var ee=0;ee<V;++ee)qo(r,f+3*ee,ae[jv[ee]]);f+=3*V;for(var qe=[H,he],E=0;E<2;++E)for(var U=qe[E],ee=0;ee<U.length;++ee){var T=U[ee]&31;qo(r,f,Je[T]),f+=ae[T],T>15&&(qo(r,f,U[ee]>>5&127),f+=U[ee]>>12)}}else Ne=n6,Re=yl,Ee=i6,Be=Lf;for(var ee=0;ee<s;++ee){var R=n[ee];if(R>255){var T=R>>18&31;N0(r,f,Ne[T+257]),f+=Re[T+257],T>7&&(qo(r,f,R>>23&31),f+=Tp[T]);var te=R&31;N0(r,f,Ee[te]),f+=Be[te],te>3&&(N0(r,f,R>>5&8191),f+=Ip[te])}else N0(r,f,Ne[R]),f+=Re[R]}return N0(r,f,Ne[256]),f+Re[256]},o6=new Ap([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),Zv=new Ha(0),s6=function(t,r,e,n,i,a){var o=a.z||t.length,s=new Ha(n+o+5*(1+Math.ceil(o/7e3))+i),l=s.subarray(n,s.length-i),c=a.l,f=(a.r||0)&7;if(r){f&&(l[0]=a.r>>3);for(var v=o6[r-1],x=v>>13,p=v&8191,S=(1<<e)-1,w=a.p||new na(32768),k=a.h||new na(S+1),O=Math.ceil(e/3),H=2*O,q=function(at){return(t[at]^t[at+1]<<O^t[at+2]<<H)&S},X=new Ap(25e3),he=new na(288),ke=new na(32),re=0,ee=0,W=a.i||0,ae=0,A=a.w||0,V=0;W+2<o;++W){var de=q(W),ue=W&32767,xe=k[de];if(w[ue]=xe,k[de]=ue,A<=W){var Ne=o-W;if((re>7e3||ae>24576)&&(Ne>423||!c)){f=qv(t,l,0,X,he,ke,ee,ae,V,W-V,f),ae=re=ee=0,V=W;for(var Re=0;Re<286;++Re)he[Re]=0;for(var Re=0;Re<30;++Re)ke[Re]=0}var Ee=2,Be=0,Je=p,qe=ue-xe&32767;if(Ne>2&&de==q(W-qe))for(var E=Math.min(x,Ne)-1,U=Math.min(32767,W),T=Math.min(258,Ne);qe<=U&&--Je&&ue!=xe;){if(t[W+Ee]==t[W+Ee-qe]){for(var R=0;R<T&&t[W+R]==t[W+R-qe];++R);if(R>Ee){if(Ee=R,Be=qe,R>E)break;for(var te=Math.min(qe,R-2),pe=0,Re=0;Re<te;++Re){var ye=W-qe+Re&32767,ve=w[ye],_e=ye-ve&32767;_e>pe&&(pe=_e,xe=ye)}}}ue=xe,xe=w[ue],qe+=ue-xe&32767}if(Be){X[ae++]=268435456|Mp[Ee]<<18|Hv[Be];var He=Mp[Ee]&31,Ye=Hv[Be]&31;ee+=Tp[He]+Ip[Ye],++he[257+He],++ke[Ye],A=W+Ee,++re}else X[ae++]=t[W],++he[t[W]]}}for(W=Math.max(W,A);W<o;++W)X[ae++]=t[W],++he[t[W]];f=qv(t,l,c,X,he,ke,ee,ae,V,W-V,f),c||(a.r=f&7|l[f/8|0]<<3,f-=7,a.h=k,a.p=w,a.i=W,a.w=A)}else{for(var W=a.w||0;W<o+c;W+=65535){var nt=W+65535;nt>=o&&(l[f/8|0]=c,nt=o),f=Kv(l,f+1,t.subarray(W,nt))}a.i=o}return a6(s,0,n+Yv(f)+i)};var Jv=function(){var t=1,r=0;return{p:function(e){for(var n=t,i=r,a=e.length|0,o=0;o!=a;){for(var s=Math.min(o+2655,a);o<s;++o)i+=n+=e[o];n=(n&65535)+15*(n>>16),i=(i&65535)+15*(i>>16)}t=n,r=i},d:function(){return t%=65521,r%=65521,(t&255)<<24|(t&65280)<<8|(r&255)<<8|r>>8}}},l6=function(t,r,e,n,i){if(!i&&(i={l:1},r.dictionary)){var a=r.dictionary.subarray(-32768),o=new Ha(a.length+t.length);o.set(a),o.set(t,a.length),t=o,i.w=a.length}return s6(t,r.level==null?6:r.level,r.mem==null?i.l?Math.ceil(Math.max(8,Math.min(13,Math.log(t.length)))*1.5):20:12+r.mem,e,n,i)};var Qv=function(t,r,e){for(;e;++r)t[r]=e,e>>>=8};var c6=function(t,r){var e=r.level,n=e==0?0:e<6?1:e==9?3:2;if(t[0]=120,t[1]=n<<6|(r.dictionary&&32),t[1]|=31-(t[0]<<8|t[1])%31,r.dictionary){var i=Jv();i.p(r.dictionary),Qv(t,2,i.d())}};function Bf(t,r){r||(r={});var e=Jv();e.p(t);var n=l6(t,r,r.dictionary?6:2,4);return c6(n,r),Qv(n,n.length-4,e.d()),n}var d6=typeof TextDecoder<"u"&&new TextDecoder,f6=0;try{d6.decode(Zv,{stream:!0}),f6=1}catch{}function e2(t){if(Array.isArray(t))return t}function t2(t,r){var e=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(e!=null){var n,i,a,o,s=[],l=!0,c=!1;try{if(a=(e=e.call(t)).next,r===0){if(Object(e)!==e)return;l=!1}else for(;!(l=(n=a.call(e)).done)&&(s.push(n.value),s.length!==r);l=!0);}catch(f){c=!0,i=f}finally{try{if(!l&&e.return!=null&&(o=e.return(),Object(o)!==o))return}finally{if(c)throw i}}return s}}function Fp(t,r){(r==null||r>t.length)&&(r=t.length);for(var e=0,n=Array(r);e<r;e++)n[e]=t[e];return n}function r2(t,r){if(t){if(typeof t=="string")return Fp(t,r);var e={}.toString.call(t).slice(8,-1);return e==="Object"&&t.constructor&&(e=t.constructor.name),e==="Map"||e==="Set"?Array.from(t):e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?Fp(t,r):void 0}}function n2(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Dp(t,r){return e2(t)||t2(t,r)||r2(t,r)||n2()}function Np(t,r="utf8"){return new TextDecoder(r).decode(t)}var u6=new TextEncoder;function i2(t){return u6.encode(t)}var h6=1024*8,p6=(()=>{let t=new Uint8Array(4),r=new Uint32Array(t.buffer);return!((r[0]=1)&t[0])})(),Rp={int8:globalThis.Int8Array,uint8:globalThis.Uint8Array,int16:globalThis.Int16Array,uint16:globalThis.Uint16Array,int32:globalThis.Int32Array,uint32:globalThis.Uint32Array,uint64:globalThis.BigUint64Array,int64:globalThis.BigInt64Array,float32:globalThis.Float32Array,float64:globalThis.Float64Array},B0=class t{buffer;byteLength;byteOffset;length;offset;lastWrittenByte;littleEndian;_data;_mark;_marks;constructor(r=h6,e={}){let n=!1;typeof r=="number"?r=new ArrayBuffer(r):(n=!0,this.lastWrittenByte=r.byteLength);let i=e.offset?e.offset>>>0:0,a=r.byteLength-i,o=i;(ArrayBuffer.isView(r)||r instanceof t)&&(r.byteLength!==r.buffer.byteLength&&(o=r.byteOffset+i),r=r.buffer),n?this.lastWrittenByte=a:this.lastWrittenByte=0,this.buffer=r,this.length=a,this.byteLength=a,this.byteOffset=o,this.offset=0,this.littleEndian=!0,this._data=new DataView(this.buffer,o,a),this._mark=0,this._marks=[]}available(r=1){return this.offset+r<=this.length}isLittleEndian(){return this.littleEndian}setLittleEndian(){return this.littleEndian=!0,this}isBigEndian(){return!this.littleEndian}setBigEndian(){return this.littleEndian=!1,this}skip(r=1){return this.offset+=r,this}back(r=1){return this.offset-=r,this}seek(r){return this.offset=r,this}mark(){return this._mark=this.offset,this}reset(){return this.offset=this._mark,this}pushMark(){return this._marks.push(this.offset),this}popMark(){let r=this._marks.pop();if(r===void 0)throw new Error("Mark stack empty");return this.seek(r),this}rewind(){return this.offset=0,this}ensureAvailable(r=1){if(!this.available(r)){let n=(this.offset+r)*2,i=new Uint8Array(n);i.set(new Uint8Array(this.buffer)),this.buffer=i.buffer,this.length=n,this.byteLength=n,this._data=new DataView(this.buffer)}return this}readBoolean(){return this.readUint8()!==0}readInt8(){return this._data.getInt8(this.offset++)}readUint8(){return this._data.getUint8(this.offset++)}readByte(){return this.readUint8()}readBytes(r=1){return this.readArray(r,"uint8")}readArray(r,e){let n=Rp[e].BYTES_PER_ELEMENT*r,i=this.byteOffset+this.offset,a=this.buffer.slice(i,i+n);if(this.littleEndian===p6&&e!=="uint8"&&e!=="int8"){let s=new Uint8Array(this.buffer.slice(i,i+n));s.reverse();let l=new Rp[e](s.buffer);return this.offset+=n,l.reverse(),l}let o=new Rp[e](a);return this.offset+=n,o}readInt16(){let r=this._data.getInt16(this.offset,this.littleEndian);return this.offset+=2,r}readUint16(){let r=this._data.getUint16(this.offset,this.littleEndian);return this.offset+=2,r}readInt32(){let r=this._data.getInt32(this.offset,this.littleEndian);return this.offset+=4,r}readUint32(){let r=this._data.getUint32(this.offset,this.littleEndian);return this.offset+=4,r}readFloat32(){let r=this._data.getFloat32(this.offset,this.littleEndian);return this.offset+=4,r}readFloat64(){let r=this._data.getFloat64(this.offset,this.littleEndian);return this.offset+=8,r}readBigInt64(){let r=this._data.getBigInt64(this.offset,this.littleEndian);return this.offset+=8,r}readBigUint64(){let r=this._data.getBigUint64(this.offset,this.littleEndian);return this.offset+=8,r}readChar(){return String.fromCharCode(this.readInt8())}readChars(r=1){let e="";for(let n=0;n<r;n++)e+=this.readChar();return e}readUtf8(r=1){return Np(this.readBytes(r))}decodeText(r=1,e="utf8"){return Np(this.readBytes(r),e)}writeBoolean(r){return this.writeUint8(r?255:0),this}writeInt8(r){return this.ensureAvailable(1),this._data.setInt8(this.offset++,r),this._updateLastWrittenByte(),this}writeUint8(r){return this.ensureAvailable(1),this._data.setUint8(this.offset++,r),this._updateLastWrittenByte(),this}writeByte(r){return this.writeUint8(r)}writeBytes(r){this.ensureAvailable(r.length);for(let e=0;e<r.length;e++)this._data.setUint8(this.offset++,r[e]);return this._updateLastWrittenByte(),this}writeInt16(r){return this.ensureAvailable(2),this._data.setInt16(this.offset,r,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeUint16(r){return this.ensureAvailable(2),this._data.setUint16(this.offset,r,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeInt32(r){return this.ensureAvailable(4),this._data.setInt32(this.offset,r,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeUint32(r){return this.ensureAvailable(4),this._data.setUint32(this.offset,r,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat32(r){return this.ensureAvailable(4),this._data.setFloat32(this.offset,r,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat64(r){return this.ensureAvailable(8),this._data.setFloat64(this.offset,r,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigInt64(r){return this.ensureAvailable(8),this._data.setBigInt64(this.offset,r,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigUint64(r){return this.ensureAvailable(8),this._data.setBigUint64(this.offset,r,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeChar(r){return this.writeUint8(r.charCodeAt(0))}writeChars(r){for(let e=0;e<r.length;e++)this.writeUint8(r.charCodeAt(e));return this}writeUtf8(r){return this.writeBytes(i2(r))}toArray(){return new Uint8Array(this.buffer,this.byteOffset,this.lastWrittenByte)}getWrittenByteLength(){return this.lastWrittenByte-this.byteOffset}_updateLastWrittenByte(){this.offset>this.lastWrittenByte&&(this.lastWrittenByte=this.offset)}};function xc(t){let r=t.length;for(;--r>=0;)t[r]=0}var m6=0,H2=1,g6=2,_6=3,v6=258,om=29,Q0=256,q0=Q0+1+om,gc=30,sm=19,W2=2*q0+1,Cl=15,Lp=16,x6=7,lm=256,q2=16,G2=17,$2=18,Zp=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),Wf=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),b6=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),X2=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),w6=512,$o=new Array((q0+2)*2);xc($o);var j0=new Array(gc*2);xc(j0);var G0=new Array(w6);xc(G0);var $0=new Array(v6-_6+1);xc($0);var cm=new Array(om);xc(cm);var qf=new Array(gc);xc(qf);function Bp(t,r,e,n,i){this.static_tree=t,this.extra_bits=r,this.extra_base=e,this.elems=n,this.max_length=i,this.has_stree=t&&t.length}var Y2,K2,Z2;function Up(t,r){this.dyn_tree=t,this.max_code=0,this.stat_desc=r}var J2=t=>t<256?G0[t]:G0[256+(t>>>7)],X0=(t,r)=>{t.pending_buf[t.pending++]=r&255,t.pending_buf[t.pending++]=r>>>8&255},Vi=(t,r,e)=>{t.bi_valid>Lp-e?(t.bi_buf|=r<<t.bi_valid&65535,X0(t,t.bi_buf),t.bi_buf=r>>Lp-t.bi_valid,t.bi_valid+=e-Lp):(t.bi_buf|=r<<t.bi_valid&65535,t.bi_valid+=e)},fo=(t,r,e)=>{Vi(t,e[r*2],e[r*2+1])},Q2=(t,r)=>{let e=0;do e|=t&1,t>>>=1,e<<=1;while(--r>0);return e>>>1},y6=t=>{t.bi_valid===16?(X0(t,t.bi_buf),t.bi_buf=0,t.bi_valid=0):t.bi_valid>=8&&(t.pending_buf[t.pending++]=t.bi_buf&255,t.bi_buf>>=8,t.bi_valid-=8)},C6=(t,r)=>{let e=r.dyn_tree,n=r.max_code,i=r.stat_desc.static_tree,a=r.stat_desc.has_stree,o=r.stat_desc.extra_bits,s=r.stat_desc.extra_base,l=r.stat_desc.max_length,c,f,v,x,p,S,w=0;for(x=0;x<=Cl;x++)t.bl_count[x]=0;for(e[t.heap[t.heap_max]*2+1]=0,c=t.heap_max+1;c<W2;c++)f=t.heap[c],x=e[e[f*2+1]*2+1]+1,x>l&&(x=l,w++),e[f*2+1]=x,!(f>n)&&(t.bl_count[x]++,p=0,f>=s&&(p=o[f-s]),S=e[f*2],t.opt_len+=S*(x+p),a&&(t.static_len+=S*(i[f*2+1]+p)));if(w!==0){do{for(x=l-1;t.bl_count[x]===0;)x--;t.bl_count[x]--,t.bl_count[x+1]+=2,t.bl_count[l]--,w-=2}while(w>0);for(x=l;x!==0;x--)for(f=t.bl_count[x];f!==0;)v=t.heap[--c],!(v>n)&&(e[v*2+1]!==x&&(t.opt_len+=(x-e[v*2+1])*e[v*2],e[v*2+1]=x),f--)}},ex=(t,r,e)=>{let n=new Array(Cl+1),i=0,a,o;for(a=1;a<=Cl;a++)i=i+e[a-1]<<1,n[a]=i;for(o=0;o<=r;o++){let s=t[o*2+1];s!==0&&(t[o*2]=Q2(n[s]++,s))}},S6=()=>{let t,r,e,n,i,a=new Array(Cl+1);for(e=0,n=0;n<om-1;n++)for(cm[n]=e,t=0;t<1<<Zp[n];t++)$0[e++]=n;for($0[e-1]=n,i=0,n=0;n<16;n++)for(qf[n]=i,t=0;t<1<<Wf[n];t++)G0[i++]=n;for(i>>=7;n<gc;n++)for(qf[n]=i<<7,t=0;t<1<<Wf[n]-7;t++)G0[256+i++]=n;for(r=0;r<=Cl;r++)a[r]=0;for(t=0;t<=143;)$o[t*2+1]=8,t++,a[8]++;for(;t<=255;)$o[t*2+1]=9,t++,a[9]++;for(;t<=279;)$o[t*2+1]=7,t++,a[7]++;for(;t<=287;)$o[t*2+1]=8,t++,a[8]++;for(ex($o,q0+1,a),t=0;t<gc;t++)j0[t*2+1]=5,j0[t*2]=Q2(t,5);Y2=new Bp($o,Zp,Q0+1,q0,Cl),K2=new Bp(j0,Wf,0,gc,Cl),Z2=new Bp(new Array(0),b6,0,sm,x6)},tx=t=>{let r;for(r=0;r<q0;r++)t.dyn_ltree[r*2]=0;for(r=0;r<gc;r++)t.dyn_dtree[r*2]=0;for(r=0;r<sm;r++)t.bl_tree[r*2]=0;t.dyn_ltree[lm*2]=1,t.opt_len=t.static_len=0,t.sym_next=t.matches=0},rx=t=>{t.bi_valid>8?X0(t,t.bi_buf):t.bi_valid>0&&(t.pending_buf[t.pending++]=t.bi_buf),t.bi_buf=0,t.bi_valid=0},a2=(t,r,e,n)=>{let i=r*2,a=e*2;return t[i]<t[a]||t[i]===t[a]&&n[r]<=n[e]},Vp=(t,r,e)=>{let n=t.heap[e],i=e<<1;for(;i<=t.heap_len&&(i<t.heap_len&&a2(r,t.heap[i+1],t.heap[i],t.depth)&&i++,!a2(r,n,t.heap[i],t.depth));)t.heap[e]=t.heap[i],e=i,i<<=1;t.heap[e]=n},o2=(t,r,e)=>{let n,i,a=0,o,s;if(t.sym_next!==0)do n=t.pending_buf[t.sym_buf+a++]&255,n+=(t.pending_buf[t.sym_buf+a++]&255)<<8,i=t.pending_buf[t.sym_buf+a++],n===0?fo(t,i,r):(o=$0[i],fo(t,o+Q0+1,r),s=Zp[o],s!==0&&(i-=cm[o],Vi(t,i,s)),n--,o=J2(n),fo(t,o,e),s=Wf[o],s!==0&&(n-=qf[o],Vi(t,n,s)));while(a<t.sym_next);fo(t,lm,r)},Jp=(t,r)=>{let e=r.dyn_tree,n=r.stat_desc.static_tree,i=r.stat_desc.has_stree,a=r.stat_desc.elems,o,s,l=-1,c;for(t.heap_len=0,t.heap_max=W2,o=0;o<a;o++)e[o*2]!==0?(t.heap[++t.heap_len]=l=o,t.depth[o]=0):e[o*2+1]=0;for(;t.heap_len<2;)c=t.heap[++t.heap_len]=l<2?++l:0,e[c*2]=1,t.depth[c]=0,t.opt_len--,i&&(t.static_len-=n[c*2+1]);for(r.max_code=l,o=t.heap_len>>1;o>=1;o--)Vp(t,e,o);c=a;do o=t.heap[1],t.heap[1]=t.heap[t.heap_len--],Vp(t,e,1),s=t.heap[1],t.heap[--t.heap_max]=o,t.heap[--t.heap_max]=s,e[c*2]=e[o*2]+e[s*2],t.depth[c]=(t.depth[o]>=t.depth[s]?t.depth[o]:t.depth[s])+1,e[o*2+1]=e[s*2+1]=c,t.heap[1]=c++,Vp(t,e,1);while(t.heap_len>=2);t.heap[--t.heap_max]=t.heap[1],C6(t,r),ex(e,l,t.bl_count)},s2=(t,r,e)=>{let n,i=-1,a,o=r[1],s=0,l=7,c=4;for(o===0&&(l=138,c=3),r[(e+1)*2+1]=65535,n=0;n<=e;n++)a=o,o=r[(n+1)*2+1],!(++s<l&&a===o)&&(s<c?t.bl_tree[a*2]+=s:a!==0?(a!==i&&t.bl_tree[a*2]++,t.bl_tree[q2*2]++):s<=10?t.bl_tree[G2*2]++:t.bl_tree[$2*2]++,s=0,i=a,o===0?(l=138,c=3):a===o?(l=6,c=3):(l=7,c=4))},l2=(t,r,e)=>{let n,i=-1,a,o=r[1],s=0,l=7,c=4;for(o===0&&(l=138,c=3),n=0;n<=e;n++)if(a=o,o=r[(n+1)*2+1],!(++s<l&&a===o)){if(s<c)do fo(t,a,t.bl_tree);while(--s!==0);else a!==0?(a!==i&&(fo(t,a,t.bl_tree),s--),fo(t,q2,t.bl_tree),Vi(t,s-3,2)):s<=10?(fo(t,G2,t.bl_tree),Vi(t,s-3,3)):(fo(t,$2,t.bl_tree),Vi(t,s-11,7));s=0,i=a,o===0?(l=138,c=3):a===o?(l=6,c=3):(l=7,c=4)}},k6=t=>{let r;for(s2(t,t.dyn_ltree,t.l_desc.max_code),s2(t,t.dyn_dtree,t.d_desc.max_code),Jp(t,t.bl_desc),r=sm-1;r>=3&&t.bl_tree[X2[r]*2+1]===0;r--);return t.opt_len+=3*(r+1)+5+5+4,r},E6=(t,r,e,n)=>{let i;for(Vi(t,r-257,5),Vi(t,e-1,5),Vi(t,n-4,4),i=0;i<n;i++)Vi(t,t.bl_tree[X2[i]*2+1],3);l2(t,t.dyn_ltree,r-1),l2(t,t.dyn_dtree,e-1)},M6=t=>{let r=4093624447,e;for(e=0;e<=31;e++,r>>>=1)if(r&1&&t.dyn_ltree[e*2]!==0)return 0;if(t.dyn_ltree[18]!==0||t.dyn_ltree[20]!==0||t.dyn_ltree[26]!==0)return 1;for(e=32;e<Q0;e++)if(t.dyn_ltree[e*2]!==0)return 1;return 0},c2=!1,P6=t=>{c2||(S6(),c2=!0),t.l_desc=new Up(t.dyn_ltree,Y2),t.d_desc=new Up(t.dyn_dtree,K2),t.bl_desc=new Up(t.bl_tree,Z2),t.bi_buf=0,t.bi_valid=0,tx(t)},nx=(t,r,e,n)=>{Vi(t,(m6<<1)+(n?1:0),3),rx(t),X0(t,e),X0(t,~e),e&&t.pending_buf.set(t.window.subarray(r,r+e),t.pending),t.pending+=e},O6=t=>{Vi(t,H2<<1,3),fo(t,lm,$o),y6(t)},A6=(t,r,e,n)=>{let i,a,o=0;t.level>0?(t.strm.data_type===2&&(t.strm.data_type=M6(t)),Jp(t,t.l_desc),Jp(t,t.d_desc),o=k6(t),i=t.opt_len+3+7>>>3,a=t.static_len+3+7>>>3,a<=i&&(i=a)):i=a=e+5,e+4<=i&&r!==-1?nx(t,r,e,n):t.strategy===4||a===i?(Vi(t,(H2<<1)+(n?1:0),3),o2(t,$o,j0)):(Vi(t,(g6<<1)+(n?1:0),3),E6(t,t.l_desc.max_code+1,t.d_desc.max_code+1,o+1),o2(t,t.dyn_ltree,t.dyn_dtree)),tx(t),n&&rx(t)},T6=(t,r,e)=>(t.pending_buf[t.sym_buf+t.sym_next++]=r,t.pending_buf[t.sym_buf+t.sym_next++]=r>>8,t.pending_buf[t.sym_buf+t.sym_next++]=e,r===0?t.dyn_ltree[e*2]++:(t.matches++,r--,t.dyn_ltree[($0[e]+Q0+1)*2]++,t.dyn_dtree[J2(r)*2]++),t.sym_next===t.sym_end),I6=P6,F6=nx,D6=A6,N6=T6,R6=O6,L6={_tr_init:I6,_tr_stored_block:F6,_tr_flush_block:D6,_tr_tally:N6,_tr_align:R6},B6=(t,r,e,n)=>{let i=t&65535|0,a=t>>>16&65535|0,o=0;for(;e!==0;){o=e>2e3?2e3:e,e-=o;do i=i+r[n++]|0,a=a+i|0;while(--o);i%=65521,a%=65521}return i|a<<16|0},Y0=B6,U6=()=>{let t,r=[];for(var e=0;e<256;e++){t=e;for(var n=0;n<8;n++)t=t&1?3988292384^t>>>1:t>>>1;r[e]=t}return r},V6=new Uint32Array(U6()),z6=(t,r,e,n)=>{let i=V6,a=n+e;t^=-1;for(let o=n;o<a;o++)t=t>>>8^i[(t^r[o])&255];return t^-1},qn=z6,El={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},bc={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8},{_tr_init:j6,_tr_stored_block:Qp,_tr_flush_block:H6,_tr_tally:Rs,_tr_align:W6}=L6,{Z_NO_FLUSH:Ls,Z_PARTIAL_FLUSH:q6,Z_FULL_FLUSH:G6,Z_FINISH:ka,Z_BLOCK:d2,Z_OK:ii,Z_STREAM_END:f2,Z_STREAM_ERROR:uo,Z_DATA_ERROR:$6,Z_BUF_ERROR:zp,Z_DEFAULT_COMPRESSION:X6,Z_FILTERED:Y6,Z_HUFFMAN_ONLY:Uf,Z_RLE:K6,Z_FIXED:Z6,Z_DEFAULT_STRATEGY:J6,Z_UNKNOWN:Q6,Z_DEFLATED:Xf}=bc,eM=9,tM=15,rM=8,nM=29,iM=256,em=iM+1+nM,aM=30,oM=19,sM=2*em+1,lM=15,cr=3,Ns=258,ho=Ns+cr+1,cM=32,_c=42,dm=57,tm=69,rm=73,nm=91,im=103,Sl=113,V0=666,wi=1,wc=2,Ml=3,yc=4,dM=3,kl=(t,r)=>(t.msg=El[r],r),u2=t=>t*2-(t>4?9:0),Ds=t=>{let r=t.length;for(;--r>=0;)t[r]=0},fM=t=>{let r,e,n,i=t.w_size;r=t.hash_size,n=r;do e=t.head[--n],t.head[n]=e>=i?e-i:0;while(--r);r=i,n=r;do e=t.prev[--n],t.prev[n]=e>=i?e-i:0;while(--r)},uM=(t,r,e)=>(r<<t.hash_shift^e)&t.hash_mask,Bs=uM,ia=t=>{let r=t.state,e=r.pending;e>t.avail_out&&(e=t.avail_out),e!==0&&(t.output.set(r.pending_buf.subarray(r.pending_out,r.pending_out+e),t.next_out),t.next_out+=e,r.pending_out+=e,t.total_out+=e,t.avail_out-=e,r.pending-=e,r.pending===0&&(r.pending_out=0))},aa=(t,r)=>{H6(t,t.block_start>=0?t.block_start:-1,t.strstart-t.block_start,r),t.block_start=t.strstart,ia(t.strm)},br=(t,r)=>{t.pending_buf[t.pending++]=r},U0=(t,r)=>{t.pending_buf[t.pending++]=r>>>8&255,t.pending_buf[t.pending++]=r&255},am=(t,r,e,n)=>{let i=t.avail_in;return i>n&&(i=n),i===0?0:(t.avail_in-=i,r.set(t.input.subarray(t.next_in,t.next_in+i),e),t.state.wrap===1?t.adler=Y0(t.adler,r,i,e):t.state.wrap===2&&(t.adler=qn(t.adler,r,i,e)),t.next_in+=i,t.total_in+=i,i)},ix=(t,r)=>{let e=t.max_chain_length,n=t.strstart,i,a,o=t.prev_length,s=t.nice_match,l=t.strstart>t.w_size-ho?t.strstart-(t.w_size-ho):0,c=t.window,f=t.w_mask,v=t.prev,x=t.strstart+Ns,p=c[n+o-1],S=c[n+o];t.prev_length>=t.good_match&&(e>>=2),s>t.lookahead&&(s=t.lookahead);do if(i=r,!(c[i+o]!==S||c[i+o-1]!==p||c[i]!==c[n]||c[++i]!==c[n+1])){n+=2,i++;do;while(c[++n]===c[++i]&&c[++n]===c[++i]&&c[++n]===c[++i]&&c[++n]===c[++i]&&c[++n]===c[++i]&&c[++n]===c[++i]&&c[++n]===c[++i]&&c[++n]===c[++i]&&n<x);if(a=Ns-(x-n),n=x-Ns,a>o){if(t.match_start=r,o=a,a>=s)break;p=c[n+o-1],S=c[n+o]}}while((r=v[r&f])>l&&--e!==0);return o<=t.lookahead?o:t.lookahead},vc=t=>{let r=t.w_size,e,n,i;do{if(n=t.window_size-t.lookahead-t.strstart,t.strstart>=r+(r-ho)&&(t.window.set(t.window.subarray(r,r+r-n),0),t.match_start-=r,t.strstart-=r,t.block_start-=r,t.insert>t.strstart&&(t.insert=t.strstart),fM(t),n+=r),t.strm.avail_in===0)break;if(e=am(t.strm,t.window,t.strstart+t.lookahead,n),t.lookahead+=e,t.lookahead+t.insert>=cr)for(i=t.strstart-t.insert,t.ins_h=t.window[i],t.ins_h=Bs(t,t.ins_h,t.window[i+1]);t.insert&&(t.ins_h=Bs(t,t.ins_h,t.window[i+cr-1]),t.prev[i&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=i,i++,t.insert--,!(t.lookahead+t.insert<cr)););}while(t.lookahead<ho&&t.strm.avail_in!==0)},ax=(t,r)=>{let e=t.pending_buf_size-5>t.w_size?t.w_size:t.pending_buf_size-5,n,i,a,o=0,s=t.strm.avail_in;do{if(n=65535,a=t.bi_valid+42>>3,t.strm.avail_out<a||(a=t.strm.avail_out-a,i=t.strstart-t.block_start,n>i+t.strm.avail_in&&(n=i+t.strm.avail_in),n>a&&(n=a),n<e&&(n===0&&r!==ka||r===Ls||n!==i+t.strm.avail_in)))break;o=r===ka&&n===i+t.strm.avail_in?1:0,Qp(t,0,0,o),t.pending_buf[t.pending-4]=n,t.pending_buf[t.pending-3]=n>>8,t.pending_buf[t.pending-2]=~n,t.pending_buf[t.pending-1]=~n>>8,ia(t.strm),i&&(i>n&&(i=n),t.strm.output.set(t.window.subarray(t.block_start,t.block_start+i),t.strm.next_out),t.strm.next_out+=i,t.strm.avail_out-=i,t.strm.total_out+=i,t.block_start+=i,n-=i),n&&(am(t.strm,t.strm.output,t.strm.next_out,n),t.strm.next_out+=n,t.strm.avail_out-=n,t.strm.total_out+=n)}while(o===0);return s-=t.strm.avail_in,s&&(s>=t.w_size?(t.matches=2,t.window.set(t.strm.input.subarray(t.strm.next_in-t.w_size,t.strm.next_in),0),t.strstart=t.w_size,t.insert=t.strstart):(t.window_size-t.strstart<=s&&(t.strstart-=t.w_size,t.window.set(t.window.subarray(t.w_size,t.w_size+t.strstart),0),t.matches<2&&t.matches++,t.insert>t.strstart&&(t.insert=t.strstart)),t.window.set(t.strm.input.subarray(t.strm.next_in-s,t.strm.next_in),t.strstart),t.strstart+=s,t.insert+=s>t.w_size-t.insert?t.w_size-t.insert:s),t.block_start=t.strstart),t.high_water<t.strstart&&(t.high_water=t.strstart),o?yc:r!==Ls&&r!==ka&&t.strm.avail_in===0&&t.strstart===t.block_start?wc:(a=t.window_size-t.strstart,t.strm.avail_in>a&&t.block_start>=t.w_size&&(t.block_start-=t.w_size,t.strstart-=t.w_size,t.window.set(t.window.subarray(t.w_size,t.w_size+t.strstart),0),t.matches<2&&t.matches++,a+=t.w_size,t.insert>t.strstart&&(t.insert=t.strstart)),a>t.strm.avail_in&&(a=t.strm.avail_in),a&&(am(t.strm,t.window,t.strstart,a),t.strstart+=a,t.insert+=a>t.w_size-t.insert?t.w_size-t.insert:a),t.high_water<t.strstart&&(t.high_water=t.strstart),a=t.bi_valid+42>>3,a=t.pending_buf_size-a>65535?65535:t.pending_buf_size-a,e=a>t.w_size?t.w_size:a,i=t.strstart-t.block_start,(i>=e||(i||r===ka)&&r!==Ls&&t.strm.avail_in===0&&i<=a)&&(n=i>a?a:i,o=r===ka&&t.strm.avail_in===0&&n===i?1:0,Qp(t,t.block_start,n,o),t.block_start+=n,ia(t.strm)),o?Ml:wi)},jp=(t,r)=>{let e,n;for(;;){if(t.lookahead<ho){if(vc(t),t.lookahead<ho&&r===Ls)return wi;if(t.lookahead===0)break}if(e=0,t.lookahead>=cr&&(t.ins_h=Bs(t,t.ins_h,t.window[t.strstart+cr-1]),e=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),e!==0&&t.strstart-e<=t.w_size-ho&&(t.match_length=ix(t,e)),t.match_length>=cr)if(n=Rs(t,t.strstart-t.match_start,t.match_length-cr),t.lookahead-=t.match_length,t.match_length<=t.max_lazy_match&&t.lookahead>=cr){t.match_length--;do t.strstart++,t.ins_h=Bs(t,t.ins_h,t.window[t.strstart+cr-1]),e=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart;while(--t.match_length!==0);t.strstart++}else t.strstart+=t.match_length,t.match_length=0,t.ins_h=t.window[t.strstart],t.ins_h=Bs(t,t.ins_h,t.window[t.strstart+1]);else n=Rs(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++;if(n&&(aa(t,!1),t.strm.avail_out===0))return wi}return t.insert=t.strstart<cr-1?t.strstart:cr-1,r===ka?(aa(t,!0),t.strm.avail_out===0?Ml:yc):t.sym_next&&(aa(t,!1),t.strm.avail_out===0)?wi:wc},pc=(t,r)=>{let e,n,i;for(;;){if(t.lookahead<ho){if(vc(t),t.lookahead<ho&&r===Ls)return wi;if(t.lookahead===0)break}if(e=0,t.lookahead>=cr&&(t.ins_h=Bs(t,t.ins_h,t.window[t.strstart+cr-1]),e=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),t.prev_length=t.match_length,t.prev_match=t.match_start,t.match_length=cr-1,e!==0&&t.prev_length<t.max_lazy_match&&t.strstart-e<=t.w_size-ho&&(t.match_length=ix(t,e),t.match_length<=5&&(t.strategy===Y6||t.match_length===cr&&t.strstart-t.match_start>4096)&&(t.match_length=cr-1)),t.prev_length>=cr&&t.match_length<=t.prev_length){i=t.strstart+t.lookahead-cr,n=Rs(t,t.strstart-1-t.prev_match,t.prev_length-cr),t.lookahead-=t.prev_length-1,t.prev_length-=2;do++t.strstart<=i&&(t.ins_h=Bs(t,t.ins_h,t.window[t.strstart+cr-1]),e=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart);while(--t.prev_length!==0);if(t.match_available=0,t.match_length=cr-1,t.strstart++,n&&(aa(t,!1),t.strm.avail_out===0))return wi}else if(t.match_available){if(n=Rs(t,0,t.window[t.strstart-1]),n&&aa(t,!1),t.strstart++,t.lookahead--,t.strm.avail_out===0)return wi}else t.match_available=1,t.strstart++,t.lookahead--}return t.match_available&&(n=Rs(t,0,t.window[t.strstart-1]),t.match_available=0),t.insert=t.strstart<cr-1?t.strstart:cr-1,r===ka?(aa(t,!0),t.strm.avail_out===0?Ml:yc):t.sym_next&&(aa(t,!1),t.strm.avail_out===0)?wi:wc},hM=(t,r)=>{let e,n,i,a,o=t.window;for(;;){if(t.lookahead<=Ns){if(vc(t),t.lookahead<=Ns&&r===Ls)return wi;if(t.lookahead===0)break}if(t.match_length=0,t.lookahead>=cr&&t.strstart>0&&(i=t.strstart-1,n=o[i],n===o[++i]&&n===o[++i]&&n===o[++i])){a=t.strstart+Ns;do;while(n===o[++i]&&n===o[++i]&&n===o[++i]&&n===o[++i]&&n===o[++i]&&n===o[++i]&&n===o[++i]&&n===o[++i]&&i<a);t.match_length=Ns-(a-i),t.match_length>t.lookahead&&(t.match_length=t.lookahead)}if(t.match_length>=cr?(e=Rs(t,1,t.match_length-cr),t.lookahead-=t.match_length,t.strstart+=t.match_length,t.match_length=0):(e=Rs(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++),e&&(aa(t,!1),t.strm.avail_out===0))return wi}return t.insert=0,r===ka?(aa(t,!0),t.strm.avail_out===0?Ml:yc):t.sym_next&&(aa(t,!1),t.strm.avail_out===0)?wi:wc},pM=(t,r)=>{let e;for(;;){if(t.lookahead===0&&(vc(t),t.lookahead===0)){if(r===Ls)return wi;break}if(t.match_length=0,e=Rs(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++,e&&(aa(t,!1),t.strm.avail_out===0))return wi}return t.insert=0,r===ka?(aa(t,!0),t.strm.avail_out===0?Ml:yc):t.sym_next&&(aa(t,!1),t.strm.avail_out===0)?wi:wc};function co(t,r,e,n,i){this.good_length=t,this.max_lazy=r,this.nice_length=e,this.max_chain=n,this.func=i}var z0=[new co(0,0,0,0,ax),new co(4,4,8,4,jp),new co(4,5,16,8,jp),new co(4,6,32,32,jp),new co(4,4,16,16,pc),new co(8,16,32,32,pc),new co(8,16,128,128,pc),new co(8,32,128,256,pc),new co(32,128,258,1024,pc),new co(32,258,258,4096,pc)],mM=t=>{t.window_size=2*t.w_size,Ds(t.head),t.max_lazy_match=z0[t.level].max_lazy,t.good_match=z0[t.level].good_length,t.nice_match=z0[t.level].nice_length,t.max_chain_length=z0[t.level].max_chain,t.strstart=0,t.block_start=0,t.lookahead=0,t.insert=0,t.match_length=t.prev_length=cr-1,t.match_available=0,t.ins_h=0};function gM(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=Xf,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(sM*2),this.dyn_dtree=new Uint16Array((2*aM+1)*2),this.bl_tree=new Uint16Array((2*oM+1)*2),Ds(this.dyn_ltree),Ds(this.dyn_dtree),Ds(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(lM+1),this.heap=new Uint16Array(2*em+1),Ds(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(2*em+1),Ds(this.depth),this.sym_buf=0,this.lit_bufsize=0,this.sym_next=0,this.sym_end=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}var ed=t=>{if(!t)return 1;let r=t.state;return!r||r.strm!==t||r.status!==_c&&r.status!==dm&&r.status!==tm&&r.status!==rm&&r.status!==nm&&r.status!==im&&r.status!==Sl&&r.status!==V0?1:0},ox=t=>{if(ed(t))return kl(t,uo);t.total_in=t.total_out=0,t.data_type=Q6;let r=t.state;return r.pending=0,r.pending_out=0,r.wrap<0&&(r.wrap=-r.wrap),r.status=r.wrap===2?dm:r.wrap?_c:Sl,t.adler=r.wrap===2?0:1,r.last_flush=-2,j6(r),ii},sx=t=>{let r=ox(t);return r===ii&&mM(t.state),r},_M=(t,r)=>ed(t)||t.state.wrap!==2?uo:(t.state.gzhead=r,ii),lx=(t,r,e,n,i,a)=>{if(!t)return uo;let o=1;if(r===X6&&(r=6),n<0?(o=0,n=-n):n>15&&(o=2,n-=16),i<1||i>eM||e!==Xf||n<8||n>15||r<0||r>9||a<0||a>Z6||n===8&&o!==1)return kl(t,uo);n===8&&(n=9);let s=new gM;return t.state=s,s.strm=t,s.status=_c,s.wrap=o,s.gzhead=null,s.w_bits=n,s.w_size=1<<s.w_bits,s.w_mask=s.w_size-1,s.hash_bits=i+7,s.hash_size=1<<s.hash_bits,s.hash_mask=s.hash_size-1,s.hash_shift=~~((s.hash_bits+cr-1)/cr),s.window=new Uint8Array(s.w_size*2),s.head=new Uint16Array(s.hash_size),s.prev=new Uint16Array(s.w_size),s.lit_bufsize=1<<i+6,s.pending_buf_size=s.lit_bufsize*4,s.pending_buf=new Uint8Array(s.pending_buf_size),s.sym_buf=s.lit_bufsize,s.sym_end=(s.lit_bufsize-1)*3,s.level=r,s.strategy=a,s.method=e,sx(t)},vM=(t,r)=>lx(t,r,Xf,tM,rM,J6),xM=(t,r)=>{if(ed(t)||r>d2||r<0)return t?kl(t,uo):uo;let e=t.state;if(!t.output||t.avail_in!==0&&!t.input||e.status===V0&&r!==ka)return kl(t,t.avail_out===0?zp:uo);let n=e.last_flush;if(e.last_flush=r,e.pending!==0){if(ia(t),t.avail_out===0)return e.last_flush=-1,ii}else if(t.avail_in===0&&u2(r)<=u2(n)&&r!==ka)return kl(t,zp);if(e.status===V0&&t.avail_in!==0)return kl(t,zp);if(e.status===_c&&e.wrap===0&&(e.status=Sl),e.status===_c){let i=Xf+(e.w_bits-8<<4)<<8,a=-1;if(e.strategy>=Uf||e.level<2?a=0:e.level<6?a=1:e.level===6?a=2:a=3,i|=a<<6,e.strstart!==0&&(i|=cM),i+=31-i%31,U0(e,i),e.strstart!==0&&(U0(e,t.adler>>>16),U0(e,t.adler&65535)),t.adler=1,e.status=Sl,ia(t),e.pending!==0)return e.last_flush=-1,ii}if(e.status===dm){if(t.adler=0,br(e,31),br(e,139),br(e,8),e.gzhead)br(e,(e.gzhead.text?1:0)+(e.gzhead.hcrc?2:0)+(e.gzhead.extra?4:0)+(e.gzhead.name?8:0)+(e.gzhead.comment?16:0)),br(e,e.gzhead.time&255),br(e,e.gzhead.time>>8&255),br(e,e.gzhead.time>>16&255),br(e,e.gzhead.time>>24&255),br(e,e.level===9?2:e.strategy>=Uf||e.level<2?4:0),br(e,e.gzhead.os&255),e.gzhead.extra&&e.gzhead.extra.length&&(br(e,e.gzhead.extra.length&255),br(e,e.gzhead.extra.length>>8&255)),e.gzhead.hcrc&&(t.adler=qn(t.adler,e.pending_buf,e.pending,0)),e.gzindex=0,e.status=tm;else if(br(e,0),br(e,0),br(e,0),br(e,0),br(e,0),br(e,e.level===9?2:e.strategy>=Uf||e.level<2?4:0),br(e,dM),e.status=Sl,ia(t),e.pending!==0)return e.last_flush=-1,ii}if(e.status===tm){if(e.gzhead.extra){let i=e.pending,a=(e.gzhead.extra.length&65535)-e.gzindex;for(;e.pending+a>e.pending_buf_size;){let s=e.pending_buf_size-e.pending;if(e.pending_buf.set(e.gzhead.extra.subarray(e.gzindex,e.gzindex+s),e.pending),e.pending=e.pending_buf_size,e.gzhead.hcrc&&e.pending>i&&(t.adler=qn(t.adler,e.pending_buf,e.pending-i,i)),e.gzindex+=s,ia(t),e.pending!==0)return e.last_flush=-1,ii;i=0,a-=s}let o=new Uint8Array(e.gzhead.extra);e.pending_buf.set(o.subarray(e.gzindex,e.gzindex+a),e.pending),e.pending+=a,e.gzhead.hcrc&&e.pending>i&&(t.adler=qn(t.adler,e.pending_buf,e.pending-i,i)),e.gzindex=0}e.status=rm}if(e.status===rm){if(e.gzhead.name){let i=e.pending,a;do{if(e.pending===e.pending_buf_size){if(e.gzhead.hcrc&&e.pending>i&&(t.adler=qn(t.adler,e.pending_buf,e.pending-i,i)),ia(t),e.pending!==0)return e.last_flush=-1,ii;i=0}e.gzindex<e.gzhead.name.length?a=e.gzhead.name.charCodeAt(e.gzindex++)&255:a=0,br(e,a)}while(a!==0);e.gzhead.hcrc&&e.pending>i&&(t.adler=qn(t.adler,e.pending_buf,e.pending-i,i)),e.gzindex=0}e.status=nm}if(e.status===nm){if(e.gzhead.comment){let i=e.pending,a;do{if(e.pending===e.pending_buf_size){if(e.gzhead.hcrc&&e.pending>i&&(t.adler=qn(t.adler,e.pending_buf,e.pending-i,i)),ia(t),e.pending!==0)return e.last_flush=-1,ii;i=0}e.gzindex<e.gzhead.comment.length?a=e.gzhead.comment.charCodeAt(e.gzindex++)&255:a=0,br(e,a)}while(a!==0);e.gzhead.hcrc&&e.pending>i&&(t.adler=qn(t.adler,e.pending_buf,e.pending-i,i))}e.status=im}if(e.status===im){if(e.gzhead.hcrc){if(e.pending+2>e.pending_buf_size&&(ia(t),e.pending!==0))return e.last_flush=-1,ii;br(e,t.adler&255),br(e,t.adler>>8&255),t.adler=0}if(e.status=Sl,ia(t),e.pending!==0)return e.last_flush=-1,ii}if(t.avail_in!==0||e.lookahead!==0||r!==Ls&&e.status!==V0){let i=e.level===0?ax(e,r):e.strategy===Uf?pM(e,r):e.strategy===K6?hM(e,r):z0[e.level].func(e,r);if((i===Ml||i===yc)&&(e.status=V0),i===wi||i===Ml)return t.avail_out===0&&(e.last_flush=-1),ii;if(i===wc&&(r===q6?W6(e):r!==d2&&(Qp(e,0,0,!1),r===G6&&(Ds(e.head),e.lookahead===0&&(e.strstart=0,e.block_start=0,e.insert=0))),ia(t),t.avail_out===0))return e.last_flush=-1,ii}return r!==ka?ii:e.wrap<=0?f2:(e.wrap===2?(br(e,t.adler&255),br(e,t.adler>>8&255),br(e,t.adler>>16&255),br(e,t.adler>>24&255),br(e,t.total_in&255),br(e,t.total_in>>8&255),br(e,t.total_in>>16&255),br(e,t.total_in>>24&255)):(U0(e,t.adler>>>16),U0(e,t.adler&65535)),ia(t),e.wrap>0&&(e.wrap=-e.wrap),e.pending!==0?ii:f2)},bM=t=>{if(ed(t))return uo;let r=t.state.status;return t.state=null,r===Sl?kl(t,$6):ii},wM=(t,r)=>{let e=r.length;if(ed(t))return uo;let n=t.state,i=n.wrap;if(i===2||i===1&&n.status!==_c||n.lookahead)return uo;if(i===1&&(t.adler=Y0(t.adler,r,e,0)),n.wrap=0,e>=n.w_size){i===0&&(Ds(n.head),n.strstart=0,n.block_start=0,n.insert=0);let l=new Uint8Array(n.w_size);l.set(r.subarray(e-n.w_size,e),0),r=l,e=n.w_size}let a=t.avail_in,o=t.next_in,s=t.input;for(t.avail_in=e,t.next_in=0,t.input=r,vc(n);n.lookahead>=cr;){let l=n.strstart,c=n.lookahead-(cr-1);do n.ins_h=Bs(n,n.ins_h,n.window[l+cr-1]),n.prev[l&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=l,l++;while(--c);n.strstart=l,n.lookahead=cr-1,vc(n)}return n.strstart+=n.lookahead,n.block_start=n.strstart,n.insert=n.lookahead,n.lookahead=0,n.match_length=n.prev_length=cr-1,n.match_available=0,t.next_in=o,t.input=s,t.avail_in=a,n.wrap=i,ii},yM=vM,CM=lx,SM=sx,kM=ox,EM=_M,MM=xM,PM=bM,OM=wM,AM="pako deflate (from Nodeca project)",H0={deflateInit:yM,deflateInit2:CM,deflateReset:SM,deflateResetKeep:kM,deflateSetHeader:EM,deflate:MM,deflateEnd:PM,deflateSetDictionary:OM,deflateInfo:AM},TM=(t,r)=>Object.prototype.hasOwnProperty.call(t,r),IM=function(t){let r=Array.prototype.slice.call(arguments,1);for(;r.length;){let e=r.shift();if(e){if(typeof e!="object")throw new TypeError(e+"must be non-object");for(let n in e)TM(e,n)&&(t[n]=e[n])}}return t},FM=t=>{let r=0;for(let n=0,i=t.length;n<i;n++)r+=t[n].length;let e=new Uint8Array(r);for(let n=0,i=0,a=t.length;n<a;n++){let o=t[n];e.set(o,i),i+=o.length}return e},Yf={assign:IM,flattenChunks:FM},cx=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{cx=!1}var K0=new Uint8Array(256);for(let t=0;t<256;t++)K0[t]=t>=252?6:t>=248?5:t>=240?4:t>=224?3:t>=192?2:1;K0[254]=K0[254]=1;var DM=t=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(t);let r,e,n,i,a,o=t.length,s=0;for(i=0;i<o;i++)e=t.charCodeAt(i),(e&64512)===55296&&i+1<o&&(n=t.charCodeAt(i+1),(n&64512)===56320&&(e=65536+(e-55296<<10)+(n-56320),i++)),s+=e<128?1:e<2048?2:e<65536?3:4;for(r=new Uint8Array(s),a=0,i=0;a<s;i++)e=t.charCodeAt(i),(e&64512)===55296&&i+1<o&&(n=t.charCodeAt(i+1),(n&64512)===56320&&(e=65536+(e-55296<<10)+(n-56320),i++)),e<128?r[a++]=e:e<2048?(r[a++]=192|e>>>6,r[a++]=128|e&63):e<65536?(r[a++]=224|e>>>12,r[a++]=128|e>>>6&63,r[a++]=128|e&63):(r[a++]=240|e>>>18,r[a++]=128|e>>>12&63,r[a++]=128|e>>>6&63,r[a++]=128|e&63);return r},NM=(t,r)=>{if(r<65534&&t.subarray&&cx)return String.fromCharCode.apply(null,t.length===r?t:t.subarray(0,r));let e="";for(let n=0;n<r;n++)e+=String.fromCharCode(t[n]);return e},RM=(t,r)=>{let e=r||t.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(t.subarray(0,r));let n,i,a=new Array(e*2);for(i=0,n=0;n<e;){let o=t[n++];if(o<128){a[i++]=o;continue}let s=K0[o];if(s>4){a[i++]=65533,n+=s-1;continue}for(o&=s===2?31:s===3?15:7;s>1&&n<e;)o=o<<6|t[n++]&63,s--;if(s>1){a[i++]=65533;continue}o<65536?a[i++]=o:(o-=65536,a[i++]=55296|o>>10&1023,a[i++]=56320|o&1023)}return NM(a,i)},LM=(t,r)=>{r=r||t.length,r>t.length&&(r=t.length);let e=r-1;for(;e>=0&&(t[e]&192)===128;)e--;return e<0||e===0?r:e+K0[t[e]]>r?e:r},Z0={string2buf:DM,buf2string:RM,utf8border:LM};function BM(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var dx=BM,fx=Object.prototype.toString,{Z_NO_FLUSH:UM,Z_SYNC_FLUSH:VM,Z_FULL_FLUSH:zM,Z_FINISH:jM,Z_OK:Gf,Z_STREAM_END:HM,Z_DEFAULT_COMPRESSION:WM,Z_DEFAULT_STRATEGY:qM,Z_DEFLATED:GM}=bc;function td(t){this.options=Yf.assign({level:WM,method:GM,chunkSize:16384,windowBits:15,memLevel:8,strategy:qM},t||{});let r=this.options;r.raw&&r.windowBits>0?r.windowBits=-r.windowBits:r.gzip&&r.windowBits>0&&r.windowBits<16&&(r.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new dx,this.strm.avail_out=0;let e=H0.deflateInit2(this.strm,r.level,r.method,r.windowBits,r.memLevel,r.strategy);if(e!==Gf)throw new Error(El[e]);if(r.header&&H0.deflateSetHeader(this.strm,r.header),r.dictionary){let n;if(typeof r.dictionary=="string"?n=Z0.string2buf(r.dictionary):fx.call(r.dictionary)==="[object ArrayBuffer]"?n=new Uint8Array(r.dictionary):n=r.dictionary,e=H0.deflateSetDictionary(this.strm,n),e!==Gf)throw new Error(El[e]);this._dict_set=!0}}td.prototype.push=function(t,r){let e=this.strm,n=this.options.chunkSize,i,a;if(this.ended)return!1;for(r===~~r?a=r:a=r===!0?jM:UM,typeof t=="string"?e.input=Z0.string2buf(t):fx.call(t)==="[object ArrayBuffer]"?e.input=new Uint8Array(t):e.input=t,e.next_in=0,e.avail_in=e.input.length;;){if(e.avail_out===0&&(e.output=new Uint8Array(n),e.next_out=0,e.avail_out=n),(a===VM||a===zM)&&e.avail_out<=6){this.onData(e.output.subarray(0,e.next_out)),e.avail_out=0;continue}if(i=H0.deflate(e,a),i===HM)return e.next_out>0&&this.onData(e.output.subarray(0,e.next_out)),i=H0.deflateEnd(this.strm),this.onEnd(i),this.ended=!0,i===Gf;if(e.avail_out===0){this.onData(e.output);continue}if(a>0&&e.next_out>0){this.onData(e.output.subarray(0,e.next_out)),e.avail_out=0;continue}if(e.avail_in===0)break}return!0};td.prototype.onData=function(t){this.chunks.push(t)};td.prototype.onEnd=function(t){t===Gf&&(this.result=Yf.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg};function fm(t,r){let e=new td(r);if(e.push(t,!0),e.err)throw e.msg||El[e.err];return e.result}function $M(t,r){return r=r||{},r.raw=!0,fm(t,r)}function XM(t,r){return r=r||{},r.gzip=!0,fm(t,r)}var YM=td,KM=fm,ZM=$M,JM=XM,QM=bc,eP={Deflate:YM,deflate:KM,deflateRaw:ZM,gzip:JM,constants:QM},Vf=16209,tP=16191,rP=function(r,e){let n,i,a,o,s,l,c,f,v,x,p,S,w,k,O,H,q,X,he,ke,re,ee,W,ae,A=r.state;n=r.next_in,W=r.input,i=n+(r.avail_in-5),a=r.next_out,ae=r.output,o=a-(e-r.avail_out),s=a+(r.avail_out-257),l=A.dmax,c=A.wsize,f=A.whave,v=A.wnext,x=A.window,p=A.hold,S=A.bits,w=A.lencode,k=A.distcode,O=(1<<A.lenbits)-1,H=(1<<A.distbits)-1;e:do{S<15&&(p+=W[n++]<<S,S+=8,p+=W[n++]<<S,S+=8),q=w[p&O];t:for(;;){if(X=q>>>24,p>>>=X,S-=X,X=q>>>16&255,X===0)ae[a++]=q&65535;else if(X&16){he=q&65535,X&=15,X&&(S<X&&(p+=W[n++]<<S,S+=8),he+=p&(1<<X)-1,p>>>=X,S-=X),S<15&&(p+=W[n++]<<S,S+=8,p+=W[n++]<<S,S+=8),q=k[p&H];r:for(;;){if(X=q>>>24,p>>>=X,S-=X,X=q>>>16&255,X&16){if(ke=q&65535,X&=15,S<X&&(p+=W[n++]<<S,S+=8,S<X&&(p+=W[n++]<<S,S+=8)),ke+=p&(1<<X)-1,ke>l){r.msg="invalid distance too far back",A.mode=Vf;break e}if(p>>>=X,S-=X,X=a-o,ke>X){if(X=ke-X,X>f&&A.sane){r.msg="invalid distance too far back",A.mode=Vf;break e}if(re=0,ee=x,v===0){if(re+=c-X,X<he){he-=X;do ae[a++]=x[re++];while(--X);re=a-ke,ee=ae}}else if(v<X){if(re+=c+v-X,X-=v,X<he){he-=X;do ae[a++]=x[re++];while(--X);if(re=0,v<he){X=v,he-=X;do ae[a++]=x[re++];while(--X);re=a-ke,ee=ae}}}else if(re+=v-X,X<he){he-=X;do ae[a++]=x[re++];while(--X);re=a-ke,ee=ae}for(;he>2;)ae[a++]=ee[re++],ae[a++]=ee[re++],ae[a++]=ee[re++],he-=3;he&&(ae[a++]=ee[re++],he>1&&(ae[a++]=ee[re++]))}else{re=a-ke;do ae[a++]=ae[re++],ae[a++]=ae[re++],ae[a++]=ae[re++],he-=3;while(he>2);he&&(ae[a++]=ae[re++],he>1&&(ae[a++]=ae[re++]))}}else if((X&64)===0){q=k[(q&65535)+(p&(1<<X)-1)];continue r}else{r.msg="invalid distance code",A.mode=Vf;break e}break}}else if((X&64)===0){q=w[(q&65535)+(p&(1<<X)-1)];continue t}else if(X&32){A.mode=tP;break e}else{r.msg="invalid literal/length code",A.mode=Vf;break e}break}}while(n<i&&a<s);he=S>>3,n-=he,S-=he<<3,p&=(1<<S)-1,r.next_in=n,r.next_out=a,r.avail_in=n<i?5+(i-n):5-(n-i),r.avail_out=a<s?257+(s-a):257-(a-s),A.hold=p,A.bits=S},mc=15,h2=852,p2=592,m2=0,Hp=1,g2=2,nP=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),iP=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),aP=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),oP=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),sP=(t,r,e,n,i,a,o,s)=>{let l=s.bits,c=0,f=0,v=0,x=0,p=0,S=0,w=0,k=0,O=0,H=0,q,X,he,ke,re,ee=null,W,ae=new Uint16Array(mc+1),A=new Uint16Array(mc+1),V=null,de,ue,xe;for(c=0;c<=mc;c++)ae[c]=0;for(f=0;f<n;f++)ae[r[e+f]]++;for(p=l,x=mc;x>=1&&ae[x]===0;x--);if(p>x&&(p=x),x===0)return i[a++]=1<<24|64<<16|0,i[a++]=1<<24|64<<16|0,s.bits=1,0;for(v=1;v<x&&ae[v]===0;v++);for(p<v&&(p=v),k=1,c=1;c<=mc;c++)if(k<<=1,k-=ae[c],k<0)return-1;if(k>0&&(t===m2||x!==1))return-1;for(A[1]=0,c=1;c<mc;c++)A[c+1]=A[c]+ae[c];for(f=0;f<n;f++)r[e+f]!==0&&(o[A[r[e+f]]++]=f);if(t===m2?(ee=V=o,W=20):t===Hp?(ee=nP,V=iP,W=257):(ee=aP,V=oP,W=0),H=0,f=0,c=v,re=a,S=p,w=0,he=-1,O=1<<p,ke=O-1,t===Hp&&O>h2||t===g2&&O>p2)return 1;for(;;){de=c-w,o[f]+1<W?(ue=0,xe=o[f]):o[f]>=W?(ue=V[o[f]-W],xe=ee[o[f]-W]):(ue=96,xe=0),q=1<<c-w,X=1<<S,v=X;do X-=q,i[re+(H>>w)+X]=de<<24|ue<<16|xe|0;while(X!==0);for(q=1<<c-1;H&q;)q>>=1;if(q!==0?(H&=q-1,H+=q):H=0,f++,--ae[c]===0){if(c===x)break;c=r[e+o[f]]}if(c>p&&(H&ke)!==he){for(w===0&&(w=p),re+=v,S=c-w,k=1<<S;S+w<x&&(k-=ae[S+w],!(k<=0));)S++,k<<=1;if(O+=1<<S,t===Hp&&O>h2||t===g2&&O>p2)return 1;he=H&ke,i[he]=p<<24|S<<16|re-a|0}}return H!==0&&(i[re+H]=c-w<<24|64<<16|0),s.bits=p,0},W0=sP,lP=0,ux=1,hx=2,{Z_FINISH:_2,Z_BLOCK:cP,Z_TREES:zf,Z_OK:Pl,Z_STREAM_END:dP,Z_NEED_DICT:fP,Z_STREAM_ERROR:Ea,Z_DATA_ERROR:px,Z_MEM_ERROR:mx,Z_BUF_ERROR:uP,Z_DEFLATED:v2}=bc,Kf=16180,x2=16181,b2=16182,w2=16183,y2=16184,C2=16185,S2=16186,k2=16187,E2=16188,M2=16189,$f=16190,Go=16191,Wp=16192,P2=16193,qp=16194,O2=16195,A2=16196,T2=16197,I2=16198,jf=16199,Hf=16200,F2=16201,D2=16202,N2=16203,R2=16204,L2=16205,Gp=16206,B2=16207,U2=16208,Zr=16209,gx=16210,_x=16211,hP=852,pP=592,mP=15,gP=mP,V2=t=>(t>>>24&255)+(t>>>8&65280)+((t&65280)<<8)+((t&255)<<24);function _P(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}var Ol=t=>{if(!t)return 1;let r=t.state;return!r||r.strm!==t||r.mode<Kf||r.mode>_x?1:0},vx=t=>{if(Ol(t))return Ea;let r=t.state;return t.total_in=t.total_out=r.total=0,t.msg="",r.wrap&&(t.adler=r.wrap&1),r.mode=Kf,r.last=0,r.havedict=0,r.flags=-1,r.dmax=32768,r.head=null,r.hold=0,r.bits=0,r.lencode=r.lendyn=new Int32Array(hP),r.distcode=r.distdyn=new Int32Array(pP),r.sane=1,r.back=-1,Pl},xx=t=>{if(Ol(t))return Ea;let r=t.state;return r.wsize=0,r.whave=0,r.wnext=0,vx(t)},bx=(t,r)=>{let e;if(Ol(t))return Ea;let n=t.state;return r<0?(e=0,r=-r):(e=(r>>4)+5,r<48&&(r&=15)),r&&(r<8||r>15)?Ea:(n.window!==null&&n.wbits!==r&&(n.window=null),n.wrap=e,n.wbits=r,xx(t))},wx=(t,r)=>{if(!t)return Ea;let e=new _P;t.state=e,e.strm=t,e.window=null,e.mode=Kf;let n=bx(t,r);return n!==Pl&&(t.state=null),n},vP=t=>wx(t,gP),z2=!0,$p,Xp,xP=t=>{if(z2){$p=new Int32Array(512),Xp=new Int32Array(32);let r=0;for(;r<144;)t.lens[r++]=8;for(;r<256;)t.lens[r++]=9;for(;r<280;)t.lens[r++]=7;for(;r<288;)t.lens[r++]=8;for(W0(ux,t.lens,0,288,$p,0,t.work,{bits:9}),r=0;r<32;)t.lens[r++]=5;W0(hx,t.lens,0,32,Xp,0,t.work,{bits:5}),z2=!1}t.lencode=$p,t.lenbits=9,t.distcode=Xp,t.distbits=5},yx=(t,r,e,n)=>{let i,a=t.state;return a.window===null&&(a.wsize=1<<a.wbits,a.wnext=0,a.whave=0,a.window=new Uint8Array(a.wsize)),n>=a.wsize?(a.window.set(r.subarray(e-a.wsize,e),0),a.wnext=0,a.whave=a.wsize):(i=a.wsize-a.wnext,i>n&&(i=n),a.window.set(r.subarray(e-n,e-n+i),a.wnext),n-=i,n?(a.window.set(r.subarray(e-n,e),0),a.wnext=n,a.whave=a.wsize):(a.wnext+=i,a.wnext===a.wsize&&(a.wnext=0),a.whave<a.wsize&&(a.whave+=i))),0},bP=(t,r)=>{let e,n,i,a,o,s,l,c,f,v,x,p,S,w,k=0,O,H,q,X,he,ke,re,ee,W=new Uint8Array(4),ae,A,V=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(Ol(t)||!t.output||!t.input&&t.avail_in!==0)return Ea;e=t.state,e.mode===Go&&(e.mode=Wp),o=t.next_out,i=t.output,l=t.avail_out,a=t.next_in,n=t.input,s=t.avail_in,c=e.hold,f=e.bits,v=s,x=l,ee=Pl;e:for(;;)switch(e.mode){case Kf:if(e.wrap===0){e.mode=Wp;break}for(;f<16;){if(s===0)break e;s--,c+=n[a++]<<f,f+=8}if(e.wrap&2&&c===35615){e.wbits===0&&(e.wbits=15),e.check=0,W[0]=c&255,W[1]=c>>>8&255,e.check=qn(e.check,W,2,0),c=0,f=0,e.mode=x2;break}if(e.head&&(e.head.done=!1),!(e.wrap&1)||(((c&255)<<8)+(c>>8))%31){t.msg="incorrect header check",e.mode=Zr;break}if((c&15)!==v2){t.msg="unknown compression method",e.mode=Zr;break}if(c>>>=4,f-=4,re=(c&15)+8,e.wbits===0&&(e.wbits=re),re>15||re>e.wbits){t.msg="invalid window size",e.mode=Zr;break}e.dmax=1<<e.wbits,e.flags=0,t.adler=e.check=1,e.mode=c&512?M2:Go,c=0,f=0;break;case x2:for(;f<16;){if(s===0)break e;s--,c+=n[a++]<<f,f+=8}if(e.flags=c,(e.flags&255)!==v2){t.msg="unknown compression method",e.mode=Zr;break}if(e.flags&57344){t.msg="unknown header flags set",e.mode=Zr;break}e.head&&(e.head.text=c>>8&1),e.flags&512&&e.wrap&4&&(W[0]=c&255,W[1]=c>>>8&255,e.check=qn(e.check,W,2,0)),c=0,f=0,e.mode=b2;case b2:for(;f<32;){if(s===0)break e;s--,c+=n[a++]<<f,f+=8}e.head&&(e.head.time=c),e.flags&512&&e.wrap&4&&(W[0]=c&255,W[1]=c>>>8&255,W[2]=c>>>16&255,W[3]=c>>>24&255,e.check=qn(e.check,W,4,0)),c=0,f=0,e.mode=w2;case w2:for(;f<16;){if(s===0)break e;s--,c+=n[a++]<<f,f+=8}e.head&&(e.head.xflags=c&255,e.head.os=c>>8),e.flags&512&&e.wrap&4&&(W[0]=c&255,W[1]=c>>>8&255,e.check=qn(e.check,W,2,0)),c=0,f=0,e.mode=y2;case y2:if(e.flags&1024){for(;f<16;){if(s===0)break e;s--,c+=n[a++]<<f,f+=8}e.length=c,e.head&&(e.head.extra_len=c),e.flags&512&&e.wrap&4&&(W[0]=c&255,W[1]=c>>>8&255,e.check=qn(e.check,W,2,0)),c=0,f=0}else e.head&&(e.head.extra=null);e.mode=C2;case C2:if(e.flags&1024&&(p=e.length,p>s&&(p=s),p&&(e.head&&(re=e.head.extra_len-e.length,e.head.extra||(e.head.extra=new Uint8Array(e.head.extra_len)),e.head.extra.set(n.subarray(a,a+p),re)),e.flags&512&&e.wrap&4&&(e.check=qn(e.check,n,p,a)),s-=p,a+=p,e.length-=p),e.length))break e;e.length=0,e.mode=S2;case S2:if(e.flags&2048){if(s===0)break e;p=0;do re=n[a+p++],e.head&&re&&e.length<65536&&(e.head.name+=String.fromCharCode(re));while(re&&p<s);if(e.flags&512&&e.wrap&4&&(e.check=qn(e.check,n,p,a)),s-=p,a+=p,re)break e}else e.head&&(e.head.name=null);e.length=0,e.mode=k2;case k2:if(e.flags&4096){if(s===0)break e;p=0;do re=n[a+p++],e.head&&re&&e.length<65536&&(e.head.comment+=String.fromCharCode(re));while(re&&p<s);if(e.flags&512&&e.wrap&4&&(e.check=qn(e.check,n,p,a)),s-=p,a+=p,re)break e}else e.head&&(e.head.comment=null);e.mode=E2;case E2:if(e.flags&512){for(;f<16;){if(s===0)break e;s--,c+=n[a++]<<f,f+=8}if(e.wrap&4&&c!==(e.check&65535)){t.msg="header crc mismatch",e.mode=Zr;break}c=0,f=0}e.head&&(e.head.hcrc=e.flags>>9&1,e.head.done=!0),t.adler=e.check=0,e.mode=Go;break;case M2:for(;f<32;){if(s===0)break e;s--,c+=n[a++]<<f,f+=8}t.adler=e.check=V2(c),c=0,f=0,e.mode=$f;case $f:if(e.havedict===0)return t.next_out=o,t.avail_out=l,t.next_in=a,t.avail_in=s,e.hold=c,e.bits=f,fP;t.adler=e.check=1,e.mode=Go;case Go:if(r===cP||r===zf)break e;case Wp:if(e.last){c>>>=f&7,f-=f&7,e.mode=Gp;break}for(;f<3;){if(s===0)break e;s--,c+=n[a++]<<f,f+=8}switch(e.last=c&1,c>>>=1,f-=1,c&3){case 0:e.mode=P2;break;case 1:if(xP(e),e.mode=jf,r===zf){c>>>=2,f-=2;break e}break;case 2:e.mode=A2;break;case 3:t.msg="invalid block type",e.mode=Zr}c>>>=2,f-=2;break;case P2:for(c>>>=f&7,f-=f&7;f<32;){if(s===0)break e;s--,c+=n[a++]<<f,f+=8}if((c&65535)!==(c>>>16^65535)){t.msg="invalid stored block lengths",e.mode=Zr;break}if(e.length=c&65535,c=0,f=0,e.mode=qp,r===zf)break e;case qp:e.mode=O2;case O2:if(p=e.length,p){if(p>s&&(p=s),p>l&&(p=l),p===0)break e;i.set(n.subarray(a,a+p),o),s-=p,a+=p,l-=p,o+=p,e.length-=p;break}e.mode=Go;break;case A2:for(;f<14;){if(s===0)break e;s--,c+=n[a++]<<f,f+=8}if(e.nlen=(c&31)+257,c>>>=5,f-=5,e.ndist=(c&31)+1,c>>>=5,f-=5,e.ncode=(c&15)+4,c>>>=4,f-=4,e.nlen>286||e.ndist>30){t.msg="too many length or distance symbols",e.mode=Zr;break}e.have=0,e.mode=T2;case T2:for(;e.have<e.ncode;){for(;f<3;){if(s===0)break e;s--,c+=n[a++]<<f,f+=8}e.lens[V[e.have++]]=c&7,c>>>=3,f-=3}for(;e.have<19;)e.lens[V[e.have++]]=0;if(e.lencode=e.lendyn,e.lenbits=7,ae={bits:e.lenbits},ee=W0(lP,e.lens,0,19,e.lencode,0,e.work,ae),e.lenbits=ae.bits,ee){t.msg="invalid code lengths set",e.mode=Zr;break}e.have=0,e.mode=I2;case I2:for(;e.have<e.nlen+e.ndist;){for(;k=e.lencode[c&(1<<e.lenbits)-1],O=k>>>24,H=k>>>16&255,q=k&65535,!(O<=f);){if(s===0)break e;s--,c+=n[a++]<<f,f+=8}if(q<16)c>>>=O,f-=O,e.lens[e.have++]=q;else{if(q===16){for(A=O+2;f<A;){if(s===0)break e;s--,c+=n[a++]<<f,f+=8}if(c>>>=O,f-=O,e.have===0){t.msg="invalid bit length repeat",e.mode=Zr;break}re=e.lens[e.have-1],p=3+(c&3),c>>>=2,f-=2}else if(q===17){for(A=O+3;f<A;){if(s===0)break e;s--,c+=n[a++]<<f,f+=8}c>>>=O,f-=O,re=0,p=3+(c&7),c>>>=3,f-=3}else{for(A=O+7;f<A;){if(s===0)break e;s--,c+=n[a++]<<f,f+=8}c>>>=O,f-=O,re=0,p=11+(c&127),c>>>=7,f-=7}if(e.have+p>e.nlen+e.ndist){t.msg="invalid bit length repeat",e.mode=Zr;break}for(;p--;)e.lens[e.have++]=re}}if(e.mode===Zr)break;if(e.lens[256]===0){t.msg="invalid code -- missing end-of-block",e.mode=Zr;break}if(e.lenbits=9,ae={bits:e.lenbits},ee=W0(ux,e.lens,0,e.nlen,e.lencode,0,e.work,ae),e.lenbits=ae.bits,ee){t.msg="invalid literal/lengths set",e.mode=Zr;break}if(e.distbits=6,e.distcode=e.distdyn,ae={bits:e.distbits},ee=W0(hx,e.lens,e.nlen,e.ndist,e.distcode,0,e.work,ae),e.distbits=ae.bits,ee){t.msg="invalid distances set",e.mode=Zr;break}if(e.mode=jf,r===zf)break e;case jf:e.mode=Hf;case Hf:if(s>=6&&l>=258){t.next_out=o,t.avail_out=l,t.next_in=a,t.avail_in=s,e.hold=c,e.bits=f,rP(t,x),o=t.next_out,i=t.output,l=t.avail_out,a=t.next_in,n=t.input,s=t.avail_in,c=e.hold,f=e.bits,e.mode===Go&&(e.back=-1);break}for(e.back=0;k=e.lencode[c&(1<<e.lenbits)-1],O=k>>>24,H=k>>>16&255,q=k&65535,!(O<=f);){if(s===0)break e;s--,c+=n[a++]<<f,f+=8}if(H&&(H&240)===0){for(X=O,he=H,ke=q;k=e.lencode[ke+((c&(1<<X+he)-1)>>X)],O=k>>>24,H=k>>>16&255,q=k&65535,!(X+O<=f);){if(s===0)break e;s--,c+=n[a++]<<f,f+=8}c>>>=X,f-=X,e.back+=X}if(c>>>=O,f-=O,e.back+=O,e.length=q,H===0){e.mode=L2;break}if(H&32){e.back=-1,e.mode=Go;break}if(H&64){t.msg="invalid literal/length code",e.mode=Zr;break}e.extra=H&15,e.mode=F2;case F2:if(e.extra){for(A=e.extra;f<A;){if(s===0)break e;s--,c+=n[a++]<<f,f+=8}e.length+=c&(1<<e.extra)-1,c>>>=e.extra,f-=e.extra,e.back+=e.extra}e.was=e.length,e.mode=D2;case D2:for(;k=e.distcode[c&(1<<e.distbits)-1],O=k>>>24,H=k>>>16&255,q=k&65535,!(O<=f);){if(s===0)break e;s--,c+=n[a++]<<f,f+=8}if((H&240)===0){for(X=O,he=H,ke=q;k=e.distcode[ke+((c&(1<<X+he)-1)>>X)],O=k>>>24,H=k>>>16&255,q=k&65535,!(X+O<=f);){if(s===0)break e;s--,c+=n[a++]<<f,f+=8}c>>>=X,f-=X,e.back+=X}if(c>>>=O,f-=O,e.back+=O,H&64){t.msg="invalid distance code",e.mode=Zr;break}e.offset=q,e.extra=H&15,e.mode=N2;case N2:if(e.extra){for(A=e.extra;f<A;){if(s===0)break e;s--,c+=n[a++]<<f,f+=8}e.offset+=c&(1<<e.extra)-1,c>>>=e.extra,f-=e.extra,e.back+=e.extra}if(e.offset>e.dmax){t.msg="invalid distance too far back",e.mode=Zr;break}e.mode=R2;case R2:if(l===0)break e;if(p=x-l,e.offset>p){if(p=e.offset-p,p>e.whave&&e.sane){t.msg="invalid distance too far back",e.mode=Zr;break}p>e.wnext?(p-=e.wnext,S=e.wsize-p):S=e.wnext-p,p>e.length&&(p=e.length),w=e.window}else w=i,S=o-e.offset,p=e.length;p>l&&(p=l),l-=p,e.length-=p;do i[o++]=w[S++];while(--p);e.length===0&&(e.mode=Hf);break;case L2:if(l===0)break e;i[o++]=e.length,l--,e.mode=Hf;break;case Gp:if(e.wrap){for(;f<32;){if(s===0)break e;s--,c|=n[a++]<<f,f+=8}if(x-=l,t.total_out+=x,e.total+=x,e.wrap&4&&x&&(t.adler=e.check=e.flags?qn(e.check,i,x,o-x):Y0(e.check,i,x,o-x)),x=l,e.wrap&4&&(e.flags?c:V2(c))!==e.check){t.msg="incorrect data check",e.mode=Zr;break}c=0,f=0}e.mode=B2;case B2:if(e.wrap&&e.flags){for(;f<32;){if(s===0)break e;s--,c+=n[a++]<<f,f+=8}if(e.wrap&4&&c!==(e.total&4294967295)){t.msg="incorrect length check",e.mode=Zr;break}c=0,f=0}e.mode=U2;case U2:ee=dP;break e;case Zr:ee=px;break e;case gx:return mx;case _x:default:return Ea}return t.next_out=o,t.avail_out=l,t.next_in=a,t.avail_in=s,e.hold=c,e.bits=f,(e.wsize||x!==t.avail_out&&e.mode<Zr&&(e.mode<Gp||r!==_2))&&yx(t,t.output,t.next_out,x-t.avail_out),v-=t.avail_in,x-=t.avail_out,t.total_in+=v,t.total_out+=x,e.total+=x,e.wrap&4&&x&&(t.adler=e.check=e.flags?qn(e.check,i,x,t.next_out-x):Y0(e.check,i,x,t.next_out-x)),t.data_type=e.bits+(e.last?64:0)+(e.mode===Go?128:0)+(e.mode===jf||e.mode===qp?256:0),(v===0&&x===0||r===_2)&&ee===Pl&&(ee=uP),ee},wP=t=>{if(Ol(t))return Ea;let r=t.state;return r.window&&(r.window=null),t.state=null,Pl},yP=(t,r)=>{if(Ol(t))return Ea;let e=t.state;return(e.wrap&2)===0?Ea:(e.head=r,r.done=!1,Pl)},CP=(t,r)=>{let e=r.length,n,i,a;return Ol(t)||(n=t.state,n.wrap!==0&&n.mode!==$f)?Ea:n.mode===$f&&(i=1,i=Y0(i,r,e,0),i!==n.check)?px:(a=yx(t,r,e,e),a?(n.mode=gx,mx):(n.havedict=1,Pl))},SP=xx,kP=bx,EP=vx,MP=vP,PP=wx,OP=bP,AP=wP,TP=yP,IP=CP,FP="pako inflate (from Nodeca project)",Xo={inflateReset:SP,inflateReset2:kP,inflateResetKeep:EP,inflateInit:MP,inflateInit2:PP,inflate:OP,inflateEnd:AP,inflateGetHeader:TP,inflateSetDictionary:IP,inflateInfo:FP};function DP(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var NP=DP,Cx=Object.prototype.toString,{Z_NO_FLUSH:RP,Z_FINISH:LP,Z_OK:J0,Z_STREAM_END:Yp,Z_NEED_DICT:Kp,Z_STREAM_ERROR:BP,Z_DATA_ERROR:j2,Z_MEM_ERROR:UP}=bc;function rd(t){this.options=Yf.assign({chunkSize:1024*64,windowBits:15,to:""},t||{});let r=this.options;r.raw&&r.windowBits>=0&&r.windowBits<16&&(r.windowBits=-r.windowBits,r.windowBits===0&&(r.windowBits=-15)),r.windowBits>=0&&r.windowBits<16&&!(t&&t.windowBits)&&(r.windowBits+=32),r.windowBits>15&&r.windowBits<48&&(r.windowBits&15)===0&&(r.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new dx,this.strm.avail_out=0;let e=Xo.inflateInit2(this.strm,r.windowBits);if(e!==J0)throw new Error(El[e]);if(this.header=new NP,Xo.inflateGetHeader(this.strm,this.header),r.dictionary&&(typeof r.dictionary=="string"?r.dictionary=Z0.string2buf(r.dictionary):Cx.call(r.dictionary)==="[object ArrayBuffer]"&&(r.dictionary=new Uint8Array(r.dictionary)),r.raw&&(e=Xo.inflateSetDictionary(this.strm,r.dictionary),e!==J0)))throw new Error(El[e])}rd.prototype.push=function(t,r){let e=this.strm,n=this.options.chunkSize,i=this.options.dictionary,a,o,s;if(this.ended)return!1;for(r===~~r?o=r:o=r===!0?LP:RP,Cx.call(t)==="[object ArrayBuffer]"?e.input=new Uint8Array(t):e.input=t,e.next_in=0,e.avail_in=e.input.length;;){for(e.avail_out===0&&(e.output=new Uint8Array(n),e.next_out=0,e.avail_out=n),a=Xo.inflate(e,o),a===Kp&&i&&(a=Xo.inflateSetDictionary(e,i),a===J0?a=Xo.inflate(e,o):a===j2&&(a=Kp));e.avail_in>0&&a===Yp&&e.state.wrap>0&&t[e.next_in]!==0;)Xo.inflateReset(e),a=Xo.inflate(e,o);switch(a){case BP:case j2:case Kp:case UP:return this.onEnd(a),this.ended=!0,!1}if(s=e.avail_out,e.next_out&&(e.avail_out===0||a===Yp))if(this.options.to==="string"){let l=Z0.utf8border(e.output,e.next_out),c=e.next_out-l,f=Z0.buf2string(e.output,l);e.next_out=c,e.avail_out=n-c,c&&e.output.set(e.output.subarray(l,l+c),0),this.onData(f)}else this.onData(e.output.length===e.next_out?e.output:e.output.subarray(0,e.next_out));if(!(a===J0&&s===0)){if(a===Yp)return a=Xo.inflateEnd(this.strm),this.onEnd(a),this.ended=!0,!0;if(e.avail_in===0)break}}return!0};rd.prototype.onData=function(t){this.chunks.push(t)};rd.prototype.onEnd=function(t){t===J0&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=Yf.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg};function um(t,r){let e=new rd(r);if(e.push(t),e.err)throw e.msg||El[e.err];return e.result}function VP(t,r){return r=r||{},r.raw=!0,um(t,r)}var zP=rd,jP=um,HP=VP,WP=um,qP=bc,GP={Inflate:zP,inflate:jP,inflateRaw:HP,ungzip:WP,constants:qP},{Deflate:lR,deflate:cR,deflateRaw:dR,gzip:fR}=eP,{Inflate:$P,inflate:XP,inflateRaw:uR,ungzip:hR}=GP;var hm=$P,Sx=XP;var Ex=[];for(let t=0;t<256;t++){let r=t;for(let e=0;e<8;e++)r&1?r=3988292384^r>>>1:r=r>>>1;Ex[t]=r}var kx=4294967295;function YP(t,r,e){let n=t;for(let i=0;i<e;i++)n=Ex[(n^r[i])&255]^n>>>8;return n}function KP(t,r){return(YP(kx,t,r)^kx)>>>0}function pm(t,r,e){let n=t.readUint32(),i=KP(new Uint8Array(t.buffer,t.byteOffset+t.offset-r-4,r),r);if(i!==n)throw new Error(`CRC mismatch for chunk ${e}. Expected ${n}, found ${i}`)}function Zf(t,r,e){for(let n=0;n<e;n++)r[n]=t[n]}function Jf(t,r,e,n){let i=0;for(;i<n;i++)r[i]=t[i];for(;i<e;i++)r[i]=t[i]+r[i-n]&255}function Qf(t,r,e,n){let i=0;if(e.length===0)for(;i<n;i++)r[i]=t[i];else for(;i<n;i++)r[i]=t[i]+e[i]&255}function eu(t,r,e,n,i){let a=0;if(e.length===0){for(;a<i;a++)r[a]=t[a];for(;a<n;a++)r[a]=t[a]+(r[a-i]>>1)&255}else{for(;a<i;a++)r[a]=t[a]+(e[a]>>1)&255;for(;a<n;a++)r[a]=t[a]+(r[a-i]+e[a]>>1)&255}}function tu(t,r,e,n,i){let a=0;if(e.length===0){for(;a<i;a++)r[a]=t[a];for(;a<n;a++)r[a]=t[a]+r[a-i]&255}else{for(;a<i;a++)r[a]=t[a]+e[a]&255;for(;a<n;a++)r[a]=t[a]+ZP(r[a-i],e[a],e[a-i])&255}}function ZP(t,r,e){let n=t+r-e,i=Math.abs(n-t),a=Math.abs(n-r),o=Math.abs(n-e);return i<=a&&i<=o?t:a<=o?r:e}function Mx(t,r,e,n,i,a){switch(t){case 0:Zf(r,e,i);break;case 1:Jf(r,e,i,a);break;case 2:Qf(r,e,n,i);break;case 3:eu(r,e,n,i,a);break;case 4:tu(r,e,n,i,a);break;default:throw new Error(`Unsupported filter: ${t}`)}}var JP=new Uint16Array([255]),QP=new Uint8Array(JP.buffer),e8=QP[0]===255;function Px(t){let{data:r,width:e,height:n,channels:i,depth:a}=t,o=[{x:0,y:0,xStep:8,yStep:8},{x:4,y:0,xStep:8,yStep:8},{x:0,y:4,xStep:4,yStep:8},{x:2,y:0,xStep:4,yStep:4},{x:0,y:2,xStep:2,yStep:4},{x:1,y:0,xStep:2,yStep:2},{x:0,y:1,xStep:1,yStep:2}],s=Math.ceil(a/8)*i,l=new Uint8Array(n*e*s),c=0;for(let f=0;f<7;f++){let v=o[f],x=Math.ceil((e-v.x)/v.xStep),p=Math.ceil((n-v.y)/v.yStep);if(x<=0||p<=0)continue;let S=x*s,w=new Uint8Array(S);for(let k=0;k<p;k++){let O=r[c++],H=r.subarray(c,c+S);c+=S;let q=new Uint8Array(S);Mx(O,H,q,w,S,s),w.set(q);for(let X=0;X<x;X++){let he=v.x+X*v.xStep,ke=v.y+k*v.yStep;if(!(he>=e||ke>=n))for(let re=0;re<s;re++)l[(ke*e+he)*s+re]=q[X*s+re]}}}if(a===16){let f=new Uint16Array(l.buffer);if(e8)for(let v=0;v<f.length;v++)f[v]=t8(f[v]);return f}else return l}function t8(t){return(t&255)<<8|t>>8&255}var r8=new Uint16Array([255]),n8=new Uint8Array(r8.buffer),i8=n8[0]===255,a8=new Uint8Array(0);function mm(t){let{data:r,width:e,height:n,channels:i,depth:a}=t,o=Math.ceil(a/8)*i,s=Math.ceil(a/8*i*e),l=new Uint8Array(n*s),c=a8,f=0,v,x;for(let p=0;p<n;p++){switch(v=r.subarray(f+1,f+1+s),x=l.subarray(p*s,(p+1)*s),r[f]){case 0:Zf(v,x,s);break;case 1:Jf(v,x,s,o);break;case 2:Qf(v,x,c,s);break;case 3:eu(v,x,c,s,o);break;case 4:tu(v,x,c,s,o);break;default:throw new Error(`Unsupported filter: ${r[f]}`)}c=x,f+=s+1}if(a===16){let p=new Uint16Array(l.buffer);if(i8)for(let S=0;S<p.length;S++)p[S]=o8(p[S]);return p}else return l}function o8(t){return(t&255)<<8|t>>8&255}var ru=Uint8Array.of(137,80,78,71,13,10,26,10);function gm(t){if(!Ox(t.readBytes(ru.length)))throw new Error("wrong PNG signature")}function Ox(t){if(t.length<ru.length)return!1;for(let r=0;r<ru.length;r++)if(t[r]!==ru[r])return!1;return!0}var Ax="tEXt",l8=0,Tx=new TextDecoder("latin1");function c8(t){if(f8(t),t.length===0||t.length>79)throw new Error("keyword length must be between 1 and 79")}var d8=/^[\u0000-\u00FF]*$/;function f8(t){if(!d8.test(t))throw new Error("invalid latin1 text")}function Ix(t,r,e){let n=_m(r);t[n]=u8(r,e-n.length-1)}function _m(t){for(t.mark();t.readByte()!==l8;);let r=t.offset;t.reset();let e=Tx.decode(t.readBytes(r-t.offset-1));return t.skip(1),c8(e),e}function u8(t,r){return Tx.decode(t.readBytes(r))}var yi={UNKNOWN:-1,GREYSCALE:0,TRUECOLOUR:2,INDEXED_COLOUR:3,GREYSCALE_ALPHA:4,TRUECOLOUR_ALPHA:6},nd={UNKNOWN:-1,DEFLATE:0},nu={UNKNOWN:-1,ADAPTIVE:0},id={UNKNOWN:-1,NO_INTERLACE:0,ADAM7:1},ad={NONE:0,BACKGROUND:1,PREVIOUS:2},iu={SOURCE:0,OVER:1};var au=class extends B0{_checkCrc;_inflator;_png;_apng;_end;_hasPalette;_palette;_hasTransparency;_transparency;_compressionMethod;_filterMethod;_interlaceMethod;_colorType;_isAnimated;_numberOfFrames;_numberOfPlays;_frames;_writingDataChunks;constructor(r,e={}){super(r);let{checkCrc:n=!1}=e;this._checkCrc=n,this._inflator=new hm,this._png={width:-1,height:-1,channels:-1,data:new Uint8Array(0),depth:1,text:{}},this._apng={width:-1,height:-1,channels:-1,depth:1,numberOfFrames:1,numberOfPlays:0,text:{},frames:[]},this._end=!1,this._hasPalette=!1,this._palette=[],this._hasTransparency=!1,this._transparency=new Uint16Array(0),this._compressionMethod=nd.UNKNOWN,this._filterMethod=nu.UNKNOWN,this._interlaceMethod=id.UNKNOWN,this._colorType=yi.UNKNOWN,this._isAnimated=!1,this._numberOfFrames=1,this._numberOfPlays=0,this._frames=[],this._writingDataChunks=!1,this.setBigEndian()}decode(){for(gm(this);!this._end;){let r=this.readUint32(),e=this.readChars(4);this.decodeChunk(r,e)}return this.decodeImage(),this._png}decodeApng(){for(gm(this);!this._end;){let r=this.readUint32(),e=this.readChars(4);this.decodeApngChunk(r,e)}return this.decodeApngImage(),this._apng}decodeChunk(r,e){let n=this.offset;switch(e){case"IHDR":this.decodeIHDR();break;case"PLTE":this.decodePLTE(r);break;case"IDAT":this.decodeIDAT(r);break;case"IEND":this._end=!0;break;case"tRNS":this.decodetRNS(r);break;case"iCCP":this.decodeiCCP(r);break;case Ax:Ix(this._png.text,this,r);break;case"pHYs":this.decodepHYs();break;default:this.skip(r);break}if(this.offset-n!==r)throw new Error(`Length mismatch while decoding chunk ${e}`);this._checkCrc?pm(this,r+4,e):this.skip(4)}decodeApngChunk(r,e){let n=this.offset;switch(e!=="fdAT"&&e!=="IDAT"&&this._writingDataChunks&&this.pushDataToFrame(),e){case"acTL":this.decodeACTL();break;case"fcTL":this.decodeFCTL();break;case"fdAT":this.decodeFDAT(r);break;default:this.decodeChunk(r,e),this.offset=n+r;break}if(this.offset-n!==r)throw new Error(`Length mismatch while decoding chunk ${e}`);this._checkCrc?pm(this,r+4,e):this.skip(4)}decodeIHDR(){let r=this._png;r.width=this.readUint32(),r.height=this.readUint32(),r.depth=h8(this.readUint8());let e=this.readUint8();this._colorType=e;let n;switch(e){case yi.GREYSCALE:n=1;break;case yi.TRUECOLOUR:n=3;break;case yi.INDEXED_COLOUR:n=1;break;case yi.GREYSCALE_ALPHA:n=2;break;case yi.TRUECOLOUR_ALPHA:n=4;break;case yi.UNKNOWN:default:throw new Error(`Unknown color type: ${e}`)}if(this._png.channels=n,this._compressionMethod=this.readUint8(),this._compressionMethod!==nd.DEFLATE)throw new Error(`Unsupported compression method: ${this._compressionMethod}`);this._filterMethod=this.readUint8(),this._interlaceMethod=this.readUint8()}decodeACTL(){this._numberOfFrames=this.readUint32(),this._numberOfPlays=this.readUint32(),this._isAnimated=!0}decodeFCTL(){let r={sequenceNumber:this.readUint32(),width:this.readUint32(),height:this.readUint32(),xOffset:this.readUint32(),yOffset:this.readUint32(),delayNumber:this.readUint16(),delayDenominator:this.readUint16(),disposeOp:this.readUint8(),blendOp:this.readUint8(),data:new Uint8Array(0)};this._frames.push(r)}decodePLTE(r){if(r%3!==0)throw new RangeError(`PLTE field length must be a multiple of 3. Got ${r}`);let e=r/3;this._hasPalette=!0;let n=[];this._palette=n;for(let i=0;i<e;i++)n.push([this.readUint8(),this.readUint8(),this.readUint8()])}decodeIDAT(r){this._writingDataChunks=!0;let e=r,n=this.offset+this.byteOffset;if(this._inflator.push(new Uint8Array(this.buffer,n,e)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(r)}decodeFDAT(r){this._writingDataChunks=!0;let e=r,n=this.offset+this.byteOffset;if(n+=4,e-=4,this._inflator.push(new Uint8Array(this.buffer,n,e)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(r)}decodetRNS(r){switch(this._colorType){case yi.GREYSCALE:case yi.TRUECOLOUR:{if(r%2!==0)throw new RangeError(`tRNS chunk length must be a multiple of 2. Got ${r}`);if(r/2>this._png.width*this._png.height)throw new Error(`tRNS chunk contains more alpha values than there are pixels (${r/2} vs ${this._png.width*this._png.height})`);this._hasTransparency=!0,this._transparency=new Uint16Array(r/2);for(let e=0;e<r/2;e++)this._transparency[e]=this.readUint16();break}case yi.INDEXED_COLOUR:{if(r>this._palette.length)throw new Error(`tRNS chunk contains more alpha values than there are palette colors (${r} vs ${this._palette.length})`);let e=0;for(;e<r;e++){let n=this.readByte();this._palette[e].push(n)}for(;e<this._palette.length;e++)this._palette[e].push(255);break}case yi.UNKNOWN:case yi.GREYSCALE_ALPHA:case yi.TRUECOLOUR_ALPHA:default:throw new Error(`tRNS chunk is not supported for color type ${this._colorType}`)}}decodeiCCP(r){let e=_m(this),n=this.readUint8();if(n!==nd.DEFLATE)throw new Error(`Unsupported iCCP compression method: ${n}`);let i=this.readBytes(r-e.length-2);this._png.iccEmbeddedProfile={name:e,profile:Sx(i)}}decodepHYs(){let r=this.readUint32(),e=this.readUint32(),n=this.readByte();this._png.resolution={x:r,y:e,unit:n}}decodeApngImage(){this._apng.width=this._png.width,this._apng.height=this._png.height,this._apng.channels=this._png.channels,this._apng.depth=this._png.depth,this._apng.numberOfFrames=this._numberOfFrames,this._apng.numberOfPlays=this._numberOfPlays,this._apng.text=this._png.text,this._apng.resolution=this._png.resolution;for(let r=0;r<this._numberOfFrames;r++){let e={sequenceNumber:this._frames[r].sequenceNumber,delayNumber:this._frames[r].delayNumber,delayDenominator:this._frames[r].delayDenominator,data:this._apng.depth===8?new Uint8Array(this._apng.width*this._apng.height*this._apng.channels):new Uint16Array(this._apng.width*this._apng.height*this._apng.channels)},n=this._frames.at(r);if(n){if(n.data=mm({data:n.data,width:n.width,height:n.height,channels:this._apng.channels,depth:this._apng.depth}),this._hasPalette&&(this._apng.palette=this._palette),this._hasTransparency&&(this._apng.transparency=this._transparency),r===0||n.xOffset===0&&n.yOffset===0&&n.width===this._png.width&&n.height===this._png.height)e.data=n.data;else{let i=this._apng.frames.at(r-1);this.disposeFrame(n,i,e),this.addFrameDataToCanvas(e,n)}this._apng.frames.push(e)}}return this._apng}disposeFrame(r,e,n){switch(r.disposeOp){case ad.NONE:break;case ad.BACKGROUND:for(let i=0;i<this._png.height;i++)for(let a=0;a<this._png.width;a++){let o=(i*r.width+a)*this._png.channels;for(let s=0;s<this._png.channels;s++)n.data[o+s]=0}break;case ad.PREVIOUS:n.data.set(e.data);break;default:throw new Error("Unknown disposeOp")}}addFrameDataToCanvas(r,e){let n=1<<this._png.depth,i=(a,o)=>{let s=((a+e.yOffset)*this._png.width+e.xOffset+o)*this._png.channels,l=(a*e.width+o)*this._png.channels;return{index:s,frameIndex:l}};switch(e.blendOp){case iu.SOURCE:for(let a=0;a<e.height;a++)for(let o=0;o<e.width;o++){let{index:s,frameIndex:l}=i(a,o);for(let c=0;c<this._png.channels;c++)r.data[s+c]=e.data[l+c]}break;case iu.OVER:for(let a=0;a<e.height;a++)for(let o=0;o<e.width;o++){let{index:s,frameIndex:l}=i(a,o);for(let c=0;c<this._png.channels;c++){let f=e.data[l+this._png.channels-1]/n,v=c%(this._png.channels-1)===0?1:e.data[l+c],x=Math.floor(f*v+(1-f)*r.data[s+c]);r.data[s+c]+=x}}break;default:throw new Error("Unknown blendOp")}}decodeImage(){if(this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);let r=this._isAnimated?(this._frames?.at(0)).data:this._inflator.result;if(this._filterMethod!==nu.ADAPTIVE)throw new Error(`Filter method ${this._filterMethod} not supported`);if(this._interlaceMethod===id.NO_INTERLACE)this._png.data=mm({data:r,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else if(this._interlaceMethod===id.ADAM7)this._png.data=Px({data:r,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else throw new Error(`Interlace method ${this._interlaceMethod} not supported`);this._hasPalette&&(this._png.palette=this._palette),this._hasTransparency&&(this._png.transparency=this._transparency)}pushDataToFrame(){let r=this._inflator.result,e=this._frames.at(-1);e?e.data=r:this._frames.push({sequenceNumber:0,width:this._png.width,height:this._png.height,xOffset:0,yOffset:0,delayNumber:0,delayDenominator:0,disposeOp:ad.NONE,blendOp:iu.SOURCE,data:r}),this._inflator=new hm,this._writingDataChunks=!1}};function h8(t){if(t!==1&&t!==2&&t!==4&&t!==8&&t!==16)throw new Error(`invalid bit depth: ${t}`);return t}function Fx(t,r){return new au(t,r).decode()}var Ut=(function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this})();function vm(){Ut.console&&typeof Ut.console.log=="function"&&Ut.console.log.apply(Ut.console,arguments)}var Br={log:vm,warn:function(t){Ut.console&&(typeof Ut.console.warn=="function"?Ut.console.warn.apply(Ut.console,arguments):vm.call(null,arguments))},error:function(t){Ut.console&&(typeof Ut.console.error=="function"?Ut.console.error.apply(Ut.console,arguments):vm(t))}};function xm(t,r,e){var n=new XMLHttpRequest;n.open("GET",t),n.responseType="blob",n.onload=function(){Al(n.response,r,e)},n.onerror=function(){Br.error("could not download file")},n.send()}function Dx(t){var r=new XMLHttpRequest;r.open("HEAD",t,!1);try{r.send()}catch{}return r.status>=200&&r.status<=299}function ou(t){try{t.dispatchEvent(new MouseEvent("click"))}catch{var r=document.createEvent("MouseEvents");r.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),t.dispatchEvent(r)}}var Al=Ut.saveAs||((typeof window>"u"?"undefined":Ir(window))!=="object"||window!==Ut?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(t,r,e){var n=Ut.URL||Ut.webkitURL,i=document.createElement("a");r=r||t.name||"download",i.download=r,i.rel="noopener",typeof t=="string"?(i.href=t,i.origin!==location.origin?Dx(i.href)?xm(t,r,e):ou(i,i.target="_blank"):ou(i)):(i.href=n.createObjectURL(t),setTimeout(function(){n.revokeObjectURL(i.href)},4e4),setTimeout(function(){ou(i)},0))}:"msSaveOrOpenBlob"in navigator?function(t,r,e){if(r=r||t.name||"download",typeof t=="string")if(Dx(t))xm(t,r,e);else{var n=document.createElement("a");n.href=t,n.target="_blank",setTimeout(function(){ou(n)})}else navigator.msSaveOrOpenBlob((function(i,a){return a===void 0?a={autoBom:!1}:Ir(a)!=="object"&&(Br.warn("Deprecated: Expected third argument to be a object"),a={autoBom:!a}),a.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(i.type)?new Blob(["\uFEFF",i],{type:i.type}):i})(t,e),r)}:function(t,r,e,n){if((n=n||open("","_blank"))&&(n.document.title=n.document.body.innerText="downloading..."),typeof t=="string")return xm(t,r,e);var i=t.type==="application/octet-stream",a=/constructor/i.test(Ut.HTMLElement)||Ut.safari,o=/CriOS\/[\d]+/.test(navigator.userAgent);if((o||i&&a)&&(typeof FileReader>"u"?"undefined":Ir(FileReader))==="object"){var s=new FileReader;s.onloadend=function(){var f=s.result;f=o?f:f.replace(/^data:[^;]*;/,"data:attachment/file;"),n?n.location.href=f:location=f,n=null},s.readAsDataURL(t)}else{var l=Ut.URL||Ut.webkitURL,c=l.createObjectURL(t);n?n.location=c:location.href=c,n=null,setTimeout(function(){l.revokeObjectURL(c)},4e4)}});function ib(t){var r;t=t||"",this.ok=!1,t.charAt(0)=="#"&&(t=t.substr(1,6)),t={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[t=(t=t.replace(/ /g,"")).toLowerCase()]||t;for(var e=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(s){return[parseInt(s[1]),parseInt(s[2]),parseInt(s[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(s){return[parseInt(s[1],16),parseInt(s[2],16),parseInt(s[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(s){return[parseInt(s[1]+s[1],16),parseInt(s[2]+s[2],16),parseInt(s[3]+s[3],16)]}}],n=0;n<e.length;n++){var i=e[n].re,a=e[n].process,o=i.exec(t);o&&(r=a(o),this.r=r[0],this.g=r[1],this.b=r[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var s=this.r.toString(16),l=this.g.toString(16),c=this.b.toString(16);return s.length==1&&(s="0"+s),l.length==1&&(l="0"+l),c.length==1&&(c="0"+c),"#"+s+l+c}}var du=Ut.atob.bind(Ut),Nx=Ut.btoa.bind(Ut);function bm(t,r){var e=t[0],n=t[1],i=t[2],a=t[3];e=ci(e,n,i,a,r[0],7,-680876936),a=ci(a,e,n,i,r[1],12,-389564586),i=ci(i,a,e,n,r[2],17,606105819),n=ci(n,i,a,e,r[3],22,-1044525330),e=ci(e,n,i,a,r[4],7,-176418897),a=ci(a,e,n,i,r[5],12,1200080426),i=ci(i,a,e,n,r[6],17,-1473231341),n=ci(n,i,a,e,r[7],22,-45705983),e=ci(e,n,i,a,r[8],7,1770035416),a=ci(a,e,n,i,r[9],12,-1958414417),i=ci(i,a,e,n,r[10],17,-42063),n=ci(n,i,a,e,r[11],22,-1990404162),e=ci(e,n,i,a,r[12],7,1804603682),a=ci(a,e,n,i,r[13],12,-40341101),i=ci(i,a,e,n,r[14],17,-1502002290),e=di(e,n=ci(n,i,a,e,r[15],22,1236535329),i,a,r[1],5,-165796510),a=di(a,e,n,i,r[6],9,-1069501632),i=di(i,a,e,n,r[11],14,643717713),n=di(n,i,a,e,r[0],20,-373897302),e=di(e,n,i,a,r[5],5,-701558691),a=di(a,e,n,i,r[10],9,38016083),i=di(i,a,e,n,r[15],14,-660478335),n=di(n,i,a,e,r[4],20,-405537848),e=di(e,n,i,a,r[9],5,568446438),a=di(a,e,n,i,r[14],9,-1019803690),i=di(i,a,e,n,r[3],14,-187363961),n=di(n,i,a,e,r[8],20,1163531501),e=di(e,n,i,a,r[13],5,-1444681467),a=di(a,e,n,i,r[2],9,-51403784),i=di(i,a,e,n,r[7],14,1735328473),e=fi(e,n=di(n,i,a,e,r[12],20,-1926607734),i,a,r[5],4,-378558),a=fi(a,e,n,i,r[8],11,-2022574463),i=fi(i,a,e,n,r[11],16,1839030562),n=fi(n,i,a,e,r[14],23,-35309556),e=fi(e,n,i,a,r[1],4,-1530992060),a=fi(a,e,n,i,r[4],11,1272893353),i=fi(i,a,e,n,r[7],16,-155497632),n=fi(n,i,a,e,r[10],23,-1094730640),e=fi(e,n,i,a,r[13],4,681279174),a=fi(a,e,n,i,r[0],11,-358537222),i=fi(i,a,e,n,r[3],16,-722521979),n=fi(n,i,a,e,r[6],23,76029189),e=fi(e,n,i,a,r[9],4,-640364487),a=fi(a,e,n,i,r[12],11,-421815835),i=fi(i,a,e,n,r[15],16,530742520),e=ui(e,n=fi(n,i,a,e,r[2],23,-995338651),i,a,r[0],6,-198630844),a=ui(a,e,n,i,r[7],10,1126891415),i=ui(i,a,e,n,r[14],15,-1416354905),n=ui(n,i,a,e,r[5],21,-57434055),e=ui(e,n,i,a,r[12],6,1700485571),a=ui(a,e,n,i,r[3],10,-1894986606),i=ui(i,a,e,n,r[10],15,-1051523),n=ui(n,i,a,e,r[1],21,-2054922799),e=ui(e,n,i,a,r[8],6,1873313359),a=ui(a,e,n,i,r[15],10,-30611744),i=ui(i,a,e,n,r[6],15,-1560198380),n=ui(n,i,a,e,r[13],21,1309151649),e=ui(e,n,i,a,r[4],6,-145523070),a=ui(a,e,n,i,r[11],10,-1120210379),i=ui(i,a,e,n,r[2],15,718787259),n=ui(n,i,a,e,r[9],21,-343485551),t[0]=Vs(e,t[0]),t[1]=Vs(n,t[1]),t[2]=Vs(i,t[2]),t[3]=Vs(a,t[3])}function _u(t,r,e,n,i,a){return r=Vs(Vs(r,t),Vs(n,a)),Vs(r<<i|r>>>32-i,e)}function ci(t,r,e,n,i,a,o){return _u(r&e|~r&n,t,r,i,a,o)}function di(t,r,e,n,i,a,o){return _u(r&n|e&~n,t,r,i,a,o)}function fi(t,r,e,n,i,a,o){return _u(r^e^n,t,r,i,a,o)}function ui(t,r,e,n,i,a,o){return _u(e^(r|~n),t,r,i,a,o)}function ab(t){var r,e=t.length,n=[1732584193,-271733879,-1732584194,271733878];for(r=64;r<=t.length;r+=64)bm(n,p8(t.substring(r-64,r)));t=t.substring(r-64);var i=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(r=0;r<t.length;r++)i[r>>2]|=t.charCodeAt(r)<<(r%4<<3);if(i[r>>2]|=128<<(r%4<<3),r>55)for(bm(n,i),r=0;r<16;r++)i[r]=0;return i[14]=8*e,bm(n,i),n}function p8(t){var r,e=[];for(r=0;r<64;r+=4)e[r>>2]=t.charCodeAt(r)+(t.charCodeAt(r+1)<<8)+(t.charCodeAt(r+2)<<16)+(t.charCodeAt(r+3)<<24);return e}var Rx="0123456789abcdef".split("");function m8(t){for(var r="",e=0;e<4;e++)r+=Rx[t>>8*e+4&15]+Rx[t>>8*e&15];return r}function g8(t){return String.fromCharCode(255&t,(65280&t)>>8,(16711680&t)>>16,(4278190080&t)>>24)}function Em(t){return ab(t).map(g8).join("")}var _8=(function(t){for(var r=0;r<t.length;r++)t[r]=m8(t[r]);return t.join("")})(ab("hello"))!="5d41402abc4b2a76b9719d911017c592";function Vs(t,r){if(_8){var e=(65535&t)+(65535&r);return(t>>16)+(r>>16)+(e>>16)<<16|65535&e}return t+r&4294967295}function Mm(t,r){var e,n,i,a;if(t!==e){for(var o=(i=t,a=1+(256/t.length|0),new Array(a+1).join(i)),s=[],l=0;l<256;l++)s[l]=l;var c=0;for(l=0;l<256;l++){var f=s[l];c=(c+f+o.charCodeAt(l))%256,s[l]=s[c],s[c]=f}e=t,n=s}else s=n;var v=r.length,x=0,p=0,S="";for(l=0;l<v;l++)p=(p+(f=s[x=(x+1)%256]))%256,s[x]=s[p],s[p]=f,o=s[(s[x]+s[p])%256],S+=String.fromCharCode(r.charCodeAt(l)^o);return S}var Lx={print:4,modify:8,copy:16,"annot-forms":32};function kc(t,r,e,n){this.v=1,this.r=2;var i=192;t.forEach(function(s){if(Lx.perm!==void 0)throw new Error("Invalid permission: "+s);i+=Lx[s]}),this.padding="(\xBFN^Nu\x8AAd\0NV\xFF\xFA\b..\0\xB6\xD0h>\x80/\f\xA9\xFEdSiz";var a=(r+this.padding).substr(0,32),o=(e+this.padding).substr(0,32);this.O=this.processOwnerPassword(a,o),this.P=-(1+(255^i)),this.encryptionKey=Em(a+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(n)).substr(0,5),this.U=Mm(this.encryptionKey,this.padding)}function Ec(t){if(/[^\u0000-\u00ff]/.test(t))throw new Error("Invalid PDF Name Object: "+t+", Only accept ASCII characters.");for(var r="",e=t.length,n=0;n<e;n++){var i=t.charCodeAt(n);r+=i<33||i===35||i===37||i===40||i===41||i===47||i===60||i===62||i===91||i===93||i===123||i===125||i>126?"#"+("0"+i.toString(16)).slice(-2):t[n]}return r}function Bx(t){if(Ir(t)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var r={};this.subscribe=function(e,n,i){if(i=i||!1,typeof e!="string"||typeof n!="function"||typeof i!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");r.hasOwnProperty(e)||(r[e]={});var a=Math.random().toString(35);return r[e][a]=[n,!!i],a},this.unsubscribe=function(e){for(var n in r)if(r[n][e])return delete r[n][e],Object.keys(r[n]).length===0&&delete r[n],!0;return!1},this.publish=function(e){if(r.hasOwnProperty(e)){var n=Array.prototype.slice.call(arguments,1),i=[];for(var a in r[e]){var o=r[e][a];try{o[0].apply(t,n)}catch(s){Ut.console&&Br.error("jsPDF PubSub Error",s.message,s)}o[1]&&i.push(a)}i.length&&i.forEach(this.unsubscribe)}},this.getTopics=function(){return r}}function mu(t){if(!(this instanceof mu))return new mu(t);var r="opacity,stroke-opacity".split(",");for(var e in t)t.hasOwnProperty(e)&&r.indexOf(e)>=0&&(this[e]=t[e]);this.id="",this.objectNumber=-1}function ob(t,r){this.gState=t,this.matrix=r,this.id="",this.objectNumber=-1}function Tl(t,r,e,n,i){if(!(this instanceof Tl))return new Tl(t,r,e,n,i);this.type=t==="axial"?2:3,this.coords=r,this.colors=e,ob.call(this,n,i)}function Mc(t,r,e,n,i){if(!(this instanceof Mc))return new Mc(t,r,e,n,i);this.boundingBox=t,this.xStep=r,this.yStep=e,this.stream="",this.cloneIndex=0,ob.call(this,n,i)}function bt(t){var r,e=typeof arguments[0]=="string"?arguments[0]:"p",n=arguments[1],i=arguments[2],a=arguments[3],o=[],s=1,l=16,c="S",f=null;Ir(t=t||{})==="object"&&(e=t.orientation,n=t.unit||n,i=t.format||i,a=t.compress||t.compressPdf||a,(f=t.encryption||null)!==null&&(f.userPassword=f.userPassword||"",f.ownerPassword=f.ownerPassword||"",f.userPermissions=f.userPermissions||[]),s=typeof t.userUnit=="number"?Math.abs(t.userUnit):1,t.precision!==void 0&&(r=t.precision),t.floatPrecision!==void 0&&(l=t.floatPrecision),c=t.defaultPathOperation||"S"),o=t.filters||(a===!0?["FlateEncode"]:o),n=n||"mm",e=(""+(e||"P")).toLowerCase();var v=t.putOnlyUsedFonts||!1,x={},p={internal:{},__private__:{}};p.__private__.PubSub=Bx;var S="1.3",w=p.__private__.getPdfVersion=function(){return S};p.__private__.setPdfVersion=function(b){S=b};var k={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};p.__private__.getPageFormats=function(){return k};var O=p.__private__.getPageFormat=function(b){return k[b]};i=i||"a4";var H="compat",q="advanced",X=H;function he(){this.saveGraphicsState(),Q(new Nt(jt,0,0,-jt,0,Xs()*jt).toString()+" cm"),this.setFontSize(this.getFontSize()/jt),c="n",X=q}function ke(){this.restoreGraphicsState(),c="S",X=H}var re=p.__private__.combineFontStyleAndFontWeight=function(b,I){if(b=="bold"&&I=="normal"||b=="bold"&&I==400||b=="normal"&&I=="italic"||b=="bold"&&I=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return I&&(b=I==400||I==="normal"?b==="italic"?"italic":"normal":I!=700&&I!=="bold"||b!=="normal"?(I==700?"bold":I)+""+b:"bold"),b};p.advancedAPI=function(b){var I=X===H;return I&&he.call(this),typeof b!="function"||(b(this),I&&ke.call(this)),this},p.compatAPI=function(b){var I=X===q;return I&&ke.call(this),typeof b!="function"||(b(this),I&&he.call(this)),this},p.isAdvancedAPI=function(){return X===q};var ee,W=function(b){if(X!==q)throw new Error(b+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},ae=p.roundToPrecision=p.__private__.roundToPrecision=function(b,I){var le=r||I;if(isNaN(b)||isNaN(le))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return b.toFixed(le).replace(/0+$/,"")};ee=p.hpf=p.__private__.hpf=typeof l=="number"?function(b){if(isNaN(b))throw new Error("Invalid argument passed to jsPDF.hpf");return ae(b,l)}:l==="smart"?function(b){if(isNaN(b))throw new Error("Invalid argument passed to jsPDF.hpf");return ae(b,b>-1&&b<1?16:5)}:function(b){if(isNaN(b))throw new Error("Invalid argument passed to jsPDF.hpf");return ae(b,16)};var A=p.f2=p.__private__.f2=function(b){if(isNaN(b))throw new Error("Invalid argument passed to jsPDF.f2");return ae(b,2)},V=p.__private__.f3=function(b){if(isNaN(b))throw new Error("Invalid argument passed to jsPDF.f3");return ae(b,3)},de=p.scale=p.__private__.scale=function(b){if(isNaN(b))throw new Error("Invalid argument passed to jsPDF.scale");return X===H?b*jt:X===q?b:void 0},ue=function(b){return de((function(I){return X===H?Xs()-I:X===q?I:void 0})(b))};p.__private__.setPrecision=p.setPrecision=function(b){typeof parseInt(b,10)=="number"&&(r=parseInt(b,10))};var xe,Ne="00000000000000000000000000000000",Re=p.__private__.getFileId=function(){return Ne},Ee=p.__private__.setFileId=function(b){return Ne=b!==void 0&&/^[a-fA-F0-9]{32}$/.test(b)?b.toUpperCase():Ne.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),f!==null&&(Mn=new kc(f.userPermissions,f.userPassword,f.ownerPassword,Ne)),Ne};p.setFileId=function(b){return Ee(b),this},p.getFileId=function(){return Re()};var Be=p.__private__.convertDateToPDFDate=function(b){var I=b.getTimezoneOffset(),le=I<0?"+":"-",me=Math.floor(Math.abs(I/60)),Se=Math.abs(I%60),We=[le,T(me),"'",T(Se),"'"].join("");return["D:",b.getFullYear(),T(b.getMonth()+1),T(b.getDate()),T(b.getHours()),T(b.getMinutes()),T(b.getSeconds()),We].join("")},Je=p.__private__.convertPDFDateToDate=function(b){var I=parseInt(b.substr(2,4),10),le=parseInt(b.substr(6,2),10)-1,me=parseInt(b.substr(8,2),10),Se=parseInt(b.substr(10,2),10),We=parseInt(b.substr(12,2),10),Ke=parseInt(b.substr(14,2),10);return new Date(I,le,me,Se,We,Ke,0)},qe=p.__private__.setCreationDate=function(b){var I;if(b===void 0&&(b=new Date),b instanceof Date)I=Be(b);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(b))throw new Error("Invalid argument passed to jsPDF.setCreationDate");I=b}return xe=I},E=p.__private__.getCreationDate=function(b){var I=xe;return b==="jsDate"&&(I=Je(xe)),I};p.setCreationDate=function(b){return qe(b),this},p.getCreationDate=function(b){return E(b)};var U,T=p.__private__.padd2=function(b){return("0"+parseInt(b)).slice(-2)},R=p.__private__.padd2Hex=function(b){return("00"+(b=b.toString())).substr(b.length)},te=0,pe=[],ye=[],ve=0,_e=[],He=[],Ye=!1,nt=ye;p.__private__.setCustomOutputDestination=function(b){Ye=!0,nt=b};var at=function(b){Ye||(nt=b)};p.__private__.resetCustomOutputDestination=function(){Ye=!1,nt=ye};var Q=p.__private__.out=function(b){return b=b.toString(),ve+=b.length+1,nt.push(b),nt},tt=p.__private__.write=function(b){return Q(arguments.length===1?b.toString():Array.prototype.join.call(arguments," "))},Qe=p.__private__.getArrayBuffer=function(b){for(var I=b.length,le=new ArrayBuffer(I),me=new Uint8Array(le);I--;)me[I]=b.charCodeAt(I);return le},_t=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];p.__private__.getStandardFonts=function(){return _t};var $e=t.fontSize||16;p.__private__.setFontSize=p.setFontSize=function(b){return $e=X===q?b/jt:b,this};var Et,pt=p.__private__.getFontSize=p.getFontSize=function(){return X===H?$e:$e*jt},At=t.R2L||!1;p.__private__.setR2L=p.setR2L=function(b){return At=b,this},p.__private__.getR2L=p.getR2L=function(){return At};var Pt,Kt=p.__private__.setZoomMode=function(b){if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(b))Et=b;else if(isNaN(b)){if([void 0,null,"fullwidth","fullheight","fullpage","original"].indexOf(b)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+b+'" is not recognized.');Et=b}else Et=parseInt(b,10)};p.__private__.getZoomMode=function(){return Et};var Zt,Lt=p.__private__.setPageMode=function(b){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(b)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+b+'" is not recognized.');Pt=b};p.__private__.getPageMode=function(){return Pt};var rr=p.__private__.setLayoutMode=function(b){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(b)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+b+'" is not recognized.');Zt=b};p.__private__.getLayoutMode=function(){return Zt},p.__private__.setDisplayMode=p.setDisplayMode=function(b,I,le){return Kt(b),rr(I),Lt(le),this};var Wt={title:"",subject:"",author:"",keywords:"",creator:""};p.__private__.getDocumentProperty=function(b){if(Object.keys(Wt).indexOf(b)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return Wt[b]},p.__private__.getDocumentProperties=function(){return Wt},p.__private__.setDocumentProperties=p.setProperties=p.setDocumentProperties=function(b){for(var I in Wt)Wt.hasOwnProperty(I)&&b[I]&&(Wt[I]=b[I]);return this},p.__private__.setDocumentProperty=function(b,I){if(Object.keys(Wt).indexOf(b)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return Wt[b]=I};var yt,jt,kt,$r,ar,$t={},Xt={},Ur=[],Tt={},Sr={},Dt={},Vt={},Vr=null,er=0,It=[],pr=new Bx(p),vo=t.hotfixes||[],Nn={},Pa={},sa=[],Nt=function b(I,le,me,Se,We,Ke){if(!(this instanceof b))return new b(I,le,me,Se,We,Ke);isNaN(I)&&(I=1),isNaN(le)&&(le=0),isNaN(me)&&(me=0),isNaN(Se)&&(Se=1),isNaN(We)&&(We=0),isNaN(Ke)&&(Ke=0),this._matrix=[I,le,me,Se,We,Ke]};Object.defineProperty(Nt.prototype,"sx",{get:function(){return this._matrix[0]},set:function(b){this._matrix[0]=b}}),Object.defineProperty(Nt.prototype,"shy",{get:function(){return this._matrix[1]},set:function(b){this._matrix[1]=b}}),Object.defineProperty(Nt.prototype,"shx",{get:function(){return this._matrix[2]},set:function(b){this._matrix[2]=b}}),Object.defineProperty(Nt.prototype,"sy",{get:function(){return this._matrix[3]},set:function(b){this._matrix[3]=b}}),Object.defineProperty(Nt.prototype,"tx",{get:function(){return this._matrix[4]},set:function(b){this._matrix[4]=b}}),Object.defineProperty(Nt.prototype,"ty",{get:function(){return this._matrix[5]},set:function(b){this._matrix[5]=b}}),Object.defineProperty(Nt.prototype,"a",{get:function(){return this._matrix[0]},set:function(b){this._matrix[0]=b}}),Object.defineProperty(Nt.prototype,"b",{get:function(){return this._matrix[1]},set:function(b){this._matrix[1]=b}}),Object.defineProperty(Nt.prototype,"c",{get:function(){return this._matrix[2]},set:function(b){this._matrix[2]=b}}),Object.defineProperty(Nt.prototype,"d",{get:function(){return this._matrix[3]},set:function(b){this._matrix[3]=b}}),Object.defineProperty(Nt.prototype,"e",{get:function(){return this._matrix[4]},set:function(b){this._matrix[4]=b}}),Object.defineProperty(Nt.prototype,"f",{get:function(){return this._matrix[5]},set:function(b){this._matrix[5]=b}}),Object.defineProperty(Nt.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(Nt.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(Nt.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(Nt.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),Nt.prototype.join=function(b){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(ee).join(b)},Nt.prototype.multiply=function(b){var I=b.sx*this.sx+b.shy*this.shx,le=b.sx*this.shy+b.shy*this.sy,me=b.shx*this.sx+b.sy*this.shx,Se=b.shx*this.shy+b.sy*this.sy,We=b.tx*this.sx+b.ty*this.shx+this.tx,Ke=b.tx*this.shy+b.ty*this.sy+this.ty;return new Nt(I,le,me,Se,We,Ke)},Nt.prototype.decompose=function(){var b=this.sx,I=this.shy,le=this.shx,me=this.sy,Se=this.tx,We=this.ty,Ke=Math.sqrt(b*b+I*I),xt=(b/=Ke)*le+(I/=Ke)*me;le-=b*xt,me-=I*xt;var Mt=Math.sqrt(le*le+me*me);return xt/=Mt,b*(me/=Mt)<I*(le/=Mt)&&(b=-b,I=-I,xt=-xt,Ke=-Ke),{scale:new Nt(Ke,0,0,Mt,0,0),translate:new Nt(1,0,0,1,Se,We),rotate:new Nt(b,I,-I,b,0,0),skew:new Nt(1,0,xt,1,0,0)}},Nt.prototype.toString=function(b){return this.join(" ")},Nt.prototype.inversed=function(){var b=this.sx,I=this.shy,le=this.shx,me=this.sy,Se=this.tx,We=this.ty,Ke=1/(b*me-I*le),xt=me*Ke,Mt=-I*Ke,zt=-le*Ke,Yt=b*Ke;return new Nt(xt,Mt,zt,Yt,-xt*Se-zt*We,-Mt*Se-Yt*We)},Nt.prototype.applyToPoint=function(b){var I=b.x*this.sx+b.y*this.shx+this.tx,le=b.x*this.shy+b.y*this.sy+this.ty;return new Co(I,le)},Nt.prototype.applyToRectangle=function(b){var I=this.applyToPoint(b),le=this.applyToPoint(new Co(b.x+b.w,b.y+b.h));return new jc(I.x,I.y,le.x-I.x,le.y-I.y)},Nt.prototype.clone=function(){var b=this.sx,I=this.shy,le=this.shx,me=this.sy,Se=this.tx,We=this.ty;return new Nt(b,I,le,me,Se,We)},p.Matrix=Nt;var Oa=p.matrixMult=function(b,I){return I.multiply(b)},Aa=new Nt(1,0,0,1,0,0);p.unitMatrix=p.identityMatrix=Aa;var ai=function(b,I){if(!Sr[b]){var le=(I instanceof Tl?"Sh":"P")+(Object.keys(Tt).length+1).toString(10);I.id=le,Sr[b]=le,Tt[le]=I,pr.publish("addPattern",I)}};p.ShadingPattern=Tl,p.TilingPattern=Mc,p.addShadingPattern=function(b,I){return W("addShadingPattern()"),ai(b,I),this},p.beginTilingPattern=function(b){W("beginTilingPattern()"),Hc(b.boundingBox[0],b.boundingBox[1],b.boundingBox[2]-b.boundingBox[0],b.boundingBox[3]-b.boundingBox[1],b.matrix)},p.endTilingPattern=function(b,I){W("endTilingPattern()"),I.stream=He[U].join(`
`),ai(b,I),pr.publish("endTilingPattern",I),sa.pop().restore()};var ki,Xr=p.__private__.newObject=function(){var b=vn();return B(b,!0),b},vn=p.__private__.newObjectDeferred=function(){return te++,pe[te]=function(){return ve},te},B=function(b,I){return I=typeof I=="boolean"&&I,pe[b]=ve,I&&Q(b+" 0 obj"),b},oe=p.__private__.newAdditionalObject=function(){var b={objId:vn(),content:""};return _e.push(b),b},K=vn(),J=vn(),se=p.__private__.decodeColorString=function(b){var I=b.split(" ");if(I.length!==2||I[1]!=="g"&&I[1]!=="G")I.length!==5||I[4]!=="k"&&I[4]!=="K"||(I=[(1-I[0])*(1-I[3]),(1-I[1])*(1-I[3]),(1-I[2])*(1-I[3]),"r"]);else{var le=parseFloat(I[0]);I=[le,le,le,"r"]}for(var me="#",Se=0;Se<3;Se++)me+=("0"+Math.floor(255*parseFloat(I[Se])).toString(16)).slice(-2);return me},ce=p.__private__.encodeColorString=function(b){var I;typeof b=="string"&&(b={ch1:b});var le=b.ch1,me=b.ch2,Se=b.ch3,We=b.ch4,Ke=b.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof le=="string"&&le.charAt(0)!=="#"){var xt=new ib(le);if(xt.ok)le=xt.toHex();else if(!/^\d*\.?\d*$/.test(le))throw new Error('Invalid color "'+le+'" passed to jsPDF.encodeColorString.')}if(typeof le=="string"&&/^#[0-9A-Fa-f]{3}$/.test(le)&&(le="#"+le[1]+le[1]+le[2]+le[2]+le[3]+le[3]),typeof le=="string"&&/^#[0-9A-Fa-f]{6}$/.test(le)){var Mt=parseInt(le.substr(1),16);le=Mt>>16&255,me=Mt>>8&255,Se=255&Mt}if(me===void 0||We===void 0&&le===me&&me===Se)I=typeof le=="string"?le+" "+Ke[0]:b.precision===2?A(le/255)+" "+Ke[0]:V(le/255)+" "+Ke[0];else if(We===void 0||Ir(We)==="object"){if(We&&!isNaN(We.a)&&We.a===0)return["1.","1.","1.",Ke[1]].join(" ");I=typeof le=="string"?[le,me,Se,Ke[1]].join(" "):b.precision===2?[A(le/255),A(me/255),A(Se/255),Ke[1]].join(" "):[V(le/255),V(me/255),V(Se/255),Ke[1]].join(" ")}else I=typeof le=="string"?[le,me,Se,We,Ke[2]].join(" "):b.precision===2?[A(le),A(me),A(Se),A(We),Ke[2]].join(" "):[V(le),V(me),V(Se),V(We),Ke[2]].join(" ");return I},Oe=p.__private__.getFilters=function(){return o},Le=p.__private__.putStream=function(b){var I=(b=b||{}).data||"",le=b.filters||Oe(),me=b.alreadyAppliedFilters||[],Se=b.addLength1||!1,We=I.length,Ke=b.objectId,xt=function(Pn){return Pn};if(f!==null&&Ke===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");f!==null&&(xt=Mn.encryptor(Ke,0));var Mt={};le===!0&&(le=["FlateEncode"]);var zt=b.additionalKeyValues||[],Yt=(Mt=bt.API.processDataByFilters!==void 0?bt.API.processDataByFilters(I,le):{data:I,reverseChain:[]}).reverseChain+(Array.isArray(me)?me.join(" "):me.toString());if(Mt.data.length!==0&&(zt.push({key:"Length",value:Mt.data.length}),Se===!0&&zt.push({key:"Length1",value:We})),Yt.length!=0)if(Yt.split("/").length-1==1)zt.push({key:"Filter",value:Yt});else{zt.push({key:"Filter",value:"["+Yt+"]"});for(var ur=0;ur<zt.length;ur+=1)if(zt[ur].key==="DecodeParms"){for(var Jr=[],wn=0;wn<Mt.reverseChain.split("/").length-1;wn+=1)Jr.push("null");Jr.push(zt[ur].value),zt[ur].value="["+Jr.join(" ")+"]"}}Q("<<");for(var jr=0;jr<zt.length;jr++)Q("/"+zt[jr].key+" "+zt[jr].value);Q(">>"),Mt.data.length!==0&&(Q("stream"),Q(xt(Mt.data)),Q("endstream"))},Ie=p.__private__.putPage=function(b){var I=b.number,le=b.data,me=b.objId,Se=b.contentsObjId;B(me,!0),Q("<</Type /Page"),Q("/Parent "+b.rootDictionaryObjId+" 0 R"),Q("/Resources "+b.resourceDictionaryObjId+" 0 R"),Q("/MediaBox ["+parseFloat(ee(b.mediaBox.bottomLeftX))+" "+parseFloat(ee(b.mediaBox.bottomLeftY))+" "+ee(b.mediaBox.topRightX)+" "+ee(b.mediaBox.topRightY)+"]"),b.cropBox!==null&&Q("/CropBox ["+ee(b.cropBox.bottomLeftX)+" "+ee(b.cropBox.bottomLeftY)+" "+ee(b.cropBox.topRightX)+" "+ee(b.cropBox.topRightY)+"]"),b.bleedBox!==null&&Q("/BleedBox ["+ee(b.bleedBox.bottomLeftX)+" "+ee(b.bleedBox.bottomLeftY)+" "+ee(b.bleedBox.topRightX)+" "+ee(b.bleedBox.topRightY)+"]"),b.trimBox!==null&&Q("/TrimBox ["+ee(b.trimBox.bottomLeftX)+" "+ee(b.trimBox.bottomLeftY)+" "+ee(b.trimBox.topRightX)+" "+ee(b.trimBox.topRightY)+"]"),b.artBox!==null&&Q("/ArtBox ["+ee(b.artBox.bottomLeftX)+" "+ee(b.artBox.bottomLeftY)+" "+ee(b.artBox.topRightX)+" "+ee(b.artBox.topRightY)+"]"),typeof b.userUnit=="number"&&b.userUnit!==1&&Q("/UserUnit "+b.userUnit),pr.publish("putPage",{objId:me,pageContext:It[I],pageNumber:I,page:le}),Q("/Contents "+Se+" 0 R"),Q(">>"),Q("endobj");var We=le.join(`
`);return X===q&&(We+=`
Q`),B(Se,!0),Le({data:We,filters:Oe(),objectId:Se}),Q("endobj"),me},Ae=p.__private__.putPages=function(){var b,I,le=[];for(b=1;b<=er;b++)It[b].objId=vn(),It[b].contentsObjId=vn();for(b=1;b<=er;b++)le.push(Ie({number:b,data:He[b],objId:It[b].objId,contentsObjId:It[b].contentsObjId,mediaBox:It[b].mediaBox,cropBox:It[b].cropBox,bleedBox:It[b].bleedBox,trimBox:It[b].trimBox,artBox:It[b].artBox,userUnit:It[b].userUnit,rootDictionaryObjId:K,resourceDictionaryObjId:J}));B(K,!0),Q("<</Type /Pages");var me="/Kids [";for(I=0;I<er;I++)me+=le[I]+" 0 R ";Q(me+"]"),Q("/Count "+er),Q(">>"),Q("endobj"),pr.publish("postPutPages")},De=function(b){pr.publish("putFont",{font:b,out:Q,newObject:Xr,putStream:Le}),b.isAlreadyPutted!==!0&&(b.objectNumber=Xr(),Q("<<"),Q("/Type /Font"),Q("/BaseFont /"+Ec(b.postScriptName)),Q("/Subtype /Type1"),typeof b.encoding=="string"&&Q("/Encoding /"+b.encoding),Q("/FirstChar 32"),Q("/LastChar 255"),Q(">>"),Q("endobj"))},et=function(b){b.objectNumber=Xr();var I=[];I.push({key:"Type",value:"/XObject"}),I.push({key:"Subtype",value:"/Form"}),I.push({key:"BBox",value:"["+[ee(b.x),ee(b.y),ee(b.x+b.width),ee(b.y+b.height)].join(" ")+"]"}),I.push({key:"Matrix",value:"["+b.matrix.toString()+"]"});var le=b.pages[1].join(`
`);Le({data:le,additionalKeyValues:I,objectId:b.objectNumber}),Q("endobj")},it=function(b,I){I||(I=21);var le=Xr(),me=(function(Ke,xt){var Mt,zt=[],Yt=1/(xt-1);for(Mt=0;Mt<1;Mt+=Yt)zt.push(Mt);if(zt.push(1),Ke[0].offset!=0){var ur={offset:0,color:Ke[0].color};Ke.unshift(ur)}if(Ke[Ke.length-1].offset!=1){var Jr={offset:1,color:Ke[Ke.length-1].color};Ke.push(Jr)}for(var wn="",jr=0,Pn=0;Pn<zt.length;Pn++){for(Mt=zt[Pn];Mt>Ke[jr+1].offset;)jr++;var yn=Ke[jr].offset,$n=(Mt-yn)/(Ke[jr+1].offset-yn),Eo=Ke[jr].color,Fa=Ke[jr+1].color;wn+=R(Math.round((1-$n)*Eo[0]+$n*Fa[0]).toString(16))+R(Math.round((1-$n)*Eo[1]+$n*Fa[1]).toString(16))+R(Math.round((1-$n)*Eo[2]+$n*Fa[2]).toString(16))}return wn.trim()})(b.colors,I),Se=[];Se.push({key:"FunctionType",value:"0"}),Se.push({key:"Domain",value:"[0.0 1.0]"}),Se.push({key:"Size",value:"["+I+"]"}),Se.push({key:"BitsPerSample",value:"8"}),Se.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),Se.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),Le({data:me,additionalKeyValues:Se,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:le}),Q("endobj"),b.objectNumber=Xr(),Q("<< /ShadingType "+b.type),Q("/ColorSpace /DeviceRGB");var We="/Coords ["+ee(parseFloat(b.coords[0]))+" "+ee(parseFloat(b.coords[1]))+" ";b.type===2?We+=ee(parseFloat(b.coords[2]))+" "+ee(parseFloat(b.coords[3])):We+=ee(parseFloat(b.coords[2]))+" "+ee(parseFloat(b.coords[3]))+" "+ee(parseFloat(b.coords[4]))+" "+ee(parseFloat(b.coords[5])),Q(We+="]"),b.matrix&&Q("/Matrix ["+b.matrix.toString()+"]"),Q("/Function "+le+" 0 R"),Q("/Extend [true true]"),Q(">>"),Q("endobj")},mt=function(b,I){var le=vn(),me=Xr();I.push({resourcesOid:le,objectOid:me}),b.objectNumber=me;var Se=[];Se.push({key:"Type",value:"/Pattern"}),Se.push({key:"PatternType",value:"1"}),Se.push({key:"PaintType",value:"1"}),Se.push({key:"TilingType",value:"1"}),Se.push({key:"BBox",value:"["+b.boundingBox.map(ee).join(" ")+"]"}),Se.push({key:"XStep",value:ee(b.xStep)}),Se.push({key:"YStep",value:ee(b.yStep)}),Se.push({key:"Resources",value:le+" 0 R"}),b.matrix&&Se.push({key:"Matrix",value:"["+b.matrix.toString()+"]"}),Le({data:b.stream,additionalKeyValues:Se,objectId:b.objectNumber}),Q("endobj")},ot=function(b){for(var I in b.objectNumber=Xr(),Q("<<"),b)switch(I){case"opacity":Q("/ca "+A(b[I]));break;case"stroke-opacity":Q("/CA "+A(b[I]))}Q(">>"),Q("endobj")},lt=function(b){B(b.resourcesOid,!0),Q("<<"),Q("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),(function(){for(var I in Q("/Font <<"),$t)$t.hasOwnProperty(I)&&(v===!1||v===!0&&x.hasOwnProperty(I))&&Q("/"+I+" "+$t[I].objectNumber+" 0 R");Q(">>")})(),(function(){if(Object.keys(Tt).length>0){for(var I in Q("/Shading <<"),Tt)Tt.hasOwnProperty(I)&&Tt[I]instanceof Tl&&Tt[I].objectNumber>=0&&Q("/"+I+" "+Tt[I].objectNumber+" 0 R");pr.publish("putShadingPatternDict"),Q(">>")}})(),(function(I){if(Object.keys(Tt).length>0){for(var le in Q("/Pattern <<"),Tt)Tt.hasOwnProperty(le)&&Tt[le]instanceof p.TilingPattern&&Tt[le].objectNumber>=0&&Tt[le].objectNumber<I&&Q("/"+le+" "+Tt[le].objectNumber+" 0 R");pr.publish("putTilingPatternDict"),Q(">>")}})(b.objectOid),(function(){if(Object.keys(Dt).length>0){var I;for(I in Q("/ExtGState <<"),Dt)Dt.hasOwnProperty(I)&&Dt[I].objectNumber>=0&&Q("/"+I+" "+Dt[I].objectNumber+" 0 R");pr.publish("putGStateDict"),Q(">>")}})(),(function(){for(var I in Q("/XObject <<"),Nn)Nn.hasOwnProperty(I)&&Nn[I].objectNumber>=0&&Q("/"+I+" "+Nn[I].objectNumber+" 0 R");pr.publish("putXobjectDict"),Q(">>")})(),Q(">>"),Q("endobj")},Rt=function(b){Xt[b.fontName]=Xt[b.fontName]||{},Xt[b.fontName][b.fontStyle]=b.id},wr=function(b,I,le,me,Se){var We={id:"F"+(Object.keys($t).length+1).toString(10),postScriptName:b,fontName:I,fontStyle:le,encoding:me,isStandardFont:Se||!1,metadata:{}};return pr.publish("addFont",{font:We,instance:this}),$t[We.id]=We,Rt(We),We.id},Dr=p.__private__.pdfEscape=p.pdfEscape=function(b,I){return(function(le,me){var Se,We,Ke,xt,Mt,zt,Yt,ur,Jr;if(Ke=(me=me||{}).sourceEncoding||"Unicode",Mt=me.outputEncoding,(me.autoencode||Mt)&&$t[yt].metadata&&$t[yt].metadata[Ke]&&$t[yt].metadata[Ke].encoding&&(xt=$t[yt].metadata[Ke].encoding,!Mt&&$t[yt].encoding&&(Mt=$t[yt].encoding),!Mt&&xt.codePages&&(Mt=xt.codePages[0]),typeof Mt=="string"&&(Mt=xt[Mt]),Mt)){for(Yt=!1,zt=[],Se=0,We=le.length;Se<We;Se++)(ur=Mt[le.charCodeAt(Se)])?zt.push(String.fromCharCode(ur)):zt.push(le[Se]),zt[Se].charCodeAt(0)>>8&&(Yt=!0);le=zt.join("")}for(Se=le.length;Yt===void 0&&Se!==0;)le.charCodeAt(Se-1)>>8&&(Yt=!0),Se--;if(!Yt)return le;for(zt=me.noBOM?[]:[254,255],Se=0,We=le.length;Se<We;Se++){if((Jr=(ur=le.charCodeAt(Se))>>8)>>8)throw new Error("Character at position "+Se+" of string '"+le+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");zt.push(Jr),zt.push(ur-(Jr<<8))}return String.fromCharCode.apply(void 0,zt)})(b,I).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},zr=p.__private__.beginPage=function(b){He[++er]=[],It[er]={objId:0,contentsObjId:0,userUnit:Number(s),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(b[0]),topRightY:Number(b[1])}},Xa(er),at(He[U])},Rn=function(b,I){var le,me,Se;switch(e=I||e,typeof b=="string"&&(le=O(b.toLowerCase()),Array.isArray(le)&&(me=le[0],Se=le[1])),Array.isArray(b)&&(me=b[0]*jt,Se=b[1]*jt),isNaN(me)&&(me=i[0],Se=i[1]),(me>14400||Se>14400)&&(Br.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),me=Math.min(14400,me),Se=Math.min(14400,Se)),i=[me,Se],e.substr(0,1)){case"l":Se>me&&(i=[Se,me]);break;case"p":me>Se&&(i=[Se,me])}zr(i),Ht(Bc),Q(Ll),Vc!==0&&Q(Vc+" J"),zc!==0&&Q(zc+" j"),pr.publish("addPage",{pageNumber:er})},Ta=function(b){b>0&&b<=er&&(He.splice(b,1),It.splice(b,1),er--,U>er&&(U=er),this.setPage(U))},Xa=function(b){b>0&&b<=er&&(U=b)},la=p.__private__.getNumberOfPages=p.getNumberOfPages=function(){return He.length-1},Zo=function(b,I,le){var me,Se=void 0;return le=le||{},b=b!==void 0?b:$t[yt].fontName,I=I!==void 0?I:$t[yt].fontStyle,me=b.toLowerCase(),Xt[me]!==void 0&&Xt[me][I]!==void 0?Se=Xt[me][I]:Xt[b]!==void 0&&Xt[b][I]!==void 0?Se=Xt[b][I]:le.disableWarning===!1&&Br.warn("Unable to look up font label for font '"+b+"', '"+I+"'. Refer to getFontList() for available fonts."),Se||le.noFallback||(Se=Xt.times[I])==null&&(Se=Xt.times.normal),Se},xn=p.__private__.putInfo=function(){var b=Xr(),I=function(me){return me};for(var le in f!==null&&(I=Mn.encryptor(b,0)),Q("<<"),Q("/Producer ("+Dr(I("jsPDF "+bt.version))+")"),Wt)Wt.hasOwnProperty(le)&&Wt[le]&&Q("/"+le.substr(0,1).toUpperCase()+le.substr(1)+" ("+Dr(I(Wt[le]))+")");Q("/CreationDate ("+Dr(I(xe))+")"),Q(">>"),Q("endobj")},Dl=p.__private__.putCatalog=function(b){var I=(b=b||{}).rootDictionaryObjId||K;switch(Xr(),Q("<<"),Q("/Type /Catalog"),Q("/Pages "+I+" 0 R"),Et||(Et="fullwidth"),Et){case"fullwidth":Q("/OpenAction [3 0 R /FitH null]");break;case"fullheight":Q("/OpenAction [3 0 R /FitV null]");break;case"fullpage":Q("/OpenAction [3 0 R /Fit]");break;case"original":Q("/OpenAction [3 0 R /XYZ null null 1]");break;default:var le=""+Et;le.substr(le.length-1)==="%"&&(Et=parseInt(Et)/100),typeof Et=="number"&&Q("/OpenAction [3 0 R /XYZ null null "+A(Et)+"]")}switch(Zt||(Zt="continuous"),Zt){case"continuous":Q("/PageLayout /OneColumn");break;case"single":Q("/PageLayout /SinglePage");break;case"two":case"twoleft":Q("/PageLayout /TwoColumnLeft");break;case"tworight":Q("/PageLayout /TwoColumnRight")}Pt&&Q("/PageMode /"+Pt),pr.publish("putCatalog"),Q(">>"),Q("endobj")},rh=p.__private__.putTrailer=function(){Q("trailer"),Q("<<"),Q("/Size "+(te+1)),Q("/Root "+te+" 0 R"),Q("/Info "+(te-1)+" 0 R"),f!==null&&Q("/Encrypt "+Mn.oid+" 0 R"),Q("/ID [ <"+Ne+"> <"+Ne+"> ]"),Q(">>")},bn=p.__private__.putHeader=function(){Q("%PDF-"+S),Q("%\xBA\xDF\xAC\xE0")},md=p.__private__.putXRef=function(){var b="0000000000";Q("xref"),Q("0 "+(te+1)),Q("0000000000 65535 f ");for(var I=1;I<=te;I++)typeof pe[I]=="function"?Q((b+pe[I]()).slice(-10)+" 00000 n "):pe[I]!==void 0?Q((b+pe[I]).slice(-10)+" 00000 n "):Q("0000000000 00000 n ")},Ya=p.__private__.buildDocument=function(){var b;te=0,ve=0,ye=[],pe=[],_e=[],K=vn(),J=vn(),at(ye),pr.publish("buildDocument"),bn(),Ae(),(function(){pr.publish("putAdditionalObjects");for(var le=0;le<_e.length;le++){var me=_e[le];B(me.objId,!0),Q(me.content),Q("endobj")}pr.publish("postPutAdditionalObjects")})(),b=[],(function(){for(var le in $t)$t.hasOwnProperty(le)&&(v===!1||v===!0&&x.hasOwnProperty(le))&&De($t[le])})(),(function(){var le;for(le in Dt)Dt.hasOwnProperty(le)&&ot(Dt[le])})(),(function(){for(var le in Nn)Nn.hasOwnProperty(le)&&et(Nn[le])})(),(function(le){var me;for(me in Tt)Tt.hasOwnProperty(me)&&(Tt[me]instanceof Tl?it(Tt[me]):Tt[me]instanceof Mc&&mt(Tt[me],le))})(b),pr.publish("putResources"),b.forEach(lt),lt({resourcesOid:J,objectOid:Number.MAX_SAFE_INTEGER}),pr.publish("postPutResources"),f!==null&&(Mn.oid=Xr(),Q("<<"),Q("/Filter /Standard"),Q("/V "+Mn.v),Q("/R "+Mn.r),Q("/U <"+Mn.toHexString(Mn.U)+">"),Q("/O <"+Mn.toHexString(Mn.O)+">"),Q("/P "+Mn.P),Q(">>"),Q("endobj")),xn(),Dl();var I=ve;return md(),rh(),Q("startxref"),Q(""+I),Q("%%EOF"),at(He[U]),ye.join(`
`)},Nl=p.__private__.getBlob=function(b){return new Blob([Qe(b)],{type:"application/pdf"})},gd=p.output=p.__private__.output=(ki=function(b,I){switch(typeof(I=I||{})=="string"?I={filename:I}:I.filename=I.filename||"generated.pdf",b){case void 0:return Ya();case"save":p.save(I.filename);break;case"arraybuffer":return Qe(Ya());case"blob":return Nl(Ya());case"bloburi":case"bloburl":if(Ut.URL!==void 0&&typeof Ut.URL.createObjectURL=="function")return Ut.URL&&Ut.URL.createObjectURL(Nl(Ya()))||void 0;Br.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var le="",me=Ya();try{le=Nx(me)}catch{le=Nx(unescape(encodeURIComponent(me)))}return"data:application/pdf;filename="+I.filename+";base64,"+le;case"pdfobjectnewwindow":if(Object.prototype.toString.call(Ut)==="[object Window]"){var Se="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",We=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';I.pdfObjectUrl&&(Se=I.pdfObjectUrl,We="");var Ke='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+Se+'"'+We+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(I)+");<\/script></body></html>",xt=Ut.open();return xt!==null&&xt.document.write(Ke),xt}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(Ut)==="[object Window]"){var Mt='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(I.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+I.filename+'" width="500px" height="400px" /></body></html>',zt=Ut.open();if(zt!==null){zt.document.write(Mt);var Yt=this;zt.document.documentElement.querySelector("#pdfViewer").onload=function(){zt.document.title=I.filename,zt.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(Yt.output("bloburl"))}}return zt}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(Ut)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var ur='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",I)+'"></iframe></body></html>',Jr=Ut.open();if(Jr!==null&&(Jr.document.write(ur),Jr.document.title=I.filename),Jr||typeof safari>"u")return Jr;break;case"datauri":case"dataurl":return Ut.document.location.href=this.output("datauristring",I);default:return null}},ki.foo=function(){try{return ki.apply(this,arguments)}catch(le){var b=le.stack||"";~b.indexOf(" at ")&&(b=b.split(" at ")[1]);var I="Error in function "+b.split(`
`)[0].split("<")[0]+": "+le.message;if(!Ut.console)throw new Error(I);Ut.console.error(I,le),Ut.alert&&alert(I)}},ki.foo.bar=ki,ki.foo),ca=function(b){return Array.isArray(vo)===!0&&vo.indexOf(b)>-1};switch(n){case"pt":jt=1;break;case"mm":jt=72/25.4;break;case"cm":jt=72/2.54;break;case"in":jt=72;break;case"px":jt=ca("px_scaling")==1?.75:96/72;break;case"pc":case"em":jt=12;break;case"ex":jt=6;break;default:if(typeof n!="number")throw new Error("Invalid unit: "+n);jt=n}var Mn=null;qe(),Ee();var xo=p.__private__.getPageInfo=p.getPageInfo=function(b){if(isNaN(b)||b%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:It[b].objId,pageNumber:b,pageContext:It[b]}},_d=p.__private__.getPageInfoByObjId=function(b){if(isNaN(b)||b%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var I in It)if(It[I].objId===b)break;return xo(I)},nh=p.__private__.getCurrentPageInfo=p.getCurrentPageInfo=function(){return{objId:It[U].objId,pageNumber:U,pageContext:It[U]}};p.addPage=function(){return Rn.apply(this,arguments),this},p.setPage=function(){return Xa.apply(this,arguments),at.call(this,He[U]),this},p.insertPage=function(b){return this.addPage(),this.movePage(U,b),this},p.movePage=function(b,I){var le,me;if(b>I){le=He[b],me=It[b];for(var Se=b;Se>I;Se--)He[Se]=He[Se-1],It[Se]=It[Se-1];He[I]=le,It[I]=me,this.setPage(I)}else if(b<I){le=He[b],me=It[b];for(var We=b;We<I;We++)He[We]=He[We+1],It[We]=It[We+1];He[I]=le,It[I]=me,this.setPage(I)}return this},p.deletePage=function(){return Ta.apply(this,arguments),this},p.__private__.text=p.text=function(b,I,le,me,Se){var We,Ke,xt,Mt,zt,Yt,ur,Jr,wn,jr=(me=me||{}).scope||this;if(typeof b=="number"&&typeof I=="number"&&(typeof le=="string"||Array.isArray(le))){var Pn=le;le=I,I=b,b=Pn}if(arguments[3]instanceof Nt==0?(xt=arguments[4],Mt=arguments[5],Ir(ur=arguments[3])==="object"&&ur!==null||(typeof xt=="string"&&(Mt=xt,xt=null),typeof ur=="string"&&(Mt=ur,ur=null),typeof ur=="number"&&(xt=ur,ur=null),me={flags:ur,angle:xt,align:Mt})):(W("The transform parameter of text() with a Matrix value"),wn=Se),isNaN(I)||isNaN(le)||b==null)throw new Error("Invalid arguments passed to jsPDF.text");if(b.length===0)return jr;var yn,$n="",Eo=typeof me.lineHeightFactor=="number"?me.lineHeightFactor:qs,Fa=jr.internal.scaleFactor;function Mo(yr){return yr=yr.split("	").join(Array(me.TabLen||9).join(" ")),Dr(yr,ur)}function qc(yr){for(var Nr,fn=yr.concat(),On=[],Ao=fn.length;Ao--;)typeof(Nr=fn.shift())=="string"?On.push(Nr):Array.isArray(yr)&&(Nr.length===1||Nr[1]===void 0&&Nr[2]===void 0)?On.push(Nr[0]):On.push([Nr[0],Nr[1],Nr[2]]);return On}function Ul(yr,Nr){var fn;if(typeof yr=="string")fn=Nr(yr)[0];else if(Array.isArray(yr)){for(var On,Ao,t0=yr.concat(),jl=[],Pd=t0.length;Pd--;)typeof(On=t0.shift())=="string"?jl.push(Nr(On)[0]):Array.isArray(On)&&typeof On[0]=="string"&&(Ao=Nr(On[0],On[1],On[2]),jl.push([Ao[0],Ao[1],Ao[2]]));fn=jl}return fn}var Jo=!1,Ys=!0;if(typeof b=="string")Jo=!0;else if(Array.isArray(b)){var Ks=b.concat();Ke=[];for(var Qo,Xn=Ks.length;Xn--;)(typeof(Qo=Ks.shift())!="string"||Array.isArray(Qo)&&typeof Qo[0]!="string")&&(Ys=!1);Jo=Ys}if(Jo===!1)throw new Error('Type of text must be string or Array. "'+b+'" is not recognized.');typeof b=="string"&&(b=b.match(/[\r?\n]/)?b.split(/\r\n|\r|\n/g):[b]);var Zs=$e/jr.internal.scaleFactor,Js=Zs*(Eo-1);switch(me.baseline){case"bottom":le-=Js;break;case"top":le+=Zs-Js;break;case"hanging":le+=Zs-2*Js;break;case"middle":le+=Zs/2-Js}if((Yt=me.maxWidth||0)>0&&(typeof b=="string"?b=jr.splitTextToSize(b,Yt):Object.prototype.toString.call(b)==="[object Array]"&&(b=b.reduce(function(yr,Nr){return yr.concat(jr.splitTextToSize(Nr,Yt))},[]))),We={text:b,x:I,y:le,options:me,mutex:{pdfEscape:Dr,activeFontKey:yt,fonts:$t,activeFontSize:$e}},pr.publish("preProcessText",We),b=We.text,xt=(me=We.options).angle,wn instanceof Nt==0&&xt&&typeof xt=="number"){xt*=Math.PI/180,me.rotationDirection===0&&(xt=-xt),X===q&&(xt=-xt);var Gc=Math.cos(xt),$c=Math.sin(xt);wn=new Nt(Gc,$c,-$c,Gc,0,0)}else xt&&xt instanceof Nt&&(wn=xt);X!==q||wn||(wn=Aa),(zt=me.charSpace||yo)!==void 0&&($n+=ee(de(zt))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),(Jr=me.horizontalScale)!==void 0&&($n+=ee(100*Jr)+` Tz
`),me.lang;var pi=-1,Po=me.renderingMode!==void 0?me.renderingMode:me.stroke,Vl=jr.internal.getCurrentPageInfo().pageContext;switch(Po){case 0:case!1:case"fill":pi=0;break;case 1:case!0:case"stroke":pi=1;break;case 2:case"fillThenStroke":pi=2;break;case 3:case"invisible":pi=3;break;case 4:case"fillAndAddForClipping":pi=4;break;case 5:case"strokeAndAddPathForClipping":pi=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":pi=6;break;case 7:case"addToPathForClipping":pi=7}var Ed=Vl.usedRenderingMode!==void 0?Vl.usedRenderingMode:-1;pi!==-1?$n+=pi+` Tr
`:Ed!==-1&&($n+=`0 Tr
`),pi!==-1&&(Vl.usedRenderingMode=pi),Mt=me.align||"left";var da,Qs=$e*Eo,Xc=jr.internal.pageSize.getWidth(),Yc=$t[yt];zt=me.charSpace||yo,Yt=me.maxWidth||0,ur=Object.assign({autoencode:!0,noBOM:!0},me.flags);var es=[],el=function(yr){return jr.getStringUnitWidth(yr,{font:Yc,charSpace:zt,fontSize:$e,doKerning:!1})*$e/Fa};if(Object.prototype.toString.call(b)==="[object Array]"){var ji;Ke=qc(b),Mt!=="left"&&(da=Ke.map(el));var Hi,ts=0;if(Mt==="right"){I-=da[0],b=[],Xn=Ke.length;for(var Oo=0;Oo<Xn;Oo++)Oo===0?(Hi=bo(I),ji=wo(le)):(Hi=de(ts-da[Oo]),ji=-Qs),b.push([Ke[Oo],Hi,ji]),ts=da[Oo]}else if(Mt==="center"){I-=da[0]/2,b=[],Xn=Ke.length;for(var rs=0;rs<Xn;rs++)rs===0?(Hi=bo(I),ji=wo(le)):(Hi=de((ts-da[rs])/2),ji=-Qs),b.push([Ke[rs],Hi,ji]),ts=da[rs]}else if(Mt==="left"){b=[],Xn=Ke.length;for(var Kc=0;Kc<Xn;Kc++)b.push(Ke[Kc])}else if(Mt==="justify"&&Yc.encoding==="Identity-H"){b=[],Xn=Ke.length,Yt=Yt!==0?Yt:Xc;for(var zl=0,dn=0;dn<Xn;dn++)if(ji=dn===0?wo(le):-Qs,Hi=dn===0?bo(I):zl,dn<Xn-1){var Md=de((Yt-da[dn])/(Ke[dn].split(" ").length-1)),Za=Ke[dn].split(" ");b.push([Za[0]+" ",Hi,ji]),zl=0;for(var Ja=1;Ja<Za.length;Ja++){var Zc=(el(Za[Ja-1]+" "+Za[Ja])-el(Za[Ja]))*Fa+Md;Ja==Za.length-1?b.push([Za[Ja],Zc,0]):b.push([Za[Ja]+" ",Zc,0]),zl-=Zc}}else b.push([Ke[dn],Hi,ji]);b.push(["",zl,0])}else{if(Mt!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(b=[],Xn=Ke.length,Yt=Yt!==0?Yt:Xc,dn=0;dn<Xn;dn++){ji=dn===0?wo(le):-Qs,Hi=dn===0?bo(I):0;var Jc=Ke[dn].split(" ").length-1,Qc=Jc>0?(Yt-da[dn])/Jc:0;dn<Xn-1?es.push(ee(de(Qc))):es.push(0),b.push([Ke[dn],Hi,ji])}}}(typeof me.R2L=="boolean"?me.R2L:At)===!0&&(b=Ul(b,function(yr,Nr,fn){return[yr.split("").reverse().join(""),Nr,fn]})),We={text:b,x:I,y:le,options:me,mutex:{pdfEscape:Dr,activeFontKey:yt,fonts:$t,activeFontSize:$e}},pr.publish("postProcessText",We),b=We.text,yn=We.mutex.isHex||!1;var e0=$t[yt].encoding;e0!=="WinAnsiEncoding"&&e0!=="StandardEncoding"||(b=Ul(b,function(yr,Nr,fn){return[Mo(yr),Nr,fn]})),Ke=qc(b),b=[];for(var ns,is,as,tl=Array.isArray(Ke[0])?1:0,os="",rl=function(yr,Nr,fn){var On="";return fn instanceof Nt?(fn=typeof me.angle=="number"?Oa(fn,new Nt(1,0,0,1,yr,Nr)):Oa(new Nt(1,0,0,1,yr,Nr),fn),X===q&&(fn=Oa(new Nt(1,0,0,-1,0,0),fn)),On=fn.join(" ")+` Tm
`):On=ee(yr)+" "+ee(Nr)+` Td
`,On},fa=0;fa<Ke.length;fa++){switch(os="",tl){case 1:as=(yn?"<":"(")+Ke[fa][0]+(yn?">":")"),ns=parseFloat(Ke[fa][1]),is=parseFloat(Ke[fa][2]);break;case 0:as=(yn?"<":"(")+Ke[fa]+(yn?">":")"),ns=bo(I),is=wo(le)}es!==void 0&&es[fa]!==void 0&&(os=es[fa]+` Tw
`),fa===0?b.push(os+rl(ns,is,wn)+as):tl===0?b.push(os+as):tl===1&&b.push(os+rl(ns,is,wn)+as)}b=tl===0?b.join(` Tj
T* `):b.join(` Tj
`),b+=` Tj
`;var Qa=`BT
/`;return Qa+=yt+" "+$e+` Tf
`,Qa+=ee($e*Eo)+` TL
`,Qa+=Gs+`
`,Qa+=$n,Qa+=b,Q(Qa+="ET"),x[yt]=!0,jr};var ih=p.__private__.clip=p.clip=function(b){return Q(b==="evenodd"?"W*":"W"),this};p.clipEvenOdd=function(){return ih("evenodd")},p.__private__.discardPath=p.discardPath=function(){return Q("n"),this};var Ka=p.__private__.isValidStyle=function(b){var I=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(b)!==-1&&(I=!0),I};p.__private__.setDefaultPathOperation=p.setDefaultPathOperation=function(b){return Ka(b)&&(c=b),this};var vd=p.__private__.getStyle=p.getStyle=function(b){var I=c;switch(b){case"D":case"S":I="S";break;case"F":I="f";break;case"FD":case"DF":I="B";break;case"f":case"f*":case"B":case"B*":I=b}return I},xd=p.close=function(){return Q("h"),this};p.stroke=function(){return Q("S"),this},p.fill=function(b){return Rl("f",b),this},p.fillEvenOdd=function(b){return Rl("f*",b),this},p.fillStroke=function(b){return Rl("B",b),this},p.fillStrokeEvenOdd=function(b){return Rl("B*",b),this};var Rl=function(b,I){Ir(I)==="object"?oh(I,b):Q(b)},Ws=function(b){b===null||X===q&&b===void 0||(b=vd(b),Q(b))};function ah(b,I,le,me,Se){var We=new Mc(I||this.boundingBox,le||this.xStep,me||this.yStep,this.gState,Se||this.matrix);We.stream=this.stream;var Ke=b+"$$"+this.cloneIndex+++"$$";return ai(Ke,We),We}var oh=function(b,I){var le=Sr[b.key],me=Tt[le];if(me instanceof Tl)Q("q"),Q(sh(I)),me.gState&&p.setGState(me.gState),Q(b.matrix.toString()+" cm"),Q("/"+le+" sh"),Q("Q");else if(me instanceof Mc){var Se=new Nt(1,0,0,-1,0,Xs());b.matrix&&(Se=Se.multiply(b.matrix||Aa),le=ah.call(me,b.key,b.boundingBox,b.xStep,b.yStep,Se).id),Q("q"),Q("/Pattern cs"),Q("/"+le+" scn"),me.gState&&p.setGState(me.gState),Q(I),Q("Q")}},sh=function(b){switch(b){case"f":case"F":case"n":return"W n";case"f*":return"W* n";case"B":case"S":return"W S";case"B*":return"W* S"}},Lc=p.moveTo=function(b,I){return Q(ee(de(b))+" "+ee(ue(I))+" m"),this},bd=p.lineTo=function(b,I){return Q(ee(de(b))+" "+ee(ue(I))+" l"),this},Ia=p.curveTo=function(b,I,le,me,Se,We){return Q([ee(de(b)),ee(ue(I)),ee(de(le)),ee(ue(me)),ee(de(Se)),ee(ue(We)),"c"].join(" ")),this};p.__private__.line=p.line=function(b,I,le,me,Se){if(isNaN(b)||isNaN(I)||isNaN(le)||isNaN(me)||!Ka(Se))throw new Error("Invalid arguments passed to jsPDF.line");return X===H?this.lines([[le-b,me-I]],b,I,[1,1],Se||"S"):this.lines([[le-b,me-I]],b,I,[1,1]).stroke()},p.__private__.lines=p.lines=function(b,I,le,me,Se,We){var Ke,xt,Mt,zt,Yt,ur,Jr,wn,jr,Pn,yn,$n;if(typeof b=="number"&&($n=le,le=I,I=b,b=$n),me=me||[1,1],We=We||!1,isNaN(I)||isNaN(le)||!Array.isArray(b)||!Array.isArray(me)||!Ka(Se)||typeof We!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(Lc(I,le),Ke=me[0],xt=me[1],zt=b.length,Pn=I,yn=le,Mt=0;Mt<zt;Mt++)(Yt=b[Mt]).length===2?(Pn=Yt[0]*Ke+Pn,yn=Yt[1]*xt+yn,bd(Pn,yn)):(ur=Yt[0]*Ke+Pn,Jr=Yt[1]*xt+yn,wn=Yt[2]*Ke+Pn,jr=Yt[3]*xt+yn,Pn=Yt[4]*Ke+Pn,yn=Yt[5]*xt+yn,Ia(ur,Jr,wn,jr,Pn,yn));return We&&xd(),Ws(Se),this},p.path=function(b){for(var I=0;I<b.length;I++){var le=b[I],me=le.c;switch(le.op){case"m":Lc(me[0],me[1]);break;case"l":bd(me[0],me[1]);break;case"c":Ia.apply(this,me);break;case"h":xd()}}return this},p.__private__.rect=p.rect=function(b,I,le,me,Se){if(isNaN(b)||isNaN(I)||isNaN(le)||isNaN(me)||!Ka(Se))throw new Error("Invalid arguments passed to jsPDF.rect");return X===H&&(me=-me),Q([ee(de(b)),ee(ue(I)),ee(de(le)),ee(de(me)),"re"].join(" ")),Ws(Se),this},p.__private__.triangle=p.triangle=function(b,I,le,me,Se,We,Ke){if(isNaN(b)||isNaN(I)||isNaN(le)||isNaN(me)||isNaN(Se)||isNaN(We)||!Ka(Ke))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[le-b,me-I],[Se-le,We-me],[b-Se,I-We]],b,I,[1,1],Ke,!0),this},p.__private__.roundedRect=p.roundedRect=function(b,I,le,me,Se,We,Ke){if(isNaN(b)||isNaN(I)||isNaN(le)||isNaN(me)||isNaN(Se)||isNaN(We)||!Ka(Ke))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var xt=4/3*(Math.SQRT2-1);return Se=Math.min(Se,.5*le),We=Math.min(We,.5*me),this.lines([[le-2*Se,0],[Se*xt,0,Se,We-We*xt,Se,We],[0,me-2*We],[0,We*xt,-Se*xt,We,-Se,We],[2*Se-le,0],[-Se*xt,0,-Se,-We*xt,-Se,-We],[0,2*We-me],[0,-We*xt,Se*xt,-We,Se,-We]],b+Se,I,[1,1],Ke,!0),this},p.__private__.ellipse=p.ellipse=function(b,I,le,me,Se){if(isNaN(b)||isNaN(I)||isNaN(le)||isNaN(me)||!Ka(Se))throw new Error("Invalid arguments passed to jsPDF.ellipse");var We=4/3*(Math.SQRT2-1)*le,Ke=4/3*(Math.SQRT2-1)*me;return Lc(b+le,I),Ia(b+le,I-Ke,b+We,I-me,b,I-me),Ia(b-We,I-me,b-le,I-Ke,b-le,I),Ia(b-le,I+Ke,b-We,I+me,b,I+me),Ia(b+We,I+me,b+le,I+Ke,b+le,I),Ws(Se),this},p.__private__.circle=p.circle=function(b,I,le,me){if(isNaN(b)||isNaN(I)||isNaN(le)||!Ka(me))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(b,I,le,le,me)},p.setFont=function(b,I,le){return le&&(I=re(I,le)),yt=Zo(b,I,{disableWarning:!1}),this};var lh=p.__private__.getFont=p.getFont=function(){return $t[Zo.apply(p,arguments)]};p.__private__.getFontList=p.getFontList=function(){var b,I,le={};for(b in Xt)if(Xt.hasOwnProperty(b))for(I in le[b]=[],Xt[b])Xt[b].hasOwnProperty(I)&&le[b].push(I);return le},p.addFont=function(b,I,le,me,Se){var We=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&We.indexOf(arguments[3])!==-1?Se=arguments[3]:arguments[3]&&We.indexOf(arguments[3])==-1&&(le=re(le,me)),wr.call(this,b,I,le,Se=Se||"Identity-H")};var qs,Bc=t.lineWidth||.200025,ch=p.__private__.getLineWidth=p.getLineWidth=function(){return Bc},Ht=p.__private__.setLineWidth=p.setLineWidth=function(b){return Bc=b,Q(ee(de(b))+" w"),this};p.__private__.setLineDash=bt.API.setLineDash=bt.API.setLineDashPattern=function(b,I){if(b=b||[],I=I||0,isNaN(I)||!Array.isArray(b))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return b=b.map(function(le){return ee(de(le))}).join(" "),I=ee(de(I)),Q("["+b+"] "+I+" d"),this};var dh=p.__private__.getLineHeight=p.getLineHeight=function(){return $e*qs};p.__private__.getLineHeight=p.getLineHeight=function(){return $e*qs};var fh=p.__private__.setLineHeightFactor=p.setLineHeightFactor=function(b){return typeof(b=b||1.15)=="number"&&(qs=b),this},uh=p.__private__.getLineHeightFactor=p.getLineHeightFactor=function(){return qs};fh(t.lineHeight);var bo=p.__private__.getHorizontalCoordinate=function(b){return de(b)},wo=p.__private__.getVerticalCoordinate=function(b){return X===q?b:It[U].mediaBox.topRightY-It[U].mediaBox.bottomLeftY-de(b)},hh=p.__private__.getHorizontalCoordinateString=p.getHorizontalCoordinateString=function(b){return ee(bo(b))},ph=p.__private__.getVerticalCoordinateString=p.getVerticalCoordinateString=function(b){return ee(wo(b))},Ll=t.strokeColor||"0 G";p.__private__.getStrokeColor=p.getDrawColor=function(){return se(Ll)},p.__private__.setStrokeColor=p.setDrawColor=function(b,I,le,me){return Ll=ce({ch1:b,ch2:I,ch3:le,ch4:me,pdfColorType:"draw",precision:2}),Q(Ll),this};var Uc=t.fillColor||"0 g";p.__private__.getFillColor=p.getFillColor=function(){return se(Uc)},p.__private__.setFillColor=p.setFillColor=function(b,I,le,me){return Uc=ce({ch1:b,ch2:I,ch3:le,ch4:me,pdfColorType:"fill",precision:2}),Q(Uc),this};var Gs=t.textColor||"0 g",mh=p.__private__.getTextColor=p.getTextColor=function(){return se(Gs)};p.__private__.setTextColor=p.setTextColor=function(b,I,le,me){return Gs=ce({ch1:b,ch2:I,ch3:le,ch4:me,pdfColorType:"text",precision:3}),this};var yo=t.charSpace,gh=p.__private__.getCharSpace=p.getCharSpace=function(){return parseFloat(yo||0)};p.__private__.setCharSpace=p.setCharSpace=function(b){if(isNaN(b))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return yo=b,this};var Vc=0;p.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},p.__private__.setLineCap=p.setLineCap=function(b){var I=p.CapJoinStyles[b];if(I===void 0)throw new Error("Line cap style of '"+b+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Vc=I,Q(I+" J"),this};var zc=0;p.__private__.setLineJoin=p.setLineJoin=function(b){var I=p.CapJoinStyles[b];if(I===void 0)throw new Error("Line join style of '"+b+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return zc=I,Q(I+" j"),this},p.__private__.setLineMiterLimit=p.__private__.setMiterLimit=p.setLineMiterLimit=p.setMiterLimit=function(b){if(b=b||0,isNaN(b))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return Q(ee(de(b))+" M"),this},p.GState=mu,p.setGState=function(b){(b=typeof b=="string"?Dt[Vt[b]]:wd(null,b)).equals(Vr)||(Q("/"+b.id+" gs"),Vr=b)};var wd=function(b,I){if(!b||!Vt[b]){var le=!1;for(var me in Dt)if(Dt.hasOwnProperty(me)&&Dt[me].equals(I)){le=!0;break}if(le)I=Dt[me];else{var Se="GS"+(Object.keys(Dt).length+1).toString(10);Dt[Se]=I,I.id=Se}return b&&(Vt[b]=I.id),pr.publish("addGState",I),I}};p.addGState=function(b,I){return wd(b,I),this},p.saveGraphicsState=function(){return Q("q"),Ur.push({key:yt,size:$e,color:Gs}),this},p.restoreGraphicsState=function(){Q("Q");var b=Ur.pop();return yt=b.key,$e=b.size,Gs=b.color,Vr=null,this},p.setCurrentTransformationMatrix=function(b){return Q(b.toString()+" cm"),this},p.comment=function(b){return Q("#"+b),this};var Co=function(b,I){var le=b||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return le},set:function(We){isNaN(We)||(le=parseFloat(We))}});var me=I||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return me},set:function(We){isNaN(We)||(me=parseFloat(We))}});var Se="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return Se},set:function(We){Se=We.toString()}}),this},jc=function(b,I,le,me){Co.call(this,b,I),this.type="rect";var Se=le||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return Se},set:function(Ke){isNaN(Ke)||(Se=parseFloat(Ke))}});var We=me||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return We},set:function(Ke){isNaN(Ke)||(We=parseFloat(Ke))}}),this},Bl=function(){this.page=er,this.currentPage=U,this.pages=He.slice(0),this.pagesContext=It.slice(0),this.x=kt,this.y=$r,this.matrix=ar,this.width=Wc(U),this.height=Cd(U),this.outputDestination=nt,this.id="",this.objectNumber=-1};Bl.prototype.restore=function(){er=this.page,U=this.currentPage,It=this.pagesContext,He=this.pages,kt=this.x,$r=this.y,ar=this.matrix,yd(U,this.width),So(U,this.height),nt=this.outputDestination};var Hc=function(b,I,le,me,Se){sa.push(new Bl),er=U=0,He=[],kt=b,$r=I,ar=Se,zr([le,me])};for(var $s in p.beginFormObject=function(b,I,le,me,Se){return Hc(b,I,le,me,Se),this},p.endFormObject=function(b){return(function(I){if(Pa[I])sa.pop().restore();else{var le=new Bl,me="Xo"+(Object.keys(Nn).length+1).toString(10);le.id=me,Pa[I]=me,Nn[me]=le,pr.publish("addFormObject",le),sa.pop().restore()}})(b),this},p.doFormObject=function(b,I){var le=Nn[Pa[b]];return Q("q"),Q(I.toString()+" cm"),Q("/"+le.id+" Do"),Q("Q"),this},p.getFormObject=function(b){var I=Nn[Pa[b]];return{x:I.x,y:I.y,width:I.width,height:I.height,matrix:I.matrix}},p.save=function(b,I){return b=b||"generated.pdf",(I=I||{}).returnPromise=I.returnPromise||!1,I.returnPromise===!1?(Al(Nl(Ya()),b),typeof Al.unload=="function"&&Ut.setTimeout&&setTimeout(Al.unload,911),this):new Promise(function(le,me){try{var Se=Al(Nl(Ya()),b);typeof Al.unload=="function"&&Ut.setTimeout&&setTimeout(Al.unload,911),le(Se)}catch(We){me(We.message)}})},bt.API)bt.API.hasOwnProperty($s)&&($s==="events"&&bt.API.events.length?(function(b,I){var le,me,Se;for(Se=I.length-1;Se!==-1;Se--)le=I[Se][0],me=I[Se][1],b.subscribe.apply(b,[le].concat(typeof me=="function"?[me]:me))})(pr,bt.API.events):p[$s]=bt.API[$s]);function Wc(b){return It[b].mediaBox.topRightX-It[b].mediaBox.bottomLeftX}function yd(b,I){It[b].mediaBox.topRightX=I+It[b].mediaBox.bottomLeftX}function Cd(b){return It[b].mediaBox.topRightY-It[b].mediaBox.bottomLeftY}function So(b,I){It[b].mediaBox.topRightY=I+It[b].mediaBox.bottomLeftY}var ko=p.getPageWidth=function(b){return Wc(b=b||U)/jt},Sd=p.setPageWidth=function(b,I){yd(b,I*jt)},Xs=p.getPageHeight=function(b){return Cd(b=b||U)/jt},kd=p.setPageHeight=function(b,I){So(b,I*jt)};return p.internal={pdfEscape:Dr,getStyle:vd,getFont:lh,getFontSize:pt,getCharSpace:gh,getTextColor:mh,getLineHeight:dh,getLineHeightFactor:uh,getLineWidth:ch,write:tt,getHorizontalCoordinate:bo,getVerticalCoordinate:wo,getCoordinateString:hh,getVerticalCoordinateString:ph,collections:{},newObject:Xr,newAdditionalObject:oe,newObjectDeferred:vn,newObjectDeferredBegin:B,getFilters:Oe,putStream:Le,events:pr,scaleFactor:jt,pageSize:{getWidth:function(){return ko(U)},setWidth:function(b){Sd(U,b)},getHeight:function(){return Xs(U)},setHeight:function(b){kd(U,b)}},encryptionOptions:f,encryption:Mn,getEncryptor:function(b){return f!==null?Mn.encryptor(b,0):function(I){return I}},output:gd,getNumberOfPages:la,get pages(){return He},out:Q,f2:A,f3:V,getPageInfo:xo,getPageInfoByObjId:_d,getCurrentPageInfo:nh,getPDFVersion:w,Point:Co,Rectangle:jc,Matrix:Nt,hasHotfix:ca},Object.defineProperty(p.internal.pageSize,"width",{get:function(){return ko(U)},set:function(b){Sd(U,b)},enumerable:!0,configurable:!0}),Object.defineProperty(p.internal.pageSize,"height",{get:function(){return Xs(U)},set:function(b){kd(U,b)},enumerable:!0,configurable:!0}),function(b){for(var I=0,le=_t.length;I<le;I++){var me=wr.call(this,b[I][0],b[I][1],b[I][2],_t[I][3],!0);v===!1&&(x[me]=!0);var Se=b[I][0].split("-");Rt({id:me,fontName:Se[0],fontStyle:Se[1]||""})}pr.publish("addFonts",{fonts:$t,dictionary:Xt})}.call(p,_t),yt="F1",Rn(i,e),pr.publish("initialized"),p}kc.prototype.lsbFirstWord=function(t){return String.fromCharCode(255&t,t>>8&255,t>>16&255,t>>24&255)},kc.prototype.toHexString=function(t){return t.split("").map(function(r){return("0"+(255&r.charCodeAt(0)).toString(16)).slice(-2)}).join("")},kc.prototype.hexToBytes=function(t){for(var r=[],e=0;e<t.length;e+=2)r.push(String.fromCharCode(parseInt(t.substr(e,2),16)));return r.join("")},kc.prototype.processOwnerPassword=function(t,r){return Mm(Em(r).substr(0,5),t)},kc.prototype.encryptor=function(t,r){var e=Em(this.encryptionKey+String.fromCharCode(255&t,t>>8&255,t>>16&255,255&r,r>>8&255)).substr(0,10);return function(n){return Mm(e,n)}},mu.prototype.equals=function(t){var r,e="id,objectNumber,equals";if(!t||Ir(t)!==Ir(this))return!1;var n=0;for(r in this)if(!(e.indexOf(r)>=0)){if(this.hasOwnProperty(r)&&!t.hasOwnProperty(r)||this[r]!==t[r])return!1;n++}for(r in t)t.hasOwnProperty(r)&&e.indexOf(r)<0&&n--;return n===0},bt.API={events:[]},bt.version="4.0.0";var cn=bt.API,Am=1,Fl=function(t){return t.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},Cc=function(t){return t.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},qt=function(t){return t.toFixed(2)},Us=function(t){return t.toFixed(5)};cn.__acroform__={};var zi=function(t,r){t.prototype=Object.create(r.prototype),t.prototype.constructor=t},Ux=function(t){return t*Am},po=function(t){var r=new lb,e=vt.internal.getHeight(t)||0,n=vt.internal.getWidth(t)||0;return r.BBox=[0,0,Number(qt(n)),Number(qt(e))],r},v8=cn.__acroform__.setBit=function(t,r){if(t=t||0,r=r||0,isNaN(t)||isNaN(r))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return t|1<<r},x8=cn.__acroform__.clearBit=function(t,r){if(t=t||0,r=r||0,isNaN(t)||isNaN(r))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return t&~(1<<r)},b8=cn.__acroform__.getBit=function(t,r){if(isNaN(t)||isNaN(r))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return t&1<<r?1:0},mn=cn.__acroform__.getBitForPdf=function(t,r){if(isNaN(t)||isNaN(r))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return b8(t,r-1)},gn=cn.__acroform__.setBitForPdf=function(t,r){if(isNaN(t)||isNaN(r))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return v8(t,r-1)},_n=cn.__acroform__.clearBitForPdf=function(t,r){if(isNaN(t)||isNaN(r))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return x8(t,r-1)},w8=cn.__acroform__.calculateCoordinates=function(t,r){var e=r.internal.getHorizontalCoordinate,n=r.internal.getVerticalCoordinate,i=t[0],a=t[1],o=t[2],s=t[3],l={};return l.lowerLeft_X=e(i)||0,l.lowerLeft_Y=n(a+s)||0,l.upperRight_X=e(i+o)||0,l.upperRight_Y=n(a)||0,[Number(qt(l.lowerLeft_X)),Number(qt(l.lowerLeft_Y)),Number(qt(l.upperRight_X)),Number(qt(l.upperRight_Y))]},y8=function(t){if(t.appearanceStreamContent)return t.appearanceStreamContent;if(t.V||t.DV){var r=[],e=t._V||t.DV,n=Pm(t,e),i=t.scope.internal.getFont(t.fontName,t.fontStyle).id;r.push("/Tx BMC"),r.push("q"),r.push("BT"),r.push(t.scope.__private__.encodeColorString(t.color)),r.push("/"+i+" "+qt(n.fontSize)+" Tf"),r.push("1 0 0 1 0 0 Tm"),r.push(n.text),r.push("ET"),r.push("Q"),r.push("EMC");var a=po(t);return a.scope=t.scope,a.stream=r.join(`
`),a}},Pm=function(t,r){var e=t.fontSize===0?t.maxFontSize:t.fontSize,n={text:"",fontSize:""},i=(r=(r=r.substr(0,1)=="("?r.substr(1):r).substr(r.length-1)==")"?r.substr(0,r.length-1):r).split(" ");i=t.multiline?i.map(function(A){return A.split(`
`)}):i.map(function(A){return[A]});var a=e,o=vt.internal.getHeight(t)||0;o=o<0?-o:o;var s=vt.internal.getWidth(t)||0;s=s<0?-s:s;var l=function(A,V,de){if(A+1<i.length){var ue=V+" "+i[A+1][0];return su(ue,t,de).width<=s-4}return!1};a++;e:for(;a>0;){r="",a--;var c,f,v=su("3",t,a).height,x=t.multiline?o-a:(o-v)/2,p=x+=2,S=0,w=0,k=0;if(a<=0){r=`(...) Tj
`,r+="% Width of Text: "+su(r,t,a=12).width+", FieldWidth:"+s+`
`;break}for(var O="",H=0,q=0;q<i.length;q++)if(i.hasOwnProperty(q)){var X=!1;if(i[q].length!==1&&k!==i[q].length-1){if((v+2)*(H+2)+2>o)continue e;O+=i[q][k],X=!0,w=q,q--}else{O=(O+=i[q][k]+" ").substr(O.length-1)==" "?O.substr(0,O.length-1):O;var he=parseInt(q),ke=l(he,O,a),re=q>=i.length-1;if(ke&&!re){O+=" ",k=0;continue}if(ke||re){if(re)w=he;else if(t.multiline&&(v+2)*(H+2)+2>o)continue e}else{if(!t.multiline||(v+2)*(H+2)+2>o)continue e;w=he}}for(var ee="",W=S;W<=w;W++){var ae=i[W];if(t.multiline){if(W===w){ee+=ae[k]+" ",k=(k+1)%ae.length;continue}if(W===S){ee+=ae[ae.length-1]+" ";continue}}ee+=ae[0]+" "}switch(ee=ee.substr(ee.length-1)==" "?ee.substr(0,ee.length-1):ee,f=su(ee,t,a).width,t.textAlign){case"right":c=s-f-2;break;case"center":c=(s-f)/2;break;default:c=2}r+=qt(c)+" "+qt(p)+` Td
`,r+="("+Fl(ee)+`) Tj
`,r+=-qt(c)+` 0 Td
`,p=-(a+2),f=0,S=X?w:w+1,H++,O=""}break}return n.text=r,n.fontSize=a,n},su=function(t,r,e){var n=r.scope.internal.getFont(r.fontName,r.fontStyle),i=r.scope.getStringUnitWidth(t,{font:n,fontSize:parseFloat(e),charSpace:0})*parseFloat(e);return{height:r.scope.getStringUnitWidth("3",{font:n,fontSize:parseFloat(e),charSpace:0})*parseFloat(e)*1.5,width:i}},C8={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},S8=function(t,r){var e={type:"reference",object:t};r.internal.getPageInfo(t.page).pageContext.annotations.find(function(n){return n.type===e.type&&n.object===e.object})===void 0&&r.internal.getPageInfo(t.page).pageContext.annotations.push(e)},k8=function(t,r){if(r.scope=t,t.internal!==void 0&&(t.internal.acroformPlugin===void 0||t.internal.acroformPlugin.isInitialized===!1)){if(qa.FieldNum=0,t.internal.acroformPlugin=JSON.parse(JSON.stringify(C8)),t.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");Am=t.internal.scaleFactor,t.internal.acroformPlugin.acroFormDictionaryRoot=new cb,t.internal.acroformPlugin.acroFormDictionaryRoot.scope=t,t.internal.acroformPlugin.acroFormDictionaryRoot._eventID=t.internal.events.subscribe("postPutResources",function(){(function(e){e.internal.events.unsubscribe(e.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete e.internal.acroformPlugin.acroFormDictionaryRoot._eventID,e.internal.acroformPlugin.printedOut=!0})(t)}),t.internal.events.subscribe("buildDocument",function(){(function(e){e.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var n=e.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var i in n)if(n.hasOwnProperty(i)){var a=n[i];a.objId=void 0,a.hasAnnotation&&S8(a,e)}})(t)}),t.internal.events.subscribe("putCatalog",function(){(function(e){if(e.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");e.internal.write("/AcroForm "+e.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(t)}),t.internal.events.subscribe("postPutPages",function(e){(function(n,i){var a=!n;for(var o in n||(i.internal.newObjectDeferredBegin(i.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),i.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),n=n||i.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(n.hasOwnProperty(o)){var s=n[o],l=[],c=s.Rect;if(s.Rect&&(s.Rect=w8(s.Rect,i)),i.internal.newObjectDeferredBegin(s.objId,!0),s.DA=vt.createDefaultAppearanceStream(s),Ir(s)==="object"&&typeof s.getKeyValueListForStream=="function"&&(l=s.getKeyValueListForStream()),s.Rect=c,s.hasAppearanceStream&&!s.appearanceStreamContent){var f=y8(s);l.push({key:"AP",value:"<</N "+f+">>"}),i.internal.acroformPlugin.xForms.push(f)}if(s.appearanceStreamContent){var v="";for(var x in s.appearanceStreamContent)if(s.appearanceStreamContent.hasOwnProperty(x)){var p=s.appearanceStreamContent[x];if(v+="/"+x+" ",v+="<<",Object.keys(p).length>=1||Array.isArray(p)){for(var o in p)if(p.hasOwnProperty(o)){var S=p[o];typeof S=="function"&&(S=S.call(i,s)),v+="/"+o+" "+S+" ",i.internal.acroformPlugin.xForms.indexOf(S)>=0||i.internal.acroformPlugin.xForms.push(S)}}else typeof(S=p)=="function"&&(S=S.call(i,s)),v+="/"+o+" "+S,i.internal.acroformPlugin.xForms.indexOf(S)>=0||i.internal.acroformPlugin.xForms.push(S);v+=">>"}l.push({key:"AP",value:`<<
`+v+">>"})}i.internal.putStream({additionalKeyValues:l,objectId:s.objId}),i.internal.out("endobj")}a&&(function(w,k){for(var O in w)if(w.hasOwnProperty(O)){var H=O,q=w[O];k.internal.newObjectDeferredBegin(q.objId,!0),Ir(q)==="object"&&typeof q.putStream=="function"&&q.putStream(),delete w[H]}})(i.internal.acroformPlugin.xForms,i)})(e,t)}),t.internal.acroformPlugin.isInitialized=!0}},sb=cn.__acroform__.arrayToPdfArray=function(t,r,e){var n=function(o){return o};if(Array.isArray(t)){for(var i="[",a=0;a<t.length;a++)switch(a!==0&&(i+=" "),Ir(t[a])){case"boolean":case"number":case"object":i+=t[a].toString();break;case"string":t[a].substr(0,1)!=="/"?(r!==void 0&&e&&(n=e.internal.getEncryptor(r)),i+="("+Fl(n(t[a].toString()))+")"):i+=t[a].toString()}return i+"]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},wm=function(t,r,e){var n=function(i){return i};return r!==void 0&&e&&(n=e.internal.getEncryptor(r)),(t=t||"").toString(),"("+Fl(n(t))+")"},mo=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(t){this._objId=t}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};mo.prototype.toString=function(){return this.objId+" 0 R"},mo.prototype.putStream=function(){var t=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:t,objectId:this.objId}),this.scope.internal.out("endobj")},mo.prototype.getKeyValueListForStream=function(){var t=[],r=Object.getOwnPropertyNames(this).filter(function(a){return a!="content"&&a!="appearanceStreamContent"&&a!="scope"&&a!="objId"&&a.substring(0,1)!="_"});for(var e in r)if(Object.getOwnPropertyDescriptor(this,r[e]).configurable===!1){var n=r[e],i=this[n];i&&(Array.isArray(i)?t.push({key:n,value:sb(i,this.objId,this.scope)}):i instanceof mo?(i.scope=this.scope,t.push({key:n,value:i.objId+" 0 R"})):typeof i!="function"&&t.push({key:n,value:i}))}return t};var lb=function(){mo.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var t,r=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return r},set:function(e){r=e}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(e){t=e.trim()},get:function(){return t||null}})};zi(lb,mo);var cb=function(){mo.call(this);var t,r=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return r.length>0?r:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return r}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(t){var e=function(n){return n};return this.scope&&(e=this.scope.internal.getEncryptor(this.objId)),"("+Fl(e(t))+")"}},set:function(e){t=e}})};zi(cb,mo);var qa=function t(){mo.call(this);var r=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return r},set:function(O){if(isNaN(O))throw new Error('Invalid value "'+O+'" for attribute F supplied.');r=O}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!mn(r,3)},set:function(O){O?this.F=gn(r,3):this.F=_n(r,3)}});var e=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return e},set:function(O){if(isNaN(O))throw new Error('Invalid value "'+O+'" for attribute Ff supplied.');e=O}});var n=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(n.length!==0)return n},set:function(O){n=O!==void 0?O:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[0])?0:n[0]},set:function(O){n[0]=O}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[1])?0:n[1]},set:function(O){n[1]=O}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[2])?0:n[2]},set:function(O){n[2]=O}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[3])?0:n[3]},set:function(O){n[3]=O}});var i="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return i},set:function(O){switch(O){case"/Btn":case"/Tx":case"/Ch":case"/Sig":i=O;break;default:throw new Error('Invalid value "'+O+'" for attribute FT supplied.')}}});var a=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!a||a.length<1){if(this instanceof gu)return;a="FieldObject"+t.FieldNum++}var O=function(H){return H};return this.scope&&(O=this.scope.internal.getEncryptor(this.objId)),"("+Fl(O(a))+")"},set:function(O){a=O.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return a},set:function(O){a=O}});var o="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return o},set:function(O){o=O}});var s="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return s},set:function(O){s=O}});var l=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return l},set:function(O){l=O}});var c=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return c===void 0?50/Am:c},set:function(O){c=O}});var f="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return f},set:function(O){f=O}});var v="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!v||this instanceof gu||this instanceof Il))return wm(v,this.objId,this.scope)},set:function(O){O=O.toString(),v=O}});var x=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(x)return this instanceof Gn==0?wm(x,this.objId,this.scope):x},set:function(O){O=O.toString(),x=this instanceof Gn==0?O.substr(0,1)==="("?Cc(O.substr(1,O.length-2)):Cc(O):O}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof Gn==1?Cc(x.substr(1,x.length-1)):x},set:function(O){O=O.toString(),x=this instanceof Gn==1?"/"+O:O}});var p=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(p)return p},set:function(O){this.V=O}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(p)return this instanceof Gn==0?wm(p,this.objId,this.scope):p},set:function(O){O=O.toString(),p=this instanceof Gn==0?O.substr(0,1)==="("?Cc(O.substr(1,O.length-2)):Cc(O):O}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof Gn==1?Cc(p.substr(1,p.length-1)):p},set:function(O){O=O.toString(),p=this instanceof Gn==1?"/"+O:O}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var S,w=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return w},set:function(O){O=!!O,w=O}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(S)return S},set:function(O){S=O}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!mn(this.Ff,1)},set:function(O){O?this.Ff=gn(this.Ff,1):this.Ff=_n(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!mn(this.Ff,2)},set:function(O){O?this.Ff=gn(this.Ff,2):this.Ff=_n(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!mn(this.Ff,3)},set:function(O){O?this.Ff=gn(this.Ff,3):this.Ff=_n(this.Ff,3)}});var k=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(k!==null)return k},set:function(O){if([0,1,2].indexOf(O)===-1)throw new Error('Invalid value "'+O+'" for attribute Q supplied.');k=O}}),Object.defineProperty(this,"textAlign",{get:function(){var O;switch(k){case 0:default:O="left";break;case 1:O="center";break;case 2:O="right"}return O},configurable:!0,enumerable:!0,set:function(O){switch(O){case"right":case 2:k=2;break;case"center":case 1:k=1;break;default:k=0}}})};zi(qa,mo);var Pc=function(){qa.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var t=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return t},set:function(e){t=e}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return t},set:function(e){t=e}});var r=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return sb(r,this.objId,this.scope)},set:function(e){var n,i;i=[],typeof(n=e)=="string"&&(i=(function(a,o,s){s||(s=1);for(var l,c=[];l=o.exec(a);)c.push(l[s]);return c})(n,/\((.*?)\)/g)),r=i}}),this.getOptions=function(){return r},this.setOptions=function(e){r=e,this.sort&&r.sort()},this.addOption=function(e){e=(e=e||"").toString(),r.push(e),this.sort&&r.sort()},this.removeOption=function(e,n){for(n=n||!1,e=(e=e||"").toString();r.indexOf(e)!==-1&&(r.splice(r.indexOf(e),1),n!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!mn(this.Ff,18)},set:function(e){e?this.Ff=gn(this.Ff,18):this.Ff=_n(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!mn(this.Ff,19)},set:function(e){this.combo===!0&&(e?this.Ff=gn(this.Ff,19):this.Ff=_n(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!mn(this.Ff,20)},set:function(e){e?(this.Ff=gn(this.Ff,20),r.sort()):this.Ff=_n(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!mn(this.Ff,22)},set:function(e){e?this.Ff=gn(this.Ff,22):this.Ff=_n(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!mn(this.Ff,23)},set:function(e){e?this.Ff=gn(this.Ff,23):this.Ff=_n(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!mn(this.Ff,27)},set:function(e){e?this.Ff=gn(this.Ff,27):this.Ff=_n(this.Ff,27)}}),this.hasAppearanceStream=!1};zi(Pc,qa);var Oc=function(){Pc.call(this),this.fontName="helvetica",this.combo=!1};zi(Oc,Pc);var Ac=function(){Oc.call(this),this.combo=!0};zi(Ac,Oc);var fu=function(){Ac.call(this),this.edit=!0};zi(fu,Ac);var Gn=function(){qa.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!mn(this.Ff,15)},set:function(e){e?this.Ff=gn(this.Ff,15):this.Ff=_n(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!mn(this.Ff,16)},set:function(e){e?this.Ff=gn(this.Ff,16):this.Ff=_n(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!mn(this.Ff,17)},set:function(e){e?this.Ff=gn(this.Ff,17):this.Ff=_n(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!mn(this.Ff,26)},set:function(e){e?this.Ff=gn(this.Ff,26):this.Ff=_n(this.Ff,26)}});var t,r={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var e=function(a){return a};if(this.scope&&(e=this.scope.internal.getEncryptor(this.objId)),Object.keys(r).length!==0){var n,i=[];for(n in i.push("<<"),r)i.push("/"+n+" ("+Fl(e(r[n]))+")");return i.push(">>"),i.join(`
`)}},set:function(e){Ir(e)==="object"&&(r=e)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return r.CA||""},set:function(e){typeof e=="string"&&(r.CA=e)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return t},set:function(e){t=e}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return t.substr(1,t.length-1)},set:function(e){t="/"+e}})};zi(Gn,qa);var uu=function(){Gn.call(this),this.pushButton=!0};zi(uu,Gn);var Tc=function(){Gn.call(this),this.radio=!0,this.pushButton=!1;var t=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return t},set:function(r){t=r!==void 0?r:[]}})};zi(Tc,Gn);var gu=function(){var t,r;qa.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return t},set:function(i){t=i}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return r},set:function(i){r=i}});var e,n={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var i=function(s){return s};this.scope&&(i=this.scope.internal.getEncryptor(this.objId));var a,o=[];for(a in o.push("<<"),n)o.push("/"+a+" ("+Fl(i(n[a]))+")");return o.push(">>"),o.join(`
`)},set:function(i){Ir(i)==="object"&&(n=i)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return n.CA||""},set:function(i){typeof i=="string"&&(n.CA=i)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return e},set:function(i){e=i}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return e.substr(1,e.length-1)},set:function(i){e="/"+i}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=vt.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};zi(gu,qa),Tc.prototype.setAppearance=function(t){if(!("createAppearanceStream"in t)||!("getCA"in t))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var r in this.Kids)if(this.Kids.hasOwnProperty(r)){var e=this.Kids[r];e.appearanceStreamContent=t.createAppearanceStream(e.optionName),e.caption=t.getCA()}},Tc.prototype.createOption=function(t){var r=new gu;return r.Parent=this,r.optionName=t,this.Kids.push(r),E8.call(this.scope,r),r};var hu=function(){Gn.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=vt.CheckBox.createAppearanceStream()};zi(hu,Gn);var Il=function(){qa.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!mn(this.Ff,13)},set:function(r){r?this.Ff=gn(this.Ff,13):this.Ff=_n(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!mn(this.Ff,21)},set:function(r){r?this.Ff=gn(this.Ff,21):this.Ff=_n(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!mn(this.Ff,23)},set:function(r){r?this.Ff=gn(this.Ff,23):this.Ff=_n(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!mn(this.Ff,24)},set:function(r){r?this.Ff=gn(this.Ff,24):this.Ff=_n(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!mn(this.Ff,25)},set:function(r){r?this.Ff=gn(this.Ff,25):this.Ff=_n(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!mn(this.Ff,26)},set:function(r){r?this.Ff=gn(this.Ff,26):this.Ff=_n(this.Ff,26)}});var t=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return t},set:function(r){t=r}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return t},set:function(r){Number.isInteger(r)&&(t=r)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};zi(Il,qa);var pu=function(){Il.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!mn(this.Ff,14)},set:function(t){t?this.Ff=gn(this.Ff,14):this.Ff=_n(this.Ff,14)}}),this.password=!0};zi(pu,Il);var vt={CheckBox:{createAppearanceStream:function(){return{N:{On:vt.CheckBox.YesNormal},D:{On:vt.CheckBox.YesPushDown,Off:vt.CheckBox.OffPushDown}}},YesPushDown:function(t){var r=po(t);r.scope=t.scope;var e=[],n=t.scope.internal.getFont(t.fontName,t.fontStyle).id,i=t.scope.__private__.encodeColorString(t.color),a=Pm(t,t.caption);return e.push("0.749023 g"),e.push("0 0 "+qt(vt.internal.getWidth(t))+" "+qt(vt.internal.getHeight(t))+" re"),e.push("f"),e.push("BMC"),e.push("q"),e.push("0 0 1 rg"),e.push("/"+n+" "+qt(a.fontSize)+" Tf "+i),e.push("BT"),e.push(a.text),e.push("ET"),e.push("Q"),e.push("EMC"),r.stream=e.join(`
`),r},YesNormal:function(t){var r=po(t);r.scope=t.scope;var e=t.scope.internal.getFont(t.fontName,t.fontStyle).id,n=t.scope.__private__.encodeColorString(t.color),i=[],a=vt.internal.getHeight(t),o=vt.internal.getWidth(t),s=Pm(t,t.caption);return i.push("1 g"),i.push("0 0 "+qt(o)+" "+qt(a)+" re"),i.push("f"),i.push("q"),i.push("0 0 1 rg"),i.push("0 0 "+qt(o-1)+" "+qt(a-1)+" re"),i.push("W"),i.push("n"),i.push("0 g"),i.push("BT"),i.push("/"+e+" "+qt(s.fontSize)+" Tf "+n),i.push(s.text),i.push("ET"),i.push("Q"),r.stream=i.join(`
`),r},OffPushDown:function(t){var r=po(t);r.scope=t.scope;var e=[];return e.push("0.749023 g"),e.push("0 0 "+qt(vt.internal.getWidth(t))+" "+qt(vt.internal.getHeight(t))+" re"),e.push("f"),r.stream=e.join(`
`),r}},RadioButton:{Circle:{createAppearanceStream:function(t){var r={D:{Off:vt.RadioButton.Circle.OffPushDown},N:{}};return r.N[t]=vt.RadioButton.Circle.YesNormal,r.D[t]=vt.RadioButton.Circle.YesPushDown,r},getCA:function(){return"l"},YesNormal:function(t){var r=po(t);r.scope=t.scope;var e=[],n=vt.internal.getWidth(t)<=vt.internal.getHeight(t)?vt.internal.getWidth(t)/4:vt.internal.getHeight(t)/4;n=Number((.9*n).toFixed(5));var i=vt.internal.Bezier_C,a=Number((n*i).toFixed(5));return e.push("q"),e.push("1 0 0 1 "+Us(vt.internal.getWidth(t)/2)+" "+Us(vt.internal.getHeight(t)/2)+" cm"),e.push(n+" 0 m"),e.push(n+" "+a+" "+a+" "+n+" 0 "+n+" c"),e.push("-"+a+" "+n+" -"+n+" "+a+" -"+n+" 0 c"),e.push("-"+n+" -"+a+" -"+a+" -"+n+" 0 -"+n+" c"),e.push(a+" -"+n+" "+n+" -"+a+" "+n+" 0 c"),e.push("f"),e.push("Q"),r.stream=e.join(`
`),r},YesPushDown:function(t){var r=po(t);r.scope=t.scope;var e=[],n=vt.internal.getWidth(t)<=vt.internal.getHeight(t)?vt.internal.getWidth(t)/4:vt.internal.getHeight(t)/4;n=Number((.9*n).toFixed(5));var i=Number((2*n).toFixed(5)),a=Number((i*vt.internal.Bezier_C).toFixed(5)),o=Number((n*vt.internal.Bezier_C).toFixed(5));return e.push("0.749023 g"),e.push("q"),e.push("1 0 0 1 "+Us(vt.internal.getWidth(t)/2)+" "+Us(vt.internal.getHeight(t)/2)+" cm"),e.push(i+" 0 m"),e.push(i+" "+a+" "+a+" "+i+" 0 "+i+" c"),e.push("-"+a+" "+i+" -"+i+" "+a+" -"+i+" 0 c"),e.push("-"+i+" -"+a+" -"+a+" -"+i+" 0 -"+i+" c"),e.push(a+" -"+i+" "+i+" -"+a+" "+i+" 0 c"),e.push("f"),e.push("Q"),e.push("0 g"),e.push("q"),e.push("1 0 0 1 "+Us(vt.internal.getWidth(t)/2)+" "+Us(vt.internal.getHeight(t)/2)+" cm"),e.push(n+" 0 m"),e.push(n+" "+o+" "+o+" "+n+" 0 "+n+" c"),e.push("-"+o+" "+n+" -"+n+" "+o+" -"+n+" 0 c"),e.push("-"+n+" -"+o+" -"+o+" -"+n+" 0 -"+n+" c"),e.push(o+" -"+n+" "+n+" -"+o+" "+n+" 0 c"),e.push("f"),e.push("Q"),r.stream=e.join(`
`),r},OffPushDown:function(t){var r=po(t);r.scope=t.scope;var e=[],n=vt.internal.getWidth(t)<=vt.internal.getHeight(t)?vt.internal.getWidth(t)/4:vt.internal.getHeight(t)/4;n=Number((.9*n).toFixed(5));var i=Number((2*n).toFixed(5)),a=Number((i*vt.internal.Bezier_C).toFixed(5));return e.push("0.749023 g"),e.push("q"),e.push("1 0 0 1 "+Us(vt.internal.getWidth(t)/2)+" "+Us(vt.internal.getHeight(t)/2)+" cm"),e.push(i+" 0 m"),e.push(i+" "+a+" "+a+" "+i+" 0 "+i+" c"),e.push("-"+a+" "+i+" -"+i+" "+a+" -"+i+" 0 c"),e.push("-"+i+" -"+a+" -"+a+" -"+i+" 0 -"+i+" c"),e.push(a+" -"+i+" "+i+" -"+a+" "+i+" 0 c"),e.push("f"),e.push("Q"),r.stream=e.join(`
`),r}},Cross:{createAppearanceStream:function(t){var r={D:{Off:vt.RadioButton.Cross.OffPushDown},N:{}};return r.N[t]=vt.RadioButton.Cross.YesNormal,r.D[t]=vt.RadioButton.Cross.YesPushDown,r},getCA:function(){return"8"},YesNormal:function(t){var r=po(t);r.scope=t.scope;var e=[],n=vt.internal.calculateCross(t);return e.push("q"),e.push("1 1 "+qt(vt.internal.getWidth(t)-2)+" "+qt(vt.internal.getHeight(t)-2)+" re"),e.push("W"),e.push("n"),e.push(qt(n.x1.x)+" "+qt(n.x1.y)+" m"),e.push(qt(n.x2.x)+" "+qt(n.x2.y)+" l"),e.push(qt(n.x4.x)+" "+qt(n.x4.y)+" m"),e.push(qt(n.x3.x)+" "+qt(n.x3.y)+" l"),e.push("s"),e.push("Q"),r.stream=e.join(`
`),r},YesPushDown:function(t){var r=po(t);r.scope=t.scope;var e=vt.internal.calculateCross(t),n=[];return n.push("0.749023 g"),n.push("0 0 "+qt(vt.internal.getWidth(t))+" "+qt(vt.internal.getHeight(t))+" re"),n.push("f"),n.push("q"),n.push("1 1 "+qt(vt.internal.getWidth(t)-2)+" "+qt(vt.internal.getHeight(t)-2)+" re"),n.push("W"),n.push("n"),n.push(qt(e.x1.x)+" "+qt(e.x1.y)+" m"),n.push(qt(e.x2.x)+" "+qt(e.x2.y)+" l"),n.push(qt(e.x4.x)+" "+qt(e.x4.y)+" m"),n.push(qt(e.x3.x)+" "+qt(e.x3.y)+" l"),n.push("s"),n.push("Q"),r.stream=n.join(`
`),r},OffPushDown:function(t){var r=po(t);r.scope=t.scope;var e=[];return e.push("0.749023 g"),e.push("0 0 "+qt(vt.internal.getWidth(t))+" "+qt(vt.internal.getHeight(t))+" re"),e.push("f"),r.stream=e.join(`
`),r}}},createDefaultAppearanceStream:function(t){var r=t.scope.internal.getFont(t.fontName,t.fontStyle).id,e=t.scope.__private__.encodeColorString(t.color);return"/"+r+" "+t.fontSize+" Tf "+e}};vt.internal={Bezier_C:.551915024494,calculateCross:function(t){var r=vt.internal.getWidth(t),e=vt.internal.getHeight(t),n=Math.min(r,e);return{x1:{x:(r-n)/2,y:(e-n)/2+n},x2:{x:(r-n)/2+n,y:(e-n)/2},x3:{x:(r-n)/2,y:(e-n)/2},x4:{x:(r-n)/2+n,y:(e-n)/2+n}}}},vt.internal.getWidth=function(t){var r=0;return Ir(t)==="object"&&(r=Ux(t.Rect[2])),r},vt.internal.getHeight=function(t){var r=0;return Ir(t)==="object"&&(r=Ux(t.Rect[3])),r};var E8=cn.addField=function(t){if(k8(this,t),!(t instanceof qa))throw new Error("Invalid argument passed to jsPDF.addField.");var r;return(r=t).scope.internal.acroformPlugin.printedOut&&(r.scope.internal.acroformPlugin.printedOut=!1,r.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),r.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(r),t.page=t.scope.internal.getCurrentPageInfo().pageNumber,this};cn.AcroFormChoiceField=Pc,cn.AcroFormListBox=Oc,cn.AcroFormComboBox=Ac,cn.AcroFormEditBox=fu,cn.AcroFormButton=Gn,cn.AcroFormPushButton=uu,cn.AcroFormRadioButton=Tc,cn.AcroFormCheckBox=hu,cn.AcroFormTextField=Il,cn.AcroFormPasswordField=pu,cn.AcroFormAppearance=vt,cn.AcroForm={ChoiceField:Pc,ListBox:Oc,ComboBox:Ac,EditBox:fu,Button:Gn,PushButton:uu,RadioButton:Tc,CheckBox:hu,TextField:Il,PasswordField:pu,Appearance:vt},bt.AcroForm={ChoiceField:Pc,ListBox:Oc,ComboBox:Ac,EditBox:fu,Button:Gn,PushButton:uu,RadioButton:Tc,CheckBox:hu,TextField:Il,PasswordField:pu,Appearance:vt};var s9=bt.AcroForm;function db(t){return t.reduce(function(r,e,n){return r[e]=n,r},{})}(function(t){var r="addImage_";t.__addimage__={};var e="UNKNOWN",n={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},i=t.__addimage__.getImageFileTypeByImageData=function(A,V){var de,ue,xe,Ne,Re,Ee=e;if((V=V||e)==="RGBA"||A.data!==void 0&&A.data instanceof Uint8ClampedArray&&"height"in A&&"width"in A)return"RGBA";if(ke(A))for(Re in n)for(xe=n[Re],de=0;de<xe.length;de+=1){for(Ne=!0,ue=0;ue<xe[de].length;ue+=1)if(xe[de][ue]!==void 0&&xe[de][ue]!==A[ue]){Ne=!1;break}if(Ne===!0){Ee=Re;break}}else for(Re in n)for(xe=n[Re],de=0;de<xe.length;de+=1){for(Ne=!0,ue=0;ue<xe[de].length;ue+=1)if(xe[de][ue]!==void 0&&xe[de][ue]!==A.charCodeAt(ue)){Ne=!1;break}if(Ne===!0){Ee=Re;break}}return Ee===e&&V!==e&&(Ee=V),Ee},a=function A(V){for(var de=this.internal.write,ue=this.internal.putStream,xe=(0,this.internal.getFilters)();xe.indexOf("FlateEncode")!==-1;)xe.splice(xe.indexOf("FlateEncode"),1);V.objectId=this.internal.newObject();var Ne=[];if(Ne.push({key:"Type",value:"/XObject"}),Ne.push({key:"Subtype",value:"/Image"}),Ne.push({key:"Width",value:V.width}),Ne.push({key:"Height",value:V.height}),V.colorSpace===O.INDEXED?Ne.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(V.palette.length/3-1)+" "+("sMask"in V&&V.sMask!==void 0?V.objectId+2:V.objectId+1)+" 0 R]"}):(Ne.push({key:"ColorSpace",value:"/"+V.colorSpace}),V.colorSpace===O.DEVICE_CMYK&&Ne.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),Ne.push({key:"BitsPerComponent",value:V.bitsPerComponent}),"decodeParameters"in V&&V.decodeParameters!==void 0&&Ne.push({key:"DecodeParms",value:"<<"+V.decodeParameters+">>"}),"transparency"in V&&Array.isArray(V.transparency)&&V.transparency.length>0){for(var Re="",Ee=0,Be=V.transparency.length;Ee<Be;Ee++)Re+=V.transparency[Ee]+" "+V.transparency[Ee]+" ";Ne.push({key:"Mask",value:"["+Re+"]"})}V.sMask!==void 0&&Ne.push({key:"SMask",value:V.objectId+1+" 0 R"});var Je=V.filter!==void 0?["/"+V.filter]:void 0;if(ue({data:V.data,additionalKeyValues:Ne,alreadyAppliedFilters:Je,objectId:V.objectId}),de("endobj"),"sMask"in V&&V.sMask!==void 0){var qe,E=(qe=V.sMaskBitsPerComponent)!==null&&qe!==void 0?qe:V.bitsPerComponent,U={width:V.width,height:V.height,colorSpace:"DeviceGray",bitsPerComponent:E,data:V.sMask};"filter"in V&&(U.decodeParameters="/Predictor ".concat(V.predictor," /Colors 1 /BitsPerComponent ").concat(E," /Columns ").concat(V.width),U.filter=V.filter),A.call(this,U)}if(V.colorSpace===O.INDEXED){var T=this.internal.newObject();ue({data:ee(new Uint8Array(V.palette)),objectId:T}),de("endobj")}},o=function(){var A=this.internal.collections[r+"images"];for(var V in A)a.call(this,A[V])},s=function(){var A,V=this.internal.collections[r+"images"],de=this.internal.write;for(var ue in V)de("/I"+(A=V[ue]).index,A.objectId,"0","R")},l=function(){this.internal.collections[r+"images"]||(this.internal.collections[r+"images"]={},this.internal.events.subscribe("putResources",o),this.internal.events.subscribe("putXobjectDict",s))},c=function(){var A=this.internal.collections[r+"images"];return l.call(this),A},f=function(){return Object.keys(this.internal.collections[r+"images"]).length},v=function(A){return typeof t["process"+A.toUpperCase()]=="function"},x=function(A){return Ir(A)==="object"&&A.nodeType===1},p=function(A,V){if(A.nodeName==="IMG"&&A.hasAttribute("src")){var de=""+A.getAttribute("src");if(de.indexOf("data:image/")===0)return du(unescape(de).split("base64,").pop());var ue=t.loadFile(de,!0);if(ue!==void 0)return ue}if(A.nodeName==="CANVAS"){if(A.width===0||A.height===0)throw new Error("Given canvas must have data. Canvas width: "+A.width+", height: "+A.height);var xe;switch(V){case"PNG":xe="image/png";break;case"WEBP":xe="image/webp";break;default:xe="image/jpeg"}return du(A.toDataURL(xe,1).split("base64,").pop())}},S=function(A){var V=this.internal.collections[r+"images"];if(V){for(var de in V)if(A===V[de].alias)return V[de]}},w=function(A,V,de){return A||V||(A=-96,V=-96),A<0&&(A=-1*de.width*72/A/this.internal.scaleFactor),V<0&&(V=-1*de.height*72/V/this.internal.scaleFactor),A===0&&(A=V*de.width/de.height),V===0&&(V=A*de.height/de.width),[A,V]},k=function(A,V,de,ue,xe,Ne){var Re=w.call(this,de,ue,xe),Ee=this.internal.getCoordinateString,Be=this.internal.getVerticalCoordinateString,Je=c.call(this);if(de=Re[0],ue=Re[1],Je[xe.index]=xe,Ne){Ne*=Math.PI/180;var qe=Math.cos(Ne),E=Math.sin(Ne),U=function(R){return R.toFixed(4)},T=[U(qe),U(E),U(-1*E),U(qe),0,0,"cm"]}this.internal.write("q"),Ne?(this.internal.write([1,"0","0",1,Ee(A),Be(V+ue),"cm"].join(" ")),this.internal.write(T.join(" ")),this.internal.write([Ee(de),"0","0",Ee(ue),"0","0","cm"].join(" "))):this.internal.write([Ee(de),"0","0",Ee(ue),Ee(A),Be(V+ue),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+xe.index+" Do"),this.internal.write("Q")},O=t.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};t.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var H=t.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},q=t.__addimage__.sHashCode=function(A){var V,de,ue=0;if(typeof A=="string")for(de=A.length,V=0;V<de;V++)ue=(ue<<5)-ue+A.charCodeAt(V),ue|=0;else if(ke(A))for(de=A.byteLength/2,V=0;V<de;V++)ue=(ue<<5)-ue+A[V],ue|=0;return ue},X=t.__addimage__.validateStringAsBase64=function(A){(A=A||"").toString().trim();var V=!0;return A.length===0&&(V=!1),A.length%4!=0&&(V=!1),/^[A-Za-z0-9+/]+$/.test(A.substr(0,A.length-2))===!1&&(V=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(A.substr(-2))===!1&&(V=!1),V},he=t.__addimage__.extractImageFromDataUrl=function(A){if(A==null||!(A=A.trim()).startsWith("data:"))return null;var V=A.indexOf(",");return V<0?null:A.substring(0,V).trim().endsWith("base64")?A.substring(V+1):null};t.__addimage__.isArrayBuffer=function(A){return A instanceof ArrayBuffer};var ke=t.__addimage__.isArrayBufferView=function(A){return A instanceof Int8Array||A instanceof Uint8Array||A instanceof Uint8ClampedArray||A instanceof Int16Array||A instanceof Uint16Array||A instanceof Int32Array||A instanceof Uint32Array||A instanceof Float32Array||A instanceof Float64Array},re=t.__addimage__.binaryStringToUint8Array=function(A){for(var V=A.length,de=new Uint8Array(V),ue=0;ue<V;ue++)de[ue]=A.charCodeAt(ue);return de},ee=t.__addimage__.arrayBufferToBinaryString=function(A){for(var V="",de=ke(A)?A:new Uint8Array(A),ue=0;ue<de.length;ue+=8192)V+=String.fromCharCode.apply(null,de.subarray(ue,ue+8192));return V};t.addImage=function(){var A,V,de,ue,xe,Ne,Re,Ee,Be;if(typeof arguments[1]=="number"?(V=e,de=arguments[1],ue=arguments[2],xe=arguments[3],Ne=arguments[4],Re=arguments[5],Ee=arguments[6],Be=arguments[7]):(V=arguments[1],de=arguments[2],ue=arguments[3],xe=arguments[4],Ne=arguments[5],Re=arguments[6],Ee=arguments[7],Be=arguments[8]),Ir(A=arguments[0])==="object"&&!x(A)&&"imageData"in A){var Je=A;A=Je.imageData,V=Je.format||V||e,de=Je.x||de||0,ue=Je.y||ue||0,xe=Je.w||Je.width||xe,Ne=Je.h||Je.height||Ne,Re=Je.alias||Re,Ee=Je.compression||Ee,Be=Je.rotation||Je.angle||Be}var qe=this.internal.getFilters();if(Ee===void 0&&qe.indexOf("FlateEncode")!==-1&&(Ee="SLOW"),isNaN(de)||isNaN(ue))throw new Error("Invalid coordinates passed to jsPDF.addImage");l.call(this);var E=W.call(this,A,V,Re,Ee);return k.call(this,de,ue,xe,Ne,E,Be),this};var W=function(A,V,de,ue){var xe,Ne,Re;if(typeof A=="string"&&i(A)===e){A=unescape(A);var Ee=ae(A,!1);(Ee!==""||(Ee=t.loadFile(A,!0))!==void 0)&&(A=Ee)}if(x(A)&&(A=p(A,V)),V=i(A,V),!v(V))throw new Error("addImage does not support files of type '"+V+"', please ensure that a plugin for '"+V+"' support is added.");if(((Re=de)==null||Re.length===0)&&(de=(function(Be){return typeof Be=="string"||ke(Be)?q(Be):ke(Be.data)?q(Be.data):null})(A)),(xe=S.call(this,de))||(A instanceof Uint8Array||V==="RGBA"||(Ne=A,A=re(A)),xe=this["process"+V.toUpperCase()](A,f.call(this),de,(function(Be){return Be&&typeof Be=="string"&&(Be=Be.toUpperCase()),Be in t.image_compression?Be:H.NONE})(ue),Ne)),!xe)throw new Error("An unknown error occurred whilst processing the image.");return xe},ae=t.__addimage__.convertBase64ToBinaryString=function(A,V){V=typeof V!="boolean"||V;var de,ue="";if(typeof A=="string"){var xe;de=(xe=he(A))!==null&&xe!==void 0?xe:A;try{ue=du(de)}catch(Ne){if(V)throw X(de)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+Ne.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return ue};t.getImageProperties=function(A){var V,de,ue="";if(x(A)&&(A=p(A)),typeof A=="string"&&i(A)===e&&((ue=ae(A,!1))===""&&(ue=t.loadFile(A)||""),A=ue),de=i(A),!v(de))throw new Error("addImage does not support files of type '"+de+"', please ensure that a plugin for '"+de+"' support is added.");if(A instanceof Uint8Array||(A=re(A)),!(V=this["process"+de.toUpperCase()](A)))throw new Error("An unknown error occurred whilst processing the image");return V.fileType=de,V}})(bt.API),(function(t){var r=function(e){if(e!==void 0&&e!="")return!0};bt.API.events.push(["addPage",function(e){this.internal.getPageInfo(e.pageNumber).pageContext.annotations=[]}]),t.events.push(["putPage",function(e){for(var n,i,a,o=this.internal.getCoordinateString,s=this.internal.getVerticalCoordinateString,l=this.internal.getPageInfoByObjId(e.objId),c=e.pageContext.annotations,f=!1,v=0;v<c.length&&!f;v++)switch((n=c[v]).type){case"link":(r(n.options.url)||r(n.options.pageNumber))&&(f=!0);break;case"reference":case"text":case"freetext":f=!0}if(f!=0){this.internal.write("/Annots [");for(var x=0;x<c.length;x++){n=c[x];var p=this.internal.pdfEscape,S=this.internal.getEncryptor(e.objId);switch(n.type){case"reference":this.internal.write(" "+n.object.objId+" 0 R ");break;case"text":var w=this.internal.newAdditionalObject(),k=this.internal.newAdditionalObject(),O=this.internal.getEncryptor(w.objId),H=n.title||"Note";a="<</Type /Annot /Subtype /Text "+(i="/Rect ["+o(n.bounds.x)+" "+s(n.bounds.y+n.bounds.h)+" "+o(n.bounds.x+n.bounds.w)+" "+s(n.bounds.y)+"] ")+"/Contents ("+p(O(n.contents))+")",a+=" /Popup "+k.objId+" 0 R",a+=" /P "+l.objId+" 0 R",a+=" /T ("+p(O(H))+") >>",w.content=a;var q=w.objId+" 0 R";a="<</Type /Annot /Subtype /Popup "+(i="/Rect ["+o(n.bounds.x+30)+" "+s(n.bounds.y+n.bounds.h)+" "+o(n.bounds.x+n.bounds.w+30)+" "+s(n.bounds.y)+"] ")+" /Parent "+q,n.open&&(a+=" /Open true"),a+=" >>",k.content=a,this.internal.write(w.objId,"0 R",k.objId,"0 R");break;case"freetext":i="/Rect ["+o(n.bounds.x)+" "+s(n.bounds.y)+" "+o(n.bounds.x+n.bounds.w)+" "+s(n.bounds.y+n.bounds.h)+"] ";var X=n.color||"#000000";a="<</Type /Annot /Subtype /FreeText "+i+"/Contents ("+p(S(n.contents))+")",a+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+X+")",a+=" /Border [0 0 0]",a+=" >>",this.internal.write(a);break;case"link":if(n.options.name){var he=this.annotations._nameMap[n.options.name];n.options.pageNumber=he.page,n.options.top=he.y}else n.options.top||(n.options.top=0);if(i="/Rect ["+n.finalBounds.x+" "+n.finalBounds.y+" "+n.finalBounds.w+" "+n.finalBounds.h+"] ",a="",n.options.url)a="<</Type /Annot /Subtype /Link "+i+"/Border [0 0 0] /A <</S /URI /URI ("+p(S(n.options.url))+") >>";else if(n.options.pageNumber)switch(a="<</Type /Annot /Subtype /Link "+i+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(n.options.pageNumber).objId+" 0 R",n.options.magFactor=n.options.magFactor||"XYZ",n.options.magFactor){case"Fit":a+=" /Fit]";break;case"FitH":a+=" /FitH "+n.options.top+"]";break;case"FitV":n.options.left=n.options.left||0,a+=" /FitV "+n.options.left+"]";break;default:var ke=s(n.options.top);n.options.left=n.options.left||0,n.options.zoom===void 0&&(n.options.zoom=0),a+=" /XYZ "+n.options.left+" "+ke+" "+n.options.zoom+"]"}a!=""&&(a+=" >>",this.internal.write(a))}}this.internal.write("]")}}]),t.createAnnotation=function(e){var n=this.internal.getCurrentPageInfo();switch(e.type){case"link":this.link(e.bounds.x,e.bounds.y,e.bounds.w,e.bounds.h,e);break;case"text":case"freetext":n.pageContext.annotations.push(e)}},t.link=function(e,n,i,a,o){var s=this.internal.getCurrentPageInfo(),l=this.internal.getCoordinateString,c=this.internal.getVerticalCoordinateString;s.pageContext.annotations.push({finalBounds:{x:l(e),y:c(n),w:l(e+i),h:c(n+a)},options:o,type:"link"})},t.textWithLink=function(e,n,i,a){var o,s,l=this.getTextWidth(e),c=this.internal.getLineHeight()/this.internal.scaleFactor;if(a.maxWidth!==void 0){s=a.maxWidth;var f=this.splitTextToSize(e,s).length;o=Math.ceil(c*f)}else s=l,o=c;return this.text(e,n,i,a),i+=.2*c,a.align==="center"&&(n-=l/2),a.align==="right"&&(n-=l),this.link(n,i-c,s,o,a),l},t.getTextWidth=function(e){var n=this.internal.getFontSize();return this.getStringUnitWidth(e)*n/this.internal.scaleFactor}})(bt.API),(function(t){var r={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},e={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},n={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},i=[1570,1571,1573,1575];t.__arabicParser__={};var a=t.__arabicParser__.isInArabicSubstitutionA=function(w){return r[w.charCodeAt(0)]!==void 0},o=t.__arabicParser__.isArabicLetter=function(w){return typeof w=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(w)},s=t.__arabicParser__.isArabicEndLetter=function(w){return o(w)&&a(w)&&r[w.charCodeAt(0)].length<=2},l=t.__arabicParser__.isArabicAlfLetter=function(w){return o(w)&&i.indexOf(w.charCodeAt(0))>=0};t.__arabicParser__.arabicLetterHasIsolatedForm=function(w){return o(w)&&a(w)&&r[w.charCodeAt(0)].length>=1};var c=t.__arabicParser__.arabicLetterHasFinalForm=function(w){return o(w)&&a(w)&&r[w.charCodeAt(0)].length>=2};t.__arabicParser__.arabicLetterHasInitialForm=function(w){return o(w)&&a(w)&&r[w.charCodeAt(0)].length>=3};var f=t.__arabicParser__.arabicLetterHasMedialForm=function(w){return o(w)&&a(w)&&r[w.charCodeAt(0)].length==4},v=t.__arabicParser__.resolveLigatures=function(w){var k=0,O=e,H="",q=0;for(k=0;k<w.length;k+=1)O[w.charCodeAt(k)]!==void 0?(q++,typeof(O=O[w.charCodeAt(k)])=="number"&&(H+=String.fromCharCode(O),O=e,q=0),k===w.length-1&&(O=e,H+=w.charAt(k-(q-1)),k-=q-1,q=0)):(O=e,H+=w.charAt(k-q),k-=q,q=0);return H};t.__arabicParser__.isArabicDiacritic=function(w){return w!==void 0&&n[w.charCodeAt(0)]!==void 0};var x=t.__arabicParser__.getCorrectForm=function(w,k,O){return o(w)?a(w)===!1?-1:!c(w)||!o(k)&&!o(O)||!o(O)&&s(k)||s(w)&&!o(k)||s(w)&&l(k)||s(w)&&s(k)?0:f(w)&&o(k)&&!s(k)&&o(O)&&c(O)?3:s(w)||!o(O)?1:2:-1},p=function(w){var k=0,O=0,H=0,q="",X="",he="",ke=(w=w||"").split("\\s+"),re=[];for(k=0;k<ke.length;k+=1){for(re.push(""),O=0;O<ke[k].length;O+=1)q=ke[k][O],X=ke[k][O-1],he=ke[k][O+1],o(q)?(H=x(q,X,he),re[k]+=H!==-1?String.fromCharCode(r[q.charCodeAt(0)][H]):q):re[k]+=q;re[k]=v(re[k])}return re.join(" ")},S=t.__arabicParser__.processArabic=t.processArabic=function(){var w,k=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,O=[];if(Array.isArray(k)){var H=0;for(O=[],H=0;H<k.length;H+=1)Array.isArray(k[H])?O.push([p(k[H][0]),k[H][1],k[H][2]]):O.push([p(k[H])]);w=O}else w=p(k);return typeof arguments[0]=="string"?w:(arguments[0].text=w,arguments[0])};t.events.push(["preProcessText",S])})(bt.API),bt.API.autoPrint=function(t){var r;return(t=t||{}).variant=t.variant||"non-conform",t.variant==="javascript"?this.addJS("print({});"):(this.internal.events.subscribe("postPutResources",function(){r=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+r+" 0 R")})),this},(function(t){var r=function(){var e=void 0;Object.defineProperty(this,"pdf",{get:function(){return e},set:function(s){e=s}});var n=150;Object.defineProperty(this,"width",{get:function(){return n},set:function(s){n=isNaN(s)||Number.isInteger(s)===!1||s<0?150:s,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=n+1)}});var i=300;Object.defineProperty(this,"height",{get:function(){return i},set:function(s){i=isNaN(s)||Number.isInteger(s)===!1||s<0?300:s,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=i+1)}});var a=[];Object.defineProperty(this,"childNodes",{get:function(){return a},set:function(s){a=s}});var o={};Object.defineProperty(this,"style",{get:function(){return o},set:function(s){o=s}}),Object.defineProperty(this,"parentNode",{})};r.prototype.getContext=function(e,n){var i;if((e=e||"2d")!=="2d")return null;for(i in n)this.pdf.context2d.hasOwnProperty(i)&&(this.pdf.context2d[i]=n[i]);return this.pdf.context2d._canvas=this,this.pdf.context2d},r.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},t.events.push(["initialized",function(){this.canvas=new r,this.canvas.pdf=this}])})(bt.API),(function(t){var r={left:0,top:0,bottom:0,right:0},e=!1,n=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},r),this.internal.__cell__.margins.width=this.getPageWidth(),i.call(this))},i=function(){this.internal.__cell__.lastCell=new a,this.internal.__cell__.pages=1},a=function(){var l=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return l},set:function(w){l=w}});var c=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return c},set:function(w){c=w}});var f=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return f},set:function(w){f=w}});var v=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return v},set:function(w){v=w}});var x=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return x},set:function(w){x=w}});var p=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return p},set:function(w){p=w}});var S=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return S},set:function(w){S=w}}),this};a.prototype.clone=function(){return new a(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},a.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},t.setHeaderFunction=function(l){return n.call(this),this.internal.__cell__.headerFunction=typeof l=="function"?l:void 0,this},t.getTextDimensions=function(l,c){n.call(this);var f=(c=c||{}).fontSize||this.getFontSize(),v=c.font||this.getFont(),x=c.scaleFactor||this.internal.scaleFactor,p=0,S=0,w=0,k=this;if(!Array.isArray(l)&&typeof l!="string"){if(typeof l!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");l=String(l)}var O=c.maxWidth;O>0?typeof l=="string"?l=this.splitTextToSize(l,O):Object.prototype.toString.call(l)==="[object Array]"&&(l=l.reduce(function(q,X){return q.concat(k.splitTextToSize(X,O))},[])):l=Array.isArray(l)?l:[l];for(var H=0;H<l.length;H++)p<(w=this.getStringUnitWidth(l[H],{font:v})*f)&&(p=w);return p!==0&&(S=l.length),{w:p/=x,h:Math.max((S*f*this.getLineHeightFactor()-f*(this.getLineHeightFactor()-1))/x,0)}},t.cellAddPage=function(){n.call(this),this.addPage();var l=this.internal.__cell__.margins||r;return this.internal.__cell__.lastCell=new a(l.left,l.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var o=t.cell=function(){var l;l=arguments[0]instanceof a?arguments[0]:new a(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5],arguments[6]),n.call(this);var c=this.internal.__cell__.lastCell,f=this.internal.__cell__.padding,v=this.internal.__cell__.margins||r,x=this.internal.__cell__.tableHeaderRow,p=this.internal.__cell__.printHeaders;return c.lineNumber!==void 0&&(c.lineNumber===l.lineNumber?(l.x=(c.x||0)+(c.width||0),l.y=c.y||0):c.y+c.height+l.height+v.bottom>this.getPageHeight()?(this.cellAddPage(),l.y=v.top,p&&x&&(this.printHeaderRow(l.lineNumber,!0),l.y+=x[0].height)):l.y=c.y+c.height||l.y),l.text[0]!==void 0&&(this.rect(l.x,l.y,l.width,l.height,e===!0?"FD":void 0),l.align==="right"?this.text(l.text,l.x+l.width-f,l.y+f,{align:"right",baseline:"top"}):l.align==="center"?this.text(l.text,l.x+l.width/2,l.y+f,{align:"center",baseline:"top",maxWidth:l.width-f-f}):this.text(l.text,l.x+f,l.y+f,{align:"left",baseline:"top",maxWidth:l.width-f-f})),this.internal.__cell__.lastCell=l,this};t.table=function(l,c,f,v,x){if(n.call(this),!f)throw new Error("No data for PDF table.");var p,S,w,k,O=[],H=[],q=[],X={},he={},ke=[],re=[],ee=(x=x||{}).autoSize||!1,W=x.printHeaders!==!1,ae=x.css&&x.css["font-size"]!==void 0?16*x.css["font-size"]:x.fontSize||12,A=x.margins||Object.assign({width:this.getPageWidth()},r),V=typeof x.padding=="number"?x.padding:3,de=x.headerBackgroundColor||"#c8c8c8",ue=x.headerTextColor||"#000";if(i.call(this),this.internal.__cell__.printHeaders=W,this.internal.__cell__.margins=A,this.internal.__cell__.table_font_size=ae,this.internal.__cell__.padding=V,this.internal.__cell__.headerBackgroundColor=de,this.internal.__cell__.headerTextColor=ue,this.setFontSize(ae),v==null)H=O=Object.keys(f[0]),q=O.map(function(){return"left"});else if(Array.isArray(v)&&Ir(v[0])==="object")for(O=v.map(function(Je){return Je.name}),H=v.map(function(Je){return Je.prompt||Je.name||""}),q=v.map(function(Je){return Je.align||"left"}),p=0;p<v.length;p+=1)he[v[p].name]=.7499990551181103*v[p].width;else Array.isArray(v)&&typeof v[0]=="string"&&(H=O=v,q=O.map(function(){return"left"}));if(ee||Array.isArray(v)&&typeof v[0]=="string")for(p=0;p<O.length;p+=1){for(X[k=O[p]]=f.map(function(Je){return Je[k]}),this.setFont(void 0,"bold"),ke.push(this.getTextDimensions(H[p],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),S=X[k],this.setFont(void 0,"normal"),w=0;w<S.length;w+=1)ke.push(this.getTextDimensions(S[w],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);he[k]=Math.max.apply(null,ke)+V+V,ke=[]}if(W){var xe={};for(p=0;p<O.length;p+=1)xe[O[p]]={},xe[O[p]].text=H[p],xe[O[p]].align=q[p];var Ne=s.call(this,xe,he);re=O.map(function(Je){return new a(l,c,he[Je],Ne,xe[Je].text,void 0,xe[Je].align)}),this.setTableHeaderRow(re),this.printHeaderRow(1,!1)}var Re=v.reduce(function(Je,qe){return Je[qe.name]=qe.align,Je},{});for(p=0;p<f.length;p+=1){"rowStart"in x&&x.rowStart instanceof Function&&x.rowStart({row:p,data:f[p]},this);var Ee=s.call(this,f[p],he);for(w=0;w<O.length;w+=1){var Be=f[p][O[w]];"cellStart"in x&&x.cellStart instanceof Function&&x.cellStart({row:p,col:w,data:Be},this),o.call(this,new a(l,c,he[O[w]],Ee,Be,p+2,Re[O[w]]))}}return this.internal.__cell__.table_x=l,this.internal.__cell__.table_y=c,this};var s=function(l,c){var f=this.internal.__cell__.padding,v=this.internal.__cell__.table_font_size,x=this.internal.scaleFactor;return Object.keys(l).map(function(p){var S=l[p];return this.splitTextToSize(S.hasOwnProperty("text")?S.text:S,c[p]-f-f)},this).map(function(p){return this.getLineHeightFactor()*p.length*v/x+f+f},this).reduce(function(p,S){return Math.max(p,S)},0)};t.setTableHeaderRow=function(l){n.call(this),this.internal.__cell__.tableHeaderRow=l},t.printHeaderRow=function(l,c){if(n.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var f;if(e=!0,typeof this.internal.__cell__.headerFunction=="function"){var v=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new a(v[0],v[1],v[2],v[3],void 0,-1)}this.setFont(void 0,"bold");for(var x=[],p=0;p<this.internal.__cell__.tableHeaderRow.length;p+=1){f=this.internal.__cell__.tableHeaderRow[p].clone(),c&&(f.y=this.internal.__cell__.margins.top||0,x.push(f)),f.lineNumber=l;var S=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),o.call(this,f),this.setTextColor(S)}x.length>0&&this.setTableHeaderRow(x),this.setFont(void 0,"normal"),e=!1}})(bt.API);var fb={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},ub=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],Om=db(ub),hb=[100,200,300,400,500,600,700,800,900],M8=db(hb);function ym(t){var r=t.family.replace(/"|'/g,"").toLowerCase(),e=(function(a){return fb[a=a||"normal"]?a:"normal"})(t.style),n=(function(a){return a?typeof a=="number"?a>=100&&a<=900&&a%100==0?a:400:/^\d00$/.test(a)?parseInt(a):a==="bold"?700:400:400})(t.weight),i=(function(a){return typeof Om[a=a||"normal"]=="number"?a:"normal"})(t.stretch);return{family:r,style:e,weight:n,stretch:i,src:t.src||[],ref:t.ref||{name:r,style:[i,e,n].join(" ")}}}function Vx(t,r,e,n){var i;for(i=e;i>=0&&i<r.length;i+=n)if(t[r[i]])return t[r[i]];for(i=e;i>=0&&i<r.length;i-=n)if(t[r[i]])return t[r[i]]}var P8={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},zx={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function jx(t){return[t.stretch,t.style,t.weight,t.family].join(" ")}function Hx(t){return t.trimLeft()}function O8(t,r){for(var e=0;e<t.length;){if(t.charAt(e)===r)return[t.substring(0,e),t.substring(e+1)];e+=1}return null}function A8(t){var r=t.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return r===null?null:[r[0],t.substring(r[0].length)]}var lu,Wx,qx,Sc,cu,Gx,$x,Xx,Cm=["times"];function Yx(t,r,e,n,i){var a=4,o=Zx;switch(i){case bt.API.image_compression.FAST:a=1,o=Kx;break;case bt.API.image_compression.MEDIUM:a=6,o=Jx;break;case bt.API.image_compression.SLOW:a=9,o=Qx}t=(function(l,c,f,v){for(var x,p=l.length/c,S=new Uint8Array(l.length+p),w=[T8,Kx,Zx,Jx,Qx],k=0;k<p;k+=1){var O=k*c,H=l.subarray(O,O+c);if(v)S.set(v(H,f,x),O+k);else{for(var q=w.length,X=[],he=0;he<q;he+=1)X[he]=w[he](H,f,x);var ke=F8(X.concat());S.set(X[ke],O+k)}x=H}return S})(t,r,Math.ceil(e*n/8),o);var s=Bf(t,{level:a});return bt.API.__addimage__.arrayBufferToBinaryString(s)}function T8(t){var r=Array.apply([],t);return r.unshift(0),r}function Kx(t,r){var e=t.length,n=[];n[0]=1;for(var i=0;i<e;i+=1){var a=t[i-r]||0;n[i+1]=t[i]-a+256&255}return n}function Zx(t,r,e){var n=t.length,i=[];i[0]=2;for(var a=0;a<n;a+=1){var o=e&&e[a]||0;i[a+1]=t[a]-o+256&255}return i}function Jx(t,r,e){var n=t.length,i=[];i[0]=3;for(var a=0;a<n;a+=1){var o=t[a-r]||0,s=e&&e[a]||0;i[a+1]=t[a]+256-(o+s>>>1)&255}return i}function Qx(t,r,e){var n=t.length,i=[];i[0]=4;for(var a=0;a<n;a+=1){var o=I8(t[a-r]||0,e&&e[a]||0,e&&e[a-r]||0);i[a+1]=t[a]-o+256&255}return i}function I8(t,r,e){if(t===r&&r===e)return t;var n=Math.abs(r-e),i=Math.abs(t-e),a=Math.abs(t+r-e-e);return n<=i&&n<=a?t:i<=a?r:e}function F8(t){var r=t.map(function(e){return e.reduce(function(n,i){return n+Math.abs(i)},0)});return r.indexOf(Math.min.apply(null,r))}function Sm(t,r,e){var n=r*e,i=Math.floor(n/8),a=16-(n-8*i+e),o=(1<<e)-1;return pb(t,i)>>a&o}function eb(t,r,e,n){var i=e*n,a=Math.floor(i/8),o=16-(i-8*a+n),s=(1<<n)-1,l=(r&s)<<o;(function(c,f,v){if(f+1<c.byteLength)c.setUint16(f,v,!1);else{var x=v>>8&255;c.setUint8(f,x)}})(t,a,pb(t,a)&~(s<<o)&65535|l)}function pb(t,r){return r+1<t.byteLength?t.getUint16(r,!1):t.getUint8(r)<<8}function D8(t){var r=0;if(t[r++]!==71||t[r++]!==73||t[r++]!==70||t[r++]!==56||(t[r++]+1&253)!=56||t[r++]!==97)throw new Error("Invalid GIF 87a/89a header.");var e=t[r++]|t[r++]<<8,n=t[r++]|t[r++]<<8,i=t[r++],a=i>>7,o=1<<1+(7&i);t[r++],t[r++];var s=null,l=null;a&&(s=r,l=o,r+=3*o);var c=!0,f=[],v=0,x=null,p=0,S=null;for(this.width=e,this.height=n;c&&r<t.length;)switch(t[r++]){case 33:switch(t[r++]){case 255:if(t[r]!==11||t[r+1]==78&&t[r+2]==69&&t[r+3]==84&&t[r+4]==83&&t[r+5]==67&&t[r+6]==65&&t[r+7]==80&&t[r+8]==69&&t[r+9]==50&&t[r+10]==46&&t[r+11]==48&&t[r+12]==3&&t[r+13]==1&&t[r+16]==0)r+=14,S=t[r++]|t[r++]<<8,r++;else for(r+=12;;){if(!((A=t[r++])>=0))throw Error("Invalid block size");if(A===0)break;r+=A}break;case 249:if(t[r++]!==4||t[r+4]!==0)throw new Error("Invalid graphics extension block.");var w=t[r++];v=t[r++]|t[r++]<<8,x=t[r++],1&w||(x=null),p=w>>2&7,r++;break;case 254:for(;;){if(!((A=t[r++])>=0))throw Error("Invalid block size");if(A===0)break;r+=A}break;default:throw new Error("Unknown graphic control label: 0x"+t[r-1].toString(16))}break;case 44:var k=t[r++]|t[r++]<<8,O=t[r++]|t[r++]<<8,H=t[r++]|t[r++]<<8,q=t[r++]|t[r++]<<8,X=t[r++],he=X>>6&1,ke=1<<1+(7&X),re=s,ee=l,W=!1;X>>7&&(W=!0,re=r,ee=ke,r+=3*ke);var ae=r;for(r++;;){var A;if(!((A=t[r++])>=0))throw Error("Invalid block size");if(A===0)break;r+=A}f.push({x:k,y:O,width:H,height:q,has_local_palette:W,palette_offset:re,palette_size:ee,data_offset:ae,data_length:r-ae,transparent_index:x,interlaced:!!he,delay:v,disposal:p});break;case 59:c=!1;break;default:throw new Error("Unknown gif block: 0x"+t[r-1].toString(16))}this.numFrames=function(){return f.length},this.loopCount=function(){return S},this.frameInfo=function(V){if(V<0||V>=f.length)throw new Error("Frame index out of range.");return f[V]},this.decodeAndBlitFrameBGRA=function(V,de){var ue=this.frameInfo(V),xe=ue.width*ue.height,Ne=new Uint8Array(xe);tb(t,ue.data_offset,Ne,xe);var Re=ue.palette_offset,Ee=ue.transparent_index;Ee===null&&(Ee=256);var Be=ue.width,Je=e-Be,qe=Be,E=4*(ue.y*e+ue.x),U=4*((ue.y+ue.height)*e+ue.x),T=E,R=4*Je;ue.interlaced===!0&&(R+=4*e*7);for(var te=8,pe=0,ye=Ne.length;pe<ye;++pe){var ve=Ne[pe];if(qe===0&&(qe=Be,(T+=R)>=U&&(R=4*Je+4*e*(te-1),T=E+(Be+Je)*(te<<1),te>>=1)),ve===Ee)T+=4;else{var _e=t[Re+3*ve],He=t[Re+3*ve+1],Ye=t[Re+3*ve+2];de[T++]=Ye,de[T++]=He,de[T++]=_e,de[T++]=255}--qe}},this.decodeAndBlitFrameRGBA=function(V,de){var ue=this.frameInfo(V),xe=ue.width*ue.height,Ne=new Uint8Array(xe);tb(t,ue.data_offset,Ne,xe);var Re=ue.palette_offset,Ee=ue.transparent_index;Ee===null&&(Ee=256);var Be=ue.width,Je=e-Be,qe=Be,E=4*(ue.y*e+ue.x),U=4*((ue.y+ue.height)*e+ue.x),T=E,R=4*Je;ue.interlaced===!0&&(R+=4*e*7);for(var te=8,pe=0,ye=Ne.length;pe<ye;++pe){var ve=Ne[pe];if(qe===0&&(qe=Be,(T+=R)>=U&&(R=4*Je+4*e*(te-1),T=E+(Be+Je)*(te<<1),te>>=1)),ve===Ee)T+=4;else{var _e=t[Re+3*ve],He=t[Re+3*ve+1],Ye=t[Re+3*ve+2];de[T++]=_e,de[T++]=He,de[T++]=Ye,de[T++]=255}--qe}}}function tb(t,r,e,n){for(var i=t[r++],a=1<<i,o=a+1,s=o+1,l=i+1,c=(1<<l)-1,f=0,v=0,x=0,p=t[r++],S=new Int32Array(4096),w=null;;){for(;f<16&&p!==0;)v|=t[r++]<<f,f+=8,p===1?p=t[r++]:--p;if(f<l)break;var k=v&c;if(v>>=l,f-=l,k!==a){if(k===o)break;for(var O=k<s?k:w,H=0,q=O;q>a;)q=S[q]>>8,++H;var X=q;if(x+H+(O!==k?1:0)>n)return void Br.log("Warning, gif stream longer than expected.");e[x++]=X;var he=x+=H;for(O!==k&&(e[x++]=X),q=O;H--;)q=S[q],e[--he]=255&q,q>>=8;w!==null&&s<4096&&(S[s++]=w<<8|X,s>=c+1&&l<12&&(++l,c=c<<1|1)),w=k}else s=o+1,c=(1<<(l=i+1))-1,w=null}return x!==n&&Br.log("Warning, gif stream shorter than expected."),e}function km(t){var r,e,n,i,a,o=Math.floor,s=new Array(64),l=new Array(64),c=new Array(64),f=new Array(64),v=new Array(65535),x=new Array(65535),p=new Array(64),S=new Array(64),w=[],k=0,O=7,H=new Array(64),q=new Array(64),X=new Array(64),he=new Array(256),ke=new Array(2048),re=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],ee=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],W=[0,1,2,3,4,5,6,7,8,9,10,11],ae=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],A=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],V=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],de=[0,1,2,3,4,5,6,7,8,9,10,11],ue=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],xe=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function Ne(E,U){for(var T=0,R=0,te=new Array,pe=1;pe<=16;pe++){for(var ye=1;ye<=E[pe];ye++)te[U[R]]=[],te[U[R]][0]=T,te[U[R]][1]=pe,R++,T++;T*=2}return te}function Re(E){for(var U=E[0],T=E[1]-1;T>=0;)U&1<<T&&(k|=1<<O),T--,--O<0&&(k==255?(Ee(255),Ee(0)):Ee(k),O=7,k=0)}function Ee(E){w.push(E)}function Be(E){Ee(E>>8&255),Ee(255&E)}function Je(E,U,T,R,te){for(var pe,ye=te[0],ve=te[240],_e=(function($e,Et){var pt,At,Pt,Kt,Zt,Lt,rr,Wt,yt,jt,kt=0;for(yt=0;yt<8;++yt){pt=$e[kt],At=$e[kt+1],Pt=$e[kt+2],Kt=$e[kt+3],Zt=$e[kt+4],Lt=$e[kt+5],rr=$e[kt+6];var $r=pt+(Wt=$e[kt+7]),ar=pt-Wt,$t=At+rr,Xt=At-rr,Ur=Pt+Lt,Tt=Pt-Lt,Sr=Kt+Zt,Dt=Kt-Zt,Vt=$r+Sr,Vr=$r-Sr,er=$t+Ur,It=$t-Ur;$e[kt]=Vt+er,$e[kt+4]=Vt-er;var pr=.707106781*(It+Vr);$e[kt+2]=Vr+pr,$e[kt+6]=Vr-pr;var vo=.382683433*((Vt=Dt+Tt)-(It=Xt+ar)),Nn=.5411961*Vt+vo,Pa=1.306562965*It+vo,sa=.707106781*(er=Tt+Xt),Nt=ar+sa,Oa=ar-sa;$e[kt+5]=Oa+Nn,$e[kt+3]=Oa-Nn,$e[kt+1]=Nt+Pa,$e[kt+7]=Nt-Pa,kt+=8}for(kt=0,yt=0;yt<8;++yt){pt=$e[kt],At=$e[kt+8],Pt=$e[kt+16],Kt=$e[kt+24],Zt=$e[kt+32],Lt=$e[kt+40],rr=$e[kt+48];var Aa=pt+(Wt=$e[kt+56]),ai=pt-Wt,ki=At+rr,Xr=At-rr,vn=Pt+Lt,B=Pt-Lt,oe=Kt+Zt,K=Kt-Zt,J=Aa+oe,se=Aa-oe,ce=ki+vn,Oe=ki-vn;$e[kt]=J+ce,$e[kt+32]=J-ce;var Le=.707106781*(Oe+se);$e[kt+16]=se+Le,$e[kt+48]=se-Le;var Ie=.382683433*((J=K+B)-(Oe=Xr+ai)),Ae=.5411961*J+Ie,De=1.306562965*Oe+Ie,et=.707106781*(ce=B+Xr),it=ai+et,mt=ai-et;$e[kt+40]=mt+Ae,$e[kt+24]=mt-Ae,$e[kt+8]=it+De,$e[kt+56]=it-De,kt++}for(yt=0;yt<64;++yt)jt=$e[yt]*Et[yt],p[yt]=jt>0?jt+.5|0:jt-.5|0;return p})(E,U),He=0;He<64;++He)S[re[He]]=_e[He];var Ye=S[0]-T;T=S[0],Ye==0?Re(R[0]):(Re(R[x[pe=32767+Ye]]),Re(v[pe]));for(var nt=63;nt>0&&S[nt]==0;)nt--;if(nt==0)return Re(ye),T;for(var at,Q=1;Q<=nt;){for(var tt=Q;S[Q]==0&&Q<=nt;)++Q;var Qe=Q-tt;if(Qe>=16){at=Qe>>4;for(var _t=1;_t<=at;++_t)Re(ve);Qe&=15}pe=32767+S[Q],Re(te[(Qe<<4)+x[pe]]),Re(v[pe]),Q++}return nt!=63&&Re(ye),T}function qe(E){E=Math.min(Math.max(E,1),100),a!=E&&((function(U){for(var T=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],R=0;R<64;R++){var te=o((T[R]*U+50)/100);te=Math.min(Math.max(te,1),255),s[re[R]]=te}for(var pe=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],ye=0;ye<64;ye++){var ve=o((pe[ye]*U+50)/100);ve=Math.min(Math.max(ve,1),255),l[re[ye]]=ve}for(var _e=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],He=0,Ye=0;Ye<8;Ye++)for(var nt=0;nt<8;nt++)c[He]=1/(s[re[He]]*_e[Ye]*_e[nt]*8),f[He]=1/(l[re[He]]*_e[Ye]*_e[nt]*8),He++})(E<50?Math.floor(5e3/E):Math.floor(200-2*E)),a=E)}this.encode=function(E,U){U&&qe(U),w=new Array,k=0,O=7,Be(65496),Be(65504),Be(16),Ee(74),Ee(70),Ee(73),Ee(70),Ee(0),Ee(1),Ee(1),Ee(0),Be(1),Be(1),Ee(0),Ee(0),(function(){Be(65499),Be(132),Ee(0);for(var At=0;At<64;At++)Ee(s[At]);Ee(1);for(var Pt=0;Pt<64;Pt++)Ee(l[Pt])})(),(function(At,Pt){Be(65472),Be(17),Ee(8),Be(Pt),Be(At),Ee(3),Ee(1),Ee(17),Ee(0),Ee(2),Ee(17),Ee(1),Ee(3),Ee(17),Ee(1)})(E.width,E.height),(function(){Be(65476),Be(418),Ee(0);for(var At=0;At<16;At++)Ee(ee[At+1]);for(var Pt=0;Pt<=11;Pt++)Ee(W[Pt]);Ee(16);for(var Kt=0;Kt<16;Kt++)Ee(ae[Kt+1]);for(var Zt=0;Zt<=161;Zt++)Ee(A[Zt]);Ee(1);for(var Lt=0;Lt<16;Lt++)Ee(V[Lt+1]);for(var rr=0;rr<=11;rr++)Ee(de[rr]);Ee(17);for(var Wt=0;Wt<16;Wt++)Ee(ue[Wt+1]);for(var yt=0;yt<=161;yt++)Ee(xe[yt])})(),Be(65498),Be(12),Ee(3),Ee(1),Ee(0),Ee(2),Ee(17),Ee(3),Ee(17),Ee(0),Ee(63),Ee(0);var T=0,R=0,te=0;k=0,O=7,this.encode.displayName="_encode_";for(var pe,ye,ve,_e,He,Ye,nt,at,Q,tt=E.data,Qe=E.width,_t=E.height,$e=4*Qe,Et=0;Et<_t;){for(pe=0;pe<$e;){for(He=$e*Et+pe,nt=-1,at=0,Q=0;Q<64;Q++)Ye=He+(at=Q>>3)*$e+(nt=4*(7&Q)),Et+at>=_t&&(Ye-=$e*(Et+1+at-_t)),pe+nt>=$e&&(Ye-=pe+nt-$e+4),ye=tt[Ye++],ve=tt[Ye++],_e=tt[Ye++],H[Q]=(ke[ye]+ke[ve+256|0]+ke[_e+512|0]>>16)-128,q[Q]=(ke[ye+768|0]+ke[ve+1024|0]+ke[_e+1280|0]>>16)-128,X[Q]=(ke[ye+1280|0]+ke[ve+1536|0]+ke[_e+1792|0]>>16)-128;T=Je(H,c,T,r,n),R=Je(q,f,R,e,i),te=Je(X,f,te,e,i),pe+=32}Et+=8}if(O>=0){var pt=[];pt[1]=O+1,pt[0]=(1<<O+1)-1,Re(pt)}return Be(65497),new Uint8Array(w)},t=t||50,(function(){for(var E=String.fromCharCode,U=0;U<256;U++)he[U]=E(U)})(),r=Ne(ee,W),e=Ne(V,de),n=Ne(ae,A),i=Ne(ue,xe),(function(){for(var E=1,U=2,T=1;T<=15;T++){for(var R=E;R<U;R++)x[32767+R]=T,v[32767+R]=[],v[32767+R][1]=T,v[32767+R][0]=R;for(var te=-(U-1);te<=-E;te++)x[32767+te]=T,v[32767+te]=[],v[32767+te][1]=T,v[32767+te][0]=U-1+te;E<<=1,U<<=1}})(),(function(){for(var E=0;E<256;E++)ke[E]=19595*E,ke[E+256|0]=38470*E,ke[E+512|0]=7471*E+32768,ke[E+768|0]=-11059*E,ke[E+1024|0]=-21709*E,ke[E+1280|0]=32768*E+8421375,ke[E+1536|0]=-27439*E,ke[E+1792|0]=-5329*E})(),qe(t)}function Wa(t,r){if(this.pos=0,this.buffer=t,this.datav=new DataView(t.buffer),this.is_with_alpha=!!r,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function rb(t){function r(W){if(!W)throw Error("assert :P")}function e(W,ae,A){for(var V=0;4>V;V++)if(W[ae+V]!=A.charCodeAt(V))return!0;return!1}function n(W,ae,A,V,de){for(var ue=0;ue<de;ue++)W[ae+ue]=A[V+ue]}function i(W,ae,A,V){for(var de=0;de<V;de++)W[ae+de]=A}function a(W){return new Int32Array(W)}function o(W,ae){for(var A=[],V=0;V<W;V++)A.push(new ae);return A}function s(W,ae){var A=[];return(function V(de,ue,xe){for(var Ne=xe[ue],Re=0;Re<Ne&&(de.push(xe.length>ue+1?[]:new ae),!(xe.length<ue+1));Re++)V(de[Re],ue+1,xe)})(A,0,W),A}var l=function(){var W=this;function ae(h,m){for(var y=1<<m-1>>>0;h&y;)y>>>=1;return y?(h&y-1)+y:h}function A(h,m,y,M,F){r(!(M%y));do h[m+(M-=y)]=F;while(0<M)}function V(h,m,y,M,F){if(r(2328>=F),512>=F)var z=a(512);else if((z=a(F))==null)return 0;return(function(G,Y,Z,ne,ge,Fe){var ie,we,Me=Y,Ve=1<<Z,Te=a(16),ze=a(16);for(r(ge!=0),r(ne!=null),r(G!=null),r(0<Z),we=0;we<ge;++we){if(15<ne[we])return 0;++Te[ne[we]]}if(Te[0]==ge)return 0;for(ze[1]=0,ie=1;15>ie;++ie){if(Te[ie]>1<<ie)return 0;ze[ie+1]=ze[ie]+Te[ie]}for(we=0;we<ge;++we)ie=ne[we],0<ne[we]&&(Fe[ze[ie]++]=we);if(ze[15]==1)return(ne=new de).g=0,ne.value=Fe[0],A(G,Me,1,Ve,ne),Ve;var Ge,rt=-1,Ze=Ve-1,Ot=0,gt=1,Jt=1,Ct=1<<Z;for(we=0,ie=1,ge=2;ie<=Z;++ie,ge<<=1){if(gt+=Jt<<=1,0>(Jt-=Te[ie]))return 0;for(;0<Te[ie];--Te[ie])(ne=new de).g=ie,ne.value=Fe[we++],A(G,Me+Ot,ge,Ct,ne),Ot=ae(Ot,ie)}for(ie=Z+1,ge=2;15>=ie;++ie,ge<<=1){if(gt+=Jt<<=1,0>(Jt-=Te[ie]))return 0;for(;0<Te[ie];--Te[ie]){if(ne=new de,(Ot&Ze)!=rt){for(Me+=Ct,Ge=1<<(rt=ie)-Z;15>rt&&!(0>=(Ge-=Te[rt]));)++rt,Ge<<=1;Ve+=Ct=1<<(Ge=rt-Z),G[Y+(rt=Ot&Ze)].g=Ge+Z,G[Y+rt].value=Me-Y-rt}ne.g=ie-Z,ne.value=Fe[we++],A(G,Me+(Ot>>Z),ge,Ct,ne),Ot=ae(Ot,ie)}}return gt!=2*ze[15]-1?0:Ve})(h,m,y,M,F,z)}function de(){this.value=this.g=0}function ue(){this.value=this.g=0}function xe(){this.G=o(5,de),this.H=a(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=o(el,ue)}function Ne(h,m,y,M){r(h!=null),r(m!=null),r(2147483648>M),h.Ca=254,h.I=0,h.b=-8,h.Ka=0,h.oa=m,h.pa=y,h.Jd=m,h.Yc=y+M,h.Zc=4<=M?y+M-4+1:y,ye(h)}function Re(h,m){for(var y=0;0<m--;)y|=_e(h,128)<<m;return y}function Ee(h,m){var y=Re(h,m);return ve(h)?-y:y}function Be(h,m,y,M){var F,z=0;for(r(h!=null),r(m!=null),r(4294967288>M),h.Sb=M,h.Ra=0,h.u=0,h.h=0,4<M&&(M=4),F=0;F<M;++F)z+=m[y+F]<<8*F;h.Ra=z,h.bb=M,h.oa=m,h.pa=y}function Je(h){for(;8<=h.u&&h.bb<h.Sb;)h.Ra>>>=8,h.Ra+=h.oa[h.pa+h.bb]<<ts-8>>>0,++h.bb,h.u-=8;R(h)&&(h.h=1,h.u=0)}function qe(h,m){if(r(0<=m),!h.h&&m<=Hi){var y=T(h)&ji[m];return h.u+=m,Je(h),y}return h.h=1,h.u=0}function E(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function U(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function T(h){return h.Ra>>>(h.u&ts-1)>>>0}function R(h){return r(h.bb<=h.Sb),h.h||h.bb==h.Sb&&h.u>ts}function te(h,m){h.u=m,h.h=R(h)}function pe(h){h.u>=Oo&&(r(h.u>=Oo),Je(h))}function ye(h){r(h!=null&&h.oa!=null),h.pa<h.Zc?(h.I=(h.oa[h.pa++]|h.I<<8)>>>0,h.b+=8):(r(h!=null&&h.oa!=null),h.pa<h.Yc?(h.b+=8,h.I=h.oa[h.pa++]|h.I<<8):h.Ka?h.b=0:(h.I<<=8,h.b+=8,h.Ka=1))}function ve(h){return Re(h,1)}function _e(h,m){var y=h.Ca;0>h.b&&ye(h);var M=h.b,F=y*m>>>8,z=(h.I>>>M>F)+0;for(z?(y-=F,h.I-=F+1<<M>>>0):y=F+1,M=y,F=0;256<=M;)F+=8,M>>=8;return M=7^F+rs[M],h.b-=M,h.Ca=(y<<M)-1,z}function He(h,m,y){h[m+0]=y>>24&255,h[m+1]=y>>16&255,h[m+2]=y>>8&255,h[m+3]=255&y}function Ye(h,m){return h[m+0]|h[m+1]<<8}function nt(h,m){return Ye(h,m)|h[m+2]<<16}function at(h,m){return Ye(h,m)|Ye(h,m+2)<<16}function Q(h,m){var y=1<<m;return r(h!=null),r(0<m),h.X=a(y),h.X==null?0:(h.Mb=32-m,h.Xa=m,1)}function tt(h,m){r(h!=null),r(m!=null),r(h.Xa==m.Xa),n(m.X,0,h.X,0,1<<m.Xa)}function Qe(){this.X=[],this.Xa=this.Mb=0}function _t(h,m,y,M){r(y!=null),r(M!=null);var F=y[0],z=M[0];return F==0&&(F=(h*z+m/2)/m),z==0&&(z=(m*F+h/2)/h),0>=F||0>=z?0:(y[0]=F,M[0]=z,1)}function $e(h,m){return h+(1<<m)-1>>>m}function Et(h,m){return((4278255360&h)+(4278255360&m)>>>0&4278255360)+((16711935&h)+(16711935&m)>>>0&16711935)>>>0}function pt(h,m){W[m]=function(y,M,F,z,G,Y,Z){var ne;for(ne=0;ne<G;++ne){var ge=W[h](Y[Z+ne-1],F,z+ne);Y[Z+ne]=Et(y[M+ne],ge)}}}function At(){this.ud=this.hd=this.jd=0}function Pt(h,m){return((4278124286&(h^m))>>>1)+(h&m)>>>0}function Kt(h){return 0<=h&&256>h?h:0>h?0:255<h?255:void 0}function Zt(h,m){return Kt(h+(h-m+.5>>1))}function Lt(h,m,y){return Math.abs(m-y)-Math.abs(h-y)}function rr(h,m,y,M,F,z,G){for(M=z[G-1],y=0;y<F;++y)z[G+y]=M=Et(h[m+y],M)}function Wt(h,m,y,M,F){var z;for(z=0;z<y;++z){var G=h[m+z],Y=G>>8&255,Z=16711935&(Z=(Z=16711935&G)+((Y<<16)+Y));M[F+z]=(4278255360&G)+Z>>>0}}function yt(h,m){m.jd=255&h,m.hd=h>>8&255,m.ud=h>>16&255}function jt(h,m,y,M,F,z){var G;for(G=0;G<M;++G){var Y=m[y+G],Z=Y>>>8,ne=Y,ge=255&(ge=(ge=Y>>>16)+((h.jd<<24>>24)*(Z<<24>>24)>>>5));ne=255&(ne=(ne+=(h.hd<<24>>24)*(Z<<24>>24)>>>5)+((h.ud<<24>>24)*(ge<<24>>24)>>>5)),F[z+G]=(4278255360&Y)+(ge<<16)+ne}}function kt(h,m,y,M,F){W[m]=function(z,G,Y,Z,ne,ge,Fe,ie,we){for(Z=Fe;Z<ie;++Z)for(Fe=0;Fe<we;++Fe)ne[ge++]=F(Y[M(z[G++])])},W[h]=function(z,G,Y,Z,ne,ge,Fe){var ie=8>>z.b,we=z.Ea,Me=z.K[0],Ve=z.w;if(8>ie)for(z=(1<<z.b)-1,Ve=(1<<ie)-1;G<Y;++G){var Te,ze=0;for(Te=0;Te<we;++Te)Te&z||(ze=M(Z[ne++])),ge[Fe++]=F(Me[ze&Ve]),ze>>=ie}else W["VP8LMapColor"+y](Z,ne,Me,Ve,ge,Fe,G,Y,we)}}function $r(h,m,y,M,F){for(y=m+y;m<y;){var z=h[m++];M[F++]=z>>16&255,M[F++]=z>>8&255,M[F++]=255&z}}function ar(h,m,y,M,F){for(y=m+y;m<y;){var z=h[m++];M[F++]=z>>16&255,M[F++]=z>>8&255,M[F++]=255&z,M[F++]=z>>24&255}}function $t(h,m,y,M,F){for(y=m+y;m<y;){var z=(G=h[m++])>>16&240|G>>12&15,G=240&G|G>>28&15;M[F++]=z,M[F++]=G}}function Xt(h,m,y,M,F){for(y=m+y;m<y;){var z=(G=h[m++])>>16&248|G>>13&7,G=G>>5&224|G>>3&31;M[F++]=z,M[F++]=G}}function Ur(h,m,y,M,F){for(y=m+y;m<y;){var z=h[m++];M[F++]=255&z,M[F++]=z>>8&255,M[F++]=z>>16&255}}function Tt(h,m,y,M,F,z){if(z==0)for(y=m+y;m<y;)He(M,((z=h[m++])[0]>>24|z[1]>>8&65280|z[2]<<8&16711680|z[3]<<24)>>>0),F+=32;else n(M,F,h,m,y)}function Sr(h,m){W[m][0]=W[h+"0"],W[m][1]=W[h+"1"],W[m][2]=W[h+"2"],W[m][3]=W[h+"3"],W[m][4]=W[h+"4"],W[m][5]=W[h+"5"],W[m][6]=W[h+"6"],W[m][7]=W[h+"7"],W[m][8]=W[h+"8"],W[m][9]=W[h+"9"],W[m][10]=W[h+"10"],W[m][11]=W[h+"11"],W[m][12]=W[h+"12"],W[m][13]=W[h+"13"],W[m][14]=W[h+"0"],W[m][15]=W[h+"0"]}function Dt(h){return h==xh||h==bh||h==Dd||h==wh}function Vt(){this.eb=[],this.size=this.A=this.fb=0}function Vr(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function er(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new Vt,this.f.kb=new Vr,this.sd=null}function It(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function pr(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function vo(h){return alert("todo:WebPSamplerProcessPlane"),h.T}function Nn(h,m){var y=h.T,M=m.ba.f.RGBA,F=M.eb,z=M.fb+h.ka*M.A,G=ha[m.ba.S],Y=h.y,Z=h.O,ne=h.f,ge=h.N,Fe=h.ea,ie=h.W,we=m.cc,Me=m.dc,Ve=m.Mc,Te=m.Nc,ze=h.ka,Ge=h.ka+h.T,rt=h.U,Ze=rt+1>>1;for(ze==0?G(Y,Z,null,null,ne,ge,Fe,ie,ne,ge,Fe,ie,F,z,null,null,rt):(G(m.ec,m.fc,Y,Z,we,Me,Ve,Te,ne,ge,Fe,ie,F,z-M.A,F,z,rt),++y);ze+2<Ge;ze+=2)we=ne,Me=ge,Ve=Fe,Te=ie,ge+=h.Rc,ie+=h.Rc,z+=2*M.A,G(Y,(Z+=2*h.fa)-h.fa,Y,Z,we,Me,Ve,Te,ne,ge,Fe,ie,F,z-M.A,F,z,rt);return Z+=h.fa,h.j+Ge<h.o?(n(m.ec,m.fc,Y,Z,rt),n(m.cc,m.dc,ne,ge,Ze),n(m.Mc,m.Nc,Fe,ie,Ze),y--):1&Ge||G(Y,Z,null,null,ne,ge,Fe,ie,ne,ge,Fe,ie,F,z+M.A,null,null,rt),y}function Pa(h,m,y){var M=h.F,F=[h.J];if(M!=null){var z=h.U,G=m.ba.S,Y=G==Fd||G==Dd;m=m.ba.f.RGBA;var Z=[0],ne=h.ka;Z[0]=h.T,h.Kb&&(ne==0?--Z[0]:(--ne,F[0]-=h.width),h.j+h.ka+h.T==h.o&&(Z[0]=h.o-h.j-ne));var ge=m.eb;ne=m.fb+ne*m.A,h=dg(M,F[0],h.width,z,Z,ge,ne+(Y?0:3),m.A),r(y==Z),h&&Dt(G)&&r0(ge,ne,Y,z,Z,m.A)}return 0}function sa(h){var m=h.ma,y=m.ba.S,M=11>y,F=y==Td||y==Id||y==Fd||y==vh||y==12||Dt(y);if(m.memory=null,m.Ib=null,m.Jb=null,m.Nd=null,!Xc(m.Oa,h,F?11:12))return 0;if(F&&Dt(y)&&qc(),h.da)alert("todo:use_scaling");else{if(M){if(m.Ib=vo,h.Kb){if(y=h.U+1>>1,m.memory=a(h.U+2*y),m.memory==null)return 0;m.ec=m.memory,m.fc=0,m.cc=m.ec,m.dc=m.fc+h.U,m.Mc=m.cc,m.Nc=m.dc+y,m.Ib=Nn,qc()}}else alert("todo:EmitYUV");F&&(m.Jb=Pa,M&&Fa())}if(M&&!Mg){for(h=0;256>h;++h)W5[h]=89858*(h-128)+Rd>>Nd,$5[h]=-22014*(h-128)+Rd,G5[h]=-45773*(h-128),q5[h]=113618*(h-128)+Rd>>Nd;for(h=i0;h<Sh;++h)m=76283*(h-16)+Rd>>Nd,X5[h-i0]=xn(m,255),Y5[h-i0]=xn(m+8>>4,15);Mg=1}return 1}function Nt(h){var m=h.ma,y=h.U,M=h.T;return r(!(1&h.ka)),0>=y||0>=M?0:(y=m.Ib(h,m),m.Jb!=null&&m.Jb(h,m,y),m.Dc+=y,1)}function Oa(h){h.ma.memory=null}function Aa(h,m,y,M){return qe(h,8)!=47?0:(m[0]=qe(h,14)+1,y[0]=qe(h,14)+1,M[0]=qe(h,1),qe(h,3)!=0?0:!h.h)}function ai(h,m){if(4>h)return h+1;var y=h-2>>1;return(2+(1&h)<<y)+qe(m,y)+1}function ki(h,m){return 120<m?m-120:1<=(y=((y=A5[m-1])>>4)*h+(8-(15&y)))?y:1;var y}function Xr(h,m,y){var M=T(y),F=h[m+=255&M].g-8;return 0<F&&(te(y,y.u+8),M=T(y),m+=h[m].value,m+=M&(1<<F)-1),te(y,y.u+h[m].g),h[m].value}function vn(h,m,y){return y.g+=h.g,y.value+=h.value<<m>>>0,r(8>=y.g),h.g}function B(h,m,y){var M=h.xc;return r((m=M==0?0:h.vc[h.md*(y>>M)+(m>>M)])<h.Wb),h.Ya[m]}function oe(h,m,y,M){var F=h.ab,z=h.c*m,G=h.C;m=G+m;var Y=y,Z=M;for(M=h.Ta,y=h.Ua;0<F--;){var ne=h.gc[F],ge=G,Fe=m,ie=Y,we=Z,Me=(Z=M,Y=y,ne.Ea);switch(r(ge<Fe),r(Fe<=ne.nc),ne.hc){case 2:dn(ie,we,(Fe-ge)*Me,Z,Y);break;case 0:var Ve=ge,Te=Fe,ze=Z,Ge=Y,rt=(Ct=ne).Ea;Ve==0&&(Kc(ie,we,null,null,1,ze,Ge),rr(ie,we+1,0,0,rt-1,ze,Ge+1),we+=rt,Ge+=rt,++Ve);for(var Ze=1<<Ct.b,Ot=Ze-1,gt=$e(rt,Ct.b),Jt=Ct.K,Ct=Ct.w+(Ve>>Ct.b)*gt;Ve<Te;){var lr=Jt,An=Ct,Qt=1;for(zl(ie,we,ze,Ge-rt,1,ze,Ge);Qt<rt;){var St=(Qt&~Ot)+Ze;St>rt&&(St=rt),(0,Jc[lr[An++]>>8&15])(ie,we+ +Qt,ze,Ge+Qt-rt,St-Qt,ze,Ge+Qt),Qt=St}we+=rt,Ge+=rt,++Ve&Ot||(Ct+=gt)}Fe!=ne.nc&&n(Z,Y-Me,Z,Y+(Fe-ge-1)*Me,Me);break;case 1:for(Me=ie,Te=we,rt=(ie=ne.Ea)-(Ge=ie&~(ze=(we=1<<ne.b)-1)),Ve=$e(ie,ne.b),Ze=ne.K,ne=ne.w+(ge>>ne.b)*Ve;ge<Fe;){for(Ot=Ze,gt=ne,Jt=new At,Ct=Te+Ge,lr=Te+ie;Te<Ct;)yt(Ot[gt++],Jt),Qc(Jt,Me,Te,we,Z,Y),Te+=we,Y+=we;Te<lr&&(yt(Ot[gt++],Jt),Qc(Jt,Me,Te,rt,Z,Y),Te+=rt,Y+=rt),++ge&ze||(ne+=Ve)}break;case 3:if(ie==Z&&we==Y&&0<ne.b){for(Te=Z,ie=Me=Y+(Fe-ge)*Me-(Ge=(Fe-ge)*$e(ne.Ea,ne.b)),we=Z,ze=Y,Ve=[],Ge=(rt=Ge)-1;0<=Ge;--Ge)Ve[Ge]=we[ze+Ge];for(Ge=rt-1;0<=Ge;--Ge)Te[ie+Ge]=Ve[Ge];Md(ne,ge,Fe,Z,Me,Z,Y)}else Md(ne,ge,Fe,ie,we,Z,Y)}Y=M,Z=y}Z!=y&&n(M,y,Y,Z,z)}function K(h,m){var y=h.V,M=h.Ba+h.c*h.C,F=m-h.C;if(r(m<=h.l.o),r(16>=F),0<F){var z=h.l,G=h.Ta,Y=h.Ua,Z=z.width;if(oe(h,F,y,M),F=Y=[Y],r((y=h.C)<(M=m)),r(z.v<z.va),M>z.o&&(M=z.o),y<z.j){var ne=z.j-y;y=z.j,F[0]+=ne*Z}if(y>=M?y=0:(F[0]+=4*z.v,z.ka=y-z.j,z.U=z.va-z.v,z.T=M-y,y=1),y){if(Y=Y[0],11>(y=h.ca).S){var ge=y.f.RGBA,Fe=(M=y.S,F=z.U,z=z.T,ne=ge.eb,ge.A),ie=z;for(ge=ge.fb+h.Ma*ge.A;0<ie--;){var we=G,Me=Y,Ve=F,Te=ne,ze=ge;switch(M){case Ad:e0(we,Me,Ve,Te,ze);break;case Td:ns(we,Me,Ve,Te,ze);break;case xh:ns(we,Me,Ve,Te,ze),r0(Te,ze,0,Ve,1,0);break;case _g:tl(we,Me,Ve,Te,ze);break;case Id:Tt(we,Me,Ve,Te,ze,1);break;case bh:Tt(we,Me,Ve,Te,ze,1),r0(Te,ze,0,Ve,1,0);break;case Fd:Tt(we,Me,Ve,Te,ze,0);break;case Dd:Tt(we,Me,Ve,Te,ze,0),r0(Te,ze,1,Ve,1,0);break;case vh:is(we,Me,Ve,Te,ze);break;case wh:is(we,Me,Ve,Te,ze),cg(Te,ze,Ve,1,0);break;case vg:as(we,Me,Ve,Te,ze);break;default:r(0)}Y+=Z,ge+=Fe}h.Ma+=z}else alert("todo:EmitRescaledRowsYUVA");r(h.Ma<=y.height)}}h.C=m,r(h.C<=h.i)}function J(h){var m;if(0<h.ua)return 0;for(m=0;m<h.Wb;++m){var y=h.Ya[m].G,M=h.Ya[m].H;if(0<y[1][M[1]+0].g||0<y[2][M[2]+0].g||0<y[3][M[3]+0].g)return 0}return 1}function se(h,m,y,M,F,z){if(h.Z!=0){var G=h.qd,Y=h.rd;for(r(ls[h.Z]!=null);m<y;++m)ls[h.Z](G,Y,M,F,M,F,z),G=M,Y=F,F+=z;h.qd=G,h.rd=Y}}function ce(h,m){var y=h.l.ma,M=y.Z==0||y.Z==1?h.l.j:h.C;if(M=h.C<M?M:h.C,r(m<=h.l.o),m>M){var F=h.l.width,z=y.ca,G=y.tb+F*M,Y=h.V,Z=h.Ba+h.c*M,ne=h.gc;r(h.ab==1),r(ne[0].hc==3),Ja(ne[0],M,m,Y,Z,z,G),se(y,M,m,z,G,F)}h.C=h.Ma=m}function Oe(h,m,y,M,F,z,G){var Y=h.$/M,Z=h.$%M,ne=h.m,ge=h.s,Fe=y+h.$,ie=Fe;F=y+M*F;var we=y+M*z,Me=280+ge.ua,Ve=h.Pb?Y:16777216,Te=0<ge.ua?ge.Wa:null,ze=ge.wc,Ge=Fe<we?B(ge,Z,Y):null;r(h.C<z),r(we<=F);var rt=!1;e:for(;;){for(;rt||Fe<we;){var Ze=0;if(Y>=Ve){var Ot=Fe-y;r((Ve=h).Pb),Ve.wd=Ve.m,Ve.xd=Ot,0<Ve.s.ua&&tt(Ve.s.Wa,Ve.s.vb),Ve=Y+I5}if(Z&ze||(Ge=B(ge,Z,Y)),r(Ge!=null),Ge.Qb&&(m[Fe]=Ge.qb,rt=!0),!rt)if(pe(ne),Ge.jc){Ze=ne,Ot=m;var gt=Fe,Jt=Ge.pd[T(Ze)&el-1];r(Ge.jc),256>Jt.g?(te(Ze,Ze.u+Jt.g),Ot[gt]=Jt.value,Ze=0):(te(Ze,Ze.u+Jt.g-256),r(256<=Jt.value),Ze=Jt.value),Ze==0&&(rt=!0)}else Ze=Xr(Ge.G[0],Ge.H[0],ne);if(ne.h)break;if(rt||256>Ze){if(!rt)if(Ge.nd)m[Fe]=(Ge.qb|Ze<<8)>>>0;else{if(pe(ne),rt=Xr(Ge.G[1],Ge.H[1],ne),pe(ne),Ot=Xr(Ge.G[2],Ge.H[2],ne),gt=Xr(Ge.G[3],Ge.H[3],ne),ne.h)break;m[Fe]=(gt<<24|rt<<16|Ze<<8|Ot)>>>0}if(rt=!1,++Fe,++Z>=M&&(Z=0,++Y,G!=null&&Y<=z&&!(Y%16)&&G(h,Y),Te!=null))for(;ie<Fe;)Ze=m[ie++],Te.X[(506832829*Ze&4294967295)>>>Te.Mb]=Ze}else if(280>Ze){if(Ze=ai(Ze-256,ne),Ot=Xr(Ge.G[4],Ge.H[4],ne),pe(ne),Ot=ki(M,Ot=ai(Ot,ne)),ne.h)break;if(Fe-y<Ot||F-Fe<Ze)break e;for(gt=0;gt<Ze;++gt)m[Fe+gt]=m[Fe+gt-Ot];for(Fe+=Ze,Z+=Ze;Z>=M;)Z-=M,++Y,G!=null&&Y<=z&&!(Y%16)&&G(h,Y);if(r(Fe<=F),Z&ze&&(Ge=B(ge,Z,Y)),Te!=null)for(;ie<Fe;)Ze=m[ie++],Te.X[(506832829*Ze&4294967295)>>>Te.Mb]=Ze}else{if(!(Ze<Me))break e;for(rt=Ze-280,r(Te!=null);ie<Fe;)Ze=m[ie++],Te.X[(506832829*Ze&4294967295)>>>Te.Mb]=Ze;Ze=Fe,r(!(rt>>>(Ot=Te).Xa)),m[Ze]=Ot.X[rt],rt=!0}rt||r(ne.h==R(ne))}if(h.Pb&&ne.h&&Fe<F)r(h.m.h),h.a=5,h.m=h.wd,h.$=h.xd,0<h.s.ua&&tt(h.s.vb,h.s.Wa);else{if(ne.h)break e;G?.(h,Y>z?z:Y),h.a=0,h.$=Fe-y}return 1}return h.a=3,0}function Le(h){r(h!=null),h.vc=null,h.yc=null,h.Ya=null;var m=h.Wa;m!=null&&(m.X=null),h.vb=null,r(h!=null)}function Ie(){var h=new zt;return h==null?null:(h.a=0,h.xb=wg,Sr("Predictor","VP8LPredictors"),Sr("Predictor","VP8LPredictors_C"),Sr("PredictorAdd","VP8LPredictorsAdd"),Sr("PredictorAdd","VP8LPredictorsAdd_C"),dn=Wt,Qc=jt,e0=$r,ns=ar,is=$t,as=Xt,tl=Ur,W.VP8LMapColor32b=Za,W.VP8LMapColor8b=Zc,h)}function Ae(h,m,y,M,F){var z=1,G=[h],Y=[m],Z=M.m,ne=M.s,ge=null,Fe=0;e:for(;;){if(y)for(;z&&qe(Z,1);){var ie=G,we=Y,Me=M,Ve=1,Te=Me.m,ze=Me.gc[Me.ab],Ge=qe(Te,2);if(Me.Oc&1<<Ge)z=0;else{switch(Me.Oc|=1<<Ge,ze.hc=Ge,ze.Ea=ie[0],ze.nc=we[0],ze.K=[null],++Me.ab,r(4>=Me.ab),Ge){case 0:case 1:ze.b=qe(Te,3)+2,Ve=Ae($e(ze.Ea,ze.b),$e(ze.nc,ze.b),0,Me,ze.K),ze.K=ze.K[0];break;case 3:var rt,Ze=qe(Te,8)+1,Ot=16<Ze?0:4<Ze?1:2<Ze?2:3;if(ie[0]=$e(ze.Ea,Ot),ze.b=Ot,rt=Ve=Ae(Ze,1,0,Me,ze.K)){var gt,Jt=Ze,Ct=ze,lr=1<<(8>>Ct.b),An=a(lr);if(An==null)rt=0;else{var Qt=Ct.K[0],St=Ct.w;for(An[0]=Ct.K[0][0],gt=1;gt<1*Jt;++gt)An[gt]=Et(Qt[St+gt],An[gt-1]);for(;gt<4*lr;++gt)An[gt]=0;Ct.K[0]=null,Ct.K[0]=An,rt=1}}Ve=rt;break;case 2:break;default:r(0)}z=Ve}}if(G=G[0],Y=Y[0],z&&qe(Z,1)&&!(z=1<=(Fe=qe(Z,4))&&11>=Fe)){M.a=3;break e}var dt;if(dt=z)t:{var un,Gt,dr,Wr=M,Yn=G,mi=Y,en=Fe,oi=y,gi=Wr.m,Tn=Wr.s,hr=[null],kr=1,tn=0,Er=T5[en];r:for(;;){if(oi&&qe(gi,1)){var Kn=qe(gi,3)+2,Na=$e(Yn,Kn),hn=$e(mi,Kn),Ei=Na*hn;if(!Ae(Na,hn,0,Wr,hr))break r;for(hr=hr[0],Tn.xc=Kn,un=0;un<Ei;++un){var Rr=hr[un]>>8&65535;hr[un]=Rr,Rr>=kr&&(kr=Rr+1)}}if(gi.h)break r;for(Gt=0;5>Gt;++Gt){var In=xg[Gt];!Gt&&0<en&&(In+=1<<en),tn<In&&(tn=In)}var qi=o(kr*Er,de),_i=kr,Gi=o(_i,xe);if(Gi==null)var $i=null;else r(65536>=_i),$i=Gi;var Mi=a(tn);if($i==null||Mi==null||qi==null){Wr.a=1;break r}var Xi=qi;for(un=dr=0;un<kr;++un){var Hr=$i[un],Yi=Hr.G,Ra=Hr.H,nl=0,Io=1,Zn=0;for(Gt=0;5>Gt;++Gt){In=xg[Gt],Yi[Gt]=Xi,Ra[Gt]=dr,!Gt&&0<en&&(In+=1<<en);i:{var Bd,kh=In,Ud=Wr,a0=Mi,J5=Xi,Q5=dr,Eh=0,cs=Ud.m,ew=qe(cs,1);if(i(a0,0,0,kh),ew){var tw=qe(cs,1)+1,rw=qe(cs,1),Ag=qe(cs,rw==0?1:8);a0[Ag]=1,tw==2&&(a0[Ag=qe(cs,8)]=1);var Vd=1}else{var Tg=a(19),Ig=qe(cs,4)+4;if(19<Ig){Ud.a=3;var zd=0;break i}for(Bd=0;Bd<Ig;++Bd)Tg[O5[Bd]]=qe(cs,3);var Mh=void 0,o0=void 0,Fg=Ud,nw=Tg,jd=kh,Dg=a0,Ph=0,ds=Fg.m,Ng=8,Rg=o(128,de);n:for(;V(Rg,0,7,nw,19);){if(qe(ds,1)){var iw=2+2*qe(ds,3);if((Mh=2+qe(ds,iw))>jd)break n}else Mh=jd;for(o0=0;o0<jd&&Mh--;){pe(ds);var Lg=Rg[0+(127&T(ds))];te(ds,ds.u+Lg.g);var Hl=Lg.value;if(16>Hl)Dg[o0++]=Hl,Hl!=0&&(Ng=Hl);else{var aw=Hl==16,Bg=Hl-16,ow=M5[Bg],Ug=qe(ds,E5[Bg])+ow;if(o0+Ug>jd)break n;for(var sw=aw?Ng:0;0<Ug--;)Dg[o0++]=sw}}Ph=1;break n}Ph||(Fg.a=3),Vd=Ph}(Vd=Vd&&!cs.h)&&(Eh=V(J5,Q5,8,a0,kh)),Vd&&Eh!=0?zd=Eh:(Ud.a=3,zd=0)}if(zd==0)break r;if(Io&&P5[Gt]==1&&(Io=Xi[dr].g==0),nl+=Xi[dr].g,dr+=zd,3>=Gt){var s0,Oh=Mi[0];for(s0=1;s0<In;++s0)Mi[s0]>Oh&&(Oh=Mi[s0]);Zn+=Oh}}if(Hr.nd=Io,Hr.Qb=0,Io&&(Hr.qb=(Yi[3][Ra[3]+0].value<<24|Yi[1][Ra[1]+0].value<<16|Yi[2][Ra[2]+0].value)>>>0,nl==0&&256>Yi[0][Ra[0]+0].value&&(Hr.Qb=1,Hr.qb+=Yi[0][Ra[0]+0].value<<8)),Hr.jc=!Hr.Qb&&6>Zn,Hr.jc){var Hd,Fo=Hr;for(Hd=0;Hd<el;++Hd){var fs=Hd,us=Fo.pd[fs],Wd=Fo.G[0][Fo.H[0]+fs];256<=Wd.value?(us.g=Wd.g+256,us.value=Wd.value):(us.g=0,us.value=0,fs>>=vn(Wd,8,us),fs>>=vn(Fo.G[1][Fo.H[1]+fs],16,us),fs>>=vn(Fo.G[2][Fo.H[2]+fs],0,us),vn(Fo.G[3][Fo.H[3]+fs],24,us))}}}Tn.vc=hr,Tn.Wb=kr,Tn.Ya=$i,Tn.yc=qi,dt=1;break t}dt=0}if(!(z=dt)){M.a=3;break e}if(0<Fe){if(ne.ua=1<<Fe,!Q(ne.Wa,Fe)){M.a=1,z=0;break e}}else ne.ua=0;var Ah=M,Vg=G,lw=Y,Th=Ah.s,Ih=Th.xc;if(Ah.c=Vg,Ah.i=lw,Th.md=$e(Vg,Ih),Th.wc=Ih==0?-1:(1<<Ih)-1,y){M.xb=U5;break e}if((ge=a(G*Y))==null){M.a=1,z=0;break e}z=(z=Oe(M,ge,0,G,Y,Y,null))&&!Z.h;break e}return z?(F!=null?F[0]=ge:(r(ge==null),r(y)),M.$=0,y||Le(ne)):Le(ne),z}function De(h,m){var y=h.c*h.i,M=y+m+16*m;return r(h.c<=m),h.V=a(M),h.V==null?(h.Ta=null,h.Ua=0,h.a=1,0):(h.Ta=h.V,h.Ua=h.Ba+y+m,1)}function et(h,m){var y=h.C,M=m-y,F=h.V,z=h.Ba+h.c*y;for(r(m<=h.l.o);0<M;){var G=16<M?16:M,Y=h.l.ma,Z=h.l.width,ne=Z*G,ge=Y.ca,Fe=Y.tb+Z*y,ie=h.Ta,we=h.Ua;oe(h,G,F,z),fg(ie,we,ge,Fe,ne),se(Y,y,y+G,ge,Fe,Z),M-=G,F+=G*h.c,y+=G}r(y==m),h.C=h.Ma=m}function it(){this.ub=this.yd=this.td=this.Rb=0}function mt(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function ot(){this.Fb=this.Bb=this.Cb=0,this.Zb=a(4),this.Lb=a(4)}function lt(){this.Yb=(function(){var h=[];return(function m(y,M,F){for(var z=F[M],G=0;G<z&&(y.push(F.length>M+1?[]:0),!(F.length<M+1));G++)m(y[G],M+1,F)})(h,0,[3,11]),h})()}function Rt(){this.jb=a(3),this.Wc=s([4,8],lt),this.Xc=s([4,17],lt)}function wr(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new a(4),this.od=new a(4)}function Dr(){this.ld=this.La=this.dd=this.tc=0}function zr(){this.Na=this.la=0}function Rn(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function Ta(){this.ad=a(384),this.Za=0,this.Ob=a(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function Xa(){this.uc=this.M=this.Nb=0,this.wa=Array(new Dr),this.Y=0,this.ya=Array(new Ta),this.aa=0,this.l=new Dl}function la(){this.y=a(16),this.f=a(8),this.ea=a(8)}function Zo(){this.cb=this.a=0,this.sc="",this.m=new E,this.Od=new it,this.Kc=new mt,this.ed=new wr,this.Qa=new ot,this.Ic=this.$c=this.Aa=0,this.D=new Xa,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=o(8,E),this.ia=0,this.pb=o(4,Rn),this.Pa=new Rt,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new la),this.Hd=0,this.rb=Array(new zr),this.sb=0,this.wa=Array(new Dr),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new Ta),this.L=this.aa=0,this.gd=s([4,2],Dr),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function xn(h,m){return 0>h?0:h>m?m:h}function Dl(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function rh(){var h=new Zo;return h!=null&&(h.a=0,h.sc="OK",h.cb=0,h.Xb=0,n0||(n0=Nl)),h}function bn(h,m,y){return h.a==0&&(h.a=m,h.sc=y,h.cb=0),0}function md(h,m,y){return 3<=y&&h[m+0]==157&&h[m+1]==1&&h[m+2]==42}function Ya(h,m){if(h==null)return 0;if(h.a=0,h.sc="OK",m==null)return bn(h,2,"null VP8Io passed to VP8GetHeaders()");var y=m.data,M=m.w,F=m.ha;if(4>F)return bn(h,7,"Truncated header.");var z=y[M+0]|y[M+1]<<8|y[M+2]<<16,G=h.Od;if(G.Rb=!(1&z),G.td=z>>1&7,G.yd=z>>4&1,G.ub=z>>5,3<G.td)return bn(h,3,"Incorrect keyframe parameters.");if(!G.yd)return bn(h,4,"Frame not displayable.");M+=3,F-=3;var Y=h.Kc;if(G.Rb){if(7>F)return bn(h,7,"cannot parse picture header");if(!md(y,M,F))return bn(h,3,"Bad code word");Y.c=16383&(y[M+4]<<8|y[M+3]),Y.Td=y[M+4]>>6,Y.i=16383&(y[M+6]<<8|y[M+5]),Y.Ud=y[M+6]>>6,M+=7,F-=7,h.za=Y.c+15>>4,h.Ub=Y.i+15>>4,m.width=Y.c,m.height=Y.i,m.Da=0,m.j=0,m.v=0,m.va=m.width,m.o=m.height,m.da=0,m.ib=m.width,m.hb=m.height,m.U=m.width,m.T=m.height,i((z=h.Pa).jb,0,255,z.jb.length),r((z=h.Qa)!=null),z.Cb=0,z.Bb=0,z.Fb=1,i(z.Zb,0,0,z.Zb.length),i(z.Lb,0,0,z.Lb)}if(G.ub>F)return bn(h,7,"bad partition length");Ne(z=h.m,y,M,G.ub),M+=G.ub,F-=G.ub,G.Rb&&(Y.Ld=ve(z),Y.Kd=ve(z)),Y=h.Qa;var Z,ne=h.Pa;if(r(z!=null),r(Y!=null),Y.Cb=ve(z),Y.Cb){if(Y.Bb=ve(z),ve(z)){for(Y.Fb=ve(z),Z=0;4>Z;++Z)Y.Zb[Z]=ve(z)?Ee(z,7):0;for(Z=0;4>Z;++Z)Y.Lb[Z]=ve(z)?Ee(z,6):0}if(Y.Bb)for(Z=0;3>Z;++Z)ne.jb[Z]=ve(z)?Re(z,8):255}else Y.Bb=0;if(z.Ka)return bn(h,3,"cannot parse segment header");if((Y=h.ed).zd=ve(z),Y.Tb=Re(z,6),Y.wb=Re(z,3),Y.Pc=ve(z),Y.Pc&&ve(z)){for(ne=0;4>ne;++ne)ve(z)&&(Y.vd[ne]=Ee(z,6));for(ne=0;4>ne;++ne)ve(z)&&(Y.od[ne]=Ee(z,6))}if(h.L=Y.Tb==0?0:Y.zd?1:2,z.Ka)return bn(h,3,"cannot parse filter header");var ge=F;if(F=Z=M,M=Z+ge,Y=ge,h.Xb=(1<<Re(h.m,2))-1,ge<3*(ne=h.Xb))y=7;else{for(Z+=3*ne,Y-=3*ne,ge=0;ge<ne;++ge){var Fe=y[F+0]|y[F+1]<<8|y[F+2]<<16;Fe>Y&&(Fe=Y),Ne(h.Jc[+ge],y,Z,Fe),Z+=Fe,Y-=Fe,F+=3}Ne(h.Jc[+ne],y,Z,Y),y=Z<M?0:5}if(y!=0)return bn(h,y,"cannot parse partitions");for(y=Re(Z=h.m,7),F=ve(Z)?Ee(Z,4):0,M=ve(Z)?Ee(Z,4):0,Y=ve(Z)?Ee(Z,4):0,ne=ve(Z)?Ee(Z,4):0,Z=ve(Z)?Ee(Z,4):0,ge=h.Qa,Fe=0;4>Fe;++Fe){if(ge.Cb){var ie=ge.Zb[Fe];ge.Fb||(ie+=y)}else{if(0<Fe){h.pb[Fe]=h.pb[0];continue}ie=y}var we=h.pb[Fe];we.Sc[0]=yh[xn(ie+F,127)],we.Sc[1]=Ch[xn(ie+0,127)],we.Eb[0]=2*yh[xn(ie+M,127)],we.Eb[1]=101581*Ch[xn(ie+Y,127)]>>16,8>we.Eb[1]&&(we.Eb[1]=8),we.Qc[0]=yh[xn(ie+ne,117)],we.Qc[1]=Ch[xn(ie+Z,127)],we.lc=ie+Z}if(!G.Rb)return bn(h,4,"Not a key frame.");for(ve(z),G=h.Pa,y=0;4>y;++y){for(F=0;8>F;++F)for(M=0;3>M;++M)for(Y=0;11>Y;++Y)ne=_e(z,L5[y][F][M][Y])?Re(z,8):N5[y][F][M][Y],G.Wc[y][F].Yb[M][Y]=ne;for(F=0;17>F;++F)G.Xc[y][F]=G.Wc[y][B5[F]]}return h.kc=ve(z),h.kc&&(h.Bd=Re(z,8)),h.cb=1}function Nl(h,m,y,M,F,z,G){var Y=m[F].Yb[y];for(y=0;16>F;++F){if(!_e(h,Y[y+0]))return F;for(;!_e(h,Y[y+1]);)if(Y=m[++F].Yb[0],y=0,F==16)return 16;var Z=m[F+1].Yb;if(_e(h,Y[y+2])){var ne=h,ge=0;if(_e(ne,(ie=Y)[(Fe=y)+3]))if(_e(ne,ie[Fe+6])){for(Y=0,Fe=2*(ge=_e(ne,ie[Fe+8]))+(ie=_e(ne,ie[Fe+9+ge])),ge=0,ie=F5[Fe];ie[Y];++Y)ge+=ge+_e(ne,ie[Y]);ge+=3+(8<<Fe)}else _e(ne,ie[Fe+7])?(ge=7+2*_e(ne,165),ge+=_e(ne,145)):ge=5+_e(ne,159);else ge=_e(ne,ie[Fe+4])?3+_e(ne,ie[Fe+5]):2;Y=Z[2]}else ge=1,Y=Z[1];Z=G+D5[F],0>(ne=h).b&&ye(ne);var Fe,ie=ne.b,we=(Fe=ne.Ca>>1)-(ne.I>>ie)>>31;--ne.b,ne.Ca+=we,ne.Ca|=1,ne.I-=(Fe+1&we)<<ie,z[Z]=((ge^we)-we)*M[(0<F)+0]}return 16}function gd(h){var m=h.rb[h.sb-1];m.la=0,m.Na=0,i(h.zc,0,0,h.zc.length),h.ja=0}function ca(h,m,y,M,F){F=h[m+y+32*M]+(F>>3),h[m+y+32*M]=-256&F?0>F?0:255:F}function Mn(h,m,y,M,F,z){ca(h,m,0,y,M+F),ca(h,m,1,y,M+z),ca(h,m,2,y,M-z),ca(h,m,3,y,M-F)}function xo(h){return(20091*h>>16)+h}function _d(h,m,y,M){var F,z=0,G=a(16);for(F=0;4>F;++F){var Y=h[m+0]+h[m+8],Z=h[m+0]-h[m+8],ne=(35468*h[m+4]>>16)-xo(h[m+12]),ge=xo(h[m+4])+(35468*h[m+12]>>16);G[z+0]=Y+ge,G[z+1]=Z+ne,G[z+2]=Z-ne,G[z+3]=Y-ge,z+=4,m++}for(F=z=0;4>F;++F)Y=(h=G[z+0]+4)+G[z+8],Z=h-G[z+8],ne=(35468*G[z+4]>>16)-xo(G[z+12]),ca(y,M,0,0,Y+(ge=xo(G[z+4])+(35468*G[z+12]>>16))),ca(y,M,1,0,Z+ne),ca(y,M,2,0,Z-ne),ca(y,M,3,0,Y-ge),z++,M+=32}function nh(h,m,y,M){var F=h[m+0]+4,z=35468*h[m+4]>>16,G=xo(h[m+4]),Y=35468*h[m+1]>>16;Mn(y,M,0,F+G,h=xo(h[m+1]),Y),Mn(y,M,1,F+z,h,Y),Mn(y,M,2,F-z,h,Y),Mn(y,M,3,F-G,h,Y)}function ih(h,m,y,M,F){_d(h,m,y,M),F&&_d(h,m+16,y,M+4)}function Ka(h,m,y,M){rl(h,m+0,y,M,1),rl(h,m+32,y,M+128,1)}function vd(h,m,y,M){var F;for(h=h[m+0]+4,F=0;4>F;++F)for(m=0;4>m;++m)ca(y,M,m,F,h)}function xd(h,m,y,M){h[m+0]&&yr(h,m+0,y,M),h[m+16]&&yr(h,m+16,y,M+4),h[m+32]&&yr(h,m+32,y,M+128),h[m+48]&&yr(h,m+48,y,M+128+4)}function Rl(h,m,y,M){var F,z=a(16);for(F=0;4>F;++F){var G=h[m+0+F]+h[m+12+F],Y=h[m+4+F]+h[m+8+F],Z=h[m+4+F]-h[m+8+F],ne=h[m+0+F]-h[m+12+F];z[0+F]=G+Y,z[8+F]=G-Y,z[4+F]=ne+Z,z[12+F]=ne-Z}for(F=0;4>F;++F)G=(h=z[0+4*F]+3)+z[3+4*F],Y=z[1+4*F]+z[2+4*F],Z=z[1+4*F]-z[2+4*F],ne=h-z[3+4*F],y[M+0]=G+Y>>3,y[M+16]=ne+Z>>3,y[M+32]=G-Y>>3,y[M+48]=ne-Z>>3,M+=64}function Ws(h,m,y){var M,F=m-32,z=Wi,G=255-h[F-1];for(M=0;M<y;++M){var Y,Z=z,ne=G+h[m-1];for(Y=0;Y<y;++Y)h[m+Y]=Z[ne+h[F+Y]];m+=32}}function ah(h,m){Ws(h,m,4)}function oh(h,m){Ws(h,m,8)}function sh(h,m){Ws(h,m,16)}function Lc(h,m){var y;for(y=0;16>y;++y)n(h,m+32*y,h,m-32,16)}function bd(h,m){var y;for(y=16;0<y;--y)i(h,m,h[m-1],16),m+=32}function Ia(h,m,y){var M;for(M=0;16>M;++M)i(m,y+32*M,h,16)}function lh(h,m){var y,M=16;for(y=0;16>y;++y)M+=h[m-1+32*y]+h[m+y-32];Ia(M>>5,h,m)}function qs(h,m){var y,M=8;for(y=0;16>y;++y)M+=h[m-1+32*y];Ia(M>>4,h,m)}function Bc(h,m){var y,M=8;for(y=0;16>y;++y)M+=h[m+y-32];Ia(M>>4,h,m)}function ch(h,m){Ia(128,h,m)}function Ht(h,m,y){return h+2*m+y+2>>2}function dh(h,m){var y,M=m-32;for(M=new Uint8Array([Ht(h[M-1],h[M+0],h[M+1]),Ht(h[M+0],h[M+1],h[M+2]),Ht(h[M+1],h[M+2],h[M+3]),Ht(h[M+2],h[M+3],h[M+4])]),y=0;4>y;++y)n(h,m+32*y,M,0,M.length)}function fh(h,m){var y=h[m-1],M=h[m-1+32],F=h[m-1+64],z=h[m-1+96];He(h,m+0,16843009*Ht(h[m-1-32],y,M)),He(h,m+32,16843009*Ht(y,M,F)),He(h,m+64,16843009*Ht(M,F,z)),He(h,m+96,16843009*Ht(F,z,z))}function uh(h,m){var y,M=4;for(y=0;4>y;++y)M+=h[m+y-32]+h[m-1+32*y];for(M>>=3,y=0;4>y;++y)i(h,m+32*y,M,4)}function bo(h,m){var y=h[m-1+0],M=h[m-1+32],F=h[m-1+64],z=h[m-1-32],G=h[m+0-32],Y=h[m+1-32],Z=h[m+2-32],ne=h[m+3-32];h[m+0+96]=Ht(M,F,h[m-1+96]),h[m+1+96]=h[m+0+64]=Ht(y,M,F),h[m+2+96]=h[m+1+64]=h[m+0+32]=Ht(z,y,M),h[m+3+96]=h[m+2+64]=h[m+1+32]=h[m+0+0]=Ht(G,z,y),h[m+3+64]=h[m+2+32]=h[m+1+0]=Ht(Y,G,z),h[m+3+32]=h[m+2+0]=Ht(Z,Y,G),h[m+3+0]=Ht(ne,Z,Y)}function wo(h,m){var y=h[m+1-32],M=h[m+2-32],F=h[m+3-32],z=h[m+4-32],G=h[m+5-32],Y=h[m+6-32],Z=h[m+7-32];h[m+0+0]=Ht(h[m+0-32],y,M),h[m+1+0]=h[m+0+32]=Ht(y,M,F),h[m+2+0]=h[m+1+32]=h[m+0+64]=Ht(M,F,z),h[m+3+0]=h[m+2+32]=h[m+1+64]=h[m+0+96]=Ht(F,z,G),h[m+3+32]=h[m+2+64]=h[m+1+96]=Ht(z,G,Y),h[m+3+64]=h[m+2+96]=Ht(G,Y,Z),h[m+3+96]=Ht(Y,Z,Z)}function hh(h,m){var y=h[m-1+0],M=h[m-1+32],F=h[m-1+64],z=h[m-1-32],G=h[m+0-32],Y=h[m+1-32],Z=h[m+2-32],ne=h[m+3-32];h[m+0+0]=h[m+1+64]=z+G+1>>1,h[m+1+0]=h[m+2+64]=G+Y+1>>1,h[m+2+0]=h[m+3+64]=Y+Z+1>>1,h[m+3+0]=Z+ne+1>>1,h[m+0+96]=Ht(F,M,y),h[m+0+64]=Ht(M,y,z),h[m+0+32]=h[m+1+96]=Ht(y,z,G),h[m+1+32]=h[m+2+96]=Ht(z,G,Y),h[m+2+32]=h[m+3+96]=Ht(G,Y,Z),h[m+3+32]=Ht(Y,Z,ne)}function ph(h,m){var y=h[m+0-32],M=h[m+1-32],F=h[m+2-32],z=h[m+3-32],G=h[m+4-32],Y=h[m+5-32],Z=h[m+6-32],ne=h[m+7-32];h[m+0+0]=y+M+1>>1,h[m+1+0]=h[m+0+64]=M+F+1>>1,h[m+2+0]=h[m+1+64]=F+z+1>>1,h[m+3+0]=h[m+2+64]=z+G+1>>1,h[m+0+32]=Ht(y,M,F),h[m+1+32]=h[m+0+96]=Ht(M,F,z),h[m+2+32]=h[m+1+96]=Ht(F,z,G),h[m+3+32]=h[m+2+96]=Ht(z,G,Y),h[m+3+64]=Ht(G,Y,Z),h[m+3+96]=Ht(Y,Z,ne)}function Ll(h,m){var y=h[m-1+0],M=h[m-1+32],F=h[m-1+64],z=h[m-1+96];h[m+0+0]=y+M+1>>1,h[m+2+0]=h[m+0+32]=M+F+1>>1,h[m+2+32]=h[m+0+64]=F+z+1>>1,h[m+1+0]=Ht(y,M,F),h[m+3+0]=h[m+1+32]=Ht(M,F,z),h[m+3+32]=h[m+1+64]=Ht(F,z,z),h[m+3+64]=h[m+2+64]=h[m+0+96]=h[m+1+96]=h[m+2+96]=h[m+3+96]=z}function Uc(h,m){var y=h[m-1+0],M=h[m-1+32],F=h[m-1+64],z=h[m-1+96],G=h[m-1-32],Y=h[m+0-32],Z=h[m+1-32],ne=h[m+2-32];h[m+0+0]=h[m+2+32]=y+G+1>>1,h[m+0+32]=h[m+2+64]=M+y+1>>1,h[m+0+64]=h[m+2+96]=F+M+1>>1,h[m+0+96]=z+F+1>>1,h[m+3+0]=Ht(Y,Z,ne),h[m+2+0]=Ht(G,Y,Z),h[m+1+0]=h[m+3+32]=Ht(y,G,Y),h[m+1+32]=h[m+3+64]=Ht(M,y,G),h[m+1+64]=h[m+3+96]=Ht(F,M,y),h[m+1+96]=Ht(z,F,M)}function Gs(h,m){var y;for(y=0;8>y;++y)n(h,m+32*y,h,m-32,8)}function mh(h,m){var y;for(y=0;8>y;++y)i(h,m,h[m-1],8),m+=32}function yo(h,m,y){var M;for(M=0;8>M;++M)i(m,y+32*M,h,8)}function gh(h,m){var y,M=8;for(y=0;8>y;++y)M+=h[m+y-32]+h[m-1+32*y];yo(M>>4,h,m)}function Vc(h,m){var y,M=4;for(y=0;8>y;++y)M+=h[m+y-32];yo(M>>3,h,m)}function zc(h,m){var y,M=4;for(y=0;8>y;++y)M+=h[m-1+32*y];yo(M>>3,h,m)}function wd(h,m){yo(128,h,m)}function Co(h,m,y){var M=h[m-y],F=h[m+0],z=3*(F-M)+_h[1020+h[m-2*y]-h[m+y]],G=Od[112+(z+4>>3)];h[m-y]=Wi[255+M+Od[112+(z+3>>3)]],h[m+0]=Wi[255+F-G]}function jc(h,m,y,M){var F=h[m+0],z=h[m+y];return ua[255+h[m-2*y]-h[m-y]]>M||ua[255+z-F]>M}function Bl(h,m,y,M){return 4*ua[255+h[m-y]-h[m+0]]+ua[255+h[m-2*y]-h[m+y]]<=M}function Hc(h,m,y,M,F){var z=h[m-3*y],G=h[m-2*y],Y=h[m-y],Z=h[m+0],ne=h[m+y],ge=h[m+2*y],Fe=h[m+3*y];return 4*ua[255+Y-Z]+ua[255+G-ne]>M?0:ua[255+h[m-4*y]-z]<=F&&ua[255+z-G]<=F&&ua[255+G-Y]<=F&&ua[255+Fe-ge]<=F&&ua[255+ge-ne]<=F&&ua[255+ne-Z]<=F}function $s(h,m,y,M){var F=2*M+1;for(M=0;16>M;++M)Bl(h,m+M,y,F)&&Co(h,m+M,y)}function Wc(h,m,y,M){var F=2*M+1;for(M=0;16>M;++M)Bl(h,m+M*y,1,F)&&Co(h,m+M*y,1)}function yd(h,m,y,M){var F;for(F=3;0<F;--F)$s(h,m+=4*y,y,M)}function Cd(h,m,y,M){var F;for(F=3;0<F;--F)Wc(h,m+=4,y,M)}function So(h,m,y,M,F,z,G,Y){for(z=2*z+1;0<F--;){if(Hc(h,m,y,z,G))if(jc(h,m,y,Y))Co(h,m,y);else{var Z=h,ne=m,ge=y,Fe=Z[ne-2*ge],ie=Z[ne-ge],we=Z[ne+0],Me=Z[ne+ge],Ve=Z[ne+2*ge],Te=27*(Ge=_h[1020+3*(we-ie)+_h[1020+Fe-Me]])+63>>7,ze=18*Ge+63>>7,Ge=9*Ge+63>>7;Z[ne-3*ge]=Wi[255+Z[ne-3*ge]+Ge],Z[ne-2*ge]=Wi[255+Fe+ze],Z[ne-ge]=Wi[255+ie+Te],Z[ne+0]=Wi[255+we-Te],Z[ne+ge]=Wi[255+Me-ze],Z[ne+2*ge]=Wi[255+Ve-Ge]}m+=M}}function ko(h,m,y,M,F,z,G,Y){for(z=2*z+1;0<F--;){if(Hc(h,m,y,z,G))if(jc(h,m,y,Y))Co(h,m,y);else{var Z=h,ne=m,ge=y,Fe=Z[ne-ge],ie=Z[ne+0],we=Z[ne+ge],Me=Od[112+(4+(Ve=3*(ie-Fe))>>3)],Ve=Od[112+(Ve+3>>3)],Te=Me+1>>1;Z[ne-2*ge]=Wi[255+Z[ne-2*ge]+Te],Z[ne-ge]=Wi[255+Fe+Ve],Z[ne+0]=Wi[255+ie-Me],Z[ne+ge]=Wi[255+we-Te]}m+=M}}function Sd(h,m,y,M,F,z){So(h,m,y,1,16,M,F,z)}function Xs(h,m,y,M,F,z){So(h,m,1,y,16,M,F,z)}function kd(h,m,y,M,F,z){var G;for(G=3;0<G;--G)ko(h,m+=4*y,y,1,16,M,F,z)}function b(h,m,y,M,F,z){var G;for(G=3;0<G;--G)ko(h,m+=4,1,y,16,M,F,z)}function I(h,m,y,M,F,z,G,Y){So(h,m,F,1,8,z,G,Y),So(y,M,F,1,8,z,G,Y)}function le(h,m,y,M,F,z,G,Y){So(h,m,1,F,8,z,G,Y),So(y,M,1,F,8,z,G,Y)}function me(h,m,y,M,F,z,G,Y){ko(h,m+4*F,F,1,8,z,G,Y),ko(y,M+4*F,F,1,8,z,G,Y)}function Se(h,m,y,M,F,z,G,Y){ko(h,m+4,1,F,8,z,G,Y),ko(y,M+4,1,F,8,z,G,Y)}function We(){this.ba=new er,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new pr,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function Ke(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function xt(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function Mt(){this.ua=0,this.Wa=new Qe,this.vb=new Qe,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new xe,this.yc=new de}function zt(){this.xb=this.a=0,this.l=new Dl,this.ca=new er,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new U,this.Pb=0,this.wd=new U,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new Mt,this.ab=0,this.gc=o(4,xt),this.Oc=0}function Yt(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new Dl,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function ur(h,m,y,M,F,z,G){for(h=h==null?0:h[m+0],m=0;m<G;++m)F[z+m]=h+y[M+m]&255,h=F[z+m]}function Jr(h,m,y,M,F,z,G){var Y;if(h==null)ur(null,null,y,M,F,z,G);else for(Y=0;Y<G;++Y)F[z+Y]=h[m+Y]+y[M+Y]&255}function wn(h,m,y,M,F,z,G){if(h==null)ur(null,null,y,M,F,z,G);else{var Y,Z=h[m+0],ne=Z,ge=Z;for(Y=0;Y<G;++Y)ne=ge+(Z=h[m+Y])-ne,ge=y[M+Y]+(-256&ne?0>ne?0:255:ne)&255,ne=Z,F[z+Y]=ge}}function jr(h,m,y,M){var F=m.width,z=m.o;if(r(h!=null&&m!=null),0>y||0>=M||y+M>z)return null;if(!h.Cc){if(h.ga==null){var G;if(h.ga=new Yt,(G=h.ga==null)||(G=m.width*m.o,r(h.Gb.length==0),h.Gb=a(G),h.Uc=0,h.Gb==null?G=0:(h.mb=h.Gb,h.nb=h.Uc,h.rc=null,G=1),G=!G),!G){G=h.ga;var Y=h.Fa,Z=h.P,ne=h.qc,ge=h.mb,Fe=h.nb,ie=Z+1,we=ne-1,Me=G.l;if(r(Y!=null&&ge!=null&&m!=null),ls[0]=null,ls[1]=ur,ls[2]=Jr,ls[3]=wn,G.ca=ge,G.tb=Fe,G.c=m.width,G.i=m.height,r(0<G.c&&0<G.i),1>=ne)m=0;else if(G.$a=3&Y[Z+0],G.Z=Y[Z+0]>>2&3,G.Lc=Y[Z+0]>>4&3,Z=Y[Z+0]>>6&3,0>G.$a||1<G.$a||4<=G.Z||1<G.Lc||Z)m=0;else if(Me.put=Nt,Me.ac=sa,Me.bc=Oa,Me.ma=G,Me.width=m.width,Me.height=m.height,Me.Da=m.Da,Me.v=m.v,Me.va=m.va,Me.j=m.j,Me.o=m.o,G.$a)e:{r(G.$a==1),m=Ie();t:for(;;){if(m==null){m=0;break e}if(r(G!=null),G.mc=m,m.c=G.c,m.i=G.i,m.l=G.l,m.l.ma=G,m.l.width=G.c,m.l.height=G.i,m.a=0,Be(m.m,Y,ie,we),!Ae(G.c,G.i,1,m,null)||(m.ab==1&&m.gc[0].hc==3&&J(m.s)?(G.ic=1,Y=m.c*m.i,m.Ta=null,m.Ua=0,m.V=a(Y),m.Ba=0,m.V==null?(m.a=1,m=0):m=1):(G.ic=0,m=De(m,G.c)),!m))break t;m=1;break e}G.mc=null,m=0}else m=we>=G.c*G.i;G=!m}if(G)return null;h.ga.Lc!=1?h.Ga=0:M=z-y}r(h.ga!=null),r(y+M<=z);e:{if(m=(Y=h.ga).c,z=Y.l.o,Y.$a==0){if(ie=h.rc,we=h.Vc,Me=h.Fa,Z=h.P+1+y*m,ne=h.mb,ge=h.nb+y*m,r(Z<=h.P+h.qc),Y.Z!=0)for(r(ls[Y.Z]!=null),G=0;G<M;++G)ls[Y.Z](ie,we,Me,Z,ne,ge,m),ie=ne,we=ge,ge+=m,Z+=m;else for(G=0;G<M;++G)n(ne,ge,Me,Z,m),ie=ne,we=ge,ge+=m,Z+=m;h.rc=ie,h.Vc=we}else{if(r(Y.mc!=null),m=y+M,r((G=Y.mc)!=null),r(m<=G.i),G.C>=m)m=1;else if(Y.ic||Fa(),Y.ic){Y=G.V,ie=G.Ba,we=G.c;var Ve=G.i,Te=(Me=1,Z=G.$/we,ne=G.$%we,ge=G.m,Fe=G.s,G.$),ze=we*Ve,Ge=we*m,rt=Fe.wc,Ze=Te<Ge?B(Fe,ne,Z):null;r(Te<=ze),r(m<=Ve),r(J(Fe));t:for(;;){for(;!ge.h&&Te<Ge;){if(ne&rt||(Ze=B(Fe,ne,Z)),r(Ze!=null),pe(ge),256>(Ve=Xr(Ze.G[0],Ze.H[0],ge)))Y[ie+Te]=Ve,++Te,++ne>=we&&(ne=0,++Z<=m&&!(Z%16)&&ce(G,Z));else{if(!(280>Ve)){Me=0;break t}Ve=ai(Ve-256,ge);var Ot,gt=Xr(Ze.G[4],Ze.H[4],ge);if(pe(ge),!(Te>=(gt=ki(we,gt=ai(gt,ge)))&&ze-Te>=Ve)){Me=0;break t}for(Ot=0;Ot<Ve;++Ot)Y[ie+Te+Ot]=Y[ie+Te+Ot-gt];for(Te+=Ve,ne+=Ve;ne>=we;)ne-=we,++Z<=m&&!(Z%16)&&ce(G,Z);Te<Ge&&ne&rt&&(Ze=B(Fe,ne,Z))}r(ge.h==R(ge))}ce(G,Z>m?m:Z);break t}!Me||ge.h&&Te<ze?(Me=0,G.a=ge.h?5:3):G.$=Te,m=Me}else m=Oe(G,G.V,G.Ba,G.c,G.i,m,et);if(!m){M=0;break e}}y+M>=z&&(h.Cc=1),M=1}if(!M)return null;if(h.Cc&&((M=h.ga)!=null&&(M.mc=null),h.ga=null,0<h.Ga))return alert("todo:WebPDequantizeLevels"),null}return h.nb+y*F}function Pn(h,m,y,M,F,z){for(;0<F--;){var G,Y=h,Z=m+(y?1:0),ne=h,ge=m+(y?0:3);for(G=0;G<M;++G){var Fe=ne[ge+4*G];Fe!=255&&(Fe*=32897,Y[Z+4*G+0]=Y[Z+4*G+0]*Fe>>23,Y[Z+4*G+1]=Y[Z+4*G+1]*Fe>>23,Y[Z+4*G+2]=Y[Z+4*G+2]*Fe>>23)}m+=z}}function yn(h,m,y,M,F){for(;0<M--;){var z;for(z=0;z<y;++z){var G=h[m+2*z+0],Y=15&(ne=h[m+2*z+1]),Z=4369*Y,ne=(240&ne|ne>>4)*Z>>16;h[m+2*z+0]=(240&G|G>>4)*Z>>16&240|(15&G|G<<4)*Z>>16>>4&15,h[m+2*z+1]=240&ne|Y}m+=F}}function $n(h,m,y,M,F,z,G,Y){var Z,ne,ge=255;for(ne=0;ne<F;++ne){for(Z=0;Z<M;++Z){var Fe=h[m+Z];z[G+4*Z]=Fe,ge&=Fe}m+=y,G+=Y}return ge!=255}function Eo(h,m,y,M,F){var z;for(z=0;z<F;++z)y[M+z]=h[m+z]>>8}function Fa(){r0=Pn,cg=yn,dg=$n,fg=Eo}function Mo(h,m,y){W[h]=function(M,F,z,G,Y,Z,ne,ge,Fe,ie,we,Me,Ve,Te,ze,Ge,rt){var Ze,Ot=rt-1>>1,gt=Y[Z+0]|ne[ge+0]<<16,Jt=Fe[ie+0]|we[Me+0]<<16;r(M!=null);var Ct=3*gt+Jt+131074>>2;for(m(M[F+0],255&Ct,Ct>>16,Ve,Te),z!=null&&(Ct=3*Jt+gt+131074>>2,m(z[G+0],255&Ct,Ct>>16,ze,Ge)),Ze=1;Ze<=Ot;++Ze){var lr=Y[Z+Ze]|ne[ge+Ze]<<16,An=Fe[ie+Ze]|we[Me+Ze]<<16,Qt=gt+lr+Jt+An+524296,St=Qt+2*(lr+Jt)>>3;Ct=St+gt>>1,gt=(Qt=Qt+2*(gt+An)>>3)+lr>>1,m(M[F+2*Ze-1],255&Ct,Ct>>16,Ve,Te+(2*Ze-1)*y),m(M[F+2*Ze-0],255&gt,gt>>16,Ve,Te+(2*Ze-0)*y),z!=null&&(Ct=Qt+Jt>>1,gt=St+An>>1,m(z[G+2*Ze-1],255&Ct,Ct>>16,ze,Ge+(2*Ze-1)*y),m(z[G+2*Ze+0],255&gt,gt>>16,ze,Ge+(2*Ze+0)*y)),gt=lr,Jt=An}1&rt||(Ct=3*gt+Jt+131074>>2,m(M[F+rt-1],255&Ct,Ct>>16,Ve,Te+(rt-1)*y),z!=null&&(Ct=3*Jt+gt+131074>>2,m(z[G+rt-1],255&Ct,Ct>>16,ze,Ge+(rt-1)*y)))}}function qc(){ha[Ad]=V5,ha[Td]=yg,ha[_g]=z5,ha[Id]=Cg,ha[Fd]=Sg,ha[vh]=kg,ha[vg]=j5,ha[xh]=yg,ha[bh]=Cg,ha[Dd]=Sg,ha[wh]=kg}function Ul(h){return h&~H5?0>h?0:255:h>>Eg}function Jo(h,m){return Ul((19077*h>>8)+(26149*m>>8)-14234)}function Ys(h,m,y){return Ul((19077*h>>8)-(6419*m>>8)-(13320*y>>8)+8708)}function Ks(h,m){return Ul((19077*h>>8)+(33050*m>>8)-17685)}function Qo(h,m,y,M,F){M[F+0]=Jo(h,y),M[F+1]=Ys(h,m,y),M[F+2]=Ks(h,m)}function Xn(h,m,y,M,F){M[F+0]=Ks(h,m),M[F+1]=Ys(h,m,y),M[F+2]=Jo(h,y)}function Zs(h,m,y,M,F){var z=Ys(h,m,y);m=z<<3&224|Ks(h,m)>>3,M[F+0]=248&Jo(h,y)|z>>5,M[F+1]=m}function Js(h,m,y,M,F){var z=240&Ks(h,m)|15;M[F+0]=240&Jo(h,y)|Ys(h,m,y)>>4,M[F+1]=z}function Gc(h,m,y,M,F){M[F+0]=255,Qo(h,m,y,M,F+1)}function $c(h,m,y,M,F){Xn(h,m,y,M,F),M[F+3]=255}function pi(h,m,y,M,F){Qo(h,m,y,M,F),M[F+3]=255}function Po(h,m,y){W[h]=function(M,F,z,G,Y,Z,ne,ge,Fe){for(var ie=ge+(-2&Fe)*y;ge!=ie;)m(M[F+0],z[G+0],Y[Z+0],ne,ge),m(M[F+1],z[G+0],Y[Z+0],ne,ge+y),F+=2,++G,++Z,ge+=2*y;1&Fe&&m(M[F+0],z[G+0],Y[Z+0],ne,ge)}}function Vl(h,m,y){return y==0?h==0?m==0?6:5:m==0?4:0:y}function Ed(h,m,y,M,F){switch(h>>>30){case 3:rl(m,y,M,F,0);break;case 2:fa(m,y,M,F);break;case 1:yr(m,y,M,F)}}function da(h,m){var y,M,F=m.M,z=m.Nb,G=h.oc,Y=h.pc+40,Z=h.oc,ne=h.pc+584,ge=h.oc,Fe=h.pc+600;for(y=0;16>y;++y)G[Y+32*y-1]=129;for(y=0;8>y;++y)Z[ne+32*y-1]=129,ge[Fe+32*y-1]=129;for(0<F?G[Y-1-32]=Z[ne-1-32]=ge[Fe-1-32]=129:(i(G,Y-32-1,127,21),i(Z,ne-32-1,127,9),i(ge,Fe-32-1,127,9)),M=0;M<h.za;++M){var ie=m.ya[m.aa+M];if(0<M){for(y=-1;16>y;++y)n(G,Y+32*y-4,G,Y+32*y+12,4);for(y=-1;8>y;++y)n(Z,ne+32*y-4,Z,ne+32*y+4,4),n(ge,Fe+32*y-4,ge,Fe+32*y+4,4)}var we=h.Gd,Me=h.Hd+M,Ve=ie.ad,Te=ie.Hc;if(0<F&&(n(G,Y-32,we[Me].y,0,16),n(Z,ne-32,we[Me].f,0,8),n(ge,Fe-32,we[Me].ea,0,8)),ie.Za){var ze=G,Ge=Y-32+16;for(0<F&&(M>=h.za-1?i(ze,Ge,we[Me].y[15],4):n(ze,Ge,we[Me+1].y,0,4)),y=0;4>y;y++)ze[Ge+128+y]=ze[Ge+256+y]=ze[Ge+384+y]=ze[Ge+0+y];for(y=0;16>y;++y,Te<<=2)ze=G,Ge=Y+Pg[y],Da[ie.Ob[y]](ze,Ge),Ed(Te,Ve,16*+y,ze,Ge)}else if(ze=Vl(M,F,ie.Ob[0]),ss[ze](G,Y),Te!=0)for(y=0;16>y;++y,Te<<=2)Ed(Te,Ve,16*+y,G,Y+Pg[y]);for(y=ie.Gc,ze=Vl(M,F,ie.Dd),To[ze](Z,ne),To[ze](ge,Fe),Te=Ve,ze=Z,Ge=ne,255&(ie=0|y)&&(170&ie?Qa(Te,256,ze,Ge):Nr(Te,256,ze,Ge)),ie=ge,Te=Fe,255&(y>>=8)&&(170&y?Qa(Ve,320,ie,Te):Nr(Ve,320,ie,Te)),F<h.Ub-1&&(n(we[Me].y,0,G,Y+480,16),n(we[Me].f,0,Z,ne+224,8),n(we[Me].ea,0,ge,Fe+224,8)),y=8*z*h.B,we=h.sa,Me=h.ta+16*M+16*z*h.R,Ve=h.qa,ie=h.ra+8*M+y,Te=h.Ha,ze=h.Ia+8*M+y,y=0;16>y;++y)n(we,Me+y*h.R,G,Y+32*y,16);for(y=0;8>y;++y)n(Ve,ie+y*h.B,Z,ne+32*y,8),n(Te,ze+y*h.B,ge,Fe+32*y,8)}}function Qs(h,m,y,M,F,z,G,Y,Z){var ne=[0],ge=[0],Fe=0,ie=Z!=null?Z.kd:0,we=Z??new Ke;if(h==null||12>y)return 7;we.data=h,we.w=m,we.ha=y,m=[m],y=[y],we.gb=[we.gb];e:{var Me=m,Ve=y,Te=we.gb;if(r(h!=null),r(Ve!=null),r(Te!=null),Te[0]=0,12<=Ve[0]&&!e(h,Me[0],"RIFF")){if(e(h,Me[0]+8,"WEBP")){Te=3;break e}var ze=at(h,Me[0]+4);if(12>ze||4294967286<ze){Te=3;break e}if(ie&&ze>Ve[0]-8){Te=7;break e}Te[0]=ze,Me[0]+=12,Ve[0]-=12}Te=0}if(Te!=0)return Te;for(ze=0<we.gb[0],y=y[0];;){e:{var Ge=h;Ve=m,Te=y;var rt=ne,Ze=ge,Ot=Me=[0];if((Ct=Fe=[Fe])[0]=0,8>Te[0])Te=7;else{if(!e(Ge,Ve[0],"VP8X")){if(at(Ge,Ve[0]+4)!=10){Te=3;break e}if(18>Te[0]){Te=7;break e}var gt=at(Ge,Ve[0]+8),Jt=1+nt(Ge,Ve[0]+12);if(2147483648<=Jt*(Ge=1+nt(Ge,Ve[0]+15))){Te=3;break e}Ot!=null&&(Ot[0]=gt),rt!=null&&(rt[0]=Jt),Ze!=null&&(Ze[0]=Ge),Ve[0]+=18,Te[0]-=18,Ct[0]=1}Te=0}}if(Fe=Fe[0],Me=Me[0],Te!=0)return Te;if(Ve=!!(2&Me),!ze&&Fe)return 3;if(z!=null&&(z[0]=!!(16&Me)),G!=null&&(G[0]=Ve),Y!=null&&(Y[0]=0),G=ne[0],Me=ge[0],Fe&&Ve&&Z==null){Te=0;break}if(4>y){Te=7;break}if(ze&&Fe||!ze&&!Fe&&!e(h,m[0],"ALPH")){y=[y],we.na=[we.na],we.P=[we.P],we.Sa=[we.Sa];e:{gt=h,Te=m,ze=y;var Ct=we.gb;rt=we.na,Ze=we.P,Ot=we.Sa,Jt=22,r(gt!=null),r(ze!=null),Ge=Te[0];var lr=ze[0];for(r(rt!=null),r(Ot!=null),rt[0]=null,Ze[0]=null,Ot[0]=0;;){if(Te[0]=Ge,ze[0]=lr,8>lr){Te=7;break e}var An=at(gt,Ge+4);if(4294967286<An){Te=3;break e}var Qt=8+An+1&-2;if(Jt+=Qt,0<Ct&&Jt>Ct){Te=3;break e}if(!e(gt,Ge,"VP8 ")||!e(gt,Ge,"VP8L")){Te=0;break e}if(lr[0]<Qt){Te=7;break e}e(gt,Ge,"ALPH")||(rt[0]=gt,Ze[0]=Ge+8,Ot[0]=An),Ge+=Qt,lr-=Qt}}if(y=y[0],we.na=we.na[0],we.P=we.P[0],we.Sa=we.Sa[0],Te!=0)break}y=[y],we.Ja=[we.Ja],we.xa=[we.xa];e:if(Ct=h,Te=m,ze=y,rt=we.gb[0],Ze=we.Ja,Ot=we.xa,gt=Te[0],Ge=!e(Ct,gt,"VP8 "),Jt=!e(Ct,gt,"VP8L"),r(Ct!=null),r(ze!=null),r(Ze!=null),r(Ot!=null),8>ze[0])Te=7;else{if(Ge||Jt){if(Ct=at(Ct,gt+4),12<=rt&&Ct>rt-12){Te=3;break e}if(ie&&Ct>ze[0]-8){Te=7;break e}Ze[0]=Ct,Te[0]+=8,ze[0]-=8,Ot[0]=Jt}else Ot[0]=5<=ze[0]&&Ct[gt+0]==47&&!(Ct[gt+4]>>5),Ze[0]=ze[0];Te=0}if(y=y[0],we.Ja=we.Ja[0],we.xa=we.xa[0],m=m[0],Te!=0)break;if(4294967286<we.Ja)return 3;if(Y==null||Ve||(Y[0]=we.xa?2:1),G=[G],Me=[Me],we.xa){if(5>y){Te=7;break}Y=G,ie=Me,Ve=z,h==null||5>y?h=0:5<=y&&h[m+0]==47&&!(h[m+4]>>5)?(ze=[0],Ct=[0],rt=[0],Be(Ze=new U,h,m,y),Aa(Ze,ze,Ct,rt)?(Y!=null&&(Y[0]=ze[0]),ie!=null&&(ie[0]=Ct[0]),Ve!=null&&(Ve[0]=rt[0]),h=1):h=0):h=0}else{if(10>y){Te=7;break}Y=Me,h==null||10>y||!md(h,m+3,y-3)?h=0:(ie=h[m+0]|h[m+1]<<8|h[m+2]<<16,Ve=16383&(h[m+7]<<8|h[m+6]),h=16383&(h[m+9]<<8|h[m+8]),1&ie||3<(ie>>1&7)||!(ie>>4&1)||ie>>5>=we.Ja||!Ve||!h?h=0:(G&&(G[0]=Ve),Y&&(Y[0]=h),h=1))}if(!h||(G=G[0],Me=Me[0],Fe&&(ne[0]!=G||ge[0]!=Me)))return 3;Z!=null&&(Z[0]=we,Z.offset=m-Z.w,r(4294967286>m-Z.w),r(Z.offset==Z.ha-y));break}return Te==0||Te==7&&Fe&&Z==null?(z!=null&&(z[0]|=we.na!=null&&0<we.na.length),M!=null&&(M[0]=G),F!=null&&(F[0]=Me),0):Te}function Xc(h,m,y){var M=m.width,F=m.height,z=0,G=0,Y=M,Z=F;if(m.Da=h!=null&&0<h.Da,m.Da&&(Y=h.cd,Z=h.bd,z=h.v,G=h.j,11>y||(z&=-2,G&=-2),0>z||0>G||0>=Y||0>=Z||z+Y>M||G+Z>F))return 0;if(m.v=z,m.j=G,m.va=z+Y,m.o=G+Z,m.U=Y,m.T=Z,m.da=h!=null&&0<h.da,m.da){if(!_t(Y,Z,y=[h.ib],z=[h.hb]))return 0;m.ib=y[0],m.hb=z[0]}return m.ob=h!=null&&h.ob,m.Kb=h==null||!h.Sd,m.da&&(m.ob=m.ib<3*M/4&&m.hb<3*F/4,m.Kb=0),1}function Yc(h){if(h==null)return 2;if(11>h.S){var m=h.f.RGBA;m.fb+=(h.height-1)*m.A,m.A=-m.A}else m=h.f.kb,h=h.height,m.O+=(h-1)*m.fa,m.fa=-m.fa,m.N+=(h-1>>1)*m.Ab,m.Ab=-m.Ab,m.W+=(h-1>>1)*m.Db,m.Db=-m.Db,m.F!=null&&(m.J+=(h-1)*m.lb,m.lb=-m.lb);return 0}function es(h,m,y,M){if(M==null||0>=h||0>=m)return 2;if(y!=null){if(y.Da){var F=y.cd,z=y.bd,G=-2&y.v,Y=-2&y.j;if(0>G||0>Y||0>=F||0>=z||G+F>h||Y+z>m)return 2;h=F,m=z}if(y.da){if(!_t(h,m,F=[y.ib],z=[y.hb]))return 2;h=F[0],m=z[0]}}M.width=h,M.height=m;e:{var Z=M.width,ne=M.height;if(h=M.S,0>=Z||0>=ne||!(h>=Ad&&13>h))h=2;else{if(0>=M.Rd&&M.sd==null){G=z=F=m=0;var ge=(Y=Z*Og[h])*ne;if(11>h||(z=(ne+1)/2*(m=(Z+1)/2),h==12&&(G=(F=Z)*ne)),(ne=a(ge+2*z+G))==null){h=1;break e}M.sd=ne,11>h?((Z=M.f.RGBA).eb=ne,Z.fb=0,Z.A=Y,Z.size=ge):((Z=M.f.kb).y=ne,Z.O=0,Z.fa=Y,Z.Fd=ge,Z.f=ne,Z.N=0+ge,Z.Ab=m,Z.Cd=z,Z.ea=ne,Z.W=0+ge+z,Z.Db=m,Z.Ed=z,h==12&&(Z.F=ne,Z.J=0+ge+2*z),Z.Tc=G,Z.lb=F)}if(m=1,F=M.S,z=M.width,G=M.height,F>=Ad&&13>F)if(11>F)h=M.f.RGBA,m&=(Y=Math.abs(h.A))*(G-1)+z<=h.size,m&=Y>=z*Og[F],m&=h.eb!=null;else{h=M.f.kb,Y=(z+1)/2,ge=(G+1)/2,Z=Math.abs(h.fa),ne=Math.abs(h.Ab);var Fe=Math.abs(h.Db),ie=Math.abs(h.lb),we=ie*(G-1)+z;m&=Z*(G-1)+z<=h.Fd,m&=ne*(ge-1)+Y<=h.Cd,m=(m&=Fe*(ge-1)+Y<=h.Ed)&Z>=z&ne>=Y&Fe>=Y,m&=h.y!=null,m&=h.f!=null,m&=h.ea!=null,F==12&&(m&=ie>=z,m&=we<=h.Tc,m&=h.F!=null)}else m=0;h=m?0:2}}return h!=0||y!=null&&y.fd&&(h=Yc(M)),h}var el=64,ji=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],Hi=24,ts=32,Oo=8,rs=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];pt("Predictor0","PredictorAdd0"),W.Predictor0=function(){return 4278190080},W.Predictor1=function(h){return h},W.Predictor2=function(h,m,y){return m[y+0]},W.Predictor3=function(h,m,y){return m[y+1]},W.Predictor4=function(h,m,y){return m[y-1]},W.Predictor5=function(h,m,y){return Pt(Pt(h,m[y+1]),m[y+0])},W.Predictor6=function(h,m,y){return Pt(h,m[y-1])},W.Predictor7=function(h,m,y){return Pt(h,m[y+0])},W.Predictor8=function(h,m,y){return Pt(m[y-1],m[y+0])},W.Predictor9=function(h,m,y){return Pt(m[y+0],m[y+1])},W.Predictor10=function(h,m,y){return Pt(Pt(h,m[y-1]),Pt(m[y+0],m[y+1]))},W.Predictor11=function(h,m,y){var M=m[y+0];return 0>=Lt(M>>24&255,h>>24&255,(m=m[y-1])>>24&255)+Lt(M>>16&255,h>>16&255,m>>16&255)+Lt(M>>8&255,h>>8&255,m>>8&255)+Lt(255&M,255&h,255&m)?M:h},W.Predictor12=function(h,m,y){var M=m[y+0];return(Kt((h>>24&255)+(M>>24&255)-((m=m[y-1])>>24&255))<<24|Kt((h>>16&255)+(M>>16&255)-(m>>16&255))<<16|Kt((h>>8&255)+(M>>8&255)-(m>>8&255))<<8|Kt((255&h)+(255&M)-(255&m)))>>>0},W.Predictor13=function(h,m,y){var M=m[y-1];return(Zt((h=Pt(h,m[y+0]))>>24&255,M>>24&255)<<24|Zt(h>>16&255,M>>16&255)<<16|Zt(h>>8&255,M>>8&255)<<8|Zt(255&h,255&M))>>>0};var Kc=W.PredictorAdd0;W.PredictorAdd1=rr,pt("Predictor2","PredictorAdd2"),pt("Predictor3","PredictorAdd3"),pt("Predictor4","PredictorAdd4"),pt("Predictor5","PredictorAdd5"),pt("Predictor6","PredictorAdd6"),pt("Predictor7","PredictorAdd7"),pt("Predictor8","PredictorAdd8"),pt("Predictor9","PredictorAdd9"),pt("Predictor10","PredictorAdd10"),pt("Predictor11","PredictorAdd11"),pt("Predictor12","PredictorAdd12"),pt("Predictor13","PredictorAdd13");var zl=W.PredictorAdd2;kt("ColorIndexInverseTransform","MapARGB","32b",function(h){return h>>8&255},function(h){return h}),kt("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(h){return h},function(h){return h>>8&255});var dn,Md=W.ColorIndexInverseTransform,Za=W.MapARGB,Ja=W.VP8LColorIndexInverseTransformAlpha,Zc=W.MapAlpha,Jc=W.VP8LPredictorsAdd=[];Jc.length=16,(W.VP8LPredictors=[]).length=16,(W.VP8LPredictorsAdd_C=[]).length=16,(W.VP8LPredictors_C=[]).length=16;var Qc,e0,ns,is,as,tl,os,rl,fa,Qa,yr,Nr,fn,On,Ao,t0,jl,Pd,ng,ig,ag,og,sg,lg,r0,cg,dg,fg,ug=a(511),hg=a(2041),pg=a(225),mg=a(767),gg=0,_h=hg,Od=pg,Wi=mg,ua=ug,Ad=0,Td=1,_g=2,Id=3,Fd=4,vh=5,vg=6,xh=7,bh=8,Dd=9,wh=10,E5=[2,3,7],M5=[3,3,11],xg=[280,256,256,256,40],P5=[0,1,1,1,0],O5=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],A5=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],T5=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],I5=8,yh=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],Ch=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],n0=null,F5=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],D5=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],bg=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],N5=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],R5=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],L5=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],B5=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],ss=[],Da=[],To=[],U5=1,wg=2,ls=[],ha=[];Mo("UpsampleRgbLinePair",Qo,3),Mo("UpsampleBgrLinePair",Xn,3),Mo("UpsampleRgbaLinePair",pi,4),Mo("UpsampleBgraLinePair",$c,4),Mo("UpsampleArgbLinePair",Gc,4),Mo("UpsampleRgba4444LinePair",Js,2),Mo("UpsampleRgb565LinePair",Zs,2);var V5=W.UpsampleRgbLinePair,z5=W.UpsampleBgrLinePair,yg=W.UpsampleRgbaLinePair,Cg=W.UpsampleBgraLinePair,Sg=W.UpsampleArgbLinePair,kg=W.UpsampleRgba4444LinePair,j5=W.UpsampleRgb565LinePair,Nd=16,Rd=1<<Nd-1,i0=-227,Sh=482,Eg=6,H5=(256<<Eg)-1,Mg=0,W5=a(256),q5=a(256),G5=a(256),$5=a(256),X5=a(Sh-i0),Y5=a(Sh-i0);Po("YuvToRgbRow",Qo,3),Po("YuvToBgrRow",Xn,3),Po("YuvToRgbaRow",pi,4),Po("YuvToBgraRow",$c,4),Po("YuvToArgbRow",Gc,4),Po("YuvToRgba4444Row",Js,2),Po("YuvToRgb565Row",Zs,2);var Pg=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],Ld=[0,2,8],K5=[8,7,6,4,4,2,2,2,1,1,1,1],Z5=1;this.WebPDecodeRGBA=function(h,m,y,M,F){var z=Td,G=new We,Y=new er;G.ba=Y,Y.S=z,Y.width=[Y.width],Y.height=[Y.height];var Z=Y.width,ne=Y.height,ge=new It;if(ge==null||h==null)var Fe=2;else r(ge!=null),Fe=Qs(h,m,y,ge.width,ge.height,ge.Pd,ge.Qd,ge.format,null);if(Fe!=0?Z=0:(Z!=null&&(Z[0]=ge.width[0]),ne!=null&&(ne[0]=ge.height[0]),Z=1),Z){Y.width=Y.width[0],Y.height=Y.height[0],M!=null&&(M[0]=Y.width),F!=null&&(F[0]=Y.height);e:{if(M=new Dl,(F=new Ke).data=h,F.w=m,F.ha=y,F.kd=1,m=[0],r(F!=null),((h=Qs(F.data,F.w,F.ha,null,null,null,m,null,F))==0||h==7)&&m[0]&&(h=4),(m=h)==0){if(r(G!=null),M.data=F.data,M.w=F.w+F.offset,M.ha=F.ha-F.offset,M.put=Nt,M.ac=sa,M.bc=Oa,M.ma=G,F.xa){if((h=Ie())==null){G=1;break e}if((function(ie,we){var Me=[0],Ve=[0],Te=[0];t:for(;;){if(ie==null)return 0;if(we==null)return ie.a=2,0;if(ie.l=we,ie.a=0,Be(ie.m,we.data,we.w,we.ha),!Aa(ie.m,Me,Ve,Te)){ie.a=3;break t}if(ie.xb=wg,we.width=Me[0],we.height=Ve[0],!Ae(Me[0],Ve[0],1,ie,null))break t;return 1}return r(ie.a!=0),0})(h,M)){if(M=(m=es(M.width,M.height,G.Oa,G.ba))==0){t:{M=h;r:for(;;){if(M==null){M=0;break t}if(r(M.s.yc!=null),r(M.s.Ya!=null),r(0<M.s.Wb),r((y=M.l)!=null),r((F=y.ma)!=null),M.xb!=0){if(M.ca=F.ba,M.tb=F.tb,r(M.ca!=null),!Xc(F.Oa,y,Id)){M.a=2;break r}if(!De(M,y.width)||y.da)break r;if((y.da||Dt(M.ca.S))&&Fa(),11>M.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),M.ca.f.kb.F!=null&&Fa()),M.Pb&&0<M.s.ua&&M.s.vb.X==null&&!Q(M.s.vb,M.s.Wa.Xa)){M.a=1;break r}M.xb=0}if(!Oe(M,M.V,M.Ba,M.c,M.i,y.o,K))break r;F.Dc=M.Ma,M=1;break t}r(M.a!=0),M=0}M=!M}M&&(m=h.a)}else m=h.a}else{if((h=new rh)==null){G=1;break e}if(h.Fa=F.na,h.P=F.P,h.qc=F.Sa,Ya(h,M)){if((m=es(M.width,M.height,G.Oa,G.ba))==0){if(h.Aa=0,y=G.Oa,r((F=h)!=null),y!=null){if(0<(Z=0>(Z=y.Md)?0:100<Z?255:255*Z/100)){for(ne=ge=0;4>ne;++ne)12>(Fe=F.pb[ne]).lc&&(Fe.ia=Z*K5[0>Fe.lc?0:Fe.lc]>>3),ge|=Fe.ia;ge&&(alert("todo:VP8InitRandom"),F.ia=1)}F.Ga=y.Id,100<F.Ga?F.Ga=100:0>F.Ga&&(F.Ga=0)}(function(ie,we){if(ie==null)return 0;if(we==null)return bn(ie,2,"NULL VP8Io parameter in VP8Decode().");if(!ie.cb&&!Ya(ie,we))return 0;if(r(ie.cb),we.ac==null||we.ac(we)){we.ob&&(ie.L=0);var Me=Ld[ie.L];if(ie.L==2?(ie.yb=0,ie.zb=0):(ie.yb=we.v-Me>>4,ie.zb=we.j-Me>>4,0>ie.yb&&(ie.yb=0),0>ie.zb&&(ie.zb=0)),ie.Va=we.o+15+Me>>4,ie.Hb=we.va+15+Me>>4,ie.Hb>ie.za&&(ie.Hb=ie.za),ie.Va>ie.Ub&&(ie.Va=ie.Ub),0<ie.L){var Ve=ie.ed;for(Me=0;4>Me;++Me){var Te;if(ie.Qa.Cb){var ze=ie.Qa.Lb[Me];ie.Qa.Fb||(ze+=Ve.Tb)}else ze=Ve.Tb;for(Te=0;1>=Te;++Te){var Ge=ie.gd[Me][Te],rt=ze;if(Ve.Pc&&(rt+=Ve.vd[0],Te&&(rt+=Ve.od[0])),0<(rt=0>rt?0:63<rt?63:rt)){var Ze=rt;0<Ve.wb&&(Ze=4<Ve.wb?Ze>>2:Ze>>1)>9-Ve.wb&&(Ze=9-Ve.wb),1>Ze&&(Ze=1),Ge.dd=Ze,Ge.tc=2*rt+Ze,Ge.ld=40<=rt?2:15<=rt?1:0}else Ge.tc=0;Ge.La=Te}}}Me=0}else bn(ie,6,"Frame setup failed"),Me=ie.a;if(Me=Me==0){if(Me){ie.$c=0,0<ie.Aa||(ie.Ic=Z5);t:{Me=ie.Ic,Ve=4*(Ze=ie.za);var Ot=32*Ze,gt=Ze+1,Jt=0<ie.L?Ze*(0<ie.Aa?2:1):0,Ct=(ie.Aa==2?2:1)*Ze;if((Ge=Ve+832+(Te=3*(16*Me+Ld[ie.L])/2*Ot)+(ze=ie.Fa!=null&&0<ie.Fa.length?ie.Kc.c*ie.Kc.i:0))!=Ge)Me=0;else{if(Ge>ie.Vb){if(ie.Vb=0,ie.Ec=a(Ge),ie.Fc=0,ie.Ec==null){Me=bn(ie,1,"no memory during frame initialization.");break t}ie.Vb=Ge}Ge=ie.Ec,rt=ie.Fc,ie.Ac=Ge,ie.Bc=rt,rt+=Ve,ie.Gd=o(Ot,la),ie.Hd=0,ie.rb=o(gt+1,zr),ie.sb=1,ie.wa=Jt?o(Jt,Dr):null,ie.Y=0,ie.D.Nb=0,ie.D.wa=ie.wa,ie.D.Y=ie.Y,0<ie.Aa&&(ie.D.Y+=Ze),r(!0),ie.oc=Ge,ie.pc=rt,rt+=832,ie.ya=o(Ct,Ta),ie.aa=0,ie.D.ya=ie.ya,ie.D.aa=ie.aa,ie.Aa==2&&(ie.D.aa+=Ze),ie.R=16*Ze,ie.B=8*Ze,Ze=(Ot=Ld[ie.L])*ie.R,Ot=Ot/2*ie.B,ie.sa=Ge,ie.ta=rt+Ze,ie.qa=ie.sa,ie.ra=ie.ta+16*Me*ie.R+Ot,ie.Ha=ie.qa,ie.Ia=ie.ra+8*Me*ie.B+Ot,ie.$c=0,rt+=Te,ie.mb=ze?Ge:null,ie.nb=ze?rt:null,r(rt+ze<=ie.Fc+ie.Vb),gd(ie),i(ie.Ac,ie.Bc,0,Ve),Me=1}}if(Me){if(we.ka=0,we.y=ie.sa,we.O=ie.ta,we.f=ie.qa,we.N=ie.ra,we.ea=ie.Ha,we.Vd=ie.Ia,we.fa=ie.R,we.Rc=ie.B,we.F=null,we.J=0,!gg){for(Me=-255;255>=Me;++Me)ug[255+Me]=0>Me?-Me:Me;for(Me=-1020;1020>=Me;++Me)hg[1020+Me]=-128>Me?-128:127<Me?127:Me;for(Me=-112;112>=Me;++Me)pg[112+Me]=-16>Me?-16:15<Me?15:Me;for(Me=-255;510>=Me;++Me)mg[255+Me]=0>Me?0:255<Me?255:Me;gg=1}os=Rl,rl=ih,Qa=Ka,yr=vd,Nr=xd,fa=nh,fn=Sd,On=Xs,Ao=I,t0=le,jl=kd,Pd=b,ng=me,ig=Se,ag=$s,og=Wc,sg=yd,lg=Cd,Da[0]=uh,Da[1]=ah,Da[2]=dh,Da[3]=fh,Da[4]=bo,Da[5]=hh,Da[6]=wo,Da[7]=ph,Da[8]=Uc,Da[9]=Ll,ss[0]=lh,ss[1]=sh,ss[2]=Lc,ss[3]=bd,ss[4]=qs,ss[5]=Bc,ss[6]=ch,To[0]=gh,To[1]=oh,To[2]=Gs,To[3]=mh,To[4]=zc,To[5]=Vc,To[6]=wd,Me=1}else Me=0}Me&&(Me=(function(lr,An){for(lr.M=0;lr.M<lr.Va;++lr.M){var Qt,St=lr.Jc[lr.M&lr.Xb],dt=lr.m,un=lr;for(Qt=0;Qt<un.za;++Qt){var Gt=dt,dr=un,Wr=dr.Ac,Yn=dr.Bc+4*Qt,mi=dr.zc,en=dr.ya[dr.aa+Qt];if(dr.Qa.Bb?en.$b=_e(Gt,dr.Pa.jb[0])?2+_e(Gt,dr.Pa.jb[2]):_e(Gt,dr.Pa.jb[1]):en.$b=0,dr.kc&&(en.Ad=_e(Gt,dr.Bd)),en.Za=!_e(Gt,145)+0,en.Za){var oi=en.Ob,gi=0;for(dr=0;4>dr;++dr){var Tn,hr=mi[0+dr];for(Tn=0;4>Tn;++Tn){hr=R5[Wr[Yn+Tn]][hr];for(var kr=bg[_e(Gt,hr[0])];0<kr;)kr=bg[2*kr+_e(Gt,hr[kr])];hr=-kr,Wr[Yn+Tn]=hr}n(oi,gi,Wr,Yn,4),gi+=4,mi[0+dr]=hr}}else hr=_e(Gt,156)?_e(Gt,128)?1:3:_e(Gt,163)?2:0,en.Ob[0]=hr,i(Wr,Yn,hr,4),i(mi,0,hr,4);en.Dd=_e(Gt,142)?_e(Gt,114)?_e(Gt,183)?1:3:2:0}if(un.m.Ka)return bn(lr,7,"Premature end-of-partition0 encountered.");for(;lr.ja<lr.za;++lr.ja){if(un=St,Gt=(dt=lr).rb[dt.sb-1],Wr=dt.rb[dt.sb+dt.ja],Qt=dt.ya[dt.aa+dt.ja],Yn=dt.kc?Qt.Ad:0)Gt.la=Wr.la=0,Qt.Za||(Gt.Na=Wr.Na=0),Qt.Hc=0,Qt.Gc=0,Qt.ia=0;else{var tn,Er;if(Gt=Wr,Wr=un,Yn=dt.Pa.Xc,mi=dt.ya[dt.aa+dt.ja],en=dt.pb[mi.$b],dr=mi.ad,oi=0,gi=dt.rb[dt.sb-1],hr=Tn=0,i(dr,oi,0,384),mi.Za)var Kn=0,Na=Yn[3];else{kr=a(16);var hn=Gt.Na+gi.Na;if(hn=n0(Wr,Yn[1],hn,en.Eb,0,kr,0),Gt.Na=gi.Na=(0<hn)+0,1<hn)os(kr,0,dr,oi);else{var Ei=kr[0]+3>>3;for(kr=0;256>kr;kr+=16)dr[oi+kr]=Ei}Kn=1,Na=Yn[0]}var Rr=15&Gt.la,In=15&gi.la;for(kr=0;4>kr;++kr){var qi=1&In;for(Ei=Er=0;4>Ei;++Ei)Rr=Rr>>1|(qi=(hn=n0(Wr,Na,hn=qi+(1&Rr),en.Sc,Kn,dr,oi))>Kn)<<7,Er=Er<<2|(3<hn?3:1<hn?2:dr[oi+0]!=0),oi+=16;Rr>>=4,In=In>>1|qi<<7,Tn=(Tn<<8|Er)>>>0}for(Na=Rr,Kn=In>>4,tn=0;4>tn;tn+=2){for(Er=0,Rr=Gt.la>>4+tn,In=gi.la>>4+tn,kr=0;2>kr;++kr){for(qi=1&In,Ei=0;2>Ei;++Ei)hn=qi+(1&Rr),Rr=Rr>>1|(qi=0<(hn=n0(Wr,Yn[2],hn,en.Qc,0,dr,oi)))<<3,Er=Er<<2|(3<hn?3:1<hn?2:dr[oi+0]!=0),oi+=16;Rr>>=2,In=In>>1|qi<<5}hr|=Er<<4*tn,Na|=Rr<<4<<tn,Kn|=(240&In)<<tn}Gt.la=Na,gi.la=Kn,mi.Hc=Tn,mi.Gc=hr,mi.ia=43690&hr?0:en.ia,Yn=!(Tn|hr)}if(0<dt.L&&(dt.wa[dt.Y+dt.ja]=dt.gd[Qt.$b][Qt.Za],dt.wa[dt.Y+dt.ja].La|=!Yn),un.Ka)return bn(lr,7,"Premature end-of-file encountered.")}if(gd(lr),dt=An,un=1,Qt=(St=lr).D,Gt=0<St.L&&St.M>=St.zb&&St.M<=St.Va,St.Aa==0)t:{if(Qt.M=St.M,Qt.uc=Gt,da(St,Qt),un=1,Qt=(Er=St.D).Nb,Gt=(hr=Ld[St.L])*St.R,Wr=hr/2*St.B,kr=16*Qt*St.R,Ei=8*Qt*St.B,Yn=St.sa,mi=St.ta-Gt+kr,en=St.qa,dr=St.ra-Wr+Ei,oi=St.Ha,gi=St.Ia-Wr+Ei,In=(Rr=Er.M)==0,Tn=Rr>=St.Va-1,St.Aa==2&&da(St,Er),Er.uc)for(qi=(hn=St).D.M,r(hn.D.uc),Er=hn.yb;Er<hn.Hb;++Er){Kn=Er,Na=qi;var _i=(Gi=(Zn=hn).D).Nb;tn=Zn.R;var Gi=Gi.wa[Gi.Y+Kn],$i=Zn.sa,Mi=Zn.ta+16*_i*tn+16*Kn,Xi=Gi.dd,Hr=Gi.tc;if(Hr!=0)if(r(3<=Hr),Zn.L==1)0<Kn&&og($i,Mi,tn,Hr+4),Gi.La&&lg($i,Mi,tn,Hr),0<Na&&ag($i,Mi,tn,Hr+4),Gi.La&&sg($i,Mi,tn,Hr);else{var Yi=Zn.B,Ra=Zn.qa,nl=Zn.ra+8*_i*Yi+8*Kn,Io=Zn.Ha,Zn=Zn.Ia+8*_i*Yi+8*Kn;_i=Gi.ld,0<Kn&&(On($i,Mi,tn,Hr+4,Xi,_i),t0(Ra,nl,Io,Zn,Yi,Hr+4,Xi,_i)),Gi.La&&(Pd($i,Mi,tn,Hr,Xi,_i),ig(Ra,nl,Io,Zn,Yi,Hr,Xi,_i)),0<Na&&(fn($i,Mi,tn,Hr+4,Xi,_i),Ao(Ra,nl,Io,Zn,Yi,Hr+4,Xi,_i)),Gi.La&&(jl($i,Mi,tn,Hr,Xi,_i),ng(Ra,nl,Io,Zn,Yi,Hr,Xi,_i))}}if(St.ia&&alert("todo:DitherRow"),dt.put!=null){if(Er=16*Rr,Rr=16*(Rr+1),In?(dt.y=St.sa,dt.O=St.ta+kr,dt.f=St.qa,dt.N=St.ra+Ei,dt.ea=St.Ha,dt.W=St.Ia+Ei):(Er-=hr,dt.y=Yn,dt.O=mi,dt.f=en,dt.N=dr,dt.ea=oi,dt.W=gi),Tn||(Rr-=hr),Rr>dt.o&&(Rr=dt.o),dt.F=null,dt.J=null,St.Fa!=null&&0<St.Fa.length&&Er<Rr&&(dt.J=jr(St,dt,Er,Rr-Er),dt.F=St.mb,dt.F==null&&dt.F.length==0)){un=bn(St,3,"Could not decode alpha data.");break t}Er<dt.j&&(hr=dt.j-Er,Er=dt.j,r(!(1&hr)),dt.O+=St.R*hr,dt.N+=St.B*(hr>>1),dt.W+=St.B*(hr>>1),dt.F!=null&&(dt.J+=dt.width*hr)),Er<Rr&&(dt.O+=dt.v,dt.N+=dt.v>>1,dt.W+=dt.v>>1,dt.F!=null&&(dt.J+=dt.v),dt.ka=Er-dt.j,dt.U=dt.va-dt.v,dt.T=Rr-Er,un=dt.put(dt))}Qt+1!=St.Ic||Tn||(n(St.sa,St.ta-Gt,Yn,mi+16*St.R,Gt),n(St.qa,St.ra-Wr,en,dr+8*St.B,Wr),n(St.Ha,St.Ia-Wr,oi,gi+8*St.B,Wr))}if(!un)return bn(lr,6,"Output aborted.")}return 1})(ie,we)),we.bc!=null&&we.bc(we),Me&=1}return Me?(ie.cb=0,Me):0})(h,M)||(m=h.a)}}else m=h.a}m==0&&G.Oa!=null&&G.Oa.fd&&(m=Yc(G.ba))}G=m}z=G!=0?null:11>z?Y.f.RGBA.eb:Y.f.kb.y}else z=null;return z};var Og=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function c(W,ae){for(var A="",V=0;V<4;V++)A+=String.fromCharCode(W[ae++]);return A}function f(W,ae){return W[ae+0]|W[ae+1]<<8}function v(W,ae){return(W[ae+0]|W[ae+1]<<8|W[ae+2]<<16)>>>0}function x(W,ae){return(W[ae+0]|W[ae+1]<<8|W[ae+2]<<16|W[ae+3]<<24)>>>0}new l;var p=[0],S=[0],w=[],k=new l,O=t,H=(function(W,ae){var A={},V=0,de=!1,ue=0,xe=0;if(A.frames=[],!(function(E,U){for(var T=0;T<4;T++)if(E[U+T]!="RIFF".charCodeAt(T))return!0;return!1})(W,ae)){for(x(W,ae+=4),ae+=8;ae<W.length;){var Ne=c(W,ae),Re=x(W,ae+=4);ae+=4;var Ee=Re+(1&Re);switch(Ne){case"VP8 ":case"VP8L":A.frames[V]===void 0&&(A.frames[V]={}),(qe=A.frames[V]).src_off=de?xe:ae-8,qe.src_size=ue+Re+8,V++,de&&(de=!1,ue=0,xe=0);break;case"VP8X":(qe=A.header={}).feature_flags=W[ae];var Be=ae+4;qe.canvas_width=1+v(W,Be),Be+=3,qe.canvas_height=1+v(W,Be),Be+=3;break;case"ALPH":de=!0,ue=Ee+8,xe=ae-8;break;case"ANIM":(qe=A.header).bgcolor=x(W,ae),Be=ae+4,qe.loop_count=f(W,Be),Be+=2;break;case"ANMF":var Je,qe;(qe=A.frames[V]={}).offset_x=2*v(W,ae),ae+=3,qe.offset_y=2*v(W,ae),ae+=3,qe.width=1+v(W,ae),ae+=3,qe.height=1+v(W,ae),ae+=3,qe.duration=v(W,ae),ae+=3,Je=W[ae++],qe.dispose=1&Je,qe.blend=Je>>1&1}Ne!="ANMF"&&(ae+=Ee)}return A}})(O,0);H.response=O,H.rgbaoutput=!0,H.dataurl=!1;var q=H.header?H.header:null,X=H.frames?H.frames:null;if(q){q.loop_counter=q.loop_count,p=[q.canvas_height],S=[q.canvas_width];for(var he=0;he<X.length&&X[he].blend!=0;he++);}var ke=X[0],re=k.WebPDecodeRGBA(O,ke.src_off,ke.src_size,S,p);ke.rgba=re,ke.imgwidth=S[0],ke.imgheight=p[0];for(var ee=0;ee<S[0]*p[0]*4;ee++)w[ee]=re[ee];return this.width=S,this.height=p,this.data=w,this}(function(t){var r,e,n,i,a,o,s,l,c,f=function(E){return E=E||{},this.isStrokeTransparent=E.isStrokeTransparent||!1,this.strokeOpacity=E.strokeOpacity||1,this.strokeStyle=E.strokeStyle||"#000000",this.fillStyle=E.fillStyle||"#000000",this.isFillTransparent=E.isFillTransparent||!1,this.fillOpacity=E.fillOpacity||1,this.font=E.font||"10px sans-serif",this.textBaseline=E.textBaseline||"alphabetic",this.textAlign=E.textAlign||"left",this.lineWidth=E.lineWidth||1,this.lineJoin=E.lineJoin||"miter",this.lineCap=E.lineCap||"butt",this.path=E.path||[],this.transform=E.transform!==void 0?E.transform.clone():new l,this.globalCompositeOperation=E.globalCompositeOperation||"normal",this.globalAlpha=E.globalAlpha||1,this.clip_path=E.clip_path||[],this.currentPoint=E.currentPoint||new o,this.miterLimit=E.miterLimit||10,this.lastPoint=E.lastPoint||new o,this.lineDashOffset=E.lineDashOffset||0,this.lineDash=E.lineDash||[],this.margin=E.margin||[0,0,0,0],this.prevPageLastElemOffset=E.prevPageLastElemOffset||0,this.ignoreClearRect=typeof E.ignoreClearRect!="boolean"||E.ignoreClearRect,this};t.events.push(["initialized",function(){this.context2d=new v(this),r=this.internal.f2,e=this.internal.getCoordinateString,n=this.internal.getVerticalCoordinateString,i=this.internal.getHorizontalCoordinate,a=this.internal.getVerticalCoordinate,o=this.internal.Point,s=this.internal.Rectangle,l=this.internal.Matrix,c=new f}]);var v=function(E){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var U=E;Object.defineProperty(this,"pdf",{get:function(){return U}});var T=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return T},set:function(Q){T=!!Q}});var R=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return R},set:function(Q){R=!!Q}});var te=0;Object.defineProperty(this,"posX",{get:function(){return te},set:function(Q){isNaN(Q)||(te=Q)}});var pe=0;Object.defineProperty(this,"posY",{get:function(){return pe},set:function(Q){isNaN(Q)||(pe=Q)}}),Object.defineProperty(this,"margin",{get:function(){return c.margin},set:function(Q){var tt;typeof Q=="number"?tt=[Q,Q,Q,Q]:((tt=new Array(4))[0]=Q[0],tt[1]=Q.length>=2?Q[1]:tt[0],tt[2]=Q.length>=3?Q[2]:tt[0],tt[3]=Q.length>=4?Q[3]:tt[1]),c.margin=tt}});var ye=!1;Object.defineProperty(this,"autoPaging",{get:function(){return ye},set:function(Q){ye=Q}});var ve=0;Object.defineProperty(this,"lastBreak",{get:function(){return ve},set:function(Q){ve=Q}});var _e=[];Object.defineProperty(this,"pageBreaks",{get:function(){return _e},set:function(Q){_e=Q}}),Object.defineProperty(this,"ctx",{get:function(){return c},set:function(Q){Q instanceof f&&(c=Q)}}),Object.defineProperty(this,"path",{get:function(){return c.path},set:function(Q){c.path=Q}});var He=[];Object.defineProperty(this,"ctxStack",{get:function(){return He},set:function(Q){He=Q}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(Q){var tt;tt=x(Q),this.ctx.fillStyle=tt.style,this.ctx.isFillTransparent=tt.a===0,this.ctx.fillOpacity=tt.a,this.pdf.setFillColor(tt.r,tt.g,tt.b,{a:tt.a}),this.pdf.setTextColor(tt.r,tt.g,tt.b,{a:tt.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(Q){var tt=x(Q);this.ctx.strokeStyle=tt.style,this.ctx.isStrokeTransparent=tt.a===0,this.ctx.strokeOpacity=tt.a,tt.a===0?this.pdf.setDrawColor(255,255,255):(tt.a,this.pdf.setDrawColor(tt.r,tt.g,tt.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(Q){["butt","round","square"].indexOf(Q)!==-1&&(this.ctx.lineCap=Q,this.pdf.setLineCap(Q))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(Q){isNaN(Q)||(this.ctx.lineWidth=Q,this.pdf.setLineWidth(Q))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(Q){["bevel","round","miter"].indexOf(Q)!==-1&&(this.ctx.lineJoin=Q,this.pdf.setLineJoin(Q))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(Q){isNaN(Q)||(this.ctx.miterLimit=Q,this.pdf.setMiterLimit(Q))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(Q){this.ctx.textBaseline=Q}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(Q){["right","end","center","left","start"].indexOf(Q)!==-1&&(this.ctx.textAlign=Q)}});var Ye=null,nt=null,at=null;Object.defineProperty(this,"fontFaces",{get:function(){return at},set:function(Q){Ye=null,nt=null,at=Q}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(Q){var tt;if(this.ctx.font=Q,(tt=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z0-9]+?)\s*$/i.exec(Q))!==null){var Qe=tt[1];tt[2];var _t=tt[3],$e=tt[4];tt[5];var Et=tt[6],pt=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec($e)[2];$e=Math.floor(pt==="px"?parseFloat($e)*this.pdf.internal.scaleFactor:pt==="em"?parseFloat($e)*this.pdf.getFontSize():parseFloat($e)*this.pdf.internal.scaleFactor),this.pdf.setFontSize($e);var At=(function(kt){var $r,ar,$t=[],Xt=kt.trim();if(Xt==="")return Cm;if(Xt in zx)return[zx[Xt]];for(;Xt!=="";){switch(ar=null,$r=(Xt=Hx(Xt)).charAt(0)){case'"':case"'":ar=O8(Xt.substring(1),$r);break;default:ar=A8(Xt)}if(ar===null||($t.push(ar[0]),(Xt=Hx(ar[1]))!==""&&Xt.charAt(0)!==","))return Cm;Xt=Xt.replace(/^,/,"")}return $t})(Et);if(this.fontFaces){var Pt=(function(kt,$r){var ar=kt.getFontList(),$t=JSON.stringify(ar);if(Ye===null||nt!==$t){var Xt=(function(Ur){var Tt=[];return Object.keys(Ur).forEach(function(Sr){Ur[Sr].forEach(function(Dt){var Vt=null;switch(Dt){case"bold":Vt={family:Sr,weight:"bold"};break;case"italic":Vt={family:Sr,style:"italic"};break;case"bolditalic":Vt={family:Sr,weight:"bold",style:"italic"};break;case"":case"normal":Vt={family:Sr}}Vt!==null&&(Vt.ref={name:Sr,style:Dt},Tt.push(Vt))})}),Tt})(ar);Ye=(function(Ur){for(var Tt={},Sr=0;Sr<Ur.length;++Sr){var Dt=ym(Ur[Sr]),Vt=Dt.family,Vr=Dt.stretch,er=Dt.style,It=Dt.weight;Tt[Vt]=Tt[Vt]||{},Tt[Vt][Vr]=Tt[Vt][Vr]||{},Tt[Vt][Vr][er]=Tt[Vt][Vr][er]||{},Tt[Vt][Vr][er][It]=Dt}return Tt})(Xt.concat($r)),nt=$t}return Ye})(this.pdf,this.fontFaces),Kt=At.map(function(kt){return{family:kt,stretch:"normal",weight:_t,style:Qe}}),Zt=(function(kt,$r,ar){for(var $t=(ar=ar||{}).defaultFontFamily||"times",Xt=Object.assign({},P8,ar.genericFontFamilies||{}),Ur=null,Tt=null,Sr=0;Sr<$r.length;++Sr)if(Xt[(Ur=ym($r[Sr])).family]&&(Ur.family=Xt[Ur.family]),kt.hasOwnProperty(Ur.family)){Tt=kt[Ur.family];break}if(!(Tt=Tt||kt[$t]))throw new Error("Could not find a font-family for the rule '"+jx(Ur)+"' and default family '"+$t+"'.");if(Tt=(function(Dt,Vt){if(Vt[Dt])return Vt[Dt];var Vr=Om[Dt],er=Vr<=Om.normal?-1:1,It=Vx(Vt,ub,Vr,er);if(!It)throw new Error("Could not find a matching font-stretch value for "+Dt);return It})(Ur.stretch,Tt),Tt=(function(Dt,Vt){if(Vt[Dt])return Vt[Dt];for(var Vr=fb[Dt],er=0;er<Vr.length;++er)if(Vt[Vr[er]])return Vt[Vr[er]];throw new Error("Could not find a matching font-style for "+Dt)})(Ur.style,Tt),!(Tt=(function(Dt,Vt){if(Vt[Dt])return Vt[Dt];if(Dt===400&&Vt[500])return Vt[500];if(Dt===500&&Vt[400])return Vt[400];var Vr=M8[Dt],er=Vx(Vt,hb,Vr,Dt<400?-1:1);if(!er)throw new Error("Could not find a matching font-weight for value "+Dt);return er})(Ur.weight,Tt)))throw new Error("Failed to resolve a font for the rule '"+jx(Ur)+"'.");return Tt})(Pt,Kt);this.pdf.setFont(Zt.ref.name,Zt.ref.style)}else{var Lt="";(_t==="bold"||parseInt(_t,10)>=700||Qe==="bold")&&(Lt="bold"),Qe==="italic"&&(Lt+="italic"),Lt.length===0&&(Lt="normal");for(var rr="",Wt={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},yt=0;yt<At.length;yt++){if(this.pdf.internal.getFont(At[yt],Lt,{noFallback:!0,disableWarning:!0})!==void 0){rr=At[yt];break}if(Lt==="bolditalic"&&this.pdf.internal.getFont(At[yt],"bold",{noFallback:!0,disableWarning:!0})!==void 0)rr=At[yt],Lt="bold";else if(this.pdf.internal.getFont(At[yt],"normal",{noFallback:!0,disableWarning:!0})!==void 0){rr=At[yt],Lt="normal";break}}if(rr===""){for(var jt=0;jt<At.length;jt++)if(Wt[At[jt]]){rr=Wt[At[jt]];break}}rr=rr===""?"Times":rr,this.pdf.setFont(rr,Lt)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(Q){this.ctx.globalCompositeOperation=Q}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(Q){this.ctx.globalAlpha=Q}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(Q){this.ctx.lineDashOffset=Q,qe.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(Q){this.ctx.lineDash=Q,qe.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(Q){this.ctx.ignoreClearRect=!!Q}})};v.prototype.setLineDash=function(E){this.lineDash=E},v.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},v.prototype.fill=function(){X.call(this,"fill",!1)},v.prototype.stroke=function(){X.call(this,"stroke",!1)},v.prototype.beginPath=function(){this.path=[{type:"begin"}]},v.prototype.moveTo=function(E,U){if(isNaN(E)||isNaN(U))throw Br.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var T=this.ctx.transform.applyToPoint(new o(E,U));this.path.push({type:"mt",x:T.x,y:T.y}),this.ctx.lastPoint=new o(E,U)},v.prototype.closePath=function(){var E=new o(0,0),U=0;for(U=this.path.length-1;U!==-1;U--)if(this.path[U].type==="begin"&&Ir(this.path[U+1])==="object"&&typeof this.path[U+1].x=="number"){E=new o(this.path[U+1].x,this.path[U+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new o(E.x,E.y)},v.prototype.lineTo=function(E,U){if(isNaN(E)||isNaN(U))throw Br.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var T=this.ctx.transform.applyToPoint(new o(E,U));this.path.push({type:"lt",x:T.x,y:T.y}),this.ctx.lastPoint=new o(T.x,T.y)},v.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),X.call(this,null,!0)},v.prototype.quadraticCurveTo=function(E,U,T,R){if(isNaN(T)||isNaN(R)||isNaN(E)||isNaN(U))throw Br.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var te=this.ctx.transform.applyToPoint(new o(T,R)),pe=this.ctx.transform.applyToPoint(new o(E,U));this.path.push({type:"qct",x1:pe.x,y1:pe.y,x:te.x,y:te.y}),this.ctx.lastPoint=new o(te.x,te.y)},v.prototype.bezierCurveTo=function(E,U,T,R,te,pe){if(isNaN(te)||isNaN(pe)||isNaN(E)||isNaN(U)||isNaN(T)||isNaN(R))throw Br.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var ye=this.ctx.transform.applyToPoint(new o(te,pe)),ve=this.ctx.transform.applyToPoint(new o(E,U)),_e=this.ctx.transform.applyToPoint(new o(T,R));this.path.push({type:"bct",x1:ve.x,y1:ve.y,x2:_e.x,y2:_e.y,x:ye.x,y:ye.y}),this.ctx.lastPoint=new o(ye.x,ye.y)},v.prototype.arc=function(E,U,T,R,te,pe){if(isNaN(E)||isNaN(U)||isNaN(T)||isNaN(R)||isNaN(te))throw Br.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(pe=!!pe,!this.ctx.transform.isIdentity){var ye=this.ctx.transform.applyToPoint(new o(E,U));E=ye.x,U=ye.y;var ve=this.ctx.transform.applyToPoint(new o(0,T)),_e=this.ctx.transform.applyToPoint(new o(0,0));T=Math.sqrt(Math.pow(ve.x-_e.x,2)+Math.pow(ve.y-_e.y,2))}Math.abs(te-R)>=2*Math.PI&&(R=0,te=2*Math.PI),this.path.push({type:"arc",x:E,y:U,radius:T,startAngle:R,endAngle:te,counterclockwise:pe})},v.prototype.arcTo=function(E,U,T,R,te){throw new Error("arcTo not implemented.")},v.prototype.rect=function(E,U,T,R){if(isNaN(E)||isNaN(U)||isNaN(T)||isNaN(R))throw Br.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(E,U),this.lineTo(E+T,U),this.lineTo(E+T,U+R),this.lineTo(E,U+R),this.lineTo(E,U),this.lineTo(E+T,U),this.lineTo(E,U)},v.prototype.fillRect=function(E,U,T,R){if(isNaN(E)||isNaN(U)||isNaN(T)||isNaN(R))throw Br.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!p.call(this)){var te={};this.lineCap!=="butt"&&(te.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&(te.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(E,U,T,R),this.fill(),te.hasOwnProperty("lineCap")&&(this.lineCap=te.lineCap),te.hasOwnProperty("lineJoin")&&(this.lineJoin=te.lineJoin)}},v.prototype.strokeRect=function(E,U,T,R){if(isNaN(E)||isNaN(U)||isNaN(T)||isNaN(R))throw Br.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");S.call(this)||(this.beginPath(),this.rect(E,U,T,R),this.stroke())},v.prototype.clearRect=function(E,U,T,R){if(isNaN(E)||isNaN(U)||isNaN(T)||isNaN(R))throw Br.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(E,U,T,R))},v.prototype.save=function(E){E=typeof E!="boolean"||E;for(var U=this.pdf.internal.getCurrentPageInfo().pageNumber,T=0;T<this.pdf.internal.getNumberOfPages();T++)this.pdf.setPage(T+1),this.pdf.internal.out("q");if(this.pdf.setPage(U),E){this.ctx.fontSize=this.pdf.internal.getFontSize();var R=new f(this.ctx);this.ctxStack.push(this.ctx),this.ctx=R}},v.prototype.restore=function(E){E=typeof E!="boolean"||E;for(var U=this.pdf.internal.getCurrentPageInfo().pageNumber,T=0;T<this.pdf.internal.getNumberOfPages();T++)this.pdf.setPage(T+1),this.pdf.internal.out("Q");this.pdf.setPage(U),E&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},v.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var x=function(E){var U,T,R,te;if(E.isCanvasGradient===!0&&(E=E.getColor()),!E)return{r:0,g:0,b:0,a:0,style:E};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(E))U=0,T=0,R=0,te=0;else{var pe=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(E);if(pe!==null)U=parseInt(pe[1]),T=parseInt(pe[2]),R=parseInt(pe[3]),te=1;else if((pe=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(E))!==null)U=parseInt(pe[1]),T=parseInt(pe[2]),R=parseInt(pe[3]),te=parseFloat(pe[4]);else{if(te=1,typeof E=="string"&&E.charAt(0)!=="#"){var ye=new ib(E);E=ye.ok?ye.toHex():"#000000"}E.length===4?(U=E.substring(1,2),U+=U,T=E.substring(2,3),T+=T,R=E.substring(3,4),R+=R):(U=E.substring(1,3),T=E.substring(3,5),R=E.substring(5,7)),U=parseInt(U,16),T=parseInt(T,16),R=parseInt(R,16)}}return{r:U,g:T,b:R,a:te,style:E}},p=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},S=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};v.prototype.fillText=function(E,U,T,R){if(isNaN(U)||isNaN(T)||typeof E!="string")throw Br.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(R=isNaN(R)?void 0:R,!p.call(this)){var te=Ee(this.ctx.transform.rotation),pe=this.ctx.transform.scaleX;V.call(this,{text:E,x:U,y:T,scale:pe,angle:te,align:this.textAlign,maxWidth:R})}},v.prototype.strokeText=function(E,U,T,R){if(isNaN(U)||isNaN(T)||typeof E!="string")throw Br.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!S.call(this)){R=isNaN(R)?void 0:R;var te=Ee(this.ctx.transform.rotation),pe=this.ctx.transform.scaleX;V.call(this,{text:E,x:U,y:T,scale:pe,renderingMode:"stroke",angle:te,align:this.textAlign,maxWidth:R})}},v.prototype.measureText=function(E){if(typeof E!="string")throw Br.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var U=this.pdf,T=this.pdf.internal.scaleFactor,R=U.internal.getFontSize(),te=U.getStringUnitWidth(E)*R/U.internal.scaleFactor;return new function(pe){var ye=(pe=pe||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return ye}}),this}({width:te*=Math.round(96*T/72*1e4)/1e4})},v.prototype.scale=function(E,U){if(isNaN(E)||isNaN(U))throw Br.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var T=new l(E,0,0,U,0,0);this.ctx.transform=this.ctx.transform.multiply(T)},v.prototype.rotate=function(E){if(isNaN(E))throw Br.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var U=new l(Math.cos(E),Math.sin(E),-Math.sin(E),Math.cos(E),0,0);this.ctx.transform=this.ctx.transform.multiply(U)},v.prototype.translate=function(E,U){if(isNaN(E)||isNaN(U))throw Br.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var T=new l(1,0,0,1,E,U);this.ctx.transform=this.ctx.transform.multiply(T)},v.prototype.transform=function(E,U,T,R,te,pe){if(isNaN(E)||isNaN(U)||isNaN(T)||isNaN(R)||isNaN(te)||isNaN(pe))throw Br.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var ye=new l(E,U,T,R,te,pe);this.ctx.transform=this.ctx.transform.multiply(ye)},v.prototype.setTransform=function(E,U,T,R,te,pe){E=isNaN(E)?1:E,U=isNaN(U)?0:U,T=isNaN(T)?0:T,R=isNaN(R)?1:R,te=isNaN(te)?0:te,pe=isNaN(pe)?0:pe,this.ctx.transform=new l(E,U,T,R,te,pe)};var w=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};v.prototype.drawImage=function(E,U,T,R,te,pe,ye,ve,_e){var He=this.pdf.getImageProperties(E),Ye=1,nt=1,at=1,Q=1;R!==void 0&&ve!==void 0&&(at=ve/R,Q=_e/te,Ye=He.width/R*ve/R,nt=He.height/te*_e/te),pe===void 0&&(pe=U,ye=T,U=0,T=0),R!==void 0&&ve===void 0&&(ve=R,_e=te),R===void 0&&ve===void 0&&(ve=He.width,_e=He.height);var tt=this.ctx.transform.decompose(),Qe=Ee(tt.rotate.shx),_t=new l,$e=(_t=(_t=(_t=_t.multiply(tt.translate)).multiply(tt.skew)).multiply(tt.scale)).applyToRectangle(new s(pe-U*at,ye-T*Q,R*Ye,te*nt));if(this.autoPaging){for(var Et,pt=k.call(this,$e),At=[],Pt=0;Pt<pt.length;Pt+=1)At.indexOf(pt[Pt])===-1&&At.push(pt[Pt]);q(At);for(var Kt=At[0],Zt=At[At.length-1],Lt=Kt;Lt<Zt+1;Lt++){this.pdf.setPage(Lt);var rr=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],Wt=Lt===1?this.posY+this.margin[0]:this.margin[0],yt=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],jt=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],kt=Lt===1?0:yt+(Lt-2)*jt;if(this.ctx.clip_path.length!==0){var $r=this.path;Et=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=H(Et,this.posX+this.margin[3],-kt+Wt+this.ctx.prevPageLastElemOffset),he.call(this,"fill",!0),this.path=$r}var ar=JSON.parse(JSON.stringify($e));ar=H([ar],this.posX+this.margin[3],-kt+Wt+this.ctx.prevPageLastElemOffset)[0];var $t=(Lt>Kt||Lt<Zt)&&w.call(this);$t&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],rr,jt,null).clip().discardPath()),this.pdf.addImage(E,"JPEG",ar.x,ar.y,ar.w,ar.h,null,null,Qe),$t&&this.pdf.restoreGraphicsState()}}else this.pdf.addImage(E,"JPEG",$e.x,$e.y,$e.w,$e.h,null,null,Qe)};var k=function(E,U,T){var R=[];U=U||this.pdf.internal.pageSize.width,T=T||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var te=this.posY+this.ctx.prevPageLastElemOffset;switch(E.type){default:case"mt":case"lt":R.push(Math.floor((E.y+te)/T)+1);break;case"arc":R.push(Math.floor((E.y+te-E.radius)/T)+1),R.push(Math.floor((E.y+te+E.radius)/T)+1);break;case"qct":var pe=Be(this.ctx.lastPoint.x,this.ctx.lastPoint.y,E.x1,E.y1,E.x,E.y);R.push(Math.floor((pe.y+te)/T)+1),R.push(Math.floor((pe.y+pe.h+te)/T)+1);break;case"bct":var ye=Je(this.ctx.lastPoint.x,this.ctx.lastPoint.y,E.x1,E.y1,E.x2,E.y2,E.x,E.y);R.push(Math.floor((ye.y+te)/T)+1),R.push(Math.floor((ye.y+ye.h+te)/T)+1);break;case"rect":R.push(Math.floor((E.y+te)/T)+1),R.push(Math.floor((E.y+E.h+te)/T)+1)}for(var ve=0;ve<R.length;ve+=1)for(;this.pdf.internal.getNumberOfPages()<R[ve];)O.call(this);return R},O=function(){var E=this.fillStyle,U=this.strokeStyle,T=this.font,R=this.lineCap,te=this.lineWidth,pe=this.lineJoin;this.pdf.addPage(),this.fillStyle=E,this.strokeStyle=U,this.font=T,this.lineCap=R,this.lineWidth=te,this.lineJoin=pe},H=function(E,U,T){for(var R=0;R<E.length;R++)switch(E[R].type){case"bct":E[R].x2+=U,E[R].y2+=T;case"qct":E[R].x1+=U,E[R].y1+=T;default:E[R].x+=U,E[R].y+=T}return E},q=function(E){return E.sort(function(U,T){return U-T})},X=function(E,U){var T=this.fillStyle,R=this.strokeStyle,te=this.lineCap,pe=this.lineWidth,ye=Math.abs(pe*this.ctx.transform.scaleX),ve=this.lineJoin;if(this.autoPaging){for(var _e,He,Ye=JSON.parse(JSON.stringify(this.path)),nt=JSON.parse(JSON.stringify(this.path)),at=[],Q=0;Q<nt.length;Q++)if(nt[Q].x!==void 0)for(var tt=k.call(this,nt[Q]),Qe=0;Qe<tt.length;Qe+=1)at.indexOf(tt[Qe])===-1&&at.push(tt[Qe]);for(var _t=0;_t<at.length;_t++)for(;this.pdf.internal.getNumberOfPages()<at[_t];)O.call(this);q(at);for(var $e=at[0],Et=at[at.length-1],pt=$e;pt<Et+1;pt++){this.pdf.setPage(pt),this.fillStyle=T,this.strokeStyle=R,this.lineCap=te,this.lineWidth=ye,this.lineJoin=ve;var At=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],Pt=pt===1?this.posY+this.margin[0]:this.margin[0],Kt=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Zt=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],Lt=pt===1?0:Kt+(pt-2)*Zt;if(this.ctx.clip_path.length!==0){var rr=this.path;_e=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=H(_e,this.posX+this.margin[3],-Lt+Pt+this.ctx.prevPageLastElemOffset),he.call(this,E,!0),this.path=rr}if(He=JSON.parse(JSON.stringify(Ye)),this.path=H(He,this.posX+this.margin[3],-Lt+Pt+this.ctx.prevPageLastElemOffset),U===!1||pt===0){var Wt=(pt>$e||pt<Et)&&w.call(this);Wt&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],At,Zt,null).clip().discardPath()),he.call(this,E,U),Wt&&this.pdf.restoreGraphicsState()}this.lineWidth=pe}this.path=Ye}else this.lineWidth=ye,he.call(this,E,U),this.lineWidth=pe},he=function(E,U){if((E!=="stroke"||U||!S.call(this))&&(E==="stroke"||U||!p.call(this))){for(var T,R,te=[],pe=this.path,ye=0;ye<pe.length;ye++){var ve=pe[ye];switch(ve.type){case"begin":te.push({begin:!0});break;case"close":te.push({close:!0});break;case"mt":te.push({start:ve,deltas:[],abs:[]});break;case"lt":var _e=te.length;if(pe[ye-1]&&!isNaN(pe[ye-1].x)&&(T=[ve.x-pe[ye-1].x,ve.y-pe[ye-1].y],_e>0)){for(;_e>=0;_e--)if(te[_e-1].close!==!0&&te[_e-1].begin!==!0){te[_e-1].deltas.push(T),te[_e-1].abs.push(ve);break}}break;case"bct":T=[ve.x1-pe[ye-1].x,ve.y1-pe[ye-1].y,ve.x2-pe[ye-1].x,ve.y2-pe[ye-1].y,ve.x-pe[ye-1].x,ve.y-pe[ye-1].y],te[te.length-1].deltas.push(T);break;case"qct":var He=pe[ye-1].x+2/3*(ve.x1-pe[ye-1].x),Ye=pe[ye-1].y+2/3*(ve.y1-pe[ye-1].y),nt=ve.x+2/3*(ve.x1-ve.x),at=ve.y+2/3*(ve.y1-ve.y),Q=ve.x,tt=ve.y;T=[He-pe[ye-1].x,Ye-pe[ye-1].y,nt-pe[ye-1].x,at-pe[ye-1].y,Q-pe[ye-1].x,tt-pe[ye-1].y],te[te.length-1].deltas.push(T);break;case"arc":te.push({deltas:[],abs:[],arc:!0}),Array.isArray(te[te.length-1].abs)&&te[te.length-1].abs.push(ve)}}R=U?null:E==="stroke"?"stroke":"fill";for(var Qe=!1,_t=0;_t<te.length;_t++)if(te[_t].arc)for(var $e=te[_t].abs,Et=0;Et<$e.length;Et++){var pt=$e[Et];pt.type==="arc"?ee.call(this,pt.x,pt.y,pt.radius,pt.startAngle,pt.endAngle,pt.counterclockwise,void 0,U,!Qe):de.call(this,pt.x,pt.y),Qe=!0}else if(te[_t].close===!0)this.pdf.internal.out("h"),Qe=!1;else if(te[_t].begin!==!0){var At=te[_t].start.x,Pt=te[_t].start.y;ue.call(this,te[_t].deltas,At,Pt),Qe=!0}R&&W.call(this,R),U&&ae.call(this)}},ke=function(E){var U=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,T=U*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return E-T;case"top":return E+U-T;case"hanging":return E+U-2*T;case"middle":return E+U/2-T;default:return E}},re=function(E){return E+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};v.prototype.createLinearGradient=function(){var E=function(){};return E.colorStops=[],E.addColorStop=function(U,T){this.colorStops.push([U,T])},E.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},E.isCanvasGradient=!0,E},v.prototype.createPattern=function(){return this.createLinearGradient()},v.prototype.createRadialGradient=function(){return this.createLinearGradient()};var ee=function(E,U,T,R,te,pe,ye,ve,_e){for(var He=Ne.call(this,T,R,te,pe),Ye=0;Ye<He.length;Ye++){var nt=He[Ye];Ye===0&&(_e?A.call(this,nt.x1+E,nt.y1+U):de.call(this,nt.x1+E,nt.y1+U)),xe.call(this,E,U,nt.x2,nt.y2,nt.x3,nt.y3,nt.x4,nt.y4)}ve?ae.call(this):W.call(this,ye)},W=function(E){switch(E){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},ae=function(){this.pdf.clip(),this.pdf.discardPath()},A=function(E,U){this.pdf.internal.out(e(E)+" "+n(U)+" m")},V=function(E){var U;switch(E.align){case"right":case"end":U="right";break;case"center":U="center";break;default:U="left"}var T,R,te,pe=this.pdf.getTextDimensions(E.text),ye=ke.call(this,E.y),ve=re.call(this,ye)-pe.h,_e=this.ctx.transform.applyToPoint(new o(E.x,ye));if(this.autoPaging){var He=this.ctx.transform.decompose(),Ye=new l;Ye=(Ye=(Ye=Ye.multiply(He.translate)).multiply(He.skew)).multiply(He.scale);for(var nt=this.ctx.transform.applyToRectangle(new s(E.x,ye,pe.w,pe.h)),at=Ye.applyToRectangle(new s(E.x,ve,pe.w,pe.h)),Q=k.call(this,at),tt=[],Qe=0;Qe<Q.length;Qe+=1)tt.indexOf(Q[Qe])===-1&&tt.push(Q[Qe]);q(tt);for(var _t=tt[0],$e=tt[tt.length-1],Et=_t;Et<$e+1;Et++){this.pdf.setPage(Et);var pt=Et===1?this.posY+this.margin[0]:this.margin[0],At=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Pt=this.pdf.internal.pageSize.height-this.margin[2],Kt=Pt-this.margin[0],Zt=this.pdf.internal.pageSize.width-this.margin[1],Lt=Zt-this.margin[3],rr=Et===1?0:At+(Et-2)*Kt;if(this.ctx.clip_path.length!==0){var Wt=this.path;T=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=H(T,this.posX+this.margin[3],-1*rr+pt),he.call(this,"fill",!0),this.path=Wt}var yt=H([JSON.parse(JSON.stringify(at))],this.posX+this.margin[3],-rr+pt+this.ctx.prevPageLastElemOffset)[0];E.scale>=.01&&(R=this.pdf.internal.getFontSize(),this.pdf.setFontSize(R*E.scale),te=this.lineWidth,this.lineWidth=te*E.scale);var jt=this.autoPaging!=="text";if(jt||yt.y+yt.h<=Pt){if(jt||yt.y>=pt&&yt.x<=Zt){var kt=jt?E.text:this.pdf.splitTextToSize(E.text,E.maxWidth||Zt-yt.x)[0],$r=H([JSON.parse(JSON.stringify(nt))],this.posX+this.margin[3],-rr+pt+this.ctx.prevPageLastElemOffset)[0],ar=jt&&(Et>_t||Et<$e)&&w.call(this);ar&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Lt,Kt,null).clip().discardPath()),this.pdf.text(kt,$r.x,$r.y,{angle:E.angle,align:U,renderingMode:E.renderingMode}),ar&&this.pdf.restoreGraphicsState()}}else yt.y<Pt&&(this.ctx.prevPageLastElemOffset+=Pt-yt.y);E.scale>=.01&&(this.pdf.setFontSize(R),this.lineWidth=te)}}else E.scale>=.01&&(R=this.pdf.internal.getFontSize(),this.pdf.setFontSize(R*E.scale),te=this.lineWidth,this.lineWidth=te*E.scale),this.pdf.text(E.text,_e.x+this.posX,_e.y+this.posY,{angle:E.angle,align:U,renderingMode:E.renderingMode,maxWidth:E.maxWidth}),E.scale>=.01&&(this.pdf.setFontSize(R),this.lineWidth=te)},de=function(E,U,T,R){T=T||0,R=R||0,this.pdf.internal.out(e(E+T)+" "+n(U+R)+" l")},ue=function(E,U,T){return this.pdf.lines(E,U,T,null,null)},xe=function(E,U,T,R,te,pe,ye,ve){this.pdf.internal.out([r(i(T+E)),r(a(R+U)),r(i(te+E)),r(a(pe+U)),r(i(ye+E)),r(a(ve+U)),"c"].join(" "))},Ne=function(E,U,T,R){for(var te=2*Math.PI,pe=Math.PI/2;U>T;)U-=te;var ye=Math.abs(T-U);ye<te&&R&&(ye=te-ye);for(var ve=[],_e=R?-1:1,He=U;ye>1e-5;){var Ye=He+_e*Math.min(ye,pe);ve.push(Re.call(this,E,He,Ye)),ye-=Math.abs(Ye-He),He=Ye}return ve},Re=function(E,U,T){var R=(T-U)/2,te=E*Math.cos(R),pe=E*Math.sin(R),ye=te,ve=-pe,_e=ye*ye+ve*ve,He=_e+ye*te+ve*pe,Ye=4/3*(Math.sqrt(2*_e*He)-He)/(ye*pe-ve*te),nt=ye-Ye*ve,at=ve+Ye*ye,Q=nt,tt=-at,Qe=R+U,_t=Math.cos(Qe),$e=Math.sin(Qe);return{x1:E*Math.cos(U),y1:E*Math.sin(U),x2:nt*_t-at*$e,y2:nt*$e+at*_t,x3:Q*_t-tt*$e,y3:Q*$e+tt*_t,x4:E*Math.cos(T),y4:E*Math.sin(T)}},Ee=function(E){return 180*E/Math.PI},Be=function(E,U,T,R,te,pe){var ye=E+.5*(T-E),ve=U+.5*(R-U),_e=te+.5*(T-te),He=pe+.5*(R-pe),Ye=Math.min(E,te,ye,_e),nt=Math.max(E,te,ye,_e),at=Math.min(U,pe,ve,He),Q=Math.max(U,pe,ve,He);return new s(Ye,at,nt-Ye,Q-at)},Je=function(E,U,T,R,te,pe,ye,ve){var _e,He,Ye,nt,at,Q,tt,Qe,_t,$e,Et,pt,At,Pt,Kt=T-E,Zt=R-U,Lt=te-T,rr=pe-R,Wt=ye-te,yt=ve-pe;for(He=0;He<41;He++)_t=(tt=(Ye=E+(_e=He/40)*Kt)+_e*((at=T+_e*Lt)-Ye))+_e*(at+_e*(te+_e*Wt-at)-tt),$e=(Qe=(nt=U+_e*Zt)+_e*((Q=R+_e*rr)-nt))+_e*(Q+_e*(pe+_e*yt-Q)-Qe),He==0?(Et=_t,pt=$e,At=_t,Pt=$e):(Et=Math.min(Et,_t),pt=Math.min(pt,$e),At=Math.max(At,_t),Pt=Math.max(Pt,$e));return new s(Math.round(Et),Math.round(pt),Math.round(At-Et),Math.round(Pt-pt))},qe=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var E,U,T=(E=this.ctx.lineDash,U=this.ctx.lineDashOffset,JSON.stringify({lineDash:E,lineDashOffset:U}));this.prevLineDash!==T&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=T)}}})(bt.API),(function(t){var r=function(o){var s,l,c,f,v,x,p,S,w,k;for(/[^\x00-\xFF]/.test(o),l=[],c=0,f=(o+=s="\0\0\0\0".slice(o.length%4||4)).length;f>c;c+=4)(v=(o.charCodeAt(c)<<24)+(o.charCodeAt(c+1)<<16)+(o.charCodeAt(c+2)<<8)+o.charCodeAt(c+3))!==0?(x=(v=((v=((v=((v=(v-(k=v%85))/85)-(w=v%85))/85)-(S=v%85))/85)-(p=v%85))/85)%85,l.push(x+33,p+33,S+33,w+33,k+33)):l.push(122);return(function(O,H){for(var q=H;q>0;q--)O.pop()})(l,s.length),String.fromCharCode.apply(String,l)+"~>"},e=function(o){var s,l,c,f,v,x=String,p="length",S=255,w="charCodeAt",k="slice",O="replace";for(o[k](-2),o=o[k](0,-2)[O](/\s/g,"")[O]("z","!!!!!"),c=[],f=0,v=(o+=s="uuuuu"[k](o[p]%5||5))[p];v>f;f+=5)l=52200625*(o[w](f)-33)+614125*(o[w](f+1)-33)+7225*(o[w](f+2)-33)+85*(o[w](f+3)-33)+(o[w](f+4)-33),c.push(S&l>>24,S&l>>16,S&l>>8,S&l);return(function(H,q){for(var X=q;X>0;X--)H.pop()})(c,s[p]),x.fromCharCode.apply(x,c)},n=function(o){return o.split("").map(function(s){return("0"+s.charCodeAt().toString(16)).slice(-2)}).join("")+">"},i=function(o){var s=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((o=o.replace(/\s/g,"")).indexOf(">")!==-1&&(o=o.substr(0,o.indexOf(">"))),o.length%2&&(o+="0"),s.test(o)===!1)return"";for(var l="",c=0;c<o.length;c+=2)l+=String.fromCharCode("0x"+(o[c]+o[c+1]));return l},a=function(o){for(var s=new Uint8Array(o.length),l=o.length;l--;)s[l]=o.charCodeAt(l);return(s=Bf(s)).reduce(function(c,f){return c+String.fromCharCode(f)},"")};t.processDataByFilters=function(o,s){var l=0,c=o||"",f=[];for(typeof(s=s||[])=="string"&&(s=[s]),l=0;l<s.length;l+=1)switch(s[l]){case"ASCII85Decode":case"/ASCII85Decode":c=e(c),f.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":c=r(c),f.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":c=i(c),f.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":c=n(c),f.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":c=a(c),f.push("/FlateDecode");break;default:throw new Error('The filter: "'+s[l]+'" is not implemented')}return{data:c,reverseChain:f.reverse().join(" ")}}})(bt.API),(function(t){t.loadFile=function(r,e,n){return(function(i,a,o){a=a!==!1,o=typeof o=="function"?o:function(){};var s=void 0;try{s=(function(l,c,f){var v=new XMLHttpRequest,x=0,p=function(S){var w=S.length,k=[],O=String.fromCharCode;for(x=0;x<w;x+=1)k.push(O(255&S.charCodeAt(x)));return k.join("")};if(v.open("GET",l,!c),v.overrideMimeType("text/plain; charset=x-user-defined"),c===!1&&(v.onload=function(){v.status===200?f(p(this.responseText)):f(void 0)}),v.send(null),c&&v.status===200)return p(v.responseText)})(i,a,o)}catch{}return s})(r,e,n)},t.allowFsRead=void 0,t.loadImageFile=t.loadFile})(bt.API),(function(t){function r(){return(Ut.html2canvas?Promise.resolve(Ut.html2canvas):import("./chunk-KFVPZZ6B.js")).catch(function(s){return Promise.reject(new Error("Could not load html2canvas: "+s))}).then(function(s){return s.default?s.default:s})}function e(){return(Ut.DOMPurify?Promise.resolve(Ut.DOMPurify):import("./chunk-QXSLYJU6.js")).catch(function(s){return Promise.reject(new Error("Could not load dompurify: "+s))}).then(function(s){return s.default?s.default:s})}var n=function(s){var l=Ir(s);return l==="undefined"?"undefined":l==="string"||s instanceof String?"string":l==="number"||s instanceof Number?"number":l==="function"||s instanceof Function?"function":s&&s.constructor===Array?"array":s&&s.nodeType===1?"element":l==="object"?"object":"unknown"},i=function(s,l){var c=document.createElement(s);for(var f in l.className&&(c.className=l.className),l.innerHTML&&l.dompurify&&(c.innerHTML=l.dompurify.sanitize(l.innerHTML)),l.style)c.style[f]=l.style[f];return c},a=function s(l,c){for(var f=l.nodeType===3?document.createTextNode(l.nodeValue):l.cloneNode(!1),v=l.firstChild;v;v=v.nextSibling)c!==!0&&v.nodeType===1&&v.nodeName==="SCRIPT"||f.appendChild(s(v,c));return l.nodeType===1&&(l.nodeName==="CANVAS"?(f.width=l.width,f.height=l.height,f.getContext("2d").drawImage(l,0,0)):l.nodeName!=="TEXTAREA"&&l.nodeName!=="SELECT"||(f.value=l.value),f.addEventListener("load",function(){f.scrollTop=l.scrollTop,f.scrollLeft=l.scrollLeft},!0)),f},o=function s(l){var c=Object.assign(s.convert(Promise.resolve()),JSON.parse(JSON.stringify(s.template))),f=s.convert(Promise.resolve(),c);return(f=f.setProgress(1,s,1,[s])).set(l)};(o.prototype=Object.create(Promise.prototype)).constructor=o,o.convert=function(s,l){return s.__proto__=l||o.prototype,s},o.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},o.prototype.from=function(s,l){return this.then(function(){switch(l=l||(function(c){switch(n(c)){case"string":return"string";case"element":return c.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}})(s),l){case"string":return this.then(e).then(function(c){return this.set({src:i("div",{innerHTML:s,dompurify:c})})});case"element":return this.set({src:s});case"canvas":return this.set({canvas:s});case"img":return this.set({img:s});default:return this.error("Unknown source type.")}})},o.prototype.to=function(s){switch(s){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},o.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var s={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},l=a(this.prop.src,this.opt.html2canvas.javascriptEnabled);l.tagName==="BODY"&&(s.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=i("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=i("div",{className:"html2pdf__container",style:s}),this.prop.container.appendChild(l),this.prop.container.firstChild.appendChild(i("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},o.prototype.toCanvas=function(){var s=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(s).then(r).then(function(l){var c=Object.assign({},this.opt.html2canvas);return delete c.onrendered,l(this.prop.container,c)}).then(function(l){(this.opt.html2canvas.onrendered||function(){})(l),this.prop.canvas=l,document.body.removeChild(this.prop.overlay)})},o.prototype.toContext2d=function(){var s=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(s).then(r).then(function(l){var c=this.opt.jsPDF,f=this.opt.fontFaces,v=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,x=Object.assign({async:!0,allowTaint:!0,scale:v,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete x.onrendered,c.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,c.context2d.posX=this.opt.x,c.context2d.posY=this.opt.y,c.context2d.margin=this.opt.margin,c.context2d.fontFaces=f,f)for(var p=0;p<f.length;++p){var S=f[p],w=S.src.find(function(k){return k.format==="truetype"});w&&c.addFont(w.url,S.ref.name,S.ref.style)}return x.windowHeight=x.windowHeight||0,x.windowHeight=x.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):x.windowHeight,c.context2d.save(!0),l(this.prop.container,x)}).then(function(l){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(l),this.prop.canvas=l,document.body.removeChild(this.prop.overlay)})},o.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var s=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=s})},o.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},o.prototype.output=function(s,l,c){return(c=c||"pdf").toLowerCase()==="img"||c.toLowerCase()==="image"?this.outputImg(s,l):this.outputPdf(s,l)},o.prototype.outputPdf=function(s,l){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(s,l)})},o.prototype.outputImg=function(s){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(s){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+s+'" is not supported.'}})},o.prototype.save=function(s){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(s?{filename:s}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},o.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},o.prototype.set=function(s){if(n(s)!=="object")return this;var l=Object.keys(s||{}).map(function(c){if(c in o.template.prop)return function(){this.prop[c]=s[c]};switch(c){case"margin":return this.setMargin.bind(this,s.margin);case"jsPDF":return function(){return this.opt.jsPDF=s.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,s.pageSize);default:return function(){this.opt[c]=s[c]}}},this);return this.then(function(){return this.thenList(l)})},o.prototype.get=function(s,l){return this.then(function(){var c=s in o.template.prop?this.prop[s]:this.opt[s];return l?l(c):c})},o.prototype.setMargin=function(s){return this.then(function(){switch(n(s)){case"number":s=[s,s,s,s];case"array":if(s.length===2&&(s=[s[0],s[1],s[0],s[1]]),s.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=s}).then(this.setPageSize)},o.prototype.setPageSize=function(s){function l(c,f){return Math.floor(c*f/72*96)}return this.then(function(){(s=s||bt.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(s.inner={width:s.width-this.opt.margin[1]-this.opt.margin[3],height:s.height-this.opt.margin[0]-this.opt.margin[2]},s.inner.px={width:l(s.inner.width,s.k),height:l(s.inner.height,s.k)},s.inner.ratio=s.inner.height/s.inner.width),this.prop.pageSize=s})},o.prototype.setProgress=function(s,l,c,f){return s!=null&&(this.progress.val=s),l!=null&&(this.progress.state=l),c!=null&&(this.progress.n=c),f!=null&&(this.progress.stack=f),this.progress.ratio=this.progress.val/this.progress.state,this},o.prototype.updateProgress=function(s,l,c,f){return this.setProgress(s?this.progress.val+s:null,l||null,c?this.progress.n+c:null,f?this.progress.stack.concat(f):null)},o.prototype.then=function(s,l){var c=this;return this.thenCore(s,l,function(f,v){return c.updateProgress(null,null,1,[f]),Promise.prototype.then.call(this,function(x){return c.updateProgress(null,f),x}).then(f,v).then(function(x){return c.updateProgress(1),x})})},o.prototype.thenCore=function(s,l,c){c=c||Promise.prototype.then;var f=this;s&&(s=s.bind(f)),l&&(l=l.bind(f));var v=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?f:o.convert(Object.assign({},f),Promise.prototype),x=c.call(v,s,l);return o.convert(x,f.__proto__)},o.prototype.thenExternal=function(s,l){return Promise.prototype.then.call(this,s,l)},o.prototype.thenList=function(s){var l=this;return s.forEach(function(c){l=l.thenCore(c)}),l},o.prototype.catch=function(s){s&&(s=s.bind(this));var l=Promise.prototype.catch.call(this,s);return o.convert(l,this)},o.prototype.catchExternal=function(s){return Promise.prototype.catch.call(this,s)},o.prototype.error=function(s){return this.then(function(){throw new Error(s)})},o.prototype.using=o.prototype.set,o.prototype.saveAs=o.prototype.save,o.prototype.export=o.prototype.output,o.prototype.run=o.prototype.then,bt.getPageSize=function(s,l,c){if(Ir(s)==="object"){var f=s;s=f.orientation,l=f.unit||l,c=f.format||c}l=l||"mm",c=c||"a4",s=(""+(s||"P")).toLowerCase();var v,x=(""+c).toLowerCase(),p={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(l){case"pt":v=1;break;case"mm":v=72/25.4;break;case"cm":v=72/2.54;break;case"in":v=72;break;case"px":v=.75;break;case"pc":case"em":v=12;break;case"ex":v=6;break;default:throw"Invalid unit: "+l}var S,w=0,k=0;if(p.hasOwnProperty(x))w=p[x][1]/v,k=p[x][0]/v;else try{w=c[1],k=c[0]}catch{throw new Error("Invalid format: "+c)}if(s==="p"||s==="portrait")s="p",k>w&&(S=k,k=w,w=S);else{if(s!=="l"&&s!=="landscape")throw"Invalid orientation: "+s;s="l",w>k&&(S=k,k=w,w=S)}return{width:k,height:w,unit:l,k:v,orientation:s}},t.html=function(s,l){(l=l||{}).callback=l.callback||function(){},l.html2canvas=l.html2canvas||{},l.html2canvas.canvas=l.html2canvas.canvas||this.canvas,l.jsPDF=l.jsPDF||this,l.fontFaces=l.fontFaces?l.fontFaces.map(ym):null;var c=new o(l);return l.worker?c:c.from(s).doCallback()}})(bt.API),bt.API.addJS=function(t){return qx=t,this.internal.events.subscribe("postPutResources",function(){lu=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(lu+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),Wx=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+qx+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){lu!==void 0&&Wx!==void 0&&this.internal.out("/Names <</JavaScript "+lu+" 0 R>>")}),this},(function(t){var r;t.events.push(["postPutResources",function(){var e=this,n=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var i=e.outline.render().split(/\r\n/),a=0;a<i.length;a++){var o=i[a],s=n.exec(o);if(s!=null){var l=s[1];e.internal.newObjectDeferredBegin(l,!1)}e.internal.write(o)}if(this.outline.createNamedDestinations){var c=this.internal.pages.length,f=[];for(a=0;a<c;a++){var v=e.internal.newObject();f.push(v);var x=e.internal.getPageInfo(a+1);e.internal.write("<< /D["+x.objId+" 0 R /XYZ null null null]>> endobj")}var p=e.internal.newObject();for(e.internal.write("<< /Names [ "),a=0;a<f.length;a++)e.internal.write("(page_"+(a+1)+")"+f[a]+" 0 R");e.internal.write(" ] >>","endobj"),r=e.internal.newObject(),e.internal.write("<< /Dests "+p+" 0 R"),e.internal.write(">>","endobj")}}]),t.events.push(["putCatalog",function(){var e=this;e.outline.root.children.length>0&&(e.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&e.internal.write("/Names "+r+" 0 R"))}]),t.events.push(["initialized",function(){var e=this;e.outline={createNamedDestinations:!1,root:{children:[]}},e.outline.add=function(n,i,a){var o={title:i,options:a,children:[]};return n==null&&(n=this.root),n.children.push(o),o},e.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=e,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},e.outline.genIds_r=function(n){n.id=e.internal.newObjectDeferred();for(var i=0;i<n.children.length;i++)this.genIds_r(n.children[i])},e.outline.renderRoot=function(n){this.objStart(n),this.line("/Type /Outlines"),n.children.length>0&&(this.line("/First "+this.makeRef(n.children[0])),this.line("/Last "+this.makeRef(n.children[n.children.length-1]))),this.line("/Count "+this.count_r({count:0},n)),this.objEnd()},e.outline.renderItems=function(n){for(var i=this.ctx.pdf.internal.getVerticalCoordinateString,a=0;a<n.children.length;a++){var o=n.children[a];this.objStart(o),this.line("/Title "+this.makeString(o.title)),this.line("/Parent "+this.makeRef(n)),a>0&&this.line("/Prev "+this.makeRef(n.children[a-1])),a<n.children.length-1&&this.line("/Next "+this.makeRef(n.children[a+1])),o.children.length>0&&(this.line("/First "+this.makeRef(o.children[0])),this.line("/Last "+this.makeRef(o.children[o.children.length-1])));var s=this.count=this.count_r({count:0},o);if(s>0&&this.line("/Count "+s),o.options&&o.options.pageNumber){var l=e.internal.getPageInfo(o.options.pageNumber);this.line("/Dest ["+l.objId+" 0 R /XYZ 0 "+i(0)+" 0]")}this.objEnd()}for(var c=0;c<n.children.length;c++)this.renderItems(n.children[c])},e.outline.line=function(n){this.ctx.val+=n+`\r
`},e.outline.makeRef=function(n){return n.id+" 0 R"},e.outline.makeString=function(n){return"("+e.internal.pdfEscape(n)+")"},e.outline.objStart=function(n){this.ctx.val+=`\r
`+n.id+` 0 obj\r
<<\r
`},e.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},e.outline.count_r=function(n,i){for(var a=0;a<i.children.length;a++)n.count++,this.count_r(n,i.children[a]);return n.count}}])})(bt.API),(function(t){var r=[192,193,194,195,196,197,198,199];t.processJPEG=function(e,n,i,a,o,s){var l,c=this.decode.DCT_DECODE,f=null;if(typeof e=="string"||this.__addimage__.isArrayBuffer(e)||this.__addimage__.isArrayBufferView(e)){switch(e=o||e,e=this.__addimage__.isArrayBuffer(e)?new Uint8Array(e):e,l=(function(v){for(var x,p=256*v.charCodeAt(4)+v.charCodeAt(5),S=v.length,w={width:0,height:0,numcomponents:1},k=4;k<S;k+=2){if(k+=p,r.indexOf(v.charCodeAt(k+1))!==-1){x=256*v.charCodeAt(k+5)+v.charCodeAt(k+6),w={width:256*v.charCodeAt(k+7)+v.charCodeAt(k+8),height:x,numcomponents:v.charCodeAt(k+9)};break}p=256*v.charCodeAt(k+2)+v.charCodeAt(k+3)}return w})(e=this.__addimage__.isArrayBufferView(e)?this.__addimage__.arrayBufferToBinaryString(e):e),l.numcomponents){case 1:s=this.color_spaces.DEVICE_GRAY;break;case 4:s=this.color_spaces.DEVICE_CMYK;break;case 3:s=this.color_spaces.DEVICE_RGB}f={data:e,width:l.width,height:l.height,colorSpace:s,bitsPerComponent:8,filter:c,index:n,alias:i}}return f}})(bt.API),bt.API.processPNG=function(t,r,e,n){if(this.__addimage__.isArrayBuffer(t)&&(t=new Uint8Array(t)),this.__addimage__.isArrayBufferView(t)){var i,a=Fx(t,{checkCrc:!0}),o=a.width,s=a.height,l=a.channels,c=a.palette,f=a.depth;i=c&&l===1?(function(ee){for(var W=ee.width,ae=ee.height,A=ee.data,V=ee.palette,de=ee.depth,ue=!1,xe=[],Ne=[],Re=void 0,Ee=!1,Be=0,Je=0;Je<V.length;Je++){var qe=Dp(V[Je],4),E=qe[0],U=qe[1],T=qe[2],R=qe[3];xe.push(E,U,T),R!=null&&(R===0?(Be++,Ne.length<1&&Ne.push(Je)):R<255&&(Ee=!0))}if(Ee||Be>1){ue=!0,Ne=void 0;var te=W*ae;Re=new Uint8Array(te);for(var pe=new DataView(A.buffer),ye=0;ye<te;ye++){var ve=Sm(pe,ye,de),_e=Dp(V[ve],4)[3];Re[ye]=_e}}else Be===0&&(Ne=void 0);return{colorSpace:"Indexed",colorsPerPixel:1,sMaskBitsPerComponent:ue?8:void 0,colorBytes:A,alphaBytes:Re,needSMask:ue,palette:xe,mask:Ne}})(a):l===2||l===4?(function(ee){for(var W=ee.data,ae=ee.width,A=ee.height,V=ee.channels,de=ee.depth,ue=V===2?"DeviceGray":"DeviceRGB",xe=V-1,Ne=ae*A,Re=xe,Ee=Ne*Re,Be=1*Ne,Je=Math.ceil(Ee*de/8),qe=Math.ceil(Be*de/8),E=new Uint8Array(Je),U=new Uint8Array(qe),T=new DataView(W.buffer),R=new DataView(E.buffer),te=new DataView(U.buffer),pe=!1,ye=0;ye<Ne;ye++){for(var ve=ye*V,_e=0;_e<Re;_e++)eb(R,Sm(T,ve+_e,de),ye*Re+_e,de);var He=Sm(T,ve+Re,de);He<(1<<de)-1&&(pe=!0),eb(te,He,1*ye,de)}return{colorSpace:ue,colorsPerPixel:xe,sMaskBitsPerComponent:pe?de:void 0,colorBytes:E,alphaBytes:U,needSMask:pe}})(a):(function(ee){var W=ee.data,ae=ee.channels===1?"DeviceGray":"DeviceRGB";return{colorSpace:ae,colorsPerPixel:ae==="DeviceGray"?1:3,colorBytes:W instanceof Uint16Array?(function(A){for(var V=A.length,de=new Uint8Array(2*V),ue=new DataView(de.buffer,de.byteOffset,de.byteLength),xe=0;xe<V;xe++)ue.setUint16(2*xe,A[xe],!1);return de})(W):W,needSMask:!1}})(a);var v,x,p,S=i,w=S.colorSpace,k=S.colorsPerPixel,O=S.sMaskBitsPerComponent,H=S.colorBytes,q=S.alphaBytes,X=S.needSMask,he=S.palette,ke=S.mask,re=null;return n!==bt.API.image_compression.NONE&&typeof Bf=="function"?(re=(function(ee){var W;switch(ee){case bt.API.image_compression.FAST:W=11;break;case bt.API.image_compression.MEDIUM:W=13;break;case bt.API.image_compression.SLOW:W=14;break;default:W=12}return W})(n),v=this.decode.FLATE_DECODE,x="/Predictor ".concat(re," /Colors ").concat(k," /BitsPerComponent ").concat(f," /Columns ").concat(o),t=Yx(H,Math.ceil(o*k*f/8),k,f,n),X&&(p=Yx(q,Math.ceil(o*O/8),1,O,n))):(v=void 0,x=void 0,t=H,X&&(p=q)),(this.__addimage__.isArrayBuffer(t)||this.__addimage__.isArrayBufferView(t))&&(t=this.__addimage__.arrayBufferToBinaryString(t)),(p&&this.__addimage__.isArrayBuffer(p)||this.__addimage__.isArrayBufferView(p))&&(p=this.__addimage__.arrayBufferToBinaryString(p)),{alias:e,data:t,index:r,filter:v,decodeParameters:x,transparency:ke,palette:he,sMask:p,predictor:re,width:o,height:s,bitsPerComponent:f,sMaskBitsPerComponent:O,colorSpace:w}}},(function(t){t.processGIF89A=function(r,e,n,i){var a=new D8(r),o=a.width,s=a.height,l=[];a.decodeAndBlitFrameRGBA(0,l);var c={data:l,width:o,height:s},f=new km(100).encode(c,100);return t.processJPEG.call(this,f,e,n,i)},t.processGIF87A=t.processGIF89A})(bt.API),Wa.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var t=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(t);for(var r=0;r<t;r++){var e=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0);this.palette[r]={red:i,green:n,blue:e,quad:a}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},Wa.prototype.parseBGR=function(){this.pos=this.offset;try{var t="bit"+this.bitPP,r=this.width*this.height*4;this.data=new Uint8Array(r),this[t]()}catch(e){Br.log("bit decode error:"+e)}},Wa.prototype.bit1=function(){var t,r=Math.ceil(this.width/8),e=r%4;for(t=this.height-1;t>=0;t--){for(var n=this.bottom_up?t:this.height-1-t,i=0;i<r;i++)for(var a=this.datav.getUint8(this.pos++,!0),o=n*this.width*4+8*i*4,s=0;s<8&&8*i+s<this.width;s++){var l=this.palette[a>>7-s&1];this.data[o+4*s]=l.blue,this.data[o+4*s+1]=l.green,this.data[o+4*s+2]=l.red,this.data[o+4*s+3]=255}e!==0&&(this.pos+=4-e)}},Wa.prototype.bit4=function(){for(var t=Math.ceil(this.width/2),r=t%4,e=this.height-1;e>=0;e--){for(var n=this.bottom_up?e:this.height-1-e,i=0;i<t;i++){var a=this.datav.getUint8(this.pos++,!0),o=n*this.width*4+2*i*4,s=a>>4,l=15&a,c=this.palette[s];if(this.data[o]=c.blue,this.data[o+1]=c.green,this.data[o+2]=c.red,this.data[o+3]=255,2*i+1>=this.width)break;c=this.palette[l],this.data[o+4]=c.blue,this.data[o+4+1]=c.green,this.data[o+4+2]=c.red,this.data[o+4+3]=255}r!==0&&(this.pos+=4-r)}},Wa.prototype.bit8=function(){for(var t=this.width%4,r=this.height-1;r>=0;r--){for(var e=this.bottom_up?r:this.height-1-r,n=0;n<this.width;n++){var i=this.datav.getUint8(this.pos++,!0),a=e*this.width*4+4*n;if(i<this.palette.length){var o=this.palette[i];this.data[a]=o.red,this.data[a+1]=o.green,this.data[a+2]=o.blue,this.data[a+3]=255}else this.data[a]=255,this.data[a+1]=255,this.data[a+2]=255,this.data[a+3]=255}t!==0&&(this.pos+=4-t)}},Wa.prototype.bit15=function(){for(var t=this.width%3,r=parseInt("11111",2),e=this.height-1;e>=0;e--){for(var n=this.bottom_up?e:this.height-1-e,i=0;i<this.width;i++){var a=this.datav.getUint16(this.pos,!0);this.pos+=2;var o=(a&r)/r*255|0,s=(a>>5&r)/r*255|0,l=(a>>10&r)/r*255|0,c=a>>15?255:0,f=n*this.width*4+4*i;this.data[f]=l,this.data[f+1]=s,this.data[f+2]=o,this.data[f+3]=c}this.pos+=t}},Wa.prototype.bit16=function(){for(var t=this.width%3,r=parseInt("11111",2),e=parseInt("111111",2),n=this.height-1;n>=0;n--){for(var i=this.bottom_up?n:this.height-1-n,a=0;a<this.width;a++){var o=this.datav.getUint16(this.pos,!0);this.pos+=2;var s=(o&r)/r*255|0,l=(o>>5&e)/e*255|0,c=(o>>11)/r*255|0,f=i*this.width*4+4*a;this.data[f]=c,this.data[f+1]=l,this.data[f+2]=s,this.data[f+3]=255}this.pos+=t}},Wa.prototype.bit24=function(){for(var t=this.height-1;t>=0;t--){for(var r=this.bottom_up?t:this.height-1-t,e=0;e<this.width;e++){var n=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),o=r*this.width*4+4*e;this.data[o]=a,this.data[o+1]=i,this.data[o+2]=n,this.data[o+3]=255}this.pos+=this.width%4}},Wa.prototype.bit32=function(){for(var t=this.height-1;t>=0;t--)for(var r=this.bottom_up?t:this.height-1-t,e=0;e<this.width;e++){var n=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),o=this.datav.getUint8(this.pos++,!0),s=r*this.width*4+4*e;this.data[s]=a,this.data[s+1]=i,this.data[s+2]=n,this.data[s+3]=o}},Wa.prototype.getData=function(){return this.data},(function(t){t.processBMP=function(r,e,n,i){var a=new Wa(r,!1),o=a.width,s=a.height,l={data:a.getData(),width:o,height:s},c=new km(100).encode(l,100);return t.processJPEG.call(this,c,e,n,i)}})(bt.API),rb.prototype.getData=function(){return this.data},(function(t){t.processWEBP=function(r,e,n,i){var a=new rb(r),o=a.width,s=a.height,l={data:a.getData(),width:o,height:s},c=new km(100).encode(l,100);return t.processJPEG.call(this,c,e,n,i)}})(bt.API),bt.API.processRGBA=function(t,r,e){for(var n=t.data,i=n.length,a=new Uint8Array(i/4*3),o=new Uint8Array(i/4),s=0,l=0,c=0;c<i;c+=4){var f=n[c],v=n[c+1],x=n[c+2],p=n[c+3];a[s++]=f,a[s++]=v,a[s++]=x,o[l++]=p}var S=this.__addimage__.arrayBufferToBinaryString(a);return{alpha:this.__addimage__.arrayBufferToBinaryString(o),data:S,index:r,alias:e,colorSpace:"DeviceRGB",bitsPerComponent:8,width:t.width,height:t.height}},bt.API.setLanguage=function(t){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[t]!==void 0&&(this.internal.languageSettings.languageCode=t,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},Sc=bt.API,cu=Sc.getCharWidthsArray=function(t,r){var e,n,i=(r=r||{}).font||this.internal.getFont(),a=r.fontSize||this.internal.getFontSize(),o=r.charSpace||this.internal.getCharSpace(),s=r.widths?r.widths:i.metadata.Unicode.widths,l=s.fof?s.fof:1,c=r.kerning?r.kerning:i.metadata.Unicode.kerning,f=c.fof?c.fof:1,v=r.doKerning!==!1,x=0,p=t.length,S=0,w=s[0]||l,k=[];for(e=0;e<p;e++)n=t.charCodeAt(e),typeof i.metadata.widthOfString=="function"?k.push((i.metadata.widthOfGlyph(i.metadata.characterToGlyph(n))+o*(1e3/a)||0)/1e3):(x=v&&Ir(c[n])==="object"&&!isNaN(parseInt(c[n][S],10))?c[n][S]/f:0,k.push((s[n]||w)/l+x)),S=n;return k},Gx=Sc.getStringUnitWidth=function(t,r){var e=(r=r||{}).fontSize||this.internal.getFontSize(),n=r.font||this.internal.getFont(),i=r.charSpace||this.internal.getCharSpace();return Sc.processArabic&&(t=Sc.processArabic(t)),typeof n.metadata.widthOfString=="function"?n.metadata.widthOfString(t,e,i)/e:cu.apply(this,arguments).reduce(function(a,o){return a+o},0)},$x=function(t,r,e,n){for(var i=[],a=0,o=t.length,s=0;a!==o&&s+r[a]<e;)s+=r[a],a++;i.push(t.slice(0,a));var l=a;for(s=0;a!==o;)s+r[a]>n&&(i.push(t.slice(l,a)),s=0,l=a),s+=r[a],a++;return l!==a&&i.push(t.slice(l,a)),i},Xx=function(t,r,e){e||(e={});var n,i,a,o,s,l,c,f=[],v=[f],x=e.textIndent||0,p=0,S=0,w=t.split(" "),k=cu.apply(this,[" ",e])[0];if(l=e.lineIndent===-1?w[0].length+2:e.lineIndent||0){var O=Array(l).join(" "),H=[];w.map(function(X){(X=X.split(/\s*\n/)).length>1?H=H.concat(X.map(function(he,ke){return(ke&&he.length?`
`:"")+he})):H.push(X[0])}),w=H,l=Gx.apply(this,[O,e])}for(a=0,o=w.length;a<o;a++){var q=0;if(n=w[a],l&&n[0]==`
`&&(n=n.substr(1),q=1),x+p+(S=(i=cu.apply(this,[n,e])).reduce(function(X,he){return X+he},0))>r||q){if(S>r){for(s=$x.apply(this,[n,i,r-(x+p),r]),f.push(s.shift()),f=[s.pop()];s.length;)v.push([s.shift()]);S=i.slice(n.length-(f[0]?f[0].length:0)).reduce(function(X,he){return X+he},0)}else f=[n];v.push(f),x=S+l,p=k}else f.push(n),x+=p+S,p=k}return c=l?function(X,he){return(he?O:"")+X.join(" ")}:function(X){return X.join(" ")},v.map(c)},Sc.splitTextToSize=function(t,r,e){var n,i=(e=e||{}).fontSize||this.internal.getFontSize(),a=function(f){if(f.widths&&f.kerning)return{widths:f.widths,kerning:f.kerning};var v=this.internal.getFont(f.fontName,f.fontStyle),x="Unicode";return v.metadata[x]?{widths:v.metadata[x].widths||{0:1},kerning:v.metadata[x].kerning||{}}:{font:v.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}.call(this,e);n=Array.isArray(t)?t:String(t).split(/\r?\n/);var o=1*this.internal.scaleFactor*r/i;a.textIndent=e.textIndent?1*e.textIndent*this.internal.scaleFactor/i:0,a.lineIndent=e.lineIndent;var s,l,c=[];for(s=0,l=n.length;s<l;s++)c=c.concat(Xx.apply(this,[n[s],o,a]));return c},(function(t){t.__fontmetrics__=t.__fontmetrics__||{};for(var r="0123456789abcdef",e="klmnopqrstuvwxyz",n={},i={},a=0;a<16;a++)n[e[a]]=r[a],i[r[a]]=e[a];var o=function(x){return"0x"+parseInt(x,10).toString(16)},s=t.__fontmetrics__.compress=function(x){var p,S,w,k,O=["{"];for(var H in x){if(p=x[H],isNaN(parseInt(H,10))?S="'"+H+"'":(H=parseInt(H,10),S=(S=o(H).slice(2)).slice(0,-1)+i[S.slice(-1)]),typeof p=="number")p<0?(w=o(p).slice(3),k="-"):(w=o(p).slice(2),k=""),w=k+w.slice(0,-1)+i[w.slice(-1)];else{if(Ir(p)!=="object")throw new Error("Don't know what to do with value type "+Ir(p)+".");w=s(p)}O.push(S+w)}return O.push("}"),O.join("")},l=t.__fontmetrics__.uncompress=function(x){if(typeof x!="string")throw new Error("Invalid argument passed to uncompress.");for(var p,S,w,k,O={},H=1,q=O,X=[],he="",ke="",re=x.length-1,ee=1;ee<re;ee+=1)(k=x[ee])=="'"?p?(w=p.join(""),p=void 0):p=[]:p?p.push(k):k=="{"?(X.push([q,w]),q={},w=void 0):k=="}"?((S=X.pop())[0][S[1]]=q,w=void 0,q=S[0]):k=="-"?H=-1:w===void 0?n.hasOwnProperty(k)?(he+=n[k],w=parseInt(he,16)*H,H=1,he=""):he+=k:n.hasOwnProperty(k)?(ke+=n[k],q[w]=parseInt(ke,16)*H,H=1,w=void 0,ke=""):ke+=k;return O},c={codePages:["WinAnsiEncoding"],WinAnsiEncoding:l("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},f={Unicode:{Courier:c,"Courier-Bold":c,"Courier-BoldOblique":c,"Courier-Oblique":c,Helvetica:c,"Helvetica-Bold":c,"Helvetica-BoldOblique":c,"Helvetica-Oblique":c,"Times-Roman":c,"Times-Bold":c,"Times-BoldItalic":c,"Times-Italic":c}},v={Unicode:{"Courier-Oblique":l("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":l("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":l("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:l("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":l("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":l("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:l("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:l("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":l("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:l("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":l("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":l("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":l("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":l("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};t.events.push(["addFont",function(x){var p=x.font,S=v.Unicode[p.postScriptName];S&&(p.metadata.Unicode={},p.metadata.Unicode.widths=S.widths,p.metadata.Unicode.kerning=S.kerning);var w=f.Unicode[p.postScriptName];w&&(p.metadata.Unicode.encoding=w,p.encoding=w.codePages[0])}])})(bt.API),(function(t){var r=function(e){for(var n=e.length,i=new Uint8Array(n),a=0;a<n;a++)i[a]=e.charCodeAt(a);return i};t.API.events.push(["addFont",function(e){var n=void 0,i=e.font,a=e.instance;if(!i.isStandardFont){if(a===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+i.postScriptName+"').");if(typeof(n=a.existsFileInVFS(i.postScriptName)===!1?a.loadFile(i.postScriptName):a.getFileFromVFS(i.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+i.postScriptName+"').");(function(o,s){s=/^\x00\x01\x00\x00/.test(s)?r(s):r(du(s)),o.metadata=t.API.TTFFont.open(s),o.metadata.Unicode=o.metadata.Unicode||{encoding:{},kerning:{},widths:[]},o.metadata.glyIdsUsed=[0]})(i,n)}}])})(bt),bt.API.addSvgAsImage=function(t,r,e,n,i,a,o,s){if(isNaN(r)||isNaN(e))throw Br.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(n)||isNaN(i))throw Br.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var l=document.createElement("canvas");l.width=n,l.height=i;var c=l.getContext("2d");c.fillStyle="#fff",c.fillRect(0,0,l.width,l.height);var f={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},v=this;return(Ut.canvg?Promise.resolve(Ut.canvg):import("./chunk-JQDNZCUM.js")).catch(function(x){return Promise.reject(new Error("Could not load canvg: "+x))}).then(function(x){return x.default?x.default:x}).then(function(x){return x.fromString(c,t,f)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(x){return x.render(f)}).then(function(){v.addImage(l.toDataURL("image/jpeg",1),r,e,n,i,o,s)})},bt.API.putTotalPages=function(t){var r,e=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(r=new RegExp(t,"g"),e=this.internal.getNumberOfPages()):(r=new RegExp(this.pdfEscape16(t,this.internal.getFont()),"g"),e=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var n=1;n<=this.internal.getNumberOfPages();n++)for(var i=0;i<this.internal.pages[n].length;i++)this.internal.pages[n][i]=this.internal.pages[n][i].replace(r,e);return this},bt.API.viewerPreferences=function(t,r){var e;t=t||{},r=r||!1;var n,i,a,o={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},s=Object.keys(o),l=[],c=0,f=0,v=0;function x(S,w){var k,O=!1;for(k=0;k<S.length;k+=1)S[k]===w&&(O=!0);return O}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(o)),this.internal.viewerpreferences.isSubscribed=!1),e=this.internal.viewerpreferences.configuration,t==="reset"||r===!0){var p=s.length;for(v=0;v<p;v+=1)e[s[v]].value=e[s[v]].defaultValue,e[s[v]].explicitSet=!1}if(Ir(t)==="object"){for(i in t)if(a=t[i],x(s,i)&&a!==void 0){if(e[i].type==="boolean"&&typeof a=="boolean")e[i].value=a;else if(e[i].type==="name"&&x(e[i].valueSet,a))e[i].value=a;else if(e[i].type==="integer"&&Number.isInteger(a))e[i].value=a;else if(e[i].type==="array"){for(c=0;c<a.length;c+=1)if(n=!0,a[c].length===1&&typeof a[c][0]=="number")l.push(String(a[c]-1));else if(a[c].length>1){for(f=0;f<a[c].length;f+=1)typeof a[c][f]!="number"&&(n=!1);n===!0&&l.push([a[c][0]-1,a[c][1]-1].join(" "))}e[i].value="["+l.join(" ")+"]"}else e[i].value=e[i].defaultValue;e[i].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){var S,w=[];for(S in e)e[S].explicitSet===!0&&(e[S].type==="name"?w.push("/"+S+" /"+e[S].value):w.push("/"+S+" "+e[S].value));w.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+w.join(`
`)+`
>>`)}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=e,this},(function(t){var r=function(){var n='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',i=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),a=unescape(encodeURIComponent(n)),o=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),s=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),l=unescape(encodeURIComponent("</x:xmpmeta>")),c=a.length+o.length+s.length+i.length+l.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+c+" >>"),this.internal.write("stream"),this.internal.write(i+a+o+s+l),this.internal.write("endstream"),this.internal.write("endobj")},e=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};t.addMetadata=function(n,i){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:n,namespaceuri:i||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",e),this.internal.events.subscribe("postPutResources",r)),this}})(bt.API),(function(t){var r=t.API,e=r.pdfEscape16=function(a,o){for(var s,l=o.metadata.Unicode.widths,c=["","0","00","000","0000"],f=[""],v=0,x=a.length;v<x;++v){if(s=o.metadata.characterToGlyph(a.charCodeAt(v)),o.metadata.glyIdsUsed.push(s),o.metadata.toUnicode[s]=a.charCodeAt(v),l.indexOf(s)==-1&&(l.push(s),l.push([parseInt(o.metadata.widthOfGlyph(s),10)])),s=="0")return f.join("");s=s.toString(16),f.push(c[4-s.length],s)}return f.join("")},n=function(a){var o,s,l,c,f,v,x;for(f=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,l=[],v=0,x=(s=Object.keys(a).sort(function(p,S){return p-S})).length;v<x;v++)o=s[v],l.length>=100&&(f+=`
`+l.length+` beginbfchar
`+l.join(`
`)+`
endbfchar`,l=[]),a[o]!==void 0&&a[o]!==null&&typeof a[o].toString=="function"&&(c=("0000"+a[o].toString(16)).slice(-4),o=("0000"+(+o).toString(16)).slice(-4),l.push("<"+o+"><"+c+">"));return l.length&&(f+=`
`+l.length+` beginbfchar
`+l.join(`
`)+`
endbfchar
`),f+`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};r.events.push(["putFont",function(a){(function(o){var s=o.font,l=o.out,c=o.newObject,f=o.putStream;if(s.metadata instanceof t.API.TTFFont&&s.encoding==="Identity-H"){for(var v=s.metadata.Unicode.widths,x=s.metadata.subset.encode(s.metadata.glyIdsUsed,1),p="",S=0;S<x.length;S++)p+=String.fromCharCode(x[S]);var w=c();f({data:p,addLength1:!0,objectId:w}),l("endobj");var k=c();f({data:n(s.metadata.toUnicode),addLength1:!0,objectId:k}),l("endobj");var O=c();l("<<"),l("/Type /FontDescriptor"),l("/FontName /"+Ec(s.fontName)),l("/FontFile2 "+w+" 0 R"),l("/FontBBox "+t.API.PDFObject.convert(s.metadata.bbox)),l("/Flags "+s.metadata.flags),l("/StemV "+s.metadata.stemV),l("/ItalicAngle "+s.metadata.italicAngle),l("/Ascent "+s.metadata.ascender),l("/Descent "+s.metadata.decender),l("/CapHeight "+s.metadata.capHeight),l(">>"),l("endobj");var H=c();l("<<"),l("/Type /Font"),l("/BaseFont /"+Ec(s.fontName)),l("/FontDescriptor "+O+" 0 R"),l("/W "+t.API.PDFObject.convert(v)),l("/CIDToGIDMap /Identity"),l("/DW 1000"),l("/Subtype /CIDFontType2"),l("/CIDSystemInfo"),l("<<"),l("/Supplement 0"),l("/Registry (Adobe)"),l("/Ordering ("+s.encoding+")"),l(">>"),l(">>"),l("endobj"),s.objectNumber=c(),l("<<"),l("/Type /Font"),l("/Subtype /Type0"),l("/ToUnicode "+k+" 0 R"),l("/BaseFont /"+Ec(s.fontName)),l("/Encoding /"+s.encoding),l("/DescendantFonts ["+H+" 0 R]"),l(">>"),l("endobj"),s.isAlreadyPutted=!0}})(a)}]),r.events.push(["putFont",function(a){(function(o){var s=o.font,l=o.out,c=o.newObject,f=o.putStream;if(s.metadata instanceof t.API.TTFFont&&s.encoding==="WinAnsiEncoding"){for(var v=s.metadata.rawData,x="",p=0;p<v.length;p++)x+=String.fromCharCode(v[p]);var S=c();f({data:x,addLength1:!0,objectId:S}),l("endobj");var w=c();f({data:n(s.metadata.toUnicode),addLength1:!0,objectId:w}),l("endobj");var k=c();l("<<"),l("/Descent "+s.metadata.decender),l("/CapHeight "+s.metadata.capHeight),l("/StemV "+s.metadata.stemV),l("/Type /FontDescriptor"),l("/FontFile2 "+S+" 0 R"),l("/Flags 96"),l("/FontBBox "+t.API.PDFObject.convert(s.metadata.bbox)),l("/FontName /"+Ec(s.fontName)),l("/ItalicAngle "+s.metadata.italicAngle),l("/Ascent "+s.metadata.ascender),l(">>"),l("endobj"),s.objectNumber=c();for(var O=0;O<s.metadata.hmtx.widths.length;O++)s.metadata.hmtx.widths[O]=parseInt(s.metadata.hmtx.widths[O]*(1e3/s.metadata.head.unitsPerEm));l("<</Subtype/TrueType/Type/Font/ToUnicode "+w+" 0 R/BaseFont/"+Ec(s.fontName)+"/FontDescriptor "+k+" 0 R/Encoding/"+s.encoding+" /FirstChar 29 /LastChar 255 /Widths "+t.API.PDFObject.convert(s.metadata.hmtx.widths)+">>"),l("endobj"),s.isAlreadyPutted=!0}})(a)}]);var i=function(a){var o,s=a.text||"",l=a.x,c=a.y,f=a.options||{},v=a.mutex||{},x=v.pdfEscape,p=v.activeFontKey,S=v.fonts,w=p,k="",O=0,H="",q=S[w].encoding;if(S[w].encoding!=="Identity-H")return{text:s,x:l,y:c,options:f,mutex:v};for(H=s,w=p,Array.isArray(s)&&(H=s[0]),O=0;O<H.length;O+=1)S[w].metadata.hasOwnProperty("cmap")&&(o=S[w].metadata.cmap.unicode.codeMap[H[O].charCodeAt(0)]),o||H[O].charCodeAt(0)<256&&S[w].metadata.hasOwnProperty("Unicode")?k+=H[O]:k+="";var X="";return parseInt(w.slice(1))<14||q==="WinAnsiEncoding"?X=x(k,w).split("").map(function(he){return he.charCodeAt(0).toString(16)}).join(""):q==="Identity-H"&&(X=e(k,S[w])),v.isHex=!0,{text:X,x:l,y:c,options:f,mutex:v}};r.events.push(["postProcessText",function(a){var o=a.text||"",s=[],l={text:o,x:a.x,y:a.y,options:a.options,mutex:a.mutex};if(Array.isArray(o)){var c=0;for(c=0;c<o.length;c+=1)Array.isArray(o[c])&&o[c].length===3?s.push([i(Object.assign({},l,{text:o[c][0]})).text,o[c][1],o[c][2]]):s.push(i(Object.assign({},l,{text:o[c]})).text);a.text=s}else a.text=i(Object.assign({},l,{text:o})).text}])})(bt),(function(t){var r=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};t.existsFileInVFS=function(e){return r.call(this),this.internal.vFS[e]!==void 0},t.addFileToVFS=function(e,n){return r.call(this),this.internal.vFS[e]=n,this},t.getFileFromVFS=function(e){return r.call(this),this.internal.vFS[e]!==void 0?this.internal.vFS[e]:null}})(bt.API),(function(t){t.__bidiEngine__=t.prototype.__bidiEngine__=function(n){var i,a,o,s,l,c,f,v=r,x=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],p=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],S={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},w={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},k=["(",")","(","<",">","<","[","]","[","{","}","{","\xAB","\xBB","\xAB","\u2039","\u203A","\u2039","\u2045","\u2046","\u2045","\u207D","\u207E","\u207D","\u208D","\u208E","\u208D","\u2264","\u2265","\u2264","\u2329","\u232A","\u2329","\uFE59","\uFE5A","\uFE59","\uFE5B","\uFE5C","\uFE5B","\uFE5D","\uFE5E","\uFE5D","\uFE64","\uFE65","\uFE64"],O=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),H=!1,q=0;this.__bidiEngine__={};var X=function(A){var V=A.charCodeAt(),de=V>>8,ue=w[de];return ue!==void 0?v[256*ue+(255&V)]:de===252||de===253?"AL":O.test(de)?"L":de===8?"R":"N"},he=function(A){for(var V,de=0;de<A.length;de++){if((V=X(A.charAt(de)))==="L")return!1;if(V==="R")return!0}return!1},ke=function(A,V,de,ue){var xe,Ne,Re,Ee,Be=V[ue];switch(Be){case"L":case"R":case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":H=!1;break;case"N":case"AN":break;case"EN":H&&(Be="AN");break;case"AL":H=!0,Be="R";break;case"WS":case"BN":Be="N";break;case"CS":ue<1||ue+1>=V.length||(xe=de[ue-1])!=="EN"&&xe!=="AN"||(Ne=V[ue+1])!=="EN"&&Ne!=="AN"?Be="N":H&&(Ne="AN"),Be=Ne===xe?Ne:"N";break;case"ES":Be=(xe=ue>0?de[ue-1]:"B")==="EN"&&ue+1<V.length&&V[ue+1]==="EN"?"EN":"N";break;case"ET":if(ue>0&&de[ue-1]==="EN"){Be="EN";break}if(H){Be="N";break}for(Re=ue+1,Ee=V.length;Re<Ee&&V[Re]==="ET";)Re++;Be=Re<Ee&&V[Re]==="EN"?"EN":"N";break;case"NSM":if(o&&!s){for(Ee=V.length,Re=ue+1;Re<Ee&&V[Re]==="NSM";)Re++;if(Re<Ee){var Je=A[ue],qe=Je>=1425&&Je<=2303||Je===64286;if(xe=V[Re],qe&&(xe==="R"||xe==="AL")){Be="R";break}}}Be=ue<1||(xe=V[ue-1])==="B"?"N":de[ue-1];break;case"B":H=!1,i=!0,Be=q;break;case"S":a=!0,Be="N"}return Be},re=function(A,V,de){var ue=A.split("");return de&&ee(ue,de,{hiLevel:q}),ue.reverse(),V&&V.reverse(),ue.join("")},ee=function(A,V,de){var ue,xe,Ne,Re,Ee,Be=-1,Je=A.length,qe=0,E=[],U=q?p:x,T=[];for(H=!1,i=!1,a=!1,xe=0;xe<Je;xe++)T[xe]=X(A[xe]);for(Ne=0;Ne<Je;Ne++){if(Ee=qe,E[Ne]=ke(A,T,E,Ne),ue=240&(qe=U[Ee][S[E[Ne]]]),qe&=15,V[Ne]=Re=U[qe][5],ue>0)if(ue===16){for(xe=Be;xe<Ne;xe++)V[xe]=1;Be=-1}else Be=-1;if(U[qe][6])Be===-1&&(Be=Ne);else if(Be>-1){for(xe=Be;xe<Ne;xe++)V[xe]=Re;Be=-1}T[Ne]==="B"&&(V[Ne]=0),de.hiLevel|=Re}a&&(function(R,te,pe){for(var ye=0;ye<pe;ye++)if(R[ye]==="S"){te[ye]=q;for(var ve=ye-1;ve>=0&&R[ve]==="WS";ve--)te[ve]=q}})(T,V,Je)},W=function(A,V,de,ue,xe){if(!(xe.hiLevel<A)){if(A===1&&q===1&&!i)return V.reverse(),void(de&&de.reverse());for(var Ne,Re,Ee,Be,Je=V.length,qe=0;qe<Je;){if(ue[qe]>=A){for(Ee=qe+1;Ee<Je&&ue[Ee]>=A;)Ee++;for(Be=qe,Re=Ee-1;Be<Re;Be++,Re--)Ne=V[Be],V[Be]=V[Re],V[Re]=Ne,de&&(Ne=de[Be],de[Be]=de[Re],de[Re]=Ne);qe=Ee}qe++}}},ae=function(A,V,de){var ue=A.split(""),xe={hiLevel:q};return de||(de=[]),ee(ue,de,xe),(function(Ne,Re,Ee){if(Ee.hiLevel!==0&&f)for(var Be,Je=0;Je<Ne.length;Je++)Re[Je]===1&&(Be=k.indexOf(Ne[Je]))>=0&&(Ne[Je]=k[Be+1])})(ue,de,xe),W(2,ue,V,de,xe),W(1,ue,V,de,xe),ue.join("")};return this.__bidiEngine__.doBidiReorder=function(A,V,de){if((function(xe,Ne){if(Ne)for(var Re=0;Re<xe.length;Re++)Ne[Re]=Re;s===void 0&&(s=he(xe)),c===void 0&&(c=he(xe))})(A,V),o||!l||c)if(o&&l&&s^c)q=s?1:0,A=re(A,V,de);else if(!o&&l&&c)q=s?1:0,A=ae(A,V,de),A=re(A,V);else if(!o||s||l||c){if(o&&!l&&s^c)A=re(A,V),s?(q=0,A=ae(A,V,de)):(q=1,A=ae(A,V,de),A=re(A,V));else if(o&&s&&!l&&c)q=1,A=ae(A,V,de),A=re(A,V);else if(!o&&!l&&s^c){var ue=f;s?(q=1,A=ae(A,V,de),q=0,f=!1,A=ae(A,V,de),f=ue):(q=0,A=ae(A,V,de),A=re(A,V),q=1,f=!1,A=ae(A,V,de),f=ue,A=re(A,V))}}else q=0,A=ae(A,V,de);else q=s?1:0,A=ae(A,V,de);return A},this.__bidiEngine__.setOptions=function(A){A&&(o=A.isInputVisual,l=A.isOutputVisual,s=A.isInputRtl,c=A.isOutputRtl,f=A.isSymmetricSwapping)},this.__bidiEngine__.setOptions(n),this.__bidiEngine__};var r=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],e=new t.__bidiEngine__({isInputVisual:!0});t.API.events.push(["postProcessText",function(n){var i=n.text;n.x,n.y;var a=n.options||{};n.mutex,a.lang;var o=[];if(a.isInputVisual=typeof a.isInputVisual!="boolean"||a.isInputVisual,e.setOptions(a),Object.prototype.toString.call(i)==="[object Array]"){var s=0;for(o=[],s=0;s<i.length;s+=1)Object.prototype.toString.call(i[s])==="[object Array]"?o.push([e.doBidiReorder(i[s][0]),i[s][1],i[s][2]]):o.push([e.doBidiReorder(i[s])]);n.text=o}else n.text=e.doBidiReorder(i);e.setOptions({isInputVisual:!0})}])})(bt),bt.API.TTFFont=(function(){function t(r){var e;if(this.rawData=r,e=this.contents=new zs(r),this.contents.pos=4,e.readString(4)==="ttcf")throw new Error("TTCF not supported.");e.pos=0,this.parse(),this.subset=new Y8(this),this.registerTTF()}return t.open=function(r){return new t(r)},t.prototype.parse=function(){return this.directory=new N8(this.contents),this.head=new L8(this),this.name=new j8(this),this.cmap=new mb(this),this.toUnicode={},this.hhea=new B8(this),this.maxp=new H8(this),this.hmtx=new W8(this),this.post=new V8(this),this.os2=new U8(this),this.loca=new X8(this),this.glyf=new q8(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},t.prototype.registerTTF=function(){var r,e,n,i,a;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=function(){var o,s,l,c;for(c=[],o=0,s=(l=this.bbox).length;o<s;o++)r=l[o],c.push(Math.round(r*this.scaleFactor));return c}.call(this),this.stemV=0,this.post.exists?(n=255&(i=this.post.italic_angle),32768&(e=i>>16)&&(e=-(1+(65535^e))),this.italicAngle=+(e+"."+n)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(a=this.familyClass)===1||a===2||a===3||a===4||a===5||a===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},t.prototype.characterToGlyph=function(r){var e;return((e=this.cmap.unicode)!=null?e.codeMap[r]:void 0)||0},t.prototype.widthOfGlyph=function(r){var e;return e=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(r).advance*e},t.prototype.widthOfString=function(r,e,n){var i,a,o,s;for(o=0,a=0,s=(r=""+r).length;0<=s?a<s:a>s;a=0<=s?++a:--a)i=r.charCodeAt(a),o+=this.widthOfGlyph(this.characterToGlyph(i))+n*(1e3/e)||0;return o*(e/1e3)},t.prototype.lineHeight=function(r,e){var n;return e==null&&(e=!1),n=e?this.lineGap:0,(this.ascender+n-this.decender)/1e3*r},t})();var Ga,zs=(function(){function t(r){this.data=r??[],this.pos=0,this.length=this.data.length}return t.prototype.readByte=function(){return this.data[this.pos++]},t.prototype.writeByte=function(r){return this.data[this.pos++]=r},t.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},t.prototype.writeUInt32=function(r){return this.writeByte(r>>>24&255),this.writeByte(r>>16&255),this.writeByte(r>>8&255),this.writeByte(255&r)},t.prototype.readInt32=function(){var r;return(r=this.readUInt32())>=2147483648?r-4294967296:r},t.prototype.writeInt32=function(r){return r<0&&(r+=4294967296),this.writeUInt32(r)},t.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},t.prototype.writeUInt16=function(r){return this.writeByte(r>>8&255),this.writeByte(255&r)},t.prototype.readInt16=function(){var r;return(r=this.readUInt16())>=32768?r-65536:r},t.prototype.writeInt16=function(r){return r<0&&(r+=65536),this.writeUInt16(r)},t.prototype.readString=function(r){var e,n;for(n=[],e=0;0<=r?e<r:e>r;e=0<=r?++e:--e)n[e]=String.fromCharCode(this.readByte());return n.join("")},t.prototype.writeString=function(r){var e,n,i;for(i=[],e=0,n=r.length;0<=n?e<n:e>n;e=0<=n?++e:--e)i.push(this.writeByte(r.charCodeAt(e)));return i},t.prototype.readShort=function(){return this.readInt16()},t.prototype.writeShort=function(r){return this.writeInt16(r)},t.prototype.readLongLong=function(){var r,e,n,i,a,o,s,l;return r=this.readByte(),e=this.readByte(),n=this.readByte(),i=this.readByte(),a=this.readByte(),o=this.readByte(),s=this.readByte(),l=this.readByte(),128&r?-1*(72057594037927940*(255^r)+281474976710656*(255^e)+1099511627776*(255^n)+4294967296*(255^i)+16777216*(255^a)+65536*(255^o)+256*(255^s)+(255^l)+1):72057594037927940*r+281474976710656*e+1099511627776*n+4294967296*i+16777216*a+65536*o+256*s+l},t.prototype.writeLongLong=function(r){var e,n;return e=Math.floor(r/4294967296),n=4294967295&r,this.writeByte(e>>24&255),this.writeByte(e>>16&255),this.writeByte(e>>8&255),this.writeByte(255&e),this.writeByte(n>>24&255),this.writeByte(n>>16&255),this.writeByte(n>>8&255),this.writeByte(255&n)},t.prototype.readInt=function(){return this.readInt32()},t.prototype.writeInt=function(r){return this.writeInt32(r)},t.prototype.read=function(r){var e,n;for(e=[],n=0;0<=r?n<r:n>r;n=0<=r?++n:--n)e.push(this.readByte());return e},t.prototype.write=function(r){var e,n,i,a;for(a=[],n=0,i=r.length;n<i;n++)e=r[n],a.push(this.writeByte(e));return a},t})(),N8=(function(){var t;function r(e){var n,i,a;for(this.scalarType=e.readInt(),this.tableCount=e.readShort(),this.searchRange=e.readShort(),this.entrySelector=e.readShort(),this.rangeShift=e.readShort(),this.tables={},i=0,a=this.tableCount;0<=a?i<a:i>a;i=0<=a?++i:--i)n={tag:e.readString(4),checksum:e.readInt(),offset:e.readInt(),length:e.readInt()},this.tables[n.tag]=n}return r.prototype.encode=function(e){var n,i,a,o,s,l,c,f,v,x,p,S,w;for(w in p=Object.keys(e).length,l=Math.log(2),v=16*Math.floor(Math.log(p)/l),o=Math.floor(v/l),f=16*p-v,(i=new zs).writeInt(this.scalarType),i.writeShort(p),i.writeShort(v),i.writeShort(o),i.writeShort(f),a=16*p,c=i.pos+a,s=null,S=[],e)for(x=e[w],i.writeString(w),i.writeInt(t(x)),i.writeInt(c),i.writeInt(x.length),S=S.concat(x),w==="head"&&(s=c),c+=x.length;c%4;)S.push(0),c++;return i.write(S),n=2981146554-t(i.data),i.pos=s+8,i.writeUInt32(n),i.data},t=function(e){var n,i,a,o;for(e=gb.call(e);e.length%4;)e.push(0);for(a=new zs(e),i=0,n=0,o=e.length;n<o;n=n+=4)i+=a.readUInt32();return 4294967295&i},r})(),R8={}.hasOwnProperty,go=function(t,r){for(var e in r)R8.call(r,e)&&(t[e]=r[e]);function n(){this.constructor=t}return n.prototype=r.prototype,t.prototype=new n,t.__super__=r.prototype,t};Ga=(function(){function t(r){var e;this.file=r,e=this.file.directory.tables[this.tag],this.exists=!!e,e&&(this.offset=e.offset,this.length=e.length,this.parse(this.file.contents))}return t.prototype.parse=function(){},t.prototype.encode=function(){},t.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},t})();var L8=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return go(t,Ga),t.prototype.tag="head",t.prototype.parse=function(r){return r.pos=this.offset,this.version=r.readInt(),this.revision=r.readInt(),this.checkSumAdjustment=r.readInt(),this.magicNumber=r.readInt(),this.flags=r.readShort(),this.unitsPerEm=r.readShort(),this.created=r.readLongLong(),this.modified=r.readLongLong(),this.xMin=r.readShort(),this.yMin=r.readShort(),this.xMax=r.readShort(),this.yMax=r.readShort(),this.macStyle=r.readShort(),this.lowestRecPPEM=r.readShort(),this.fontDirectionHint=r.readShort(),this.indexToLocFormat=r.readShort(),this.glyphDataFormat=r.readShort()},t.prototype.encode=function(r){var e;return(e=new zs).writeInt(this.version),e.writeInt(this.revision),e.writeInt(this.checkSumAdjustment),e.writeInt(this.magicNumber),e.writeShort(this.flags),e.writeShort(this.unitsPerEm),e.writeLongLong(this.created),e.writeLongLong(this.modified),e.writeShort(this.xMin),e.writeShort(this.yMin),e.writeShort(this.xMax),e.writeShort(this.yMax),e.writeShort(this.macStyle),e.writeShort(this.lowestRecPPEM),e.writeShort(this.fontDirectionHint),e.writeShort(r),e.writeShort(this.glyphDataFormat),e.data},t})(),nb=(function(){function t(r,e){var n,i,a,o,s,l,c,f,v,x,p,S,w,k,O,H,q;switch(this.platformID=r.readUInt16(),this.encodingID=r.readShort(),this.offset=e+r.readInt(),v=r.pos,r.pos=this.offset,this.format=r.readUInt16(),this.length=r.readUInt16(),this.language=r.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(l=0;l<256;++l)this.codeMap[l]=r.readByte();break;case 4:for(p=r.readUInt16(),x=p/2,r.pos+=6,a=(function(){var X,he;for(he=[],l=X=0;0<=x?X<x:X>x;l=0<=x?++X:--X)he.push(r.readUInt16());return he})(),r.pos+=2,w=(function(){var X,he;for(he=[],l=X=0;0<=x?X<x:X>x;l=0<=x?++X:--X)he.push(r.readUInt16());return he})(),c=(function(){var X,he;for(he=[],l=X=0;0<=x?X<x:X>x;l=0<=x?++X:--X)he.push(r.readUInt16());return he})(),f=(function(){var X,he;for(he=[],l=X=0;0<=x?X<x:X>x;l=0<=x?++X:--X)he.push(r.readUInt16());return he})(),i=(this.length-r.pos+this.offset)/2,s=(function(){var X,he;for(he=[],l=X=0;0<=i?X<i:X>i;l=0<=i?++X:--X)he.push(r.readUInt16());return he})(),l=O=0,q=a.length;O<q;l=++O)for(k=a[l],n=H=S=w[l];S<=k?H<=k:H>=k;n=S<=k?++H:--H)f[l]===0?o=n+c[l]:(o=s[f[l]/2+(n-S)-(x-l)]||0)!==0&&(o+=c[l]),this.codeMap[n]=65535&o}r.pos=v}return t.encode=function(r,e){var n,i,a,o,s,l,c,f,v,x,p,S,w,k,O,H,q,X,he,ke,re,ee,W,ae,A,V,de,ue,xe,Ne,Re,Ee,Be,Je,qe,E,U,T,R,te,pe,ye,ve,_e,He,Ye;switch(ue=new zs,o=Object.keys(r).sort(function(nt,at){return nt-at}),e){case"macroman":for(w=0,k=(function(){var nt=[];for(S=0;S<256;++S)nt.push(0);return nt})(),H={0:0},a={},xe=0,Be=o.length;xe<Be;xe++)H[ve=r[i=o[xe]]]==null&&(H[ve]=++w),a[i]={old:r[i],new:H[r[i]]},k[i]=H[r[i]];return ue.writeUInt16(1),ue.writeUInt16(0),ue.writeUInt32(12),ue.writeUInt16(0),ue.writeUInt16(262),ue.writeUInt16(0),ue.write(k),{charMap:a,subtable:ue.data,maxGlyphID:w+1};case"unicode":for(V=[],v=[],q=0,H={},n={},O=c=null,Ne=0,Je=o.length;Ne<Je;Ne++)H[he=r[i=o[Ne]]]==null&&(H[he]=++q),n[i]={old:he,new:H[he]},s=H[he]-i,O!=null&&s===c||(O&&v.push(O),V.push(i),c=s),O=i;for(O&&v.push(O),v.push(65535),V.push(65535),ae=2*(W=V.length),ee=2*Math.pow(Math.log(W)/Math.LN2,2),x=Math.log(ee/2)/Math.LN2,re=2*W-ee,l=[],ke=[],p=[],S=Re=0,qe=V.length;Re<qe;S=++Re){if(A=V[S],f=v[S],A===65535){l.push(0),ke.push(0);break}if(A-(de=n[A].new)>=32768)for(l.push(0),ke.push(2*(p.length+W-S)),i=Ee=A;A<=f?Ee<=f:Ee>=f;i=A<=f?++Ee:--Ee)p.push(n[i].new);else l.push(de-A),ke.push(0)}for(ue.writeUInt16(3),ue.writeUInt16(1),ue.writeUInt32(12),ue.writeUInt16(4),ue.writeUInt16(16+8*W+2*p.length),ue.writeUInt16(0),ue.writeUInt16(ae),ue.writeUInt16(ee),ue.writeUInt16(x),ue.writeUInt16(re),pe=0,E=v.length;pe<E;pe++)i=v[pe],ue.writeUInt16(i);for(ue.writeUInt16(0),ye=0,U=V.length;ye<U;ye++)i=V[ye],ue.writeUInt16(i);for(_e=0,T=l.length;_e<T;_e++)s=l[_e],ue.writeUInt16(s);for(He=0,R=ke.length;He<R;He++)X=ke[He],ue.writeUInt16(X);for(Ye=0,te=p.length;Ye<te;Ye++)w=p[Ye],ue.writeUInt16(w);return{charMap:n,subtable:ue.data,maxGlyphID:q+1}}},t})(),mb=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return go(t,Ga),t.prototype.tag="cmap",t.prototype.parse=function(r){var e,n,i;for(r.pos=this.offset,this.version=r.readUInt16(),i=r.readUInt16(),this.tables=[],this.unicode=null,n=0;0<=i?n<i:n>i;n=0<=i?++n:--n)e=new nb(r,this.offset),this.tables.push(e),e.isUnicode&&this.unicode==null&&(this.unicode=e);return!0},t.encode=function(r,e){var n,i;return e==null&&(e="macroman"),n=nb.encode(r,e),(i=new zs).writeUInt16(0),i.writeUInt16(1),n.table=i.data.concat(n.subtable),n},t})(),B8=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return go(t,Ga),t.prototype.tag="hhea",t.prototype.parse=function(r){return r.pos=this.offset,this.version=r.readInt(),this.ascender=r.readShort(),this.decender=r.readShort(),this.lineGap=r.readShort(),this.advanceWidthMax=r.readShort(),this.minLeftSideBearing=r.readShort(),this.minRightSideBearing=r.readShort(),this.xMaxExtent=r.readShort(),this.caretSlopeRise=r.readShort(),this.caretSlopeRun=r.readShort(),this.caretOffset=r.readShort(),r.pos+=8,this.metricDataFormat=r.readShort(),this.numberOfMetrics=r.readUInt16()},t})(),U8=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return go(t,Ga),t.prototype.tag="OS/2",t.prototype.parse=function(r){if(r.pos=this.offset,this.version=r.readUInt16(),this.averageCharWidth=r.readShort(),this.weightClass=r.readUInt16(),this.widthClass=r.readUInt16(),this.type=r.readShort(),this.ySubscriptXSize=r.readShort(),this.ySubscriptYSize=r.readShort(),this.ySubscriptXOffset=r.readShort(),this.ySubscriptYOffset=r.readShort(),this.ySuperscriptXSize=r.readShort(),this.ySuperscriptYSize=r.readShort(),this.ySuperscriptXOffset=r.readShort(),this.ySuperscriptYOffset=r.readShort(),this.yStrikeoutSize=r.readShort(),this.yStrikeoutPosition=r.readShort(),this.familyClass=r.readShort(),this.panose=(function(){var e,n;for(n=[],e=0;e<10;++e)n.push(r.readByte());return n})(),this.charRange=(function(){var e,n;for(n=[],e=0;e<4;++e)n.push(r.readInt());return n})(),this.vendorID=r.readString(4),this.selection=r.readShort(),this.firstCharIndex=r.readShort(),this.lastCharIndex=r.readShort(),this.version>0&&(this.ascent=r.readShort(),this.descent=r.readShort(),this.lineGap=r.readShort(),this.winAscent=r.readShort(),this.winDescent=r.readShort(),this.codePageRange=(function(){var e,n;for(n=[],e=0;e<2;e=++e)n.push(r.readInt());return n})(),this.version>1))return this.xHeight=r.readShort(),this.capHeight=r.readShort(),this.defaultChar=r.readShort(),this.breakChar=r.readShort(),this.maxContext=r.readShort()},t})(),V8=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return go(t,Ga),t.prototype.tag="post",t.prototype.parse=function(r){var e,n,i;switch(r.pos=this.offset,this.format=r.readInt(),this.italicAngle=r.readInt(),this.underlinePosition=r.readShort(),this.underlineThickness=r.readShort(),this.isFixedPitch=r.readInt(),this.minMemType42=r.readInt(),this.maxMemType42=r.readInt(),this.minMemType1=r.readInt(),this.maxMemType1=r.readInt(),this.format){case 65536:case 196608:break;case 131072:var a;for(n=r.readUInt16(),this.glyphNameIndex=[],a=0;0<=n?a<n:a>n;a=0<=n?++a:--a)this.glyphNameIndex.push(r.readUInt16());for(this.names=[],i=[];r.pos<this.offset+this.length;)e=r.readByte(),i.push(this.names.push(r.readString(e)));return i;case 151552:return n=r.readUInt16(),this.offsets=r.read(n);case 262144:return this.map=function(){var o,s,l;for(l=[],a=o=0,s=this.file.maxp.numGlyphs;0<=s?o<s:o>s;a=0<=s?++o:--o)l.push(r.readUInt32());return l}.call(this)}},t})(),z8=function(t,r){this.raw=t,this.length=t.length,this.platformID=r.platformID,this.encodingID=r.encodingID,this.languageID=r.languageID},j8=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return go(t,Ga),t.prototype.tag="name",t.prototype.parse=function(r){var e,n,i,a,o,s,l,c,f,v,x;for(r.pos=this.offset,r.readShort(),e=r.readShort(),s=r.readShort(),n=[],a=0;0<=e?a<e:a>e;a=0<=e?++a:--a)n.push({platformID:r.readShort(),encodingID:r.readShort(),languageID:r.readShort(),nameID:r.readShort(),length:r.readShort(),offset:this.offset+s+r.readShort()});for(l={},a=f=0,v=n.length;f<v;a=++f)i=n[a],r.pos=i.offset,c=r.readString(i.length),o=new z8(c,i),l[x=i.nameID]==null&&(l[x]=[]),l[i.nameID].push(o);this.strings=l,this.copyright=l[0],this.fontFamily=l[1],this.fontSubfamily=l[2],this.uniqueSubfamily=l[3],this.fontName=l[4],this.version=l[5];try{this.postscriptName=l[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=l[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=l[7],this.manufacturer=l[8],this.designer=l[9],this.description=l[10],this.vendorUrl=l[11],this.designerUrl=l[12],this.license=l[13],this.licenseUrl=l[14],this.preferredFamily=l[15],this.preferredSubfamily=l[17],this.compatibleFull=l[18],this.sampleText=l[19]},t})(),H8=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return go(t,Ga),t.prototype.tag="maxp",t.prototype.parse=function(r){return r.pos=this.offset,this.version=r.readInt(),this.numGlyphs=r.readUInt16(),this.maxPoints=r.readUInt16(),this.maxContours=r.readUInt16(),this.maxCompositePoints=r.readUInt16(),this.maxComponentContours=r.readUInt16(),this.maxZones=r.readUInt16(),this.maxTwilightPoints=r.readUInt16(),this.maxStorage=r.readUInt16(),this.maxFunctionDefs=r.readUInt16(),this.maxInstructionDefs=r.readUInt16(),this.maxStackElements=r.readUInt16(),this.maxSizeOfInstructions=r.readUInt16(),this.maxComponentElements=r.readUInt16(),this.maxComponentDepth=r.readUInt16()},t})(),W8=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return go(t,Ga),t.prototype.tag="hmtx",t.prototype.parse=function(r){var e,n,i,a,o,s,l;for(r.pos=this.offset,this.metrics=[],e=0,s=this.file.hhea.numberOfMetrics;0<=s?e<s:e>s;e=0<=s?++e:--e)this.metrics.push({advance:r.readUInt16(),lsb:r.readInt16()});for(i=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=(function(){var c,f;for(f=[],e=c=0;0<=i?c<i:c>i;e=0<=i?++c:--c)f.push(r.readInt16());return f})(),this.widths=function(){var c,f,v,x;for(x=[],c=0,f=(v=this.metrics).length;c<f;c++)a=v[c],x.push(a.advance);return x}.call(this),n=this.widths[this.widths.length-1],l=[],e=o=0;0<=i?o<i:o>i;e=0<=i?++o:--o)l.push(this.widths.push(n));return l},t.prototype.forGlyph=function(r){return r in this.metrics?this.metrics[r]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[r-this.metrics.length]}},t})(),gb=[].slice,q8=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return go(t,Ga),t.prototype.tag="glyf",t.prototype.parse=function(){return this.cache={}},t.prototype.glyphFor=function(r){var e,n,i,a,o,s,l,c,f,v;return r in this.cache?this.cache[r]:(a=this.file.loca,e=this.file.contents,n=a.indexOf(r),(i=a.lengthOf(r))===0?this.cache[r]=null:(e.pos=this.offset+n,o=(s=new zs(e.read(i))).readShort(),c=s.readShort(),v=s.readShort(),l=s.readShort(),f=s.readShort(),this.cache[r]=o===-1?new $8(s,c,v,l,f):new G8(s,o,c,v,l,f),this.cache[r]))},t.prototype.encode=function(r,e,n){var i,a,o,s,l;for(o=[],a=[],s=0,l=e.length;s<l;s++)i=r[e[s]],a.push(o.length),i&&(o=o.concat(i.encode(n)));return a.push(o.length),{table:o,offsets:a}},t})(),G8=(function(){function t(r,e,n,i,a,o){this.raw=r,this.numberOfContours=e,this.xMin=n,this.yMin=i,this.xMax=a,this.yMax=o,this.compound=!1}return t.prototype.encode=function(){return this.raw.data},t})(),$8=(function(){function t(r,e,n,i,a){var o,s;for(this.raw=r,this.xMin=e,this.yMin=n,this.xMax=i,this.yMax=a,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],o=this.raw;s=o.readShort(),this.glyphOffsets.push(o.pos),this.glyphIDs.push(o.readUInt16()),32&s;)o.pos+=1&s?4:2,128&s?o.pos+=8:64&s?o.pos+=4:8&s&&(o.pos+=2)}return t.prototype.encode=function(){var r,e,n;for(e=new zs(gb.call(this.raw.data)),r=0,n=this.glyphIDs.length;r<n;++r)e.pos=this.glyphOffsets[r];return e.data},t})(),X8=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return go(t,Ga),t.prototype.tag="loca",t.prototype.parse=function(r){var e,n;return r.pos=this.offset,e=this.file.head.indexToLocFormat,this.offsets=e===0?function(){var i,a;for(a=[],n=0,i=this.length;n<i;n+=2)a.push(2*r.readUInt16());return a}.call(this):function(){var i,a;for(a=[],n=0,i=this.length;n<i;n+=4)a.push(r.readUInt32());return a}.call(this)},t.prototype.indexOf=function(r){return this.offsets[r]},t.prototype.lengthOf=function(r){return this.offsets[r+1]-this.offsets[r]},t.prototype.encode=function(r,e){for(var n=new Uint32Array(this.offsets.length),i=0,a=0,o=0;o<n.length;++o)if(n[o]=i,a<e.length&&e[a]==o){++a,n[o]=i;var s=this.offsets[o],l=this.offsets[o+1]-s;l>0&&(i+=l)}for(var c=new Array(4*n.length),f=0;f<n.length;++f)c[4*f+3]=255&n[f],c[4*f+2]=(65280&n[f])>>8,c[4*f+1]=(16711680&n[f])>>16,c[4*f]=(4278190080&n[f])>>24;return c},t})(),Y8=(function(){function t(r){this.font=r,this.subset={},this.unicodes={},this.next=33}return t.prototype.generateCmap=function(){var r,e,n,i,a;for(e in i=this.font.cmap.tables[0].codeMap,r={},a=this.subset)n=a[e],r[e]=i[n];return r},t.prototype.glyphsFor=function(r){var e,n,i,a,o,s,l;for(i={},o=0,s=r.length;o<s;o++)i[a=r[o]]=this.font.glyf.glyphFor(a);for(a in e=[],i)(n=i[a])!=null&&n.compound&&e.push.apply(e,n.glyphIDs);if(e.length>0)for(a in l=this.glyphsFor(e))n=l[a],i[a]=n;return i},t.prototype.encode=function(r,e){var n,i,a,o,s,l,c,f,v,x,p,S,w,k,O;for(i in n=mb.encode(this.generateCmap(),"unicode"),o=this.glyphsFor(r),p={0:0},O=n.charMap)p[(l=O[i]).old]=l.new;for(S in x=n.maxGlyphID,o)S in p||(p[S]=x++);return f=(function(H){var q,X;for(q in X={},H)X[H[q]]=q;return X})(p),v=Object.keys(f).sort(function(H,q){return H-q}),w=(function(){var H,q,X;for(X=[],H=0,q=v.length;H<q;H++)s=v[H],X.push(f[s]);return X})(),a=this.font.glyf.encode(o,w,p),c=this.font.loca.encode(a.offsets,w),k={cmap:this.font.cmap.raw(),glyf:a.table,loca:c,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(e)},this.font.os2.exists&&(k["OS/2"]=this.font.os2.raw()),this.font.directory.encode(k)},t})();bt.API.PDFObject=(function(){var t;function r(){}return t=function(e,n){return(Array(n+1).join("0")+e).slice(-n)},r.convert=function(e){var n,i,a,o;if(Array.isArray(e))return"["+(function(){var s,l,c;for(c=[],s=0,l=e.length;s<l;s++)n=e[s],c.push(r.convert(n));return c})().join(" ")+"]";if(typeof e=="string")return"/"+e;if(e?.isString)return"("+e+")";if(e instanceof Date)return"(D:"+t(e.getUTCFullYear(),4)+t(e.getUTCMonth(),2)+t(e.getUTCDate(),2)+t(e.getUTCHours(),2)+t(e.getUTCMinutes(),2)+t(e.getUTCSeconds(),2)+"Z)";if({}.toString.call(e)==="[object Object]"){for(i in a=["<<"],e)o=e[i],a.push("/"+i+" "+r.convert(o));return a.push(">>"),a.join(`
`)}return""+e},r})();function yb(t,r,e,n,i){n=n||{};var a=1.15,o=i.internal.scaleFactor,s=i.internal.getFontSize()/o,l=i.getLineHeightFactor?i.getLineHeightFactor():a,c=s*l,f=/\r\n|\r|\n/g,v="",x=1;if((n.valign==="middle"||n.valign==="bottom"||n.halign==="center"||n.halign==="right")&&(v=typeof t=="string"?t.split(f):t,x=v.length||1),e+=s*(2-a),n.valign==="middle"?e-=x/2*c:n.valign==="bottom"&&(e-=x*c),n.halign==="center"||n.halign==="right"){var p=s;if(n.halign==="center"&&(p*=.5),v&&x>=1){for(var S=0;S<v.length;S++)i.text(v[S],r-i.getStringUnitWidth(v[S])*p,e),e+=c;return i}r-=i.getStringUnitWidth(t)*p}return n.halign==="justify"?i.text(t,r,e,{maxWidth:n.maxWidth||100,align:"justify"}):i.text(t,r,e),i}var _b={},Ic=(function(){function t(r){this.jsPDFDocument=r,this.userStyles={textColor:r.getTextColor?this.jsPDFDocument.getTextColor():0,fontSize:r.internal.getFontSize(),fontStyle:r.internal.getFont().fontStyle,font:r.internal.getFont().fontName,lineWidth:r.getLineWidth?this.jsPDFDocument.getLineWidth():0,lineColor:r.getDrawColor?this.jsPDFDocument.getDrawColor():0}}return t.setDefaults=function(r,e){e===void 0&&(e=null),e?e.__autoTableDocumentDefaults=r:_b=r},t.unifyColor=function(r){return Array.isArray(r)?r:typeof r=="number"?[r,r,r]:typeof r=="string"?[r]:null},t.prototype.applyStyles=function(r,e){var n,i,a;e===void 0&&(e=!1),r.fontStyle&&this.jsPDFDocument.setFontStyle&&this.jsPDFDocument.setFontStyle(r.fontStyle);var o=this.jsPDFDocument.internal.getFont(),s=o.fontStyle,l=o.fontName;if(r.font&&(l=r.font),r.fontStyle){s=r.fontStyle;var c=this.getFontList()[l];c&&c.indexOf(s)===-1&&this.jsPDFDocument.setFontStyle&&(this.jsPDFDocument.setFontStyle(c[0]),s=c[0])}if(this.jsPDFDocument.setFont(l,s),r.fontSize&&this.jsPDFDocument.setFontSize(r.fontSize),!e){var f=t.unifyColor(r.fillColor);f&&(n=this.jsPDFDocument).setFillColor.apply(n,f),f=t.unifyColor(r.textColor),f&&(i=this.jsPDFDocument).setTextColor.apply(i,f),f=t.unifyColor(r.lineColor),f&&(a=this.jsPDFDocument).setDrawColor.apply(a,f),typeof r.lineWidth=="number"&&this.jsPDFDocument.setLineWidth(r.lineWidth)}},t.prototype.splitTextToSize=function(r,e,n){return this.jsPDFDocument.splitTextToSize(r,e,n)},t.prototype.rect=function(r,e,n,i,a){return this.jsPDFDocument.rect(r,e,n,i,a)},t.prototype.getLastAutoTable=function(){return this.jsPDFDocument.lastAutoTable||null},t.prototype.getTextWidth=function(r){return this.jsPDFDocument.getTextWidth(r)},t.prototype.getDocument=function(){return this.jsPDFDocument},t.prototype.setPage=function(r){this.jsPDFDocument.setPage(r)},t.prototype.addPage=function(){return this.jsPDFDocument.addPage()},t.prototype.getFontList=function(){return this.jsPDFDocument.getFontList()},t.prototype.getGlobalOptions=function(){return _b||{}},t.prototype.getDocumentOptions=function(){return this.jsPDFDocument.__autoTableDocumentDefaults||{}},t.prototype.pageSize=function(){var r=this.jsPDFDocument.internal.pageSize;return r.width==null&&(r={width:r.getWidth(),height:r.getHeight()}),r},t.prototype.scaleFactor=function(){return this.jsPDFDocument.internal.scaleFactor},t.prototype.getLineHeightFactor=function(){var r=this.jsPDFDocument;return r.getLineHeightFactor?r.getLineHeightFactor():1.15},t.prototype.getLineHeight=function(r){return r/this.scaleFactor()*this.getLineHeightFactor()},t.prototype.pageNumber=function(){var r=this.jsPDFDocument.internal.getCurrentPageInfo();return r?r.pageNumber:this.jsPDFDocument.internal.getNumberOfPages()},t})(),Lm=function(t,r){return Lm=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])},Lm(t,r)};function Cb(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");Lm(t,r);function e(){this.constructor=t}t.prototype=r===null?Object.create(r):(e.prototype=r.prototype,new e)}var Sb=(function(t){Cb(r,t);function r(e){var n=t.call(this)||this;return n._element=e,n}return r})(Array);function K8(t){return{font:"helvetica",fontStyle:"normal",overflow:"linebreak",fillColor:!1,textColor:20,halign:"left",valign:"top",fontSize:10,cellPadding:5/t,lineColor:200,lineWidth:0,cellWidth:"auto",minCellHeight:0,minCellWidth:0}}function Z8(t){var r={striped:{table:{fillColor:255,textColor:80,fontStyle:"normal"},head:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},body:{},foot:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},alternateRow:{fillColor:245}},grid:{table:{fillColor:255,textColor:80,fontStyle:"normal",lineWidth:.1},head:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},body:{},foot:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},alternateRow:{}},plain:{head:{fontStyle:"bold"},foot:{fontStyle:"bold"}}};return r[t]}function vu(t,r,e){e.applyStyles(r,!0);var n=Array.isArray(t)?t:[t],i=n.map(function(a){return e.getTextWidth(a)}).reduce(function(a,o){return Math.max(a,o)},0);return i}function kb(t,r,e,n){var i=r.settings.tableLineWidth,a=r.settings.tableLineColor;t.applyStyles({lineWidth:i,lineColor:a});var o=Eb(i,!1);o&&t.rect(e.x,e.y,r.getWidth(t.pageSize().width),n.y-e.y,o)}function Eb(t,r){var e=t>0,n=r||r===0;return e&&n?"DF":e?"S":n?"F":null}function bu(t,r){var e,n,i,a;if(t=t||r,Array.isArray(t)){if(t.length>=4)return{top:t[0],right:t[1],bottom:t[2],left:t[3]};if(t.length===3)return{top:t[0],right:t[1],bottom:t[2],left:t[1]};if(t.length===2)return{top:t[0],right:t[1],bottom:t[0],left:t[1]};t.length===1?t=t[0]:t=r}return typeof t=="object"?(typeof t.vertical=="number"&&(t.top=t.vertical,t.bottom=t.vertical),typeof t.horizontal=="number"&&(t.right=t.horizontal,t.left=t.horizontal),{left:(e=t.left)!==null&&e!==void 0?e:r,top:(n=t.top)!==null&&n!==void 0?n:r,right:(i=t.right)!==null&&i!==void 0?i:r,bottom:(a=t.bottom)!==null&&a!==void 0?a:r}):(typeof t!="number"&&(t=r),{top:t,right:t,bottom:t,left:t})}function Mb(t,r){var e=bu(r.settings.margin,0);return t.pageSize().width-(e.left+e.right)}function J8(t,r,e,n,i){var a={},o=1.3333333333333333,s=Tm(r,function(q){return i.getComputedStyle(q).backgroundColor});s!=null&&(a.fillColor=s);var l=Tm(r,function(q){return i.getComputedStyle(q).color});l!=null&&(a.textColor=l);var c=eO(n,e);c&&(a.cellPadding=c);var f="borderTopColor",v=o*e,x=n.borderTopWidth;if(n.borderBottomWidth===x&&n.borderRightWidth===x&&n.borderLeftWidth===x){var p=(parseFloat(x)||0)/v;p&&(a.lineWidth=p)}else a.lineWidth={top:(parseFloat(n.borderTopWidth)||0)/v,right:(parseFloat(n.borderRightWidth)||0)/v,bottom:(parseFloat(n.borderBottomWidth)||0)/v,left:(parseFloat(n.borderLeftWidth)||0)/v},a.lineWidth.top||(a.lineWidth.right?f="borderRightColor":a.lineWidth.bottom?f="borderBottomColor":a.lineWidth.left&&(f="borderLeftColor"));var S=Tm(r,function(q){return i.getComputedStyle(q)[f]});S!=null&&(a.lineColor=S);var w=["left","right","center","justify"];w.indexOf(n.textAlign)!==-1&&(a.halign=n.textAlign),w=["middle","bottom","top"],w.indexOf(n.verticalAlign)!==-1&&(a.valign=n.verticalAlign);var k=parseInt(n.fontSize||"");isNaN(k)||(a.fontSize=k/o);var O=Q8(n);O&&(a.fontStyle=O);var H=(n.fontFamily||"").toLowerCase();return t.indexOf(H)!==-1&&(a.font=H),a}function Q8(t){var r="";return(t.fontWeight==="bold"||t.fontWeight==="bolder"||parseInt(t.fontWeight)>=700)&&(r="bold"),(t.fontStyle==="italic"||t.fontStyle==="oblique")&&(r+="italic"),r}function Tm(t,r){var e=Pb(t,r);if(!e)return null;var n=e.match(/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d*\.?\d*))?\)$/);if(!n||!Array.isArray(n))return null;var i=[parseInt(n[1]),parseInt(n[2]),parseInt(n[3])],a=parseInt(n[4]);return a===0||isNaN(i[0])||isNaN(i[1])||isNaN(i[2])?null:i}function Pb(t,r){var e=r(t);return e==="rgba(0, 0, 0, 0)"||e==="transparent"||e==="initial"||e==="inherit"?t.parentElement==null?null:Pb(t.parentElement,r):e}function eO(t,r){var e=[t.paddingTop,t.paddingRight,t.paddingBottom,t.paddingLeft],n=96/(72/r),i=(parseInt(t.lineHeight)-parseInt(t.fontSize))/r/2,a=e.map(function(s){return parseInt(s||"0")/n}),o=bu(a,0);return i>o.top&&(o.top=i),i>o.bottom&&(o.bottom=i),o}function Ob(t,r,e,n,i){var a,o;n===void 0&&(n=!1),i===void 0&&(i=!1);var s;typeof r=="string"?s=e.document.querySelector(r):s=r;var l=Object.keys(t.getFontList()),c=t.scaleFactor(),f=[],v=[],x=[];if(!s)return console.error("Html table could not be found with input: ",r),{head:f,body:v,foot:x};for(var p=0;p<s.rows.length;p++){var S=s.rows[p],w=(o=(a=S?.parentElement)===null||a===void 0?void 0:a.tagName)===null||o===void 0?void 0:o.toLowerCase(),k=tO(l,c,e,S,n,i);k&&(w==="thead"?f.push(k):w==="tfoot"?x.push(k):v.push(k))}return{head:f,body:v,foot:x}}function tO(t,r,e,n,i,a){for(var o=new Sb(n),s=0;s<n.cells.length;s++){var l=n.cells[s],c=e.getComputedStyle(l);if(i||c.display!=="none"){var f=void 0;a&&(f=J8(t,l,r,c,e)),o.push({rowSpan:l.rowSpan,colSpan:l.colSpan,styles:f,_element:l,content:rO(l)})}}var v=e.getComputedStyle(n);if(o.length>0&&(i||v.display!=="none"))return o}function rO(t){var r=t.cloneNode(!0);return r.innerHTML=r.innerHTML.replace(/\n/g,"").replace(/ +/g," "),r.innerHTML=r.innerHTML.split(/<br.*?>/).map(function(e){return e.trim()}).join(`
`),r.innerText||r.textContent||""}function nO(t,r,e){for(var n=0,i=[t,r,e];n<i.length;n++){var a=i[n];a&&typeof a!="object"&&console.error("The options parameter should be of type object, is: "+typeof a),a.startY&&typeof a.startY!="number"&&(console.error("Invalid value for startY option",a.startY),delete a.startY)}}function Yo(t,r,e,n,i){if(t==null)throw new TypeError("Cannot convert undefined or null to object");for(var a=Object(t),o=1;o<arguments.length;o++){var s=arguments[o];if(s!=null)for(var l in s)Object.prototype.hasOwnProperty.call(s,l)&&(a[l]=s[l])}return a}function Ab(t,r){var e=new Ic(t),n=e.getDocumentOptions(),i=e.getGlobalOptions();nO(i,n,r);var a=Yo({},i,n,r),o;typeof window<"u"&&(o=window);var s=iO(i,n,r),l=aO(i,n,r),c=oO(e,a),f=lO(e,a,o);return{id:r.tableId,content:f,hooks:l,styles:s,settings:c}}function iO(t,r,e){for(var n={styles:{},headStyles:{},bodyStyles:{},footStyles:{},alternateRowStyles:{},columnStyles:{}},i=function(l){if(l==="columnStyles"){var c=t[l],f=r[l],v=e[l];n.columnStyles=Yo({},c,f,v)}else{var x=[t,r,e],p=x.map(function(S){return S[l]||{}});n[l]=Yo({},p[0],p[1],p[2])}},a=0,o=Object.keys(n);a<o.length;a++){var s=o[a];i(s)}return n}function aO(t,r,e){for(var n=[t,r,e],i={didParseCell:[],willDrawCell:[],didDrawCell:[],willDrawPage:[],didDrawPage:[]},a=0,o=n;a<o.length;a++){var s=o[a];s.didParseCell&&i.didParseCell.push(s.didParseCell),s.willDrawCell&&i.willDrawCell.push(s.willDrawCell),s.didDrawCell&&i.didDrawCell.push(s.didDrawCell),s.willDrawPage&&i.willDrawPage.push(s.willDrawPage),s.didDrawPage&&i.didDrawPage.push(s.didDrawPage)}return i}function oO(t,r){var e,n,i,a,o,s,l,c,f,v,x,p,S=bu(r.margin,40/t.scaleFactor()),w=(e=sO(t,r.startY))!==null&&e!==void 0?e:S.top,k;r.showFoot===!0?k="everyPage":r.showFoot===!1?k="never":k=(n=r.showFoot)!==null&&n!==void 0?n:"everyPage";var O;r.showHead===!0?O="everyPage":r.showHead===!1?O="never":O=(i=r.showHead)!==null&&i!==void 0?i:"everyPage";var H=(a=r.useCss)!==null&&a!==void 0?a:!1,q=r.theme||(H?"plain":"striped"),X=!!r.horizontalPageBreak,he=(o=r.horizontalPageBreakRepeat)!==null&&o!==void 0?o:null;return{includeHiddenHtml:(s=r.includeHiddenHtml)!==null&&s!==void 0?s:!1,useCss:H,theme:q,startY:w,margin:S,pageBreak:(l=r.pageBreak)!==null&&l!==void 0?l:"auto",rowPageBreak:(c=r.rowPageBreak)!==null&&c!==void 0?c:"auto",tableWidth:(f=r.tableWidth)!==null&&f!==void 0?f:"auto",showHead:O,showFoot:k,tableLineWidth:(v=r.tableLineWidth)!==null&&v!==void 0?v:0,tableLineColor:(x=r.tableLineColor)!==null&&x!==void 0?x:200,horizontalPageBreak:X,horizontalPageBreakRepeat:he,horizontalPageBreakBehaviour:(p=r.horizontalPageBreakBehaviour)!==null&&p!==void 0?p:"afterAllRows"}}function sO(t,r){var e=t.getLastAutoTable(),n=t.scaleFactor(),i=t.pageNumber(),a=!1;if(e&&e.startPageNumber){var o=e.startPageNumber+e.pageNumber-1;a=o===i}return typeof r=="number"?r:(r==null||r===!1)&&a&&e?.finalY!=null?e.finalY+20/n:null}function lO(t,r,e){var n=r.head||[],i=r.body||[],a=r.foot||[];if(r.html){var o=r.includeHiddenHtml;if(e){var s=Ob(t,r.html,e,o,r.useCss)||{};n=s.head||n,i=s.body||n,a=s.foot||n}else console.error("Cannot parse html in non browser environment")}var l=r.columns||cO(n,i,a);return{columns:l,head:n,body:i,foot:a}}function cO(t,r,e){var n=t[0]||r[0]||e[0]||[],i=[];return Object.keys(n).filter(function(a){return a!=="_element"}).forEach(function(a){var o=1,s;Array.isArray(n)?s=n[parseInt(a)]:s=n[a],typeof s=="object"&&!Array.isArray(s)&&(o=s?.colSpan||1);for(var l=0;l<o;l++){var c=void 0;Array.isArray(n)?c=i.length:c=a+(l>0?"_".concat(l):"");var f={dataKey:c};i.push(f)}}),i}var Bm=(function(){function t(r,e,n){this.table=e,this.pageNumber=e.pageNumber,this.settings=e.settings,this.cursor=n,this.doc=r.getDocument()}return t})(),dO=(function(t){Cb(r,t);function r(e,n,i,a,o,s){var l=t.call(this,e,n,s)||this;return l.cell=i,l.row=a,l.column=o,l.section=a.section,l}return r})(Bm),fO=(function(){function t(r,e){this.pageNumber=1,this.id=r.id,this.settings=r.settings,this.styles=r.styles,this.hooks=r.hooks,this.columns=e.columns,this.head=e.head,this.body=e.body,this.foot=e.foot}return t.prototype.getHeadHeight=function(r){return this.head.reduce(function(e,n){return e+n.getMaxCellHeight(r)},0)},t.prototype.getFootHeight=function(r){return this.foot.reduce(function(e,n){return e+n.getMaxCellHeight(r)},0)},t.prototype.allRows=function(){return this.head.concat(this.body).concat(this.foot)},t.prototype.callCellHooks=function(r,e,n,i,a,o){for(var s=0,l=e;s<l.length;s++){var c=l[s],f=new dO(r,this,n,i,a,o),v=c(f)===!1;if(n.text=Array.isArray(n.text)?n.text:[n.text],v)return!1}return!0},t.prototype.callEndPageHooks=function(r,e){r.applyStyles(r.userStyles);for(var n=0,i=this.hooks.didDrawPage;n<i.length;n++){var a=i[n];a(new Bm(r,this,e))}},t.prototype.callWillDrawPageHooks=function(r,e){for(var n=0,i=this.hooks.willDrawPage;n<i.length;n++){var a=i[n];a(new Bm(r,this,e))}},t.prototype.getWidth=function(r){if(typeof this.settings.tableWidth=="number")return this.settings.tableWidth;if(this.settings.tableWidth==="wrap"){var e=this.columns.reduce(function(i,a){return i+a.wrappedWidth},0);return e}else{var n=this.settings.margin;return r-n.left-n.right}},t})(),Tb=(function(){function t(r,e,n,i,a){a===void 0&&(a=!1),this.height=0,this.raw=r,r instanceof Sb&&(this.raw=r._element,this.element=r._element),this.index=e,this.section=n,this.cells=i,this.spansMultiplePages=a}return t.prototype.getMaxCellHeight=function(r){var e=this;return r.reduce(function(n,i){var a;return Math.max(n,((a=e.cells[i.index])===null||a===void 0?void 0:a.height)||0)},0)},t.prototype.hasRowSpan=function(r){var e=this;return r.filter(function(n){var i=e.cells[n.index];return i?i.rowSpan>1:!1}).length>0},t.prototype.canEntireRowFit=function(r,e){return this.getMaxCellHeight(e)<=r},t.prototype.getMinimumRowHeight=function(r,e){var n=this;return r.reduce(function(i,a){var o=n.cells[a.index];if(!o)return 0;var s=e.getLineHeight(o.styles.fontSize),l=o.padding("vertical"),c=l+s;return c>i?c:i},0)},t})(),Ib=(function(){function t(r,e,n){var i;this.contentHeight=0,this.contentWidth=0,this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.height=0,this.x=0,this.y=0,this.styles=e,this.section=n,this.raw=r;var a=r;r!=null&&typeof r=="object"&&!Array.isArray(r)?(this.rowSpan=r.rowSpan||1,this.colSpan=r.colSpan||1,a=(i=r.content)!==null&&i!==void 0?i:r,r._element&&(this.raw=r._element)):(this.rowSpan=1,this.colSpan=1);var o=a!=null?""+a:"",s=/\r\n|\r|\n/g;this.text=o.split(s)}return t.prototype.getTextPos=function(){var r;if(this.styles.valign==="top")r=this.y+this.padding("top");else if(this.styles.valign==="bottom")r=this.y+this.height-this.padding("bottom");else{var e=this.height-this.padding("vertical");r=this.y+e/2+this.padding("top")}var n;if(this.styles.halign==="right")n=this.x+this.width-this.padding("right");else if(this.styles.halign==="center"){var i=this.width-this.padding("horizontal");n=this.x+i/2+this.padding("left")}else n=this.x+this.padding("left");return{x:n,y:r}},t.prototype.getContentHeight=function(r,e){e===void 0&&(e=1.15);var n=Array.isArray(this.text)?this.text.length:1,i=this.styles.fontSize/r*e,a=n*i+this.padding("vertical");return Math.max(a,this.styles.minCellHeight)},t.prototype.padding=function(r){var e=bu(this.styles.cellPadding,0);return r==="vertical"?e.top+e.bottom:r==="horizontal"?e.left+e.right:e[r]},t})(),uO=(function(){function t(r,e,n){this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.dataKey=r,this.raw=e,this.index=n}return t.prototype.getMaxCustomCellWidth=function(r){for(var e=0,n=0,i=r.allRows();n<i.length;n++){var a=i[n],o=a.cells[this.index];o&&typeof o.styles.cellWidth=="number"&&(e=Math.max(e,o.styles.cellWidth))}return e},t})();function hO(t,r){pO(t,r);var e=[],n=0;r.columns.forEach(function(a){var o=a.getMaxCustomCellWidth(r);o?a.width=o:(a.width=a.wrappedWidth,e.push(a)),n+=a.width});var i=r.getWidth(t.pageSize().width)-n;i&&(i=Um(e,i,function(a){return Math.max(a.minReadableWidth,a.minWidth)})),i&&(i=Um(e,i,function(a){return a.minWidth})),i=Math.abs(i),!r.settings.horizontalPageBreak&&i>.1/t.scaleFactor()&&(i=i<1?i:Math.round(i),console.log("Of the table content, ".concat(i," units width could not fit page"))),gO(r),_O(r,t),mO(r)}function pO(t,r){var e=t.scaleFactor(),n=r.settings.horizontalPageBreak,i=Mb(t,r);r.allRows().forEach(function(a){for(var o=0,s=r.columns;o<s.length;o++){var l=s[o],c=a.cells[l.index];if(c){var f=r.hooks.didParseCell;r.callCellHooks(t,f,c,a,l,null);var v=c.padding("horizontal");c.contentWidth=vu(c.text,c.styles,t)+v;var x=vu(c.text.join(" ").split(/[^\S\u00A0]+/),c.styles,t);if(c.minReadableWidth=x+c.padding("horizontal"),typeof c.styles.cellWidth=="number")c.minWidth=c.styles.cellWidth,c.wrappedWidth=c.styles.cellWidth;else if(c.styles.cellWidth==="wrap"||n===!0)c.contentWidth>i?(c.minWidth=i,c.wrappedWidth=i):(c.minWidth=c.contentWidth,c.wrappedWidth=c.contentWidth);else{var p=10/e;c.minWidth=c.styles.minCellWidth||p,c.wrappedWidth=c.contentWidth,c.minWidth>c.wrappedWidth&&(c.wrappedWidth=c.minWidth)}}}}),r.allRows().forEach(function(a){for(var o=0,s=r.columns;o<s.length;o++){var l=s[o],c=a.cells[l.index];if(c&&c.colSpan===1)l.wrappedWidth=Math.max(l.wrappedWidth,c.wrappedWidth),l.minWidth=Math.max(l.minWidth,c.minWidth),l.minReadableWidth=Math.max(l.minReadableWidth,c.minReadableWidth);else{var f=r.styles.columnStyles[l.dataKey]||r.styles.columnStyles[l.index]||{},v=f.cellWidth||f.minCellWidth;v&&typeof v=="number"&&(l.minWidth=v,l.wrappedWidth=v)}c&&(c.colSpan>1&&!l.minWidth&&(l.minWidth=c.minWidth),c.colSpan>1&&!l.wrappedWidth&&(l.wrappedWidth=c.minWidth))}})}function Um(t,r,e){for(var n=r,i=t.reduce(function(p,S){return p+S.wrappedWidth},0),a=0;a<t.length;a++){var o=t[a],s=o.wrappedWidth/i,l=n*s,c=o.width+l,f=e(o),v=c<f?f:c;r-=v-o.width,o.width=v}if(r=Math.round(r*1e10)/1e10,r){var x=t.filter(function(p){return r<0?p.width>e(p):!0});x.length&&(r=Um(x,r,e))}return r}function mO(t){for(var r={},e=1,n=t.allRows(),i=0;i<n.length;i++)for(var a=n[i],o=0,s=t.columns;o<s.length;o++){var l=s[o],c=r[l.index];if(e>1)e--,delete a.cells[l.index];else if(c)c.cell.height+=a.height,e=c.cell.colSpan,delete a.cells[l.index],c.left--,c.left<=1&&delete r[l.index];else{var f=a.cells[l.index];if(!f)continue;if(f.height=a.height,f.rowSpan>1){var v=n.length-i,x=f.rowSpan>v?v:f.rowSpan;r[l.index]={cell:f,left:x,row:a}}}}}function gO(t){for(var r=t.allRows(),e=0;e<r.length;e++)for(var n=r[e],i=null,a=0,o=0,s=0;s<t.columns.length;s++){var l=t.columns[s];if(o-=1,o>1&&t.columns[s+1])a+=l.width,delete n.cells[l.index];else if(i){var c=i;delete n.cells[l.index],i=null,c.width=l.width+a}else{var c=n.cells[l.index];if(!c)continue;if(o=c.colSpan,a=0,c.colSpan>1){i=c,a+=l.width;continue}c.width=l.width+a}}}function _O(t,r){for(var e={count:0,height:0},n=0,i=t.allRows();n<i.length;n++){for(var a=i[n],o=0,s=t.columns;o<s.length;o++){var l=s[o],c=a.cells[l.index];if(c){r.applyStyles(c.styles,!0);var f=c.width-c.padding("horizontal");if(c.styles.overflow==="linebreak")c.text=r.splitTextToSize(c.text,f+1/r.scaleFactor(),{fontSize:c.styles.fontSize});else if(c.styles.overflow==="ellipsize")c.text=vb(c.text,f,c.styles,r,"...");else if(c.styles.overflow==="hidden")c.text=vb(c.text,f,c.styles,r,"");else if(typeof c.styles.overflow=="function"){var v=c.styles.overflow(c.text,f);typeof v=="string"?c.text=[v]:c.text=v}c.contentHeight=c.getContentHeight(r.scaleFactor(),r.getLineHeightFactor());var x=c.contentHeight/c.rowSpan;c.rowSpan>1&&e.count*e.height<x*c.rowSpan?e={height:x,count:c.rowSpan}:e&&e.count>0&&e.height>x&&(x=e.height),x>a.height&&(a.height=x)}}e.count--}}function vb(t,r,e,n,i){return t.map(function(a){return vO(a,r,e,n,i)})}function vO(t,r,e,n,i){var a=1e4*n.scaleFactor();if(r=Math.ceil(r*a)/a,r>=vu(t,e,n))return t;for(;r<vu(t+i,e,n)&&!(t.length<=1);)t=t.substring(0,t.length-1);return t.trim()+i}function Fb(t,r){var e=new Ic(t),n=xO(r,e.scaleFactor()),i=new fO(r,n);return hO(e,i),e.applyStyles(e.userStyles),i}function xO(t,r){var e=t.content,n=wO(e.columns);if(e.head.length===0){var i=xb(n,"head");i&&e.head.push(i)}if(e.foot.length===0){var i=xb(n,"foot");i&&e.foot.push(i)}var a=t.settings.theme,o=t.styles;return{columns:n,head:Im("head",e.head,n,o,a,r),body:Im("body",e.body,n,o,a,r),foot:Im("foot",e.foot,n,o,a,r)}}function Im(t,r,e,n,i,a){var o={},s=r.map(function(l,c){for(var f=0,v={},x=0,p=0,S=0,w=e;S<w.length;S++){var k=w[S];if(o[k.index]==null||o[k.index].left===0)if(p===0){var O=void 0;Array.isArray(l)?O=l[k.index-x-f]:O=l[k.dataKey];var H={};typeof O=="object"&&!Array.isArray(O)&&(H=O?.styles||{});var q=yO(t,k,c,i,n,a,H),X=new Ib(O,q,t);v[k.dataKey]=X,v[k.index]=X,p=X.colSpan-1,o[k.index]={left:X.rowSpan-1,times:p}}else p--,x++;else o[k.index].left--,p=o[k.index].times,f++}return new Tb(l,c,t,v)});return s}function xb(t,r){var e={};return t.forEach(function(n){if(n.raw!=null){var i=bO(r,n.raw);i!=null&&(e[n.dataKey]=i)}}),Object.keys(e).length>0?e:null}function bO(t,r){if(t==="head"){if(typeof r=="object")return r.header||null;if(typeof r=="string"||typeof r=="number")return r}else if(t==="foot"&&typeof r=="object")return r.footer;return null}function wO(t){return t.map(function(r,e){var n,i;return typeof r=="object"?i=(n=r.dataKey)!==null&&n!==void 0?n:e:i=e,new uO(i,r,e)})}function yO(t,r,e,n,i,a,o){var s=Z8(n),l;t==="head"?l=i.headStyles:t==="body"?l=i.bodyStyles:t==="foot"&&(l=i.footStyles);var c=Yo({},s.table,s[t],i.styles,l),f=i.columnStyles[r.dataKey]||i.columnStyles[r.index]||{},v=t==="body"?f:{},x=t==="body"&&e%2===0?Yo({},s.alternateRow,i.alternateRowStyles):{},p=K8(a),S=Yo({},p,c,x,v);return Yo(S,o)}function CO(t,r,e){var n;e===void 0&&(e={});var i=Mb(t,r),a=new Map,o=[],s=[],l=[];Array.isArray(r.settings.horizontalPageBreakRepeat)?l=r.settings.horizontalPageBreakRepeat:(typeof r.settings.horizontalPageBreakRepeat=="string"||typeof r.settings.horizontalPageBreakRepeat=="number")&&(l=[r.settings.horizontalPageBreakRepeat]),l.forEach(function(x){var p=r.columns.find(function(S){return S.dataKey===x||S.index===x});p&&!a.has(p.index)&&(a.set(p.index,!0),o.push(p.index),s.push(r.columns[p.index]),i-=p.wrappedWidth)});for(var c=!0,f=(n=e?.start)!==null&&n!==void 0?n:0;f<r.columns.length;){if(a.has(f)){f++;continue}var v=r.columns[f].wrappedWidth;if(c||i>=v)c=!1,o.push(f),s.push(r.columns[f]),i-=v;else break;f++}return{colIndexes:o,columns:s,lastIndex:f-1}}function SO(t,r){for(var e=[],n=0;n<r.columns.length;n++){var i=CO(t,r,{start:n});i.columns.length&&(e.push(i),n=i.lastIndex)}return e}function Db(t,r){var e=r.settings,n=e.startY,i=e.margin,a={x:i.left,y:n},o=r.getHeadHeight(r.columns)+r.getFootHeight(r.columns),s=n+i.bottom+o;if(e.pageBreak==="avoid"){var l=r.body,c=l.reduce(function(x,p){return x+p.height},0);s+=c}var f=new Ic(t);(e.pageBreak==="always"||e.startY!=null&&s>f.pageSize().height)&&(Rb(f),a.y=i.top),r.callWillDrawPageHooks(f,a);var v=Yo({},a);r.startPageNumber=f.pageNumber(),e.horizontalPageBreak?kO(f,r,v,a):(f.applyStyles(f.userStyles),(e.showHead==="firstPage"||e.showHead==="everyPage")&&r.head.forEach(function(x){return Ko(f,r,x,a,r.columns)}),f.applyStyles(f.userStyles),r.body.forEach(function(x,p){var S=p===r.body.length-1;xu(f,r,x,S,v,a,r.columns)}),f.applyStyles(f.userStyles),(e.showFoot==="lastPage"||e.showFoot==="everyPage")&&r.foot.forEach(function(x){return Ko(f,r,x,a,r.columns)})),kb(f,r,v,a),r.callEndPageHooks(f,a),r.finalY=a.y,t.lastAutoTable=r,f.applyStyles(f.userStyles)}function kO(t,r,e,n){var i=SO(t,r),a=r.settings;if(a.horizontalPageBreakBehaviour==="afterAllRows")i.forEach(function(c,f){t.applyStyles(t.userStyles),f>0?od(t,r,e,n,c.columns,!0):bb(t,r,n,c.columns),EO(t,r,e,n,c.columns),Fm(t,r,n,c.columns)});else for(var o=-1,s=i[0],l=function(){var c=o;if(s){t.applyStyles(t.userStyles);var f=s.columns;o>=0?od(t,r,e,n,f,!0):bb(t,r,n,f),c=wb(t,r,o+1,n,f),Fm(t,r,n,f)}var v=c-o;i.slice(1).forEach(function(x){t.applyStyles(t.userStyles),od(t,r,e,n,x.columns,!0),wb(t,r,o+1,n,x.columns,v),Fm(t,r,n,x.columns)}),o=c};o<r.body.length-1;)l()}function bb(t,r,e,n){var i=r.settings;t.applyStyles(t.userStyles),(i.showHead==="firstPage"||i.showHead==="everyPage")&&r.head.forEach(function(a){return Ko(t,r,a,e,n)})}function EO(t,r,e,n,i){t.applyStyles(t.userStyles),r.body.forEach(function(a,o){var s=o===r.body.length-1;xu(t,r,a,s,e,n,i)})}function wb(t,r,e,n,i,a){t.applyStyles(t.userStyles),a=a??r.body.length;var o=Math.min(e+a,r.body.length),s=-1;return r.body.slice(e,o).forEach(function(l,c){var f=e+c===r.body.length-1,v=Nb(t,r,f,n);l.canEntireRowFit(v,i)&&(Ko(t,r,l,n,i),s=e+c)}),s}function Fm(t,r,e,n){var i=r.settings;t.applyStyles(t.userStyles),(i.showFoot==="lastPage"||i.showFoot==="everyPage")&&r.foot.forEach(function(a){return Ko(t,r,a,e,n)})}function MO(t,r,e){var n=e.getLineHeight(t.styles.fontSize),i=t.padding("vertical"),a=Math.floor((r-i)/n);return Math.max(0,a)}function PO(t,r,e,n){var i={};t.spansMultiplePages=!0,t.height=0;for(var a=0,o=0,s=e.columns;o<s.length;o++){var l=s[o],c=t.cells[l.index];if(c){Array.isArray(c.text)||(c.text=[c.text]);var f=new Ib(c.raw,c.styles,c.section);f=Yo(f,c),f.text=[];var v=MO(c,r,n);c.text.length>v&&(f.text=c.text.splice(v,c.text.length));var x=n.scaleFactor(),p=n.getLineHeightFactor();c.contentHeight=c.getContentHeight(x,p),c.contentHeight>=r&&(c.contentHeight=r,f.styles.minCellHeight-=r),c.contentHeight>t.height&&(t.height=c.contentHeight),f.contentHeight=f.getContentHeight(x,p),f.contentHeight>a&&(a=f.contentHeight),i[l.index]=f}}var S=new Tb(t.raw,-1,t.section,i,!0);S.height=a;for(var w=0,k=e.columns;w<k.length;w++){var l=k[w],f=S.cells[l.index];f&&(f.height=S.height);var c=t.cells[l.index];c&&(c.height=t.height)}return S}function OO(t,r,e,n){var i=t.pageSize().height,a=n.settings.margin,o=a.top+a.bottom,s=i-o;r.section==="body"&&(s-=n.getHeadHeight(n.columns)+n.getFootHeight(n.columns));var l=r.getMinimumRowHeight(n.columns,t),c=l<e;if(l>s)return console.log("Will not be able to print row ".concat(r.index," correctly since it's minimum height is larger than page height")),!0;if(!c)return!1;var f=r.hasRowSpan(n.columns),v=r.getMaxCellHeight(n.columns)>s;return v?(f&&console.log("The content of row ".concat(r.index," will not be drawn correctly since drawing rows with a height larger than the page height and has cells with rowspans is not supported.")),!0):!(f||n.settings.rowPageBreak==="avoid")}function xu(t,r,e,n,i,a,o){var s=Nb(t,r,n,a);if(e.canEntireRowFit(s,o))Ko(t,r,e,a,o);else if(OO(t,e,s,r)){var l=PO(e,s,r,t);Ko(t,r,e,a,o),od(t,r,i,a,o),xu(t,r,l,n,i,a,o)}else od(t,r,i,a,o),xu(t,r,e,n,i,a,o)}function Ko(t,r,e,n,i){n.x=r.settings.margin.left;for(var a=0,o=i;a<o.length;a++){var s=o[a],l=e.cells[s.index];if(!l){n.x+=s.width;continue}t.applyStyles(l.styles),l.x=n.x,l.y=n.y;var c=r.callCellHooks(t,r.hooks.willDrawCell,l,e,s,n);if(c===!1){n.x+=s.width;continue}AO(t,l,n);var f=l.getTextPos();yb(l.text,f.x,f.y,{halign:l.styles.halign,valign:l.styles.valign,maxWidth:Math.ceil(l.width-l.padding("left")-l.padding("right"))},t.getDocument()),r.callCellHooks(t,r.hooks.didDrawCell,l,e,s,n),n.x+=s.width}n.y+=e.height}function AO(t,r,e){var n=r.styles;if(t.getDocument().setFillColor(t.getDocument().getFillColor()),typeof n.lineWidth=="number"){var i=Eb(n.lineWidth,n.fillColor);i&&t.rect(r.x,e.y,r.width,r.height,i)}else typeof n.lineWidth=="object"&&(n.fillColor&&t.rect(r.x,e.y,r.width,r.height,"F"),TO(t,r,e,n.lineWidth))}function TO(t,r,e,n){var i,a,o,s;n.top&&(i=e.x,a=e.y,o=e.x+r.width,s=e.y,n.right&&(o+=.5*n.right),n.left&&(i-=.5*n.left),l(n.top,i,a,o,s)),n.bottom&&(i=e.x,a=e.y+r.height,o=e.x+r.width,s=e.y+r.height,n.right&&(o+=.5*n.right),n.left&&(i-=.5*n.left),l(n.bottom,i,a,o,s)),n.left&&(i=e.x,a=e.y,o=e.x,s=e.y+r.height,n.top&&(a-=.5*n.top),n.bottom&&(s+=.5*n.bottom),l(n.left,i,a,o,s)),n.right&&(i=e.x+r.width,a=e.y,o=e.x+r.width,s=e.y+r.height,n.top&&(a-=.5*n.top),n.bottom&&(s+=.5*n.bottom),l(n.right,i,a,o,s));function l(c,f,v,x,p){t.getDocument().setLineWidth(c),t.getDocument().line(f,v,x,p,"S")}}function Nb(t,r,e,n){var i=r.settings.margin.bottom,a=r.settings.showFoot;return(a==="everyPage"||a==="lastPage"&&e)&&(i+=r.getFootHeight(r.columns)),t.pageSize().height-n.y-i}function od(t,r,e,n,i,a){i===void 0&&(i=[]),a===void 0&&(a=!1),t.applyStyles(t.userStyles),r.settings.showFoot==="everyPage"&&!a&&r.foot.forEach(function(s){return Ko(t,r,s,n,i)}),r.callEndPageHooks(t,n);var o=r.settings.margin;kb(t,r,e,n),Rb(t),r.pageNumber++,n.x=o.left,n.y=o.top,e.y=o.top,r.callWillDrawPageHooks(t,n),r.settings.showHead==="everyPage"&&(r.head.forEach(function(s){return Ko(t,r,s,n,i)}),t.applyStyles(t.userStyles))}function Rb(t){var r=t.pageNumber();t.setPage(r+1);var e=t.pageNumber();return e===r?(t.addPage(),!0):!1}function IO(t){t.API.autoTable=function(){for(var r=[],e=0;e<arguments.length;e++)r[e]=arguments[e];var n=r[0],i=Ab(this,n),a=Fb(this,i);return Db(this,a),this},t.API.lastAutoTable=!1,t.API.autoTableText=function(r,e,n,i){yb(r,e,n,i,this)},t.API.autoTableSetDefaults=function(r){return Ic.setDefaults(r,this),this},t.autoTableSetDefaults=function(r,e){Ic.setDefaults(r,e)},t.API.autoTableHtmlToJson=function(r,e){var n;if(e===void 0&&(e=!1),typeof window>"u")return console.error("Cannot run autoTableHtmlToJson in non browser environment"),null;var i=new Ic(this),a=Ob(i,r,window,e,!1),o=a.head,s=a.body,l=((n=o[0])===null||n===void 0?void 0:n.map(function(c){return c.content}))||[];return{columns:l,rows:s,data:s}}}var Dm;function sd(t,r){var e=Ab(t,r),n=Fb(t,e);Db(t,n)}try{typeof window<"u"&&window&&(Nm=window,Rm=Nm.jsPDF||((Dm=Nm.jspdf)===null||Dm===void 0?void 0:Dm.jsPDF),Rm&&IO(Rm))}catch(t){console.error("Could not apply autoTable plugin",t)}var Nm,Rm;var Fc=class t{exportToExcel(r,e,n,i,a=!1,o=!1){let s=this.getOrderedVisibleColumns(e),l=lo.book_new(),c=[];if(i){let f=this.groupData(r,i,o);Object.keys(f).forEach(x=>{c.push({[s[0].label]:`${i.toUpperCase()}: ${x}`});let p=this.formatDataForExport(f[x],s);if(c.push(...p),a){let S=this.calculateSummary(f[x],s);c.push(S.total),c.push(S.average)}c.push({})});let v=lo.json_to_sheet(c,{skipHeader:!1});lo.book_append_sheet(l,v,"Reporte")}else{let f=this.formatDataForExport(r,s);if(c.push(...f),a){let x=this.calculateSummary(r,s);c.push({}),c.push(x.total),c.push(x.average)}let v=lo.json_to_sheet(c);lo.book_append_sheet(l,v,"Reporte")}Rf(l,`${n}.xlsx`)}exportToPdf(r,e,n,i,a,o=!1,s=!1){let l=this.getOrderedVisibleColumns(e),c=new bt,f=[l.map(v=>v.label)];if(a){let v=this.groupData(r,a,s),x=35;Object.keys(v).forEach((p,S)=>{x>250&&(c.addPage(),x=20),S>0&&(x+=10),c.setFontSize(12),c.setTextColor(0),c.setFont("helvetica","bold"),c.text(`${a.toUpperCase()}: ${p}`,14,x),x+=5;let k=this.formatDataForExport(v[p],l).map(O=>l.map(H=>O[H.label]));if(o){let O=this.calculateSummary(v[p],l);k.push(l.map(H=>O.total[H.label])),k.push(l.map(H=>O.average[H.label]))}sd(c,{startY:x,head:f,body:k,theme:"striped",headStyles:{fillColor:[41,128,185],textColor:255},styles:{fontSize:8,cellPadding:2},didDrawPage:O=>{}}),x=c.lastAutoTable.finalY+5})}else{let x=this.formatDataForExport(r,l).map(p=>l.map(S=>p[S.label]));if(o){let p=this.calculateSummary(r,l);x.push(l.map(S=>p.total[S.label])),x.push(l.map(S=>p.average[S.label]))}sd(c,{startY:35,head:f,body:x,theme:"striped",headStyles:{fillColor:[41,128,185],textColor:255},styles:{fontSize:8,cellPadding:2}})}c.save(`${n}.pdf`)}calculateSummary(r,e){let n=r.reduce((s,l)=>s+(Number(l.total)||0),0),i=r.length>0?Math.round(n/r.length):0,a={},o={};return e.forEach((s,l)=>{l===0?(a[s.label]="TOTAL",o[s.label]="PROMEDIO"):s.id==="total"?(a[s.label]=n,o[s.label]=i):(a[s.label]="",o[s.label]="")}),{total:a,average:o}}groupData(r,e,n=!1){return r.reduce((i,a)=>{let o=this.resolveValue(a,e)||"Sin Valor";if(n&&e==="date"){let s=a.date||(a.serviceTime?a.serviceTime.split("T")[0]:""),l=a.serviceName||"";l&&(o=`${s} (${l})`)}return i[o]||(i[o]=[]),i[o].push(a),i},{})}getOrderedVisibleColumns(r){return[...r].filter(e=>e.visible).sort((e,n)=>e.order-n.order)}formatDataForExport(r,e){let n=new Map;return r.forEach(i=>{let a={},o=[];e.forEach(l=>{let c=this.resolveValue(i,l.id);a[l.label]=c,l.id!=="total"&&o.push(String(c))});let s=o.join("|");if(n.has(s)){let l=n.get(s);e.forEach(c=>{if(c.id==="total"){let f=this.resolveValue(i,c.id);l[c.label]=(Number(l[c.label])||0)+(Number(f)||0)}})}else n.set(s,Yr({},a))}),Array.from(n.values())}resolveValue(r,e){let n;if(e==="attendanceDate"||e==="serviceDate")n=new Date(r[e]||r.id?.[e]).toLocaleString();else if(e==="date"){let i=r.date||(r.serviceTime?r.serviceTime.split("T")[0]:""),a=r.serviceName||"";n=a?`${i} (${a})`:i}else e==="date"&&r.serviceTime?n=new Date(r.serviceTime).toLocaleString():e.includes(".")?n=e.split(".").reduce((i,a)=>i?.[a],r):n=r[e];return n&&typeof n=="object"&&"name"in n?n.name:n}static \u0275fac=function(e){return new(e||t)};static \u0275prov=nr({token:t,factory:t.\u0275fac,providedIn:"root"})};var js=class t{constructor(r,e){this.el=r;this.renderer=e;this.subscription=this.clicks.pipe(qg(600)).subscribe(n=>{this.safeClick.emit(n),this.applyFeedback()})}_throttleDelay=600;set throttleDelay(r){r!==""&&(this._throttleDelay=typeof r=="string"?parseInt(r,10)||600:r)}get throttleDelay(){return this._throttleDelay}safeClick=new Fn;clicks=new Bt;subscription;clickEvent(r){r.preventDefault(),r.stopPropagation(),this.clicks.next(r)}applyFeedback(){this.renderer.setStyle(this.el.nativeElement,"opacity","0.6"),this.renderer.setStyle(this.el.nativeElement,"pointer-events","none"),this.renderer.setStyle(this.el.nativeElement,"cursor","not-allowed"),Hg(this.throttleDelay).subscribe(()=>{this.renderer.removeStyle(this.el.nativeElement,"opacity"),this.renderer.removeStyle(this.el.nativeElement,"pointer-events"),this.renderer.removeStyle(this.el.nativeElement,"cursor")})}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}static \u0275fac=function(e){return new(e||t)(h0(Ro),h0(u0))};static \u0275dir=_s({type:t,selectors:[["","appSafeClick",""]],hostBindings:function(e,n){e&1&&L("click",function(a){return n.clickEvent(a)})},inputs:{throttleDelay:[0,"appSafeClick","throttleDelay"]},outputs:{safeClick:"safeClick"}})};function FO(t,r){if(t&1&&(d(0,"span",39),_(1),u()),t&2){let e=C();g(),je(" ",e.selectedTypes.length+e.selectedCategories.length+(e.hasCc!==null?1:0)+(e.hasCellphone!==null?1:0)+(e.hasAddress!==null?1:0)+(e.hasBirthdate!==null?1:0)+(e.ageFilterRange1!==null||e.ageFilterRange2!==null?1:0)+(e.filterLocation?1:0)," ")}}function DO(t,r){if(t&1&&(d(0,"span",40),_(1),u()),t&2){let e=C();g(),je(" ",e.selectedTypes.length+e.selectedCategories.length+e.selectedSubCategories.length+(e.hasCc!==null?1:0)+(e.hasCellphone!==null?1:0)+(e.hasAddress!==null?1:0)+(e.hasBirthdate!==null?1:0)+(e.ageFilterRange1!==null||e.ageFilterRange2!==null?1:0)+(e.filterLocation?1:0)," ")}}function NO(t,r){if(t&1){let e=Pe();d(0,"button",46),L("click",function(){D(e);let i=C(2);return i.openFormModal(),N(i.showMobileMenu=!1)}),j(1,"i",49),d(2,"span"),_(3,"Nuevo Integrante"),u()()}}function RO(t,r){if(t&1){let e=Pe();d(0,"div",41)(1,"div",42)(2,"span",43),_(3,"Opciones"),u()(),fe(4,NO,4,0,"button",44),j(5,"div",45),d(6,"button",46),L("click",function(){D(e);let i=C();return i.exportData("excel"),N(i.showMobileMenu=!1)}),j(7,"i",47),d(8,"span"),_(9,"Exportar Excel"),u()(),d(10,"button",46),L("click",function(){D(e);let i=C();return i.exportData("pdf"),N(i.showMobileMenu=!1)}),j(11,"i",48),d(12,"span"),_(13,"Exportar PDF"),u()()()}if(t&2){let e=C();g(4),P("ngIf",e.can("CREATE_MEMBER"))}}function LO(t,r){if(t&1){let e=Pe();d(0,"div",50)(1,"button",46),L("click",function(){D(e);let i=C();return N(i.exportData("excel"))}),j(2,"i",47),d(3,"span"),_(4,"Excel"),u()(),d(5,"button",46),L("click",function(){D(e);let i=C();return N(i.exportData("pdf"))}),j(6,"i",48),d(7,"span"),_(8,"PDF"),u()()()}}function BO(t,r){if(t&1){let e=Pe();d(0,"button",51),L("click",function(){D(e);let i=C();return N(i.openFormModal())}),j(1,"i",52),d(2,"span",5),_(3,"Nuevo"),u()()}}function UO(t,r){t&1&&(d(0,"tr")(1,"td",53)(2,"div",54),j(3,"div",55),d(4,"div"),_(5,"Cargando integrantes..."),u()()()())}function VO(t,r){if(t&1&&(d(0,"span",87),_(1),u()),t&2){let e=C().$implicit;g(),je("",e.age," a\xF1os")}}function zO(t,r){if(t&1&&(d(0,"span",88),_(1),u()),t&2){let e=C().$implicit;Ft("background-color",e.category.color),g(),be(e.category.name)}}function jO(t,r){if(t&1&&(d(0,"span",89),_(1),u()),t&2){let e=C().$implicit;Ft("border-color",e.category.color)("color",e.category.color),g(),be(e.subCategory.name)}}function HO(t,r){if(t&1&&(d(0,"span",90),_(1),u()),t&2){let e=C().$implicit;Ft("background-color",e.category.color),g(),je(" ",e.category.name," ")}}function WO(t,r){if(t&1&&(d(0,"span",91),_(1),u()),t&2){let e=C().$implicit;Ft("border-color",e.subCategory.color||"#ccc")("color",e.subCategory.color||"#ccc"),g(),je(" ",e.subCategory.name," ")}}function qO(t,r){if(t&1&&(d(0,"span",92),_(1),u()),t&2){let e=C().$implicit;wt("badge-blue",e.gender==="HOMBRE")("badge-pink",e.gender==="MUJER"),g(),je(" ",e.gender==="HOMBRE"?"M":e.gender==="MUJER"?"F":e.gender," ")}}function GO(t,r){t&1&&(d(0,"span",93),_(1,"---"),u())}function $O(t,r){if(t&1){let e=Pe();d(0,"button",94),L("click",function(){D(e);let i=C().$implicit,a=C(2);return N(a.editIntegrante(i))}),j(1,"i",95),u()}}function XO(t,r){if(t&1){let e=Pe();d(0,"button",96),L("click",function(){D(e);let i=C().$implicit,a=C(2);return N(a.openNoteModal(i))}),j(1,"i",97),u()}}function YO(t,r){if(t&1){let e=Pe();d(0,"button",98),L("click",function(){D(e);let i=C().$implicit,a=C(2);return N(a.deleteIntegrante(i.id))}),j(1,"i",99),u()}}function KO(t,r){if(t&1){let e=Pe();d(0,"button",46),L("click",function(){D(e);let i=C(2).$implicit,a=C(2);return a.editIntegrante(i),N(a.activeDropdownId=null)}),j(1,"i",107),d(2,"span"),_(3,"Editar"),u()()}}function ZO(t,r){if(t&1){let e=Pe();d(0,"button",46),L("click",function(){D(e);let i=C(2).$implicit,a=C(2);return a.openNoteModal(i),N(a.activeDropdownId=null)}),j(1,"i",97),d(2,"span"),_(3,"Agregar Nota"),u()()}}function JO(t,r){if(t&1){let e=Pe();d(0,"button",46),L("click",function(){D(e);let i=C(2).$implicit,a=C(2);return a.deleteIntegrante(i.id),N(a.activeDropdownId=null)}),j(1,"i",108),d(2,"span",109),_(3,"Eliminar"),u()()}}function QO(t,r){if(t&1){let e=Pe();d(0,"div",100),L("click",function(i){return D(e),N(i.stopPropagation())}),d(1,"div",101)(2,"span",102),_(3),u()(),d(4,"div",103)(5,"span",104),_(6,"Estado"),u(),d(7,"label",105),L("safeClick",function(){D(e);let i=C().$implicit,a=C(2);return N(a.toggleMemberStatus(i))}),j(8,"input",77)(9,"span",78),u()(),j(10,"hr",106),d(11,"button",46),L("click",function(){D(e);let i=C().$implicit,a=C(2);return a.viewMember(i),N(a.activeDropdownId=null)}),j(12,"i",80),d(13,"span"),_(14,"Ver Detalles"),u()(),fe(15,KO,4,0,"button",44)(16,ZO,4,0,"button",44)(17,JO,4,0,"button",44),u()}if(t&2){let e=C().$implicit,n=C(2);g(3),be(e.completeName),g(5),P("checked",e.active)("disabled",!n.can("UPDATE_MEMBER")),g(7),P("ngIf",n.can("UPDATE_MEMBER")),g(),P("ngIf",n.can("CREATE_NOTE")),g(),P("ngIf",n.can("DELETE_MEMBER"))}}function eA(t,r){if(t&1){let e=Pe();d(0,"tr")(1,"td")(2,"div",57),j(3,"img",58),d(4,"div",59)(5,"span",60),_(6),u(),fe(7,VO,2,1,"span",61),d(8,"div",62),fe(9,zO,2,3,"span",63)(10,jO,2,5,"span",64),u()()()(),d(11,"td",30),_(12),u(),d(13,"td",5)(14,"div",65),_(15),u()(),d(16,"td",5)(17,"div",66),fe(18,HO,2,3,"span",67)(19,WO,2,5,"span",68),u()(),d(20,"td",5)(21,"span",69),_(22),u()(),d(23,"td",30),fe(24,qO,2,5,"span",70)(25,GO,2,0,"span",71),u(),d(26,"td",5)(27,"span",72),_(28),u()(),d(29,"td",73)(30,"div",74)(31,"div",75)(32,"label",76),L("safeClick",function(){let i=D(e).$implicit,a=C(2);return N(a.toggleMemberStatus(i))}),j(33,"input",77)(34,"span",78),u(),d(35,"button",79),L("click",function(){let i=D(e).$implicit,a=C(2);return N(a.viewMember(i))}),j(36,"i",80),u(),fe(37,$O,2,0,"button",81)(38,XO,2,0,"button",82)(39,YO,2,0,"button",83),u(),d(40,"div",84)(41,"button",85),L("click",function(i){let a=D(e).$implicit,o=C(2);return o.activeDropdownId=o.activeDropdownId===a.id?null:a.id,N(i.stopPropagation())}),j(42,"i",19),u(),fe(43,QO,18,6,"div",86),u()()()()}if(t&2){let e=r.$implicit,n=C(2);wt("inactive-row",!e.active),g(3),P("src",e.pictureProfileUrl||"https://ui-avatars.com/api/?name="+e.completeName+"&background=random",pn),g(3),be(e.completeName),g(),P("ngIf",e.age&&e.age>0),g(2),P("ngIf",e.category),g(),P("ngIf",e.subCategory),g(2),be(e.cellphone||"---"),g(2),P("title",e.address||"---"),g(),je(" ",e.address||"---"," "),g(3),P("ngIf",e.category),g(),P("ngIf",e.subCategory),g(2),P("title",(e.branch==null?null:e.branch.name)||e.branchName||"---"),g(),be((e.branch==null?null:e.branch.name)||e.branchName||"---"),g(2),P("ngIf",e.gender),g(),P("ngIf",!e.gender),g(2),Ft("border-color",e.type.color)("color",e.type.color),g(),je(" ",e.type.name," "),g(5),P("checked",e.active)("disabled",!n.can("UPDATE_MEMBER")),g(4),P("ngIf",n.can("UPDATE_MEMBER")),g(),P("ngIf",n.can("CREATE_NOTE")),g(),P("ngIf",n.can("DELETE_MEMBER")),g(4),P("ngIf",n.activeDropdownId===e.id)}}function tA(t,r){if(t&1&&(Ln(0),fe(1,eA,44,27,"tr",56),Bn()),t&2){let e=C();g(),P("ngForOf",e.members)}}function rA(t,r){t&1&&(d(0,"tr")(1,"td",110),j(2,"i",111),_(3," No se encontraron integrantes "),u()())}function nA(t,r){t&1&&(d(0,"div",170)(1,"div",171),j(2,"div",172),d(3,"p"),_(4,"Guardando integrante..."),u()()())}function iA(t,r){if(t&1&&(d(0,"option",176),_(1),u()),t&2){let e=r.$implicit;P("value",e.id),g(),be(e.name)}}function aA(t,r){t&1&&(d(0,"small",177),_(1," La sede es requerida. "),u())}function oA(t,r){if(t&1&&(d(0,"div",132)(1,"label",173),_(2,"Sede *"),u(),d(3,"select",174)(4,"option",135),_(5,"Seleccione una sede"),u(),fe(6,iA,2,2,"option",136),u(),fe(7,aA,2,0,"small",175),u()),t&2){let e,n=C(2);g(6),P("ngForOf",n.branches),g(),P("ngIf",((e=n.integranteForm.get("branchId"))==null?null:e.invalid)&&((e=n.integranteForm.get("branchId"))==null?null:e.touched))}}function sA(t,r){if(t&1&&(d(0,"option",176),_(1),u()),t&2){let e=r.$implicit;P("value",e.id),g(),be(e.name)}}function lA(t,r){if(t&1&&(d(0,"option",176),_(1),u()),t&2){let e=r.$implicit;P("value",e.id),g(),be(e.name)}}function cA(t,r){if(t&1&&(d(0,"option",176),_(1),u()),t&2){let e=r.$implicit;P("value",e.id),g(),je(" ",e.name," ")}}function dA(t,r){if(t&1&&(d(0,"option",176),_(1),u()),t&2){let e=r.$implicit;P("value",e.value),g(),be(e.label)}}function fA(t,r){if(t&1&&(d(0,"small",181),_(1),u()),t&2){let e,n=C(3);g(),je("Barrio: ",(e=n.integranteForm.get("neighborhood"))==null?null:e.value)}}function uA(t,r){if(t&1&&(d(0,"small",181),_(1),u()),t&2){let e,n=C(3);g(),je("Ciudad: ",(e=n.integranteForm.get("city"))==null?null:e.value)}}function hA(t,r){if(t&1&&(d(0,"small",181),_(1),u()),t&2){let e,n=C(3);g(),je("Municipio: ",(e=n.integranteForm.get("municipality"))==null?null:e.value)}}function pA(t,r){if(t&1&&(d(0,"div",178)(1,"small",93),j(2,"i",179),_(3," Direcci\xF3n capturada:"),u(),fe(4,fA,2,1,"small",180)(5,uA,2,1,"small",180)(6,hA,2,1,"small",180),u()),t&2){let e,n,i,a=C(2);g(4),P("ngIf",(e=a.integranteForm.get("neighborhood"))==null?null:e.value),g(),P("ngIf",(n=a.integranteForm.get("city"))==null?null:n.value),g(),P("ngIf",(i=a.integranteForm.get("municipality"))==null?null:i.value)}}function mA(t,r){if(t&1){let e=Pe();d(0,"div",112),L("click",function(){D(e);let i=C();return N(i.closeFormModal())}),fe(1,nA,5,0,"div",113),d(2,"div",114),L("click",function(i){return D(e),N(i.stopPropagation())}),d(3,"div",115)(4,"h2"),_(5),u(),d(6,"button",116),L("click",function(){D(e);let i=C();return N(i.closeFormModal())}),_(7,"\xD7"),u()(),d(8,"div",117)(9,"form",118),L("ngSubmit",function(){D(e);let i=C();return N(i.onSubmit())}),d(10,"div",119)(11,"div",120)(12,"div",121),L("click",function(){D(e);let i=n1(17);return N(i.click())}),j(13,"img",122),d(14,"div",123),j(15,"i",124),u()(),d(16,"input",125,0),L("change",function(i){D(e);let a=C();return N(a.onFileSelected(i))}),u(),d(18,"span",126),_(19,"Foto de Perfil"),u()(),d(20,"div",127)(21,"label",128),_(22,"Nombre Completo *"),u(),j(23,"input",129),u()(),d(24,"div",130),fe(25,oA,8,2,"div",131),d(26,"div",132)(27,"label",133),_(28,"Tipo *"),u(),d(29,"select",134)(30,"option",135),_(31,"Seleccione un tipo"),u(),fe(32,sA,2,2,"option",136),u()(),d(33,"div",132)(34,"label",137),_(35,"Categor\xEDa *"),u(),d(36,"select",138),L("change",function(){D(e);let i=C();return N(i.onCategoryChange())}),d(37,"option",135),_(38,"Seleccione una categor\xEDa"),u(),fe(39,lA,2,2,"option",136),u()(),d(40,"div",132)(41,"label",139),_(42,"Sub-categor\xEDa"),u(),d(43,"select",140)(44,"option",141),_(45,"Ninguna"),u(),fe(46,cA,2,2,"option",136),u()(),d(47,"div",142)(48,"label",143),j(49,"input",144),d(50,"span",145),_(51,"Bloquear actualizaci\xF3n autom\xE1tica de categor\xEDas"),u()(),d(52,"small",146),_(53," Al marcar esta opci\xF3n, el sistema no reasignar\xE1 autom\xE1ticamente la categor\xEDa/sub-categor\xEDa de este integrante seg\xFAn las reglas de edad y g\xE9nero. "),u()(),d(54,"div",132)(55,"label",147),_(56,"Tel\xE9fono"),u(),j(57,"input",148),u(),d(58,"div",132)(59,"label",149),_(60,"Nacimiento"),u(),j(61,"input",150),u(),d(62,"div",132)(63,"label",151),_(64,"G\xE9nero *"),u(),d(65,"select",152)(66,"option",135),_(67,"Seleccione un g\xE9nero"),u(),fe(68,dA,2,2,"option",136),u()(),d(69,"div",132)(70,"label",153),_(71,"Identificaci\xF3n (CC)"),u(),j(72,"input",154),u(),d(73,"div",155)(74,"label",156),_(75,"Direcci\xF3n"),u(),d(76,"input",157),L("keydown.enter",function(i){return D(e),N(i.preventDefault())}),u(),fe(77,pA,7,3,"div",158),j(78,"input",159)(79,"input",160)(80,"input",161)(81,"input",162)(82,"input",163)(83,"input",164)(84,"input",165),u()(),d(85,"div",166)(86,"button",167),L("click",function(){D(e);let i=C();return N(i.closeFormModal())}),_(87," Cancelar "),u(),d(88,"button",168),j(89,"i",169),_(90),u()()()()()()}if(t&2){let e,n=C();g(),P("ngIf",n.isSaving&&n.showFormModal),g(4),be(n.isEditing?"Editar Integrante":"Nuevo Integrante"),g(),P("disabled",n.isSaving),g(3),P("formGroup",n.integranteForm),g(4),P("src",n.imagePreview||"https://ui-avatars.com/api/?name=?&size=100&background=e2e8f0&color=94a3b8",pn),g(12),P("ngIf",n.isAdmin),g(7),P("ngForOf",n.availableTypes),g(7),P("ngForOf",n.availableCategories),g(7),P("ngForOf",n.subCategoriesForSelectedCategory),g(22),P("ngForOf",n.availableGenders),g(9),P("ngIf",((e=n.integranteForm.get("neighborhood"))==null?null:e.value)||((e=n.integranteForm.get("city"))==null?null:e.value)),g(9),P("disabled",n.isSaving),g(2),P("disabled",n.integranteForm.invalid||n.isSaving),g(),P("ngClass",n.isSaving?"fa-spinner fa-spin":"fa-save"),g(),je(" ",n.isSaving?n.isEditing?"Actualizando...":"Guardando...":n.isEditing?"Actualizar":"Guardar"," ")}}function gA(t,r){if(t&1&&(d(0,"span",191),_(1),u()),t&2){let e=C(3);Ft("border-color",e.selectedMember.subCategory.color)("color",e.selectedMember.subCategory.color),g(),be(e.selectedMember.subCategory.name)}}function _A(t,r){if(t&1&&(d(0,"div",193)(1,"label"),_(2,"Sub-categor\xEDa:"),u(),d(3,"span",191),_(4),u()()),t&2){let e=C(3);g(3),Ft("border-color",e.selectedMember.subCategory.color)("color",e.selectedMember.subCategory.color),g(),be(e.selectedMember.subCategory.name)}}function vA(t,r){if(t&1&&(d(0,"div",193)(1,"label"),_(2,"Edad:"),u(),d(3,"span"),_(4),u()()),t&2){let e=C(3);g(4),je("",e.selectedMember.age," a\xF1os")}}function xA(t,r){if(t&1&&(d(0,"div",193)(1,"label"),_(2,"G\xE9nero:"),u(),d(3,"span"),_(4),u()()),t&2){let e=C(3);g(4),be(e.selectedMember.gender)}}function bA(t,r){if(t&1){let e=Pe();d(0,"button",204),L("click",function(){D(e);let i=C(3);return N(i.openNoteModal(i.selectedMember))}),j(1,"i",205),_(2," Nueva Nota "),u()}}function wA(t,r){if(t&1){let e=Pe();d(0,"button",215),L("click",function(){D(e);let i=C().$implicit,a=C(4);return N(a.deleteNote(i.id))}),j(1,"i",216),u()}}function yA(t,r){if(t&1&&(d(0,"div",208)(1,"div",209)(2,"div",210)(3,"span",211),_(4),u(),d(5,"span",212),_(6),Cr(7,"date"),u()(),fe(8,wA,2,0,"button",213),u(),d(9,"div",214),_(10),u()()),t&2){let e=r.$implicit,n=C(4);g(4),be(e.createdBy),g(2),be(Qr(7,4,e.createdAt,"medium")),g(2),P("ngIf",n.can("DELETE_NOTE")),g(2),be(e.note)}}function CA(t,r){if(t&1&&(d(0,"div",206),fe(1,yA,11,7,"div",207),u()),t&2){let e=C(3);g(),P("ngForOf",e.selectedMember.notes)}}function SA(t,r){t&1&&(d(0,"div",217),j(1,"i",218),_(2," No hay notas registradas para este integrante. "),u())}function kA(t,r){if(t&1&&(d(0,"div",117)(1,"div",185),j(2,"img",186),d(3,"div",187)(4,"h3"),_(5),u(),d(6,"div",188)(7,"span",189),_(8),u(),fe(9,gA,2,5,"span",190),d(10,"span",191),_(11),u()()()(),d(12,"div",192)(13,"div",193)(14,"label"),_(15,"ID del sistema:"),u(),d(16,"span",194),_(17),u()(),d(18,"div",193)(19,"label"),_(20,"C\xE9dula:"),u(),d(21,"span"),_(22),u()(),d(23,"div",193)(24,"label"),_(25,"Tipo:"),u(),d(26,"span",191),_(27),u()(),d(28,"div",193)(29,"label"),_(30,"Categor\xEDa:"),u(),d(31,"span",195),_(32),u()(),fe(33,_A,5,5,"div",196),d(34,"div",193)(35,"label"),_(36,"Tel\xE9fono:"),u(),d(37,"span"),_(38),u()(),d(39,"div",193)(40,"label"),_(41,"Nacimiento:"),u(),d(42,"span"),_(43),u()(),fe(44,vA,5,1,"div",196)(45,xA,5,1,"div",196),d(46,"div",197)(47,"label"),_(48,"Direcci\xF3n:"),u(),d(49,"span"),_(50),u()(),d(51,"div",193)(52,"label"),_(53,"Registrado:"),u(),d(54,"span"),_(55),Cr(56,"date"),u()(),d(57,"div",193)(58,"label"),_(59,"\xDAltima Actualizaci\xF3n:"),u(),d(60,"span"),_(61),Cr(62,"date"),u()(),d(63,"div",193)(64,"label"),_(65,"Estado:"),u(),d(66,"span"),_(67),u()()(),d(68,"div",198)(69,"div",199)(70,"h4"),j(71,"i",200),_(72," Notas"),u(),fe(73,bA,3,0,"button",201),u(),fe(74,CA,2,1,"div",202)(75,SA,3,0,"div",203),u()()),t&2){let e=C(2);g(2),P("src",e.selectedMember.pictureProfileUrl||"https://ui-avatars.com/api/?name="+e.selectedMember.completeName+"&size=128&background=random",pn),g(3),be(e.selectedMember.completeName),g(2),Ft("background-color",e.selectedMember.category.color),g(),be(e.selectedMember.category.name),g(),P("ngIf",e.selectedMember.subCategory),g(),Ft("border-color",e.selectedMember.type.color)("color",e.selectedMember.type.color),g(),be(e.selectedMember.type.name),g(6),be(e.selectedMember.id),g(5),be(e.selectedMember.cc),g(4),Ft("border-color",e.selectedMember.type.color)("color",e.selectedMember.type.color),g(),be(e.selectedMember.type.name),g(4),Ft("background-color",e.selectedMember.category.color),g(),be(e.selectedMember.category.name),g(),P("ngIf",e.selectedMember.subCategory),g(5),be(e.selectedMember.cellphone),g(5),be(e.selectedMember.birthdate),g(),P("ngIf",e.selectedMember.age&&e.selectedMember.age>0),g(),P("ngIf",e.selectedMember.gender),g(5),be(e.selectedMember.address||"---"),g(5),be(Qr(56,37,e.selectedMember.createdAt,"mediumDate")),g(6),be(Qr(62,40,e.selectedMember.updatedAt,"mediumDate")),g(5),wt("text-success",e.selectedMember.active)("text-danger",!e.selectedMember.active),g(),je(" ",e.selectedMember.active?"Activo":"Inactivo"," "),g(6),P("ngIf",e.can("CREATE_NOTE")),g(),P("ngIf",e.selectedMember.notes&&e.selectedMember.notes.length>0),g(),P("ngIf",!e.selectedMember.notes||e.selectedMember.notes.length===0)}}function EA(t,r){if(t&1){let e=Pe();d(0,"div",112),L("click",function(){D(e);let i=C();return N(i.closeModal())}),d(1,"div",182),L("click",function(i){return D(e),N(i.stopPropagation())}),d(2,"div",115)(3,"h2"),_(4,"Detalles del Integrante"),u(),d(5,"button",183),L("click",function(){D(e);let i=C();return N(i.closeModal())}),_(6,"\xD7"),u()(),fe(7,kA,76,43,"div",184),u()()}if(t&2){let e=C();g(7),P("ngIf",e.selectedMember)}}function MA(t,r){t&1&&(d(0,"div",170)(1,"div",171),j(2,"div",172),d(3,"p"),_(4,"Guardando nota..."),u()()())}function PA(t,r){if(t&1){let e=Pe();d(0,"div",112),L("click",function(){D(e);let i=C();return N(i.closeNoteModal())}),d(1,"div",219),L("click",function(i){return D(e),N(i.stopPropagation())}),d(2,"div",115)(3,"h2"),_(4,"Agregar Nota"),u(),d(5,"button",116),L("click",function(){D(e);let i=C();return N(i.closeNoteModal())}),_(6," \xD7 "),u()(),fe(7,MA,5,0,"div",113),d(8,"div",117)(9,"form",220),L("ngSubmit",function(){D(e);let i=C();return N(i.onSubmitNote())}),d(10,"div",132)(11,"div",221)(12,"label",222),_(13,"Contenido de la nota *"),u(),d(14,"span",223),_(15),u()(),j(16,"textarea",224),u(),d(17,"div",166)(18,"button",167),L("click",function(){D(e);let i=C();return N(i.closeNoteModal())}),_(19," Cancelar "),u(),d(20,"button",225),j(21,"i",169),_(22),u()()()()()()}if(t&2){let e,n,i=C();g(5),P("disabled",i.isAddingNote),g(2),P("ngIf",i.isAddingNote),g(2),P("formGroup",i.noteForm),g(5),wt("danger",((e=i.noteForm.get("note"))==null||e.value==null?null:e.value.length)>254),g(),je(" ",((n=i.noteForm.get("note"))==null||n.value==null?null:n.value.length)||0,"/254 "),g(3),P("disabled",i.isAddingNote),g(2),P("disabled",i.noteForm.invalid||i.isAddingNote),g(),P("ngClass",i.isAddingNote?"fa-spinner fa-spin":"fa-paper-plane"),g(),je(" ",i.isAddingNote?"Guardando...":"Guardar Nota"," ")}}function OA(t,r){if(t&1&&(d(0,"option",176),_(1),u()),t&2){let e=r.$implicit;P("value",e.id),g(),be(e.name)}}function AA(t,r){if(t&1){let e=Pe();d(0,"div",229)(1,"h3"),_(2,"Sede"),u(),d(3,"div",249),j(4,"i",250),d(5,"select",251),ht("ngModelChange",function(i){D(e);let a=C(2);return ut(a.tempSelectedBranchId,i)||(a.tempSelectedBranchId=i),N(i)}),d(6,"option",141),_(7,"Todas las sedes"),u(),fe(8,OA,2,2,"option",136),u(),j(9,"i",252),u()()}if(t&2){let e=C(2);g(5),ft("ngModel",e.tempSelectedBranchId),g(3),P("ngForOf",e.branches)}}function TA(t,r){if(t&1){let e=Pe();d(0,"label",253)(1,"input",254),L("change",function(){let i=D(e).$implicit,a=C(2);return N(a.toggleAdvancedTypeSelection(i.id))}),u(),d(2,"span"),_(3),u()()}if(t&2){let e=r.$implicit,n=C(2);g(),P("checked",n.isAdvancedTypeSelected(e.id)),g(2),be(e.name)}}function IA(t,r){if(t&1){let e=Pe();d(0,"label",253)(1,"input",254),L("change",function(){let i=D(e).$implicit,a=C(2);return N(a.toggleAdvancedCategorySelection(i.id))}),u(),d(2,"span"),_(3),u()()}if(t&2){let e=r.$implicit,n=C(2);g(),P("checked",n.isAdvancedCategorySelected(e.id)),g(2),be(e.name)}}function FA(t,r){if(t&1){let e=Pe();d(0,"label",253)(1,"input",254),L("change",function(){let i=D(e).$implicit,a=C(5);return N(a.toggleAdvancedSubCategorySelection(i.id))}),u(),d(2,"span"),_(3),u()()}if(t&2){let e=r.$implicit,n=C(5);g(),P("checked",n.isAdvancedSubCategorySelected(e.id)),g(2),be(e.name)}}function DA(t,r){if(t&1&&(Ln(0),d(1,"h4",257),_(2),u(),d(3,"div",230),fe(4,FA,4,2,"label",231),u(),Bn()),t&2){let e=C().$implicit;g(2),be(e.name),g(2),P("ngForOf",e.subCategories)}}function NA(t,r){if(t&1&&(Ln(0),fe(1,DA,5,2,"ng-container",31),Bn()),t&2){let e=r.$implicit,n=C(3);g(),P("ngIf",e.subCategories&&e.subCategories.length>0&&(n.tempSelectedCategories.length===0||n.isAdvancedCategorySelected(e.id)))}}function RA(t,r){if(t&1&&(d(0,"div",229)(1,"h3"),_(2,"Sub-Categor\xEDa"),u(),d(3,"div",255),fe(4,NA,2,1,"ng-container",256),u()()),t&2){let e=C(2);g(4),P("ngForOf",e.availableCategories)}}function LA(t,r){if(t&1){let e=Pe();d(0,"button",233),L("click",function(){let i=D(e).$implicit,a=C(2);return N(a.tempSelectedGender=i.value)}),_(1),u()}if(t&2){let e=r.$implicit,n=C(2);wt("active",n.tempSelectedGender===e.value),g(),je(" ",e.label," ")}}function BA(t,r){if(t&1){let e=Pe();d(0,"div",112),L("click",function(){D(e);let i=C();return N(i.closeAdvancedFilters())}),d(1,"div",226),L("click",function(i){return D(e),N(i.stopPropagation())}),d(2,"div",115)(3,"h2"),_(4,"Filtros Avanzados"),u(),d(5,"button",183),L("click",function(){D(e);let i=C();return N(i.closeAdvancedFilters())}),_(6,"\xD7"),u()(),d(7,"div",117)(8,"div",227),fe(9,AA,10,2,"div",228),d(10,"div",229)(11,"h3"),_(12,"Tipo"),u(),d(13,"div",230),fe(14,TA,4,2,"label",231),u()(),d(15,"div",229)(16,"h3"),_(17,"Categor\xEDa"),u(),d(18,"div",230),fe(19,IA,4,2,"label",231),u()(),fe(20,RA,5,1,"div",228),d(21,"div",229)(22,"h3"),_(23,"G\xE9nero"),u(),d(24,"div",232)(25,"button",233),L("click",function(){D(e);let i=C();return N(i.tempSelectedGender="")}),_(26," Todos "),u(),fe(27,LA,2,3,"button",234),u()(),d(28,"div",235)(29,"h3"),_(30,"Datos Disponibles"),u(),d(31,"div",236)(32,"div",237)(33,"span"),_(34,"C\xE9dula:"),u(),d(35,"div",232)(36,"button",233),L("click",function(){D(e);let i=C();return N(i.setAdvancedFilterValue("tempHasCc",null))}),_(37," Todos "),u(),d(38,"button",233),L("click",function(){D(e);let i=C();return N(i.setAdvancedFilterValue("tempHasCc",!0))}),_(39," Con "),u(),d(40,"button",233),L("click",function(){D(e);let i=C();return N(i.setAdvancedFilterValue("tempHasCc",!1))}),_(41," Sin "),u()()(),d(42,"div",237)(43,"span"),_(44,"Tel\xE9fono:"),u(),d(45,"div",232)(46,"button",233),L("click",function(){D(e);let i=C();return N(i.setAdvancedFilterValue("tempHasCellphone",null))}),_(47," Todos "),u(),d(48,"button",233),L("click",function(){D(e);let i=C();return N(i.setAdvancedFilterValue("tempHasCellphone",!0))}),_(49," Con "),u(),d(50,"button",233),L("click",function(){D(e);let i=C();return N(i.setAdvancedFilterValue("tempHasCellphone",!1))}),_(51," Sin "),u()()(),d(52,"div",237)(53,"span"),_(54,"Direcci\xF3n:"),u(),d(55,"div",232)(56,"button",233),L("click",function(){D(e);let i=C();return N(i.setAdvancedFilterValue("tempHasAddress",null))}),_(57," Todos "),u(),d(58,"button",233),L("click",function(){D(e);let i=C();return N(i.setAdvancedFilterValue("tempHasAddress",!0))}),_(59," Con "),u(),d(60,"button",233),L("click",function(){D(e);let i=C();return N(i.setAdvancedFilterValue("tempHasAddress",!1))}),_(61," Sin "),u()()(),d(62,"div",237)(63,"span"),_(64,"Nacimiento:"),u(),d(65,"div",232)(66,"button",233),L("click",function(){D(e);let i=C();return N(i.setAdvancedFilterValue("tempHasBirthdate",null))}),_(67," Todos "),u(),d(68,"button",233),L("click",function(){D(e);let i=C();return N(i.setAdvancedFilterValue("tempHasBirthdate",!0))}),_(69," Con "),u(),d(70,"button",233),L("click",function(){D(e);let i=C();return N(i.setAdvancedFilterValue("tempHasBirthdate",!1))}),_(71," Sin "),u()()()()(),d(72,"div",229)(73,"h3"),_(74,"Rango de Edad"),u(),d(75,"div",238)(76,"input",239),ht("ngModelChange",function(i){D(e);let a=C();return ut(a.tempAgeRange1,i)||(a.tempAgeRange1=i),N(i)}),u(),d(77,"span"),_(78,"-"),u(),d(79,"input",240),ht("ngModelChange",function(i){D(e);let a=C();return ut(a.tempAgeRange2,i)||(a.tempAgeRange2=i),N(i)}),u()()(),d(80,"div",229)(81,"h3"),_(82,"Ubicaci\xF3n"),u(),d(83,"input",241),ht("ngModelChange",function(i){D(e);let a=C();return ut(a.tempLocation,i)||(a.tempLocation=i),N(i)}),u()(),d(84,"div",229)(85,"h3"),_(86,"Estado"),u(),d(87,"label",242)(88,"input",243),ht("ngModelChange",function(i){D(e);let a=C();return ut(a.tempOnlyActive,i)||(a.tempOnlyActive=i),N(i)}),u(),j(89,"span",78),u(),d(90,"span",244),_(91),u()()()(),d(92,"div",245)(93,"button",246),L("click",function(){D(e);let i=C();return i.clearFilters(),N(i.closeAdvancedFilters())}),_(94," Limpiar Filtros "),u(),d(95,"button",247),L("click",function(){D(e);let i=C();return N(i.applyAdvancedFilters())}),j(96,"i",248),_(97," Aplicar Filtros "),u()()()()}if(t&2){let e=C();g(9),P("ngIf",e.isAdmin),g(5),P("ngForOf",e.availableTypes),g(5),P("ngForOf",e.availableCategories),g(),P("ngIf",e.hasVisibleSubCategories),g(5),wt("active",e.tempSelectedGender===""),g(2),P("ngForOf",e.availableGenders),g(9),wt("active",e.isAdvancedFilterActive("tempHasCc",null)),g(2),wt("active",e.isAdvancedFilterActive("tempHasCc",!0)),g(2),wt("active",e.isAdvancedFilterActive("tempHasCc",!1)),g(6),wt("active",e.isAdvancedFilterActive("tempHasCellphone",null)),g(2),wt("active",e.isAdvancedFilterActive("tempHasCellphone",!0)),g(2),wt("active",e.isAdvancedFilterActive("tempHasCellphone",!1)),g(6),wt("active",e.isAdvancedFilterActive("tempHasAddress",null)),g(2),wt("active",e.isAdvancedFilterActive("tempHasAddress",!0)),g(2),wt("active",e.isAdvancedFilterActive("tempHasAddress",!1)),g(6),wt("active",e.isAdvancedFilterActive("tempHasBirthdate",null)),g(2),wt("active",e.isAdvancedFilterActive("tempHasBirthdate",!0)),g(2),wt("active",e.isAdvancedFilterActive("tempHasBirthdate",!1)),g(6),ft("ngModel",e.tempAgeRange1),g(3),ft("ngModel",e.tempAgeRange2),g(4),ft("ngModel",e.tempLocation),g(5),ft("ngModel",e.tempOnlyActive),g(3),be(e.tempOnlyActive?"Solo Activos":"Todos")}}var wu=class t{fb=Ce(ks);integranteService=Ce(Ri);configService=Ce(wa);branchService=Ce(ba);notificationService=Ce(Kr);confirmationService=Ce(Ni);reportService=Ce(Fc);authService=Ce(fr);cdr=Ce(Un);availableCategories=[];availableTypes=[];members=[];categories=[];subCategories=[];types=[];branches=[];filteredSubCategories=[];isLoading=!0;showModal=!1;searchSubject=new Bt;isEditing=!1;isSaving=!1;currentId=null;showFilters=!1;showNoteModal=!1;showMobileMenu=!1;currentPage=0;totalPages=0;totalElements=0;selectedTypes=[];selectedCategories=[];selectedSubCategories=[];selectedBranchId="";selectedGender="";onlyActive=!0;searchQuery="";hasCc=null;hasCellphone=null;hasAddress=null;hasBirthdate=null;ageFilterRange1=null;ageFilterRange2=null;showTypeDropdown=!1;showCategoryDropdown=!1;activeDropdownId=null;showAdvancedFilters=!1;showAdvancedFiltersModal=!1;showExportDropdown=!1;showMobileFiltersModal=!1;openModal(r){this.isEditing=!!r,this.currentId=r?.id||null,this.showFormModal=!0,r?this.integranteForm.patchValue({completeName:r.completeName,typeId:r.type?.id,categoryId:r.category?.id,subCategoryId:r.subCategory?.id,cellphone:r.cellphone,address:r.address,birthdate:r.birthdate?new Date(r.birthdate).toISOString().substring(0,10):"",cc:r.cc,gender:r.gender?r.gender.toUpperCase():"",branchId:r.branch?.id||"",active:r.active,categoryLocked:r.categoryLocked||!1}):(this.integranteForm.reset({active:!0,gender:"HOMBRE",branchId:this.isAdmin?"":this.currentUserBranchId,categoryLocked:!1}),this.filteredSubCategories=[]),this.initializeGeocoder()}filters={onlyActive:!0};noteForm;constructor(){this.noteForm=this.fb.group({content:["",or.required]})}availableGenders=[{value:"HOMBRE",label:"Hombre"},{value:"MUJER",label:"Mujer"}];tempSelectedTypes=[];tempSelectedCategories=[];tempSelectedSubCategories=[];tempSelectedBranchId="";tempSelectedGender="";tempOnlyActive=!0;tempHasCc=null;tempHasCellphone=null;tempHasAddress=null;tempHasBirthdate=null;tempAgeRange1=null;tempAgeRange2=null;tempLocation="";filterLocation="";selectedMember;showFormModal=!1;integranteForm;isAddingNote=!1;selectedFile=null;imagePreview=null;currentUserBranchId="";ngOnInit(){if(this.checkPermissions(),this.initForm(),this.setupSearchDebounce(),this.loadCategoriesAndTypes(),this.loadMembers(),this.isAdmin)this.loadBranches(),this.integranteForm.get("branchId")?.setValidators([or.required]);else{let r=this.authService.currentUser();this.currentUserBranchId=r?.branchId||r?.memberResponseDto?.branch?.id||""}this.integranteForm.get("branchId")?.updateValueAndValidity()}isAdmin=!1;checkPermissions(){this.isAdmin=this.authService.can("ADMINISTRATOR")}loadBranches(){this.branchService.findAll().subscribe({next:r=>this.branches=r,error:()=>this.notificationService.error("Error al cargar las sedes")})}loadCategoriesAndTypes(){this.configService.getCategories().subscribe({next:r=>this.availableCategories=r,error:()=>this.notificationService.error("Error al cargar categor\xEDas")}),this.configService.getTypes().subscribe({next:r=>this.availableTypes=r,error:()=>this.notificationService.error("Error al cargar tipos")})}can(r){return this.authService.can(r)}formatAddress(r){let e=[];return r.neighborhood&&e.push(r.neighborhood),r.city&&e.push(r.city),r.municipality&&e.push(r.municipality),e.length>0?e.join(", "):"---"}initForm(){this.integranteForm=this.fb.group({completeName:["",[or.required]],typeId:["",[or.required]],categoryId:["",[or.required]],subCategoryId:[""],cellphone:[""],address:[""],neighborhood:[""],city:[""],municipality:[""],district:[""],postalCode:[""],latitude:[null],longitude:[null],birthdate:[""],cc:[""],gender:["",[or.required]],branchId:[""],active:[!0],categoryLocked:[!1]}),this.noteForm=this.fb.group({note:["",[or.required,or.minLength(3),or.maxLength(254)]],memberId:[""]})}onCategoryChange(){this.integranteForm.patchValue({subCategoryId:""})}get subCategoriesForSelectedCategory(){let r=this.integranteForm.get("categoryId")?.value;return r?this.availableCategories.find(n=>n.id===r)?.subCategories||[]:[]}onFileSelected(r){let e=r.target.files[0];if(e){this.selectedFile=e;let n=new FileReader;n.onload=i=>this.imagePreview=i.target.result,n.readAsDataURL(e)}}loadMembers(){this.isLoading=!0;let r={memberType:this.selectedTypes.length>0?this.selectedTypes:void 0,memberCategory:this.selectedCategories.length>0?this.selectedCategories:void 0,subCategory:this.selectedSubCategories.length>0?this.selectedSubCategories:void 0,onlyActive:this.onlyActive,query:this.searchQuery.trim()||void 0,hasCc:this.hasCc,hasCellphone:this.hasCellphone,hasAddress:this.hasAddress,hasBirthdate:this.hasBirthdate,ageFilterRange1:this.ageFilterRange1,ageFilterRange2:this.ageFilterRange2,location:this.filterLocation||void 0,gender:this.selectedGender||void 0,branchId:this.selectedBranchId||void 0};this.integranteService.searchMembers(r,this.currentPage).subscribe({next:e=>{this.members=e.data,this.totalPages=e.totalPages,this.totalElements=e.totalElements,this.isLoading=!1,this.scrollToTop()},error:e=>{console.error("Error loading members:",e),this.notificationService.error("Error al cargar los integrantes"),this.isLoading=!1}})}setupSearchDebounce(){this.searchSubject.pipe(Ki(1e3),Oi()).subscribe(r=>{this.searchQuery=r,this.onSearch()})}onSearchInput(){this.searchSubject.next(this.searchQuery)}onSearch(){this.currentPage=0,this.loadMembers()}onToggleOnlyActive(){this.currentPage=0,this.loadMembers()}nextPage(){this.currentPage<this.totalPages-1&&(this.currentPage++,this.loadMembers())}prevPage(){this.currentPage>0&&(this.currentPage--,this.loadMembers())}toggleMemberStatus(r){if(!this.can("UPDATE_MEMBER"))return;let e=!r.active;this.integranteService.toggleStatus(r.id,e).subscribe({next:n=>{r.active=n,this.notificationService.success(`Integrante ${n?"activado":"desactivado"} correctamente`)}})}viewMember(r){this.selectedMember=r,this.showModal=!0}openAddModal(){this.can("REGISTER_MEMBER")&&(this.isEditing=!1,this.selectedMember=void 0,this.selectedFile=null,this.imagePreview=null,this.integranteForm.reset({active:!0}),this.showFormModal=!0)}closeModal(){this.showModal=!1,this.selectedMember=void 0}closeFormModal(){this.showFormModal=!1,this.selectedMember=void 0,this.isEditing=!1,this.selectedFile=null,this.imagePreview=null}toggleTypeDropdown(){this.showTypeDropdown=!this.showTypeDropdown,this.showTypeDropdown&&(this.showCategoryDropdown=!1)}toggleCategoryDropdown(){this.showCategoryDropdown=!this.showCategoryDropdown,this.showCategoryDropdown&&(this.showTypeDropdown=!1)}toggleTypeSelection(r){let e=this.selectedTypes.indexOf(r);e>-1?this.selectedTypes.splice(e,1):this.selectedTypes.push(r),this.currentPage=0,this.loadMembers()}toggleCategorySelection(r){let e=this.selectedCategories.indexOf(r);e>-1?this.selectedCategories.splice(e,1):this.selectedCategories.push(r),this.currentPage=0,this.loadMembers()}isTypeSelected(r){return this.selectedTypes.includes(r)}isCategorySelected(r){return this.selectedCategories.includes(r)}closeFilterDropdowns(r){let e=r.target;e.closest(".filter-dropdown-container")||(this.showTypeDropdown=!1,this.showCategoryDropdown=!1),e.closest(".action-dropdown")||(this.activeDropdownId=null),e.closest(".advanced-filters-dropdown-container")||(this.showAdvancedFilters=!1),e.closest(".export-dropdown-container")||(this.showExportDropdown=!1)}toggleAdvancedFilters(){this.showAdvancedFilters=!this.showAdvancedFilters,this.showAdvancedFilters&&(this.showTypeDropdown=!1,this.showCategoryDropdown=!1,this.showExportDropdown=!1)}toggleExportDropdown(){this.showExportDropdown=!this.showExportDropdown,this.showExportDropdown&&(this.showAdvancedFilters=!1,this.showTypeDropdown=!1,this.showCategoryDropdown=!1)}setFilterValue(r,e){this[r]=e,this.currentPage=0,this.loadMembers()}onAgeRangeChange(){this.currentPage=0,this.loadMembers()}isFilterActive(r,e){return this[r]===e}clearFilters(){this.selectedTypes=[],this.selectedCategories=[],this.selectedSubCategories=[],this.selectedGender="",this.selectedBranchId="",this.hasCc=null,this.hasCellphone=null,this.hasAddress=null,this.hasBirthdate=null,this.ageFilterRange1=null,this.ageFilterRange2=null,this.filterLocation="",this.tempSelectedTypes=[],this.tempSelectedCategories=[],this.tempSelectedSubCategories=[],this.tempSelectedBranchId="",this.tempSelectedGender="",this.tempHasCc=null,this.tempHasCellphone=null,this.tempHasAddress=null,this.tempHasBirthdate=null,this.tempAgeRange1=null,this.tempAgeRange2=null,this.tempLocation="",this.tempOnlyActive=!0,this.onlyActive=!0,this.searchQuery="",this.currentPage=0,this.loadMembers()}exportData(r){let e={memberType:this.selectedTypes.length>0?this.selectedTypes:void 0,memberCategory:this.selectedCategories.length>0?this.selectedCategories:void 0,subCategory:this.selectedSubCategories.length>0?this.selectedSubCategories:void 0,onlyActive:this.onlyActive,query:this.searchQuery.trim()||void 0,hasCc:this.hasCc,hasCellphone:this.hasCellphone,hasAddress:this.hasAddress,hasBirthdate:this.hasBirthdate,ageFilterRange1:this.ageFilterRange1,ageFilterRange2:this.ageFilterRange2,location:this.filterLocation||void 0,gender:this.selectedGender||void 0,branchId:this.selectedBranchId||void 0};this.integranteService.exportMembers(e).subscribe({next:n=>{let i=n.data,a=[{id:"completeName",label:"Nombre Completo",visible:!0,order:1},{id:"type",label:"Tipo",visible:!0,order:2},{id:"category",label:"Categor\xEDa",visible:!0,order:3},{id:"subCategory",label:"Sub-categor\xEDa",visible:!0,order:4},{id:"cc",label:"C\xE9dula",visible:!0,order:5},{id:"cellphone",label:"Tel\xE9fono",visible:!0,order:6},{id:"birthdate",label:"Nacimiento",visible:!0,order:7},{id:"age",label:"Edad",visible:!0,order:8},{id:"gender",label:"G\xE9nero",visible:!0,order:9},{id:"address",label:"Direcci\xF3n",visible:!0,order:10}];r==="excel"?this.reportService.exportToExcel(i,a,"integrantes_export"):this.reportService.exportToPdf(i,a,"integrantes_export","Reporte de Integrantes"),this.showExportDropdown=!1,this.notificationService.success(`Datos exportados a ${r.toUpperCase()} correctamente`)},error:n=>{console.error("Error exporting members:",n),this.notificationService.error("Error al exportar los datos")}})}openMobileFilters(){this.tempSelectedTypes=[...this.selectedTypes],this.tempSelectedCategories=[...this.selectedCategories],this.tempSelectedGender=this.selectedGender,this.tempOnlyActive=this.onlyActive,this.tempHasCc=this.hasCc,this.tempHasCellphone=this.hasCellphone,this.tempHasAddress=this.hasAddress,this.tempHasBirthdate=this.hasBirthdate,this.tempAgeRange1=this.ageFilterRange1,this.tempAgeRange2=this.ageFilterRange2,this.tempLocation=this.filterLocation,this.showMobileFiltersModal=!0}closeMobileFilters(){this.showMobileFiltersModal=!1}toggleMobileTypeSelection(r){let e=this.tempSelectedTypes.indexOf(r);e>-1?this.tempSelectedTypes.splice(e,1):this.tempSelectedTypes.push(r)}toggleMobileCategorySelection(r){let e=this.tempSelectedCategories.indexOf(r);e>-1?this.tempSelectedCategories.splice(e,1):this.tempSelectedCategories.push(r)}isMobileTypeSelected(r){return this.tempSelectedTypes.includes(r)}isMobileCategorySelected(r){return this.tempSelectedCategories.includes(r)}applyMobileFilters(){this.selectedTypes=[...this.tempSelectedTypes],this.selectedCategories=[...this.tempSelectedCategories],this.onlyActive=this.tempOnlyActive,this.hasCc=this.tempHasCc,this.hasCellphone=this.tempHasCellphone,this.hasAddress=this.tempHasAddress,this.hasBirthdate=this.tempHasBirthdate,this.ageFilterRange1=this.tempAgeRange1,this.ageFilterRange2=this.tempAgeRange2,this.filterLocation=this.tempLocation,this.currentPage=0,this.loadMembers(),this.closeMobileFilters()}setMobileFilterValue(r,e){this[r]=e}isMobileFilterActive(r,e){return this[r]===e}resetMobileFilters(){this.tempSelectedTypes=[],this.tempSelectedCategories=[],this.tempOnlyActive=!0,this.tempHasCc=null,this.tempHasCellphone=null,this.tempHasAddress=null,this.tempHasBirthdate=null,this.tempAgeRange1=null,this.tempAgeRange2=null,this.tempLocation=""}openAdvancedFilters(){this.tempSelectedTypes=[...this.selectedTypes],this.tempSelectedCategories=[...this.selectedCategories],this.tempSelectedSubCategories=[...this.selectedSubCategories],this.tempSelectedBranchId=this.selectedBranchId,this.tempSelectedGender=this.selectedGender,this.tempHasCc=this.hasCc,this.tempHasCellphone=this.hasCellphone,this.tempHasAddress=this.hasAddress,this.tempHasBirthdate=this.hasBirthdate,this.tempAgeRange1=this.ageFilterRange1,this.tempAgeRange2=this.ageFilterRange2,this.tempLocation=this.filterLocation,this.showAdvancedFiltersModal=!0}closeAdvancedFilters(){this.showAdvancedFiltersModal=!1}applyAdvancedFilters(){this.selectedTypes=[...this.tempSelectedTypes],this.selectedCategories=[...this.tempSelectedCategories],this.selectedSubCategories=[...this.tempSelectedSubCategories],this.selectedBranchId=this.tempSelectedBranchId,this.selectedGender=this.tempSelectedGender,this.hasCc=this.tempHasCc,this.hasCellphone=this.tempHasCellphone,this.hasAddress=this.tempHasAddress,this.hasBirthdate=this.tempHasBirthdate,this.ageFilterRange1=this.tempAgeRange1,this.ageFilterRange2=this.tempAgeRange2,this.filterLocation=this.tempLocation,this.currentPage=0,this.loadMembers(),this.closeAdvancedFilters()}toggleAdvancedTypeSelection(r){let e=this.tempSelectedTypes.indexOf(r);e>-1?this.tempSelectedTypes.splice(e,1):this.tempSelectedTypes.push(r)}toggleAdvancedCategorySelection(r){let e=this.tempSelectedCategories.indexOf(r);e>-1?this.tempSelectedCategories.splice(e,1):this.tempSelectedCategories.push(r)}toggleAdvancedSubCategorySelection(r){let e=this.tempSelectedSubCategories.indexOf(r);e>-1?this.tempSelectedSubCategories.splice(e,1):this.tempSelectedSubCategories.push(r)}isAdvancedTypeSelected(r){return this.tempSelectedTypes.includes(r)}isAdvancedCategorySelected(r){return this.tempSelectedCategories.includes(r)}isAdvancedSubCategorySelected(r){return this.tempSelectedSubCategories.includes(r)}setAdvancedFilterValue(r,e){this[r]=e}isAdvancedFilterActive(r,e){return this[r]===e}get hasVisibleSubCategories(){return this.tempSelectedCategories.length>0?this.availableCategories.filter(r=>this.tempSelectedCategories.includes(r.id)).some(r=>r.subCategories&&r.subCategories.length>0):this.availableCategories.some(r=>r.subCategories&&r.subCategories.length>0)}openFormModal(){this.openModal(),this.cdr.detectChanges()}initializeGeocoder(){setTimeout(()=>{this.initGoogleAutocomplete()},100)}initGoogleAutocomplete(){let r=document.getElementById("googleAddress");if(!r)return;if(typeof google>"u"){console.error("Google Maps API not loaded");return}let e=new google.maps.places.Autocomplete(r,{componentRestrictions:{country:"co"},fields:["address_components","geometry","formatted_address"],types:["geocode","establishment"]});e.addListener("place_changed",()=>{let n=e.getPlace();this.handleGoogleResult(n)})}handleGoogleResult(r){if(!r.geometry)return;let e=r.formatted_address,n=r.address_components,i="",a="",o="",s="",l="";console.log("Google Maps components:",n),n.forEach((c,f)=>{console.log(`Component ${f}: ${c.long_name} - Types:`,c.types)});for(let c of n){let f=c.types,v=c.long_name;!i&&(f.includes("neighborhood")||f.includes("sublocality")||f.includes("sublocality_level_1")||f.includes("sublocality_level_2")||f.includes("sublocality_level_3")||f.includes("route")||f.includes("point_of_interest")||f.includes("establishment")||f.includes("natural_feature"))&&(i=v,console.log("\u2705 Neighborhood found:",v,"from types:",f)),!a&&f.includes("locality")&&(a=v,console.log("\u2705 City found:",v)),!o&&f.includes("administrative_area_level_2")&&(o=v,console.log("\u2705 Municipality found:",v)),!s&&f.includes("administrative_area_level_1")&&(s=v,console.log("\u2705 District found:",v)),!l&&f.includes("postal_code")&&(l=v,console.log("\u2705 Postal Code found:",v))}!a&&o&&(a=o,console.log("\u2139\uFE0F Using municipality as city (fallback):",a)),console.log("\u{1F4CD} Final parsed address:",{neighborhood:i,city:a,municipality:o,district:s,postalCode:l}),this.integranteForm.patchValue({address:e,neighborhood:i,city:a,municipality:o,district:s,postalCode:l,latitude:r.geometry.location.lat(),longitude:r.geometry.location.lng()}),this.cdr.detectChanges()}onSubmit(){if(this.integranteForm.valid&&!this.isSaving){this.isSaving=!0;let r=new FormData,e=this.integranteForm.value;Object.keys(e).forEach(n=>{n==="subCategoryId"&&!e[n]||e[n]!==null&&e[n]!==void 0&&r.append(n,e[n])}),this.selectedFile&&r.append("pictureProfile",this.selectedFile),this.isEditing&&this.currentId?this.integranteService.updateIntegrante(this.currentId,r).subscribe({next:()=>{this.isSaving=!1,this.closeFormModal(),this.loadMembers(),this.notificationService.success("Integrante actualizado correctamente")},error:()=>this.isSaving=!1}):this.integranteService.addIntegrante(r).subscribe({next:()=>{this.isSaving=!1,this.closeFormModal(),this.loadMembers(),this.notificationService.success("Integrante creado correctamente")},error:()=>this.isSaving=!1})}}editIntegrante(r){this.openModal(r)}deleteIntegrante(r){return Cn(this,null,function*(){(yield this.confirmationService.confirm({title:"Eliminar Integrante",message:"\xBFEst\xE1 seguro de eliminar este integrante?",type:"danger",confirmText:"Eliminar"}))&&this.integranteService.deleteIntegrante(r).subscribe(()=>{this.loadMembers(),this.notificationService.success("Integrante eliminado correctamente")})})}resetForm(){this.isEditing=!1,this.currentId=null,this.selectedFile=null,this.imagePreview=null,this.integranteForm.reset({active:!0,categoryLocked:!1,typeId:this.availableTypes.length>0?this.availableTypes[0].id:"",categoryId:this.availableCategories.length>0?this.availableCategories[0].id:"",subCategoryId:""})}getBadgeClass(r){return""}openNoteModal(r){this.selectedMember=r,this.noteForm.reset({note:"",memberId:r.id}),this.showNoteModal=!0}closeNoteModal(){this.showNoteModal=!1,this.noteForm.reset()}onSubmitNote(){if(this.noteForm.valid&&!this.isAddingNote){this.isAddingNote=!0;let r=this.noteForm.value;this.integranteService.createNote(r).subscribe({next:e=>{this.selectedMember&&this.selectedMember.id===r.memberId&&(this.selectedMember.notes||(this.selectedMember.notes=[]),this.selectedMember.notes.unshift(e)),this.isAddingNote=!1,this.closeNoteModal(),this.notificationService.success("Nota agregada correctamente")},error:e=>{this.isAddingNote=!1,console.error("Error adding note:",e),this.notificationService.error("Error al agregar la nota")}})}}loadNotes(r){this.integranteService.getNotes(r).subscribe({next:e=>{this.selectedMember&&this.selectedMember.id===r&&(this.selectedMember.notes=e)},error:e=>console.error("Error loading notes",e)})}editNote(r){let e=prompt("Editar nota:",r.note);e!==null&&e.trim()!==""&&e!==r.note&&this.updateNote(r.id,e)}updateNote(r,e){this.integranteService.updateNote(r,e).subscribe({next:()=>{if(this.notificationService.success("Nota actualizada"),this.selectedMember&&this.selectedMember.notes){let n=this.selectedMember.notes.findIndex(i=>i.id===r);n>-1&&(this.selectedMember.notes[n].note=e)}},error:n=>this.notificationService.error("Error al actualizar nota")})}deleteNote(r){return Cn(this,null,function*(){(yield this.confirmationService.confirm({title:"Eliminar Nota",message:"\xBFEst\xE1 seguro de eliminar esta nota?",type:"danger",confirmText:"Eliminar"}))&&this.selectedMember&&this.integranteService.deleteNote(r).subscribe({next:()=>{this.selectedMember&&this.selectedMember.notes&&(this.selectedMember.notes=this.selectedMember.notes.filter(n=>n.id!==r)),this.notificationService.success("Nota eliminada correctamente")},error:n=>{console.error("Error deleting note:",n),this.notificationService.error("Error al eliminar la nota")}})})}formatType(r){return r?typeof r=="string"?r.replace(/_/g," "):r.name||"":""}formatCategory(r){return r==null?"":typeof r=="string"?r:r?.name||""}scrollToTop(){[".page-container",".table-container",".full-table",".list-container"].forEach(e=>{let n=document.querySelector(e);n&&n.scrollTo({top:0,behavior:"smooth"})}),window.scrollTo({top:0,behavior:"smooth"})}static \u0275fac=function(e){return new(e||t)};static \u0275cmp=ir({type:t,selectors:[["app-integrantes"]],hostBindings:function(e,n){e&1&&L("click",function(a){return n.closeFilterDropdowns(a)},to)},decls:68,vars:18,consts:[["fileInput",""],[1,"integrantes-container","full-width"],[1,"card","full-card"],[1,"header-section"],[1,"filters-left"],[1,"desktop-only"],[1,"btn","btn-action-soft",3,"click"],[2,"display","flex","align-items","center","gap","0.5rem"],[1,"fa-solid","fa-sliders"],["class","filter-badge",4,"ngIf"],[1,"search-center"],[2,"display","flex","gap","0.5rem","width","100%"],[1,"soft-input-wrapper",2,"flex","1"],[1,"fa-solid","fa-magnifying-glass","soft-input-icon"],["type","text","placeholder","Buscar por nombre, documento, celular...",1,"soft-input",3,"ngModelChange","keyup.enter","ngModel"],[1,"btn-icon-soft","mobile-only",2,"height","42px","width","42px","flex-shrink","0","display","flex","align-items","center","justify-content","center","border","1px solid var(--border-color)","border-radius","12px","background","var(--bg-input)","color","var(--text-muted)","cursor","pointer","position","relative",3,"click"],["class","filter-badge","style",`
                position: absolute;
                top: -5px;
                right: -5px;
                min-width: 18px;
                padding: 2px 4px;
                font-size: 0.65rem;
              `,4,"ngIf"],[1,"mobile-only","filter-dropdown-container"],[1,"btn-icon-soft",2,"height","42px","width","42px","flex-shrink","0","display","flex","align-items","center","justify-content","center","border","1px solid var(--border-color)","border-radius","12px","background","var(--bg-input)","color","var(--text-muted)","cursor","pointer",3,"click"],[1,"fa-solid","fa-ellipsis-vertical"],["class","filter-dropdown","style","right: 0; left: auto; min-width: 160px; top: 110%",4,"ngIf"],[1,"actions-right","desktop-only",2,"display","flex","gap","0.75rem","align-items","center"],[1,"filter-dropdown-container","export-dropdown-container"],["title","Exportar",1,"btn","btn-muted","btn-action-soft",3,"click"],[1,"fa-solid","fa-download"],[1,"desktop-only",2,"font-weight","500"],["class","filter-dropdown export-menu","style","right: 0; left: auto",4,"ngIf"],["class","btn btn-primary btn-action-soft",3,"click",4,"ngIf"],[1,"table-container","full-table"],[1,"data-table"],[1,"desktop-only","text-center"],[4,"ngIf"],[1,"integrantes-footer"],[1,"pagination-mini"],[1,"pagination-buttons"],[1,"btn-icon-sm",3,"click","disabled"],[1,"fa-solid","fa-chevron-left"],[1,"fa-solid","fa-chevron-right"],["class","modal-overlay",3,"click",4,"ngIf"],[1,"filter-badge"],[1,"filter-badge",2,"position","absolute","top","-5px","right","-5px","min-width","18px","padding","2px 4px","font-size","0.65rem"],[1,"filter-dropdown",2,"right","0","left","auto","min-width","160px","top","110%"],[2,"padding","0.5rem 0.75rem","border-bottom","1px solid var(--border-color)"],[2,"font-size","0.75rem","font-weight","700","color","var(--text-muted)","text-transform","uppercase"],["class","dropdown-item",3,"click",4,"ngIf"],[2,"border-top","1px solid var(--border-color)","margin","0.25rem 0"],[1,"dropdown-item",3,"click"],[1,"fa-solid","fa-file-excel","text-success"],[1,"fa-solid","fa-file-pdf","text-danger"],[1,"fa-solid","fa-user-plus","text-primary"],[1,"filter-dropdown","export-menu",2,"right","0","left","auto"],[1,"btn","btn-primary","btn-action-soft",3,"click"],[1,"fa-solid","fa-user-plus"],["colspan","8",2,"padding","0","border","none"],[1,"loading-container"],[1,"loading-spinner"],[3,"inactive-row",4,"ngFor","ngForOf"],[1,"user-cell-mini"],["alt","Avatar",3,"src"],[1,"name-column"],[1,"user-name"],["class","user-age",4,"ngIf"],[1,"mobile-category-info","mobile-only"],["class","badge-mini",3,"background-color",4,"ngIf"],["class","badge-mini-outline",3,"border-color","color",4,"ngIf"],[1,"address-cell",3,"title"],[2,"display","flex","flex-direction","column","gap","0.25rem","align-items","flex-start"],["class","badge badge-sm badge-solid","style","color: white !important",3,"background-color",4,"ngIf"],["class","badge badge-sm badge-outline","style","font-size: 0.65rem",3,"border-color","color",4,"ngIf"],[1,"text-muted",3,"title"],["class","badge badge-sm",3,"badge-blue","badge-pink",4,"ngIf"],["class","text-muted",4,"ngIf"],[1,"badge","badge-sm","badge-outline"],[1,"text-center"],[1,"actions-mini"],[1,"desktop-actions","desktop-only"],["appSafeClick","","title","Cambiar Estado",1,"status-switch-mini",3,"safeClick"],["type","checkbox",3,"checked","disabled"],[1,"slider","round"],["title","Ver",1,"action-btn-sm","view",3,"click"],[1,"fa-solid","fa-eye"],["class","action-btn-sm edit","title","Editar",3,"click",4,"ngIf"],["class","action-btn-sm view","title","Agregar Nota",3,"click",4,"ngIf"],["class","action-btn-sm delete","title","Eliminar",3,"click",4,"ngIf"],[1,"mobile-actions-wrapper","mobile-only"],[1,"action-btn-sm","menu-trigger",3,"click"],["class","action-dropdown",3,"click",4,"ngIf"],[1,"user-age"],[1,"badge-mini"],[1,"badge-mini-outline"],[1,"badge","badge-sm","badge-solid",2,"color","white !important"],[1,"badge","badge-sm","badge-outline",2,"font-size","0.65rem"],[1,"badge","badge-sm"],[1,"text-muted"],["title","Editar",1,"action-btn-sm","edit",3,"click"],[1,"fa-solid","fa-pencil"],["title","Agregar Nota",1,"action-btn-sm","view",3,"click"],[1,"fa-solid","fa-sticky-note","text-primary"],["title","Eliminar",1,"action-btn-sm","delete",3,"click"],[1,"fa-solid","fa-trash"],[1,"action-dropdown",3,"click"],[1,"dropdown-header-mobile"],[1,"member-name-small"],[1,"dropdown-item","status-row"],[1,"dropdown-label"],["appSafeClick","",1,"status-switch",3,"safeClick"],[1,"dropdown-divider"],[1,"fa-solid","fa-pencil","text-primary"],[1,"fa-solid","fa-trash","text-danger"],[1,"delete-text"],["colspan","8",2,"text-align","center","padding","2rem","color","var(--text-muted)"],[1,"fa-solid","fa-users-slash",2,"font-size","2rem","display","block","margin-bottom","0.5rem","opacity","0.4"],[1,"modal-overlay",3,"click"],["class","modal-loading-overlay",4,"ngIf"],[1,"modal-content","form-modal",3,"click"],[1,"modal-header"],[1,"close-btn",3,"click","disabled"],[1,"modal-body"],[1,"integrante-form-modal",3,"ngSubmit","formGroup"],[1,"form-header-row"],[1,"photo-upload-container-large"],[1,"photo-preview-large",3,"click"],["alt","Preview",3,"src"],[1,"photo-overlay-large"],[1,"fa-solid","fa-camera"],["type","file","accept","image/*","hidden","",3,"change"],[1,"photo-label"],[1,"form-group","flex-1"],["for","completeName"],["id","completeName","type","text","formControlName","completeName","placeholder","Ej: Juan P\xE9rez"],[1,"form-grid"],["class","form-group",4,"ngIf"],[1,"form-group"],["for","typeId"],["id","typeId","formControlName","typeId"],["value","","disabled",""],[3,"value",4,"ngFor","ngForOf"],["for","categoryId"],["id","categoryId","formControlName","categoryId",3,"change"],["for","subCategoryId"],["id","subCategoryId","formControlName","subCategoryId"],["value",""],[1,"form-group",2,"grid-column","1 / -1"],[1,"checkbox-label",2,"display","flex","align-items","center","gap","0.5rem","cursor","pointer"],["type","checkbox","formControlName","categoryLocked",2,"width","18px","height","18px","cursor","pointer"],[2,"font-weight","500","color","var(--text-primary)"],[2,"color","var(--text-muted)","display","block","margin-top","0.25rem"],["for","cellphone"],["id","cellphone","type","text","formControlName","cellphone","placeholder","0414-1234567"],["for","birthdate"],["id","birthdate","type","date","formControlName","birthdate"],["for","gender"],["id","gender","formControlName","gender"],["for","cc"],["id","cc","type","text","formControlName","cc","placeholder","V-12345678"],[1,"form-group","full"],["for","address"],["id","googleAddress","type","text","placeholder","Buscar direcci\xF3n...",1,"form-control",3,"keydown.enter"],["class","address-preview",4,"ngIf"],["type","hidden","formControlName","neighborhood"],["type","hidden","formControlName","city"],["type","hidden","formControlName","municipality"],["type","hidden","formControlName","district"],["type","hidden","formControlName","postalCode"],["type","hidden","formControlName","latitude"],["type","hidden","formControlName","longitude"],[1,"form-footer"],["type","button",1,"btn","btn-muted",3,"click","disabled"],["type","submit",1,"btn","btn-primary",3,"disabled"],[1,"fa-solid",3,"ngClass"],[1,"modal-loading-overlay"],[1,"spinner-wrapper"],[1,"spinner-circle"],["for","branchId"],["id","branchId","formControlName","branchId"],["class","text-error",4,"ngIf"],[3,"value"],[1,"text-error"],[1,"address-preview"],[1,"fa-solid","fa-location-dot"],["class","text-primary d-block",4,"ngIf"],[1,"text-primary","d-block"],[1,"modal-content",3,"click"],[1,"close-btn",3,"click"],["class","modal-body",4,"ngIf"],[1,"profile-header"],["alt","Avatar Grande",3,"src"],[1,"profile-title"],[2,"display","flex","gap","0.5rem","flex-wrap","wrap","margin-top","0.25rem"],[1,"badge","badge-solid"],["class","badge badge-outline",3,"border-color","color",4,"ngIf"],[1,"badge","badge-outline"],[1,"details-grid"],[1,"detail-item"],[1,"text-sm","font-mono","text-muted"],[1,"badge","badge-solid",2,"color","white !important"],["class","detail-item",4,"ngIf"],[1,"detail-item","full"],[1,"notes-container"],[1,"notes-header-flex"],[1,"fa-solid","fa-notes"],["class","btn btn-primary btn-xs",3,"click",4,"ngIf"],["class","notes-scroll-area",4,"ngIf"],["class","empty-notes",4,"ngIf"],[1,"btn","btn-primary","btn-xs",3,"click"],[1,"fa-solid","fa-plus"],[1,"notes-scroll-area"],["class","note-item",4,"ngFor","ngForOf"],[1,"note-item"],[1,"note-top"],[1,"note-info"],[1,"note-author"],[1,"note-date"],["class","btn-delete-note","title","Eliminar nota",3,"click",4,"ngIf"],[1,"note-body"],["title","Eliminar nota",1,"btn-delete-note",3,"click"],[1,"fa-solid","fa-trash-can"],[1,"empty-notes"],[1,"fa-solid","fa-note-sticky"],[1,"modal-content","note-modal",3,"click"],[1,"note-form",3,"ngSubmit","formGroup"],[1,"label-spread"],["for","noteContent"],[1,"char-counter"],["id","noteContent","formControlName","note","rows","5","maxlength","254","placeholder","Escribe aqu\xED la informaci\xF3n relevante..."],["type","submit",1,"btn","btn-primary","note-submit-btn",3,"disabled"],[1,"modal-content","filters-modal",3,"click"],[1,"filters-grid"],["class","filter-section",4,"ngIf"],[1,"filter-section"],[1,"checkbox-group"],["class","checkbox-label",4,"ngFor","ngForOf"],[1,"trip-switch"],["type","button",3,"click"],["type","button",3,"active","click",4,"ngFor","ngForOf"],[1,"filter-section","full-width"],[1,"data-filters-grid"],[1,"data-filter-item"],[1,"age-range-inputs"],["type","number","placeholder","M\xEDn","min","0","max","120",3,"ngModelChange","ngModel"],["type","number","placeholder","M\xE1x","min","0","max","120",3,"ngModelChange","ngModel"],["type","text","placeholder","Barrio, ciudad, direcci\xF3n...",1,"full-width-input",3,"ngModelChange","ngModel"],[1,"status-switch"],["type","checkbox",3,"ngModelChange","ngModel"],[1,"toggle-label"],[1,"modal-footer"],[1,"btn","btn-muted",3,"click"],[1,"btn","btn-primary",3,"click"],[1,"fa-solid","fa-filter"],[1,"soft-input-wrapper","full-width"],[1,"fa-solid","fa-building","soft-input-icon"],[1,"soft-input",3,"ngModelChange","ngModel"],[1,"fa-solid","fa-chevron-down","select-arrow"],[1,"checkbox-label"],["type","checkbox",3,"change","checked"],[1,"filters-grid-nested"],[4,"ngFor","ngForOf"],[1,"nested-category-title"]],template:function(e,n){e&1&&(d(0,"div",1)(1,"div",2)(2,"div",3)(3,"div",4)(4,"div",5)(5,"button",6),L("click",function(){return n.openAdvancedFilters()}),d(6,"div",7),j(7,"i",8),d(8,"span"),_(9,"Filtros"),u()(),fe(10,FO,2,1,"span",9),u()()(),d(11,"div",10)(12,"div",11)(13,"div",12),j(14,"i",13),d(15,"input",14),ht("ngModelChange",function(a){return ut(n.searchQuery,a)||(n.searchQuery=a),a}),L("ngModelChange",function(){return n.onSearchInput()})("keyup.enter",function(){return n.onSearch()}),u()(),d(16,"button",15),L("click",function(){return n.openAdvancedFilters()}),j(17,"i",8),fe(18,DO,2,1,"span",16),u(),d(19,"div",17)(20,"button",18),L("click",function(){return n.showMobileMenu=!n.showMobileMenu}),j(21,"i",19),u(),fe(22,RO,14,1,"div",20),u()()(),d(23,"div",21)(24,"div",22)(25,"button",23),L("click",function(){return n.toggleExportDropdown()}),j(26,"i",24),d(27,"span",25),_(28,"Exportar"),u()(),fe(29,LO,9,0,"div",26),u(),fe(30,BO,4,0,"button",27),u()(),d(31,"div",28)(32,"table",29)(33,"thead")(34,"tr")(35,"th"),_(36,"NOMBRE COMPLETO"),u(),d(37,"th",30),_(38,"TEL\xC9FONO"),u(),d(39,"th",5),_(40,"DIRECCI\xD3N"),u(),d(41,"th",5),_(42,"CATEGOR\xCDA"),u(),d(43,"th",5),_(44,"SEDE"),u(),d(45,"th",30),_(46,"G\xC9NERO"),u(),d(47,"th",5),_(48,"TIPO"),u(),d(49,"th"),_(50,"ACCIONES"),u()()(),d(51,"tbody"),fe(52,UO,6,0,"tr",31)(53,tA,2,1,"ng-container",31)(54,rA,4,0,"tr",31),u()()(),d(55,"div",32)(56,"div",33)(57,"span"),_(58),u(),d(59,"div",34)(60,"button",35),L("click",function(){return n.prevPage()}),j(61,"i",36),u(),d(62,"button",35),L("click",function(){return n.nextPage()}),j(63,"i",37),u()()()()()(),fe(64,mA,91,15,"div",38)(65,EA,8,1,"div",38)(66,PA,23,10,"div",38)(67,BA,98,36,"div",38)),e&2&&(g(10),P("ngIf",n.selectedTypes.length+n.selectedCategories.length+(n.hasCc!==null?1:0)+(n.hasCellphone!==null?1:0)+(n.hasAddress!==null?1:0)+(n.hasBirthdate!==null?1:0)+(n.ageFilterRange1!==null||n.ageFilterRange2!==null?1:0)+(n.filterLocation?1:0)>0),g(5),ft("ngModel",n.searchQuery),g(3),P("ngIf",n.selectedTypes.length+n.selectedCategories.length+n.selectedSubCategories.length+(n.hasCc!==null?1:0)+(n.hasCellphone!==null?1:0)+(n.hasAddress!==null?1:0)+(n.hasBirthdate!==null?1:0)+(n.ageFilterRange1!==null||n.ageFilterRange2!==null?1:0)+(n.filterLocation?1:0)>0),g(4),P("ngIf",n.showMobileMenu),g(7),P("ngIf",n.showExportDropdown),g(),P("ngIf",n.can("CREATE_MEMBER")),g(22),P("ngIf",n.isLoading),g(),P("ngIf",!n.isLoading),g(),P("ngIf",n.members.length===0&&!n.isLoading),g(4),_a("P\xE1gina ",n.currentPage+1," de ",n.totalPages||1," (Total: ",n.totalElements,")"),g(2),P("disabled",n.currentPage===0),g(2),P("disabled",n.currentPage>=n.totalPages-1),g(2),P("ngIf",n.showFormModal),g(),P("ngIf",n.showModal),g(),P("ngIf",n.showNoteModal),g(),P("ngIf",n.showAdvancedFiltersModal))},dependencies:[gr,Tr,rn,mr,on,xa,Fi,Di,nn,Gl,ys,Ii,an,va,Yl,$l,tf,Vn,Es,Ss,Cs,js,Ji],styles:['[_nghost-%COMP%]{display:block;height:100%;width:100%;min-height:0}.integrantes-container.full-width[_ngcontent-%COMP%]{height:100%;width:100%;display:flex;flex-direction:column;min-height:0;box-sizing:border-box;background:var(--bg-main)}.full-card[_ngcontent-%COMP%]{padding:1.25rem;display:flex;flex-direction:column;height:100%;min-height:0;background:var(--bg-card);border-radius:12px;box-shadow:var(--shadow-sm);overflow:hidden}.compact-card[_ngcontent-%COMP%]{padding:1rem;display:flex;flex-direction:column;height:100%;min-height:0;background:var(--bg-card);border-radius:12px;box-shadow:var(--shadow-sm);overflow:hidden}.table-section[_ngcontent-%COMP%]{height:100%;min-height:0;display:flex;flex-direction:column;overflow:hidden}.mini-header[_ngcontent-%COMP%]{margin-bottom:.5rem;display:flex;align-items:center;gap:.5rem;flex-shrink:0}.mini-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:.95rem;font-weight:700;color:var(--text-main)}.card-header.spread[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;justify-content:space-between;gap:1.5rem;flex-wrap:nowrap;margin-bottom:5px}.header-left[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.75rem}.header-left[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0}.full-table[_ngcontent-%COMP%]{flex:1;overflow:auto;border:1px solid var(--border-color);border-radius:8px;background:var(--bg-card);min-height:0}.data-table[_ngcontent-%COMP%]{width:100%;border-collapse:separate;border-spacing:0}.data-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{position:sticky;top:0;background:var(--bg-input);z-index:10;padding:.75rem .7rem;font-size:.7rem;font-weight:700;border-bottom:2px solid var(--border-color);text-align:center;color:var(--text-muted);text-transform:uppercase}.text-center[_ngcontent-%COMP%]{text-align:center}.filter-dropdown-container[_ngcontent-%COMP%]{position:relative}.btn-filter[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;padding:.45rem .75rem;background:var(--bg-card);border:1.5px solid var(--border-color);border-radius:8px;font-size:.85rem;font-weight:600;color:var(--text-main);cursor:pointer;transition:all .2s;position:relative}.btn-filter[_ngcontent-%COMP%]:hover{border-color:var(--primary);background:var(--bg-input)}.filter-badge[_ngcontent-%COMP%]{background:var(--primary-color);color:#fff;font-size:.7rem;font-weight:700;padding:.15rem .5rem;border-radius:12px;min-width:20px;text-align:center}.filter-dropdown[_ngcontent-%COMP%]{position:absolute;top:calc(100% + .5rem);left:0;background:var(--bg-card);border:1.5px solid var(--border-color);border-radius:8px;box-shadow:var(--shadow-md);min-width:180px;z-index:1000;overflow:hidden;animation:_ngcontent-%COMP%_dropdownFadeIn .2s ease-out}.filter-option[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;padding:.4rem .75rem;cursor:pointer;transition:background .15s}.filter-option[_ngcontent-%COMP%]:hover{background:var(--bg-input)}.filter-option[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]{width:16px;height:16px;cursor:pointer;accent-color:var(--primary-color)}.filter-option[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:.85rem;font-weight:500;color:var(--text-main)}@keyframes _ngcontent-%COMP%_dropdownFadeIn{0%{opacity:0;transform:translateY(-8px)}to{opacity:1;transform:translateY(0)}}.filters-modal[_ngcontent-%COMP%]{max-width:800px!important;width:90vw!important;max-height:85vh;display:flex;flex-direction:column}.filters-modal[_ngcontent-%COMP%]   .modal-body[_ngcontent-%COMP%]{padding:0;overflow-y:auto;background:var(--bg-card)}.filters-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(280px,1fr));gap:1.5rem;padding:1.5rem}.filter-section[_ngcontent-%COMP%]{background:var(--bg-input);padding:1rem;border-radius:10px;border:1px solid var(--border-color)}.filter-section[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:.85rem;font-weight:700;color:var(--text-muted);text-transform:uppercase;margin-bottom:1rem;letter-spacing:.5px;display:flex;align-items:center;gap:.5rem}.filter-section[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]:before{content:"";display:block;width:4px;height:14px;background:var(--primary);border-radius:2px}.checkbox-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.6rem;max-height:200px;overflow-y:auto;padding-right:.5rem}.checkbox-group[_ngcontent-%COMP%]::-webkit-scrollbar{width:4px}.checkbox-group[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:transparent}.checkbox-group[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:var(--border-color);border-radius:4px}.checkbox-label[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.6rem;cursor:pointer;font-size:.9rem;color:var(--text-main);transition:all .2s;padding:.25rem 0}.checkbox-label[_ngcontent-%COMP%]:hover{color:var(--primary)}.checkbox-label[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]{width:16px;height:16px;accent-color:var(--primary);cursor:pointer}.filters-grid-nested[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1rem}.nested-category-title[_ngcontent-%COMP%]{font-size:.8rem;font-weight:700;color:var(--primary);margin-bottom:.5rem;padding-bottom:.25rem;border-bottom:1px dashed var(--border-color)}.full-width[_ngcontent-%COMP%]{grid-column:1 / -1}.data-filters-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:1rem}.data-filter-item[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:.8rem;font-weight:600;color:var(--text-muted)}.trip-switch[_ngcontent-%COMP%]{display:flex;background:var(--bg-card);padding:3px;border-radius:8px;border:1px solid var(--border-color);width:fit-content}.trip-switch[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:4px 12px;font-size:.8rem;font-weight:600;border:none;background:transparent;border-radius:6px;cursor:pointer;color:var(--text-muted);transition:all .2s;min-width:50px}.trip-switch[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{color:var(--text-main)}.trip-switch[_ngcontent-%COMP%]   button.active[_ngcontent-%COMP%]{background:var(--primary);color:#fff;box-shadow:0 2px 4px rgba(var(--primary-rgb),.3)}.age-range-inputs[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem}.age-range-inputs[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{flex:1;padding:.5rem;border:1px solid var(--border-color);border-radius:8px;background:var(--bg-card);font-size:.9rem;text-align:center}.age-range-inputs[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{border-color:var(--primary);outline:none}.full-width-input[_ngcontent-%COMP%]{width:100%;padding:.6rem;border:1px solid var(--border-color);border-radius:8px;background:var(--bg-card);font-size:.9rem}.full-width-input[_ngcontent-%COMP%]:focus{border-color:var(--primary);outline:none}.filters-modal[_ngcontent-%COMP%]   .modal-footer[_ngcontent-%COMP%]{padding:1rem 1.5rem;background:var(--bg-input);border-top:1px solid var(--border-color);display:flex;justify-content:flex-end;gap:1rem}@media(max-width:768px){.filters-modal[_ngcontent-%COMP%]{width:95%!important;max-width:95%!important}.filters-grid[_ngcontent-%COMP%]{grid-template-columns:1fr;padding:1rem;gap:1rem}.data-filters-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}.full-card[_ngcontent-%COMP%]{padding:.5rem}.header-section[_ngcontent-%COMP%]{padding:.5rem;gap:.5rem;margin-bottom:.5rem}}.advanced-dropdown-footer[_ngcontent-%COMP%]{margin-top:1rem;padding-top:.75rem;border-top:1px dashed var(--border-color);display:flex;justify-content:space-between;align-items:center}.footer-actions-right[_ngcontent-%COMP%]{display:flex;gap:.5rem;margin-left:auto}.btn-xs[_ngcontent-%COMP%]{padding:.25rem .5rem;font-size:.7rem}.export-menu[_ngcontent-%COMP%]{min-width:150px;padding:.4rem 0}.dropdown-item[_ngcontent-%COMP%]{width:100%;display:flex;align-items:center;gap:.4rem;padding:.35rem .5rem;border:none;background:none;cursor:pointer;font-size:.85rem;font-weight:500;color:var(--text-main);transition:background .2s}.dropdown-item[_ngcontent-%COMP%]:hover{background:var(--bg-input)}.dropdown-item[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{width:16px;text-align:center}.mt-4[_ngcontent-%COMP%]{margin-top:1rem}.boolean-filters-mobile[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1rem;padding:.5rem 0}.boolean-filter-item-mobile[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;gap:1rem}.boolean-filter-item-mobile[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:.9rem;font-weight:600;color:var(--text-main)}.data-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:.45rem .5rem;font-size:.8rem;border-bottom:1px solid var(--border-color);text-align:left;vertical-align:middle}.user-cell-mini[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem}.user-cell-mini[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:32px;height:32px;border-radius:100%;object-fit:cover}.name-column[_ngcontent-%COMP%]{display:flex;flex-direction:column}.user-name[_ngcontent-%COMP%]{font-weight:700;color:var(--text-main);display:inline-block;line-height:1.2}.user-age[_ngcontent-%COMP%]{font-size:.7rem;color:var(--text-muted);font-weight:500}@media(max-width:768px){.user-name[_ngcontent-%COMP%]{white-space:normal;overflow:visible}}@media(min-width:769px){.user-name[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;max-width:12rem}}.btn-sm[_ngcontent-%COMP%]{padding:.35rem .6rem;font-size:.75rem}.action-btn-sm[_ngcontent-%COMP%]{width:24px;height:24px;display:flex;align-items:center;justify-content:center;border-radius:4px;font-size:.75rem;transition:all var(--transition-speed)}.action-btn-sm[_ngcontent-%COMP%]:hover{background-color:var(--bg-input)}.action-btn-sm.view[_ngcontent-%COMP%]{color:var(--text-muted)}.action-btn-sm.edit[_ngcontent-%COMP%]{color:var(--primary)}.action-btn-sm.delete[_ngcontent-%COMP%]{color:#ef4444}.actions-mini[_ngcontent-%COMP%]{display:flex;gap:.5rem;justify-content:center;align-items:center}.desktop-actions[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem}.modal-content.form-modal[_ngcontent-%COMP%]{max-width:550px}.integrante-form-modal[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1.5rem}.form-header-row[_ngcontent-%COMP%]{display:flex;align-items:center;gap:1.5rem;padding-bottom:1rem;border-bottom:1px dashed var(--border-color)}.photo-upload-container-large[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;gap:.5rem}.photo-preview-large[_ngcontent-%COMP%]{width:80px;height:80px;border-radius:50%;position:relative;overflow:hidden;cursor:pointer;border:3px solid var(--primary-light);box-shadow:0 4px 6px #0000001a}.photo-preview-large[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover}.photo-overlay-large[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;background:rgba(var(--primary-rgb),.4);display:flex;align-items:center;justify-content:center;opacity:0;transition:opacity .2s;color:#fff}.photo-preview-large[_ngcontent-%COMP%]:hover   .photo-overlay-large[_ngcontent-%COMP%]{opacity:1}.photo-label[_ngcontent-%COMP%]{font-size:.65rem;font-weight:700;color:var(--text-muted);text-transform:uppercase}.form-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:1rem 1.5rem}.form-group.full[_ngcontent-%COMP%]{grid-column:span 2}.form-footer[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;gap:1rem;margin-top:1rem;padding-top:1.25rem;border-top:1px solid var(--border-color)}.form-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.35rem;width:100%}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:.75rem;font-weight:700;color:var(--text-muted);text-transform:uppercase;letter-spacing:.05em}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .form-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%], .form-group[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]{padding:.6rem .8rem;font-size:.9rem;border:1px solid var(--border-color);border-radius:8px;background:var(--bg-input);color:var(--text-main);width:100%;transition:all .2s}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus, .form-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus, .form-group[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]:focus{border-color:var(--primary);background:var(--bg-card);outline:none;box-shadow:0 0 0 3px rgba(var(--primary-rgb),.1)}.btn-new[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;font-weight:600}.status-switch[_ngcontent-%COMP%]{display:inline-block;width:36px;height:20px;position:relative}.status-switch[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{opacity:0;width:0;height:0}.status-switch[_ngcontent-%COMP%]   .slider[_ngcontent-%COMP%]{position:absolute;cursor:pointer;inset:0;background-color:var(--border-color);transition:.4s;border-radius:20px}.status-switch[_ngcontent-%COMP%]   .slider[_ngcontent-%COMP%]:before{position:absolute;content:"";height:14px;width:14px;left:3px;bottom:3px;background-color:#fff;transition:.4s;border-radius:50%}.status-switch[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:checked + .slider[_ngcontent-%COMP%]{background-color:var(--primary)}.status-switch[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:checked + .slider[_ngcontent-%COMP%]:before{transform:translate(16px)}.status-switch[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:disabled + .slider[_ngcontent-%COMP%]{opacity:.6;cursor:not-allowed;background-color:var(--border-color)!important}.status-switch[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:disabled + .slider[_ngcontent-%COMP%]:before{background-color:var(--bg-input)}.status-switch-mini[_ngcontent-%COMP%]{display:inline-block;width:28px;height:16px;position:relative;margin-right:4px}.status-switch-mini[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{opacity:0;width:0;height:0}.status-switch-mini[_ngcontent-%COMP%]   .slider[_ngcontent-%COMP%]{position:absolute;cursor:pointer;inset:0;background-color:var(--border-color);transition:.4s;border-radius:16px}.status-switch-mini[_ngcontent-%COMP%]   .slider[_ngcontent-%COMP%]:before{position:absolute;content:"";height:10px;width:10px;left:3px;bottom:3px;background-color:#fff;transition:.4s;border-radius:50%}.status-switch-mini[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:checked + .slider[_ngcontent-%COMP%]{background-color:#2563eb}.status-switch-mini[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:checked + .slider[_ngcontent-%COMP%]:before{transform:translate(12px)}.status-switch-mini[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:disabled + .slider[_ngcontent-%COMP%]{opacity:.6;cursor:not-allowed;background-color:#cbd5e1!important}.status-switch-mini[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:disabled + .slider[_ngcontent-%COMP%]:before{background-color:#f1f5f9}.address-cell[_ngcontent-%COMP%]{max-width:200px;font-size:.8rem;color:var(--text-muted);display:-webkit-box;-webkit-line-clamp:2;line-clamp:2;-webkit-box-orient:vertical;overflow:hidden;text-overflow:ellipsis;line-height:1.4;white-space:normal}.header-actions[_ngcontent-%COMP%]{display:flex;align-items:center;gap:1.25rem;flex:1}.toggle-filter[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;flex-shrink:0}.toggle-label[_ngcontent-%COMP%]{font-size:.75rem;font-weight:600;color:var(--text-muted)}.search-box-mini[_ngcontent-%COMP%]{position:relative;flex:1;display:flex;align-items:center;flex-grow:1}.search-box-mini[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;padding:.55rem 1rem .55rem 2.5rem;font-size:.9rem;border:2px solid var(--border-color);border-radius:9999px;background-color:var(--bg-card);transition:all .2s ease;box-shadow:inset 0 2px 4px #00000005}.search-box-mini[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{border-color:var(--primary);box-shadow:0 0 0 4px rgba(var(--primary-rgb),.15);outline:none}.search-box-mini[_ngcontent-%COMP%]   .search-icon-btn[_ngcontent-%COMP%]{position:absolute;left:1rem;color:var(--text-muted);font-size:1rem;background:none;border:none;cursor:pointer;display:flex;align-items:center;justify-content:center;z-index:5}.inactive-row[_ngcontent-%COMP%]{background-color:var(--bg-main)}.modal-overlay[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;background-color:#00000080;display:flex;align-items:center;justify-content:center;z-index:1000;-webkit-backdrop-filter:blur(4px);backdrop-filter:blur(4px)}.modal-content[_ngcontent-%COMP%]{background:var(--bg-card);width:90%;max-width:600px;max-height:85vh;border-radius:16px;box-shadow:var(--shadow-md);overflow:hidden;display:flex;flex-direction:column;animation:_ngcontent-%COMP%_modal-slide-in .3s ease-out}@keyframes _ngcontent-%COMP%_modal-slide-in{0%{transform:translateY(20px);opacity:0}to{transform:translateY(0);opacity:1}}.modal-header[_ngcontent-%COMP%]{padding:1.25rem 1.5rem;border-bottom:1px solid var(--border-color);display:flex;justify-content:space-between;align-items:center;background:var(--bg-card)}.modal-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:1.25rem;font-weight:700;color:var(--text-main)}.close-btn[_ngcontent-%COMP%]{background:var(--bg-input);border:none;width:32px;height:32px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:1.25rem;cursor:pointer;color:var(--text-muted);transition:all .2s}.close-btn[_ngcontent-%COMP%]:hover{background:var(--border-color);color:var(--text-main)}.modal-body[_ngcontent-%COMP%]{padding:2rem;overflow-y:auto;flex:1}.profile-header[_ngcontent-%COMP%]{display:flex;align-items:center;gap:2rem;margin-bottom:2.5rem;padding-bottom:1.5rem;border-bottom:1px dashed var(--border-color)}.profile-header[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100px;height:100px;border-radius:16px;object-fit:cover;box-shadow:0 10px 15px -3px #0000001a;border:4px solid var(--white)}.profile-title[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:1.75rem;font-weight:800;margin-bottom:.5rem;color:var(--text-main)}.details-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:1.5rem 2rem}.detail-item[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.4rem}.detail-item.full[_ngcontent-%COMP%]{grid-column:span 2}.detail-item[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:.75rem;font-weight:700;color:var(--text-muted);text-transform:uppercase;letter-spacing:.05em}.detail-item[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:1rem;color:var(--text-main);font-weight:600;line-height:1.4}@media(max-width:900px){.grid[_ngcontent-%COMP%]{grid-template-columns:1fr;align-items:start;height:auto;overflow:visible}.form-row[_ngcontent-%COMP%]{grid-template-columns:1fr}.btn-new[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:none}.integrantes-container.compact[_ngcontent-%COMP%]{height:auto;overflow:visible}}.modal-loading-overlay[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;background:var(--bg-card-tp);display:flex;align-items:center;justify-content:center;z-index:100;animation:_ngcontent-%COMP%_fadeIn .2s ease-out;border-radius:16px}.spinner-wrapper[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;gap:1rem}.spinner-circle[_ngcontent-%COMP%]{width:40px;height:40px;border:3px solid #f3f3f3;border-top:3px solid var(--primary);border-radius:50%;animation:_ngcontent-%COMP%_spin 1s linear infinite}.spinner-wrapper[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:.9rem;font-weight:600;color:var(--primary)}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0}to{opacity:1}}.mobile-actions-wrapper[_ngcontent-%COMP%]{position:relative;display:inline-block}.action-dropdown[_ngcontent-%COMP%]{position:absolute;top:100%;right:0;z-index:1000;background:var(--bg-card);min-width:180px;border-radius:12px;box-shadow:0 10px 25px -5px #0000001a,0 8px 10px -6px #0000001a;border:1px solid var(--border-color);padding:.5rem 0;margin-top:.5rem;animation:_ngcontent-%COMP%_dropdown-fade-in .2s cubic-bezier(.16,1,.3,1)}@keyframes _ngcontent-%COMP%_dropdown-fade-in{0%{opacity:0;transform:translateY(-10px) scale(.95)}to{opacity:1;transform:translateY(0) scale(1)}}.dropdown-header-mobile[_ngcontent-%COMP%]{padding:.5rem 1rem;background:var(--bg-main);border-bottom:1px solid var(--border-color);margin-bottom:.4rem;margin-top:-.5rem;border-radius:12px 12px 0 0}.member-name-small[_ngcontent-%COMP%]{font-size:.75rem;font-weight:700;color:var(--text-muted);display:block;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.action-dropdown[_ngcontent-%COMP%]   .dropdown-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.75rem;padding:.75rem 1rem;width:100%;border:none;background:none;cursor:pointer;font-size:.85rem;font-weight:600;color:var(--text-main);transition:all .2s;text-align:left;position:relative;z-index:1}.dropdown-label[_ngcontent-%COMP%]{flex:1}.action-dropdown[_ngcontent-%COMP%]   .dropdown-item[_ngcontent-%COMP%]:hover{background:var(--bg-input);color:var(--primary)}.action-dropdown[_ngcontent-%COMP%]   .dropdown-item[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{width:16px;text-align:center;font-size:.9rem}.status-row[_ngcontent-%COMP%]{justify-content:space-between}.dropdown-divider[_ngcontent-%COMP%]{border:0;border-top:1px solid var(--border-color);margin:.4rem 0}.delete-text[_ngcontent-%COMP%]:hover{background:#ef44441a;color:#ef4444}.text-primary[_ngcontent-%COMP%]{color:var(--primary)}.menu-trigger[_ngcontent-%COMP%]{width:28px;height:28px;border-radius:6px;background:var(--bg-input);color:var(--text-muted);display:flex;align-items:center;justify-content:center;transition:all .2s}.menu-trigger[_ngcontent-%COMP%]:hover{background:#e2e8f0;color:var(--text-main)}@media(max-width:768px){.desktop-only[_ngcontent-%COMP%]{display:none!important}.mobile-only[_ngcontent-%COMP%]{display:flex!important}}@media(min-width:769px){.mobile-only[_ngcontent-%COMP%]{display:none!important}}.filter-group[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.75rem}.mobile-filters-modal[_ngcontent-%COMP%]{max-width:90vw;width:500px}.filter-section[_ngcontent-%COMP%]{margin-bottom:1.5rem}.filter-section[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:.85rem;font-weight:700;color:var(--text-muted);text-transform:uppercase;margin-bottom:.75rem;letter-spacing:.5px}.filter-options-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(2,1fr);gap:.75rem}.filter-option-card[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;padding:.6rem .75rem;background:var(--bg-card);border:1.5px solid var(--border-color);border-radius:8px;cursor:pointer;transition:all .2s}.filter-option-card[_ngcontent-%COMP%]:hover{background:var(--bg-input);border-color:var(--primary-color)}.filter-option-card.selected[_ngcontent-%COMP%]{background:rgba(var(--primary-rgb),.1);border-color:var(--primary-color);box-shadow:0 0 0 3px #3b82f61a}.filter-option-card[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]{width:18px;height:18px;cursor:pointer;accent-color:var(--primary-color)}.filter-option-card[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:.8rem;font-weight:500;color:var(--text-main)}.toggle-filter-mobile[_ngcontent-%COMP%]{display:flex;align-items:center;gap:1rem;padding:1rem;background:var(--bg-input);border-radius:8px}.toggle-filter-mobile[_ngcontent-%COMP%]   .toggle-label[_ngcontent-%COMP%]{font-size:.95rem;font-weight:600;color:var(--text-main)}.modal-footer[_ngcontent-%COMP%]{padding:1.25rem 1.5rem;border-top:1px solid var(--border-color);display:flex;justify-content:flex-end;gap:1rem;background:var(--bg-card);border-radius:0 0 16px 16px}.btn-muted[_ngcontent-%COMP%]{background:var(--bg-input);color:var(--text-muted);border:1px solid var(--border-color);font-weight:600;padding:.6rem 1.25rem;border-radius:8px;cursor:pointer;transition:all .2s}.integrantes-footer[_ngcontent-%COMP%]{border-top:1px solid var(--border-color);padding:.75rem 1rem;display:flex;justify-content:space-between;align-items:center;background:var(--bg-card);border-bottom-left-radius:12px;border-bottom-right-radius:12px;min-height:52px;flex-shrink:0;margin:0 -1.25rem -1.25rem;width:calc(100% + 2.5rem);box-sizing:border-box}.pagination-mini[_ngcontent-%COMP%]{display:flex;align-items:center;gap:1rem;font-size:.85rem;color:var(--text-muted);font-weight:500}.mobile-category-info[_ngcontent-%COMP%]{display:flex;gap:.25rem;margin-top:.25rem;flex-wrap:wrap}.badge-mini[_ngcontent-%COMP%]{font-size:.6rem;padding:.1rem .35rem;border-radius:4px;color:#fff;font-weight:700;text-transform:uppercase}.badge-mini-outline[_ngcontent-%COMP%]{font-size:.6rem;padding:.1rem .35rem;border-radius:4px;background:transparent;border:1px solid;font-weight:700;text-transform:uppercase}.btn-muted[_ngcontent-%COMP%]:hover{background:var(--border-color);color:var(--text-main)}.empty-state[_ngcontent-%COMP%]{padding:4rem!important;text-align:center;color:#94a3b8;border:none!important}@media(max-width:768px){.export-dropdown-container[_ngcontent-%COMP%]   .btn-sm[_ngcontent-%COMP%]{padding:.35rem .5rem;gap:.2rem}.export-dropdown-container[_ngcontent-%COMP%]   .btn-sm[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]:last-child{font-size:.6rem;margin-left:.1rem}}.notes-container[_ngcontent-%COMP%]{margin-top:1.5rem;padding-top:1.5rem;border-top:1px solid var(--border-color)}.notes-header-flex[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:1rem}.notes-header-flex[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{font-size:1rem;font-weight:700;color:var(--text-main);margin:0;display:flex;align-items:center;gap:.5rem}.notes-scroll-area[_ngcontent-%COMP%]{max-height:250px;overflow-y:auto;padding-right:.5rem;display:flex;flex-direction:column;gap:1rem;margin-bottom:.5rem}.notes-scroll-area[_ngcontent-%COMP%]::-webkit-scrollbar{width:6px}.notes-scroll-area[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:#f1f5f9;border-radius:10px}.notes-scroll-area[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#cbd5e1;border-radius:10px}.notes-scroll-area[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:#94a3b8}.note-item[_ngcontent-%COMP%]{background:var(--bg-card);border:1px solid var(--border-color);border-radius:10px;padding:1rem;position:relative;transition:all .2s}.note-item[_ngcontent-%COMP%]:hover{border-color:var(--primary-light);box-shadow:0 2px 4px #0000000d}.note-top[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:.5rem}.note-info[_ngcontent-%COMP%]{display:flex;flex-direction:column}.note-author[_ngcontent-%COMP%]{font-size:.75rem;font-weight:700;color:var(--primary)}.note-date[_ngcontent-%COMP%]{font-size:.65rem;color:var(--text-muted)}.note-body[_ngcontent-%COMP%]{font-size:.85rem;color:var(--text-main);line-height:1.5;white-space:pre-wrap;word-break:break-word}.btn-delete-note[_ngcontent-%COMP%]{background:transparent;border:none;color:#ef4444;padding:4px;cursor:pointer;opacity:.6;transition:opacity .2s;font-size:.8rem}.btn-delete-note[_ngcontent-%COMP%]:hover{opacity:1}.empty-notes[_ngcontent-%COMP%]{padding:2rem;text-align:center;background:var(--bg-main);border:2px dashed var(--border-color);border-radius:12px;color:var(--text-muted);font-size:.85rem}.empty-notes[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:1.5rem;margin-bottom:.5rem;display:block;opacity:.5}.note-modal[_ngcontent-%COMP%]{max-width:450px!important}.note-form[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1.25rem}.note-form[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]{min-height:120px;resize:vertical}.note-submit-btn[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;gap:.5rem}.text-success[_ngcontent-%COMP%]{color:#10b981}.text-danger[_ngcontent-%COMP%]{color:#ef4444}.text-primary[_ngcontent-%COMP%]{color:#2563eb}.label-spread[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:.25rem}.age-range-filter-container[_ngcontent-%COMP%]{padding:0 .25rem}.filter-label[_ngcontent-%COMP%]{display:block;font-size:.8rem;font-weight:700;color:var(--text-muted);margin-bottom:.5rem;text-transform:uppercase;letter-spacing:.025em}.range-inputs[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem}.range-inputs[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:60px;padding:.4rem .5rem;border:1.5px solid #e2e8f0;border-radius:6px;font-size:.85rem;text-align:center}.range-inputs[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{border-color:var(--primary-color);outline:none;box-shadow:0 0 0 3px #2563eb1a}.range-sep[_ngcontent-%COMP%]{color:var(--text-muted);font-weight:500}.range-inputs-mobile[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.75rem;padding:.5rem 0}.range-inputs-mobile[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{flex:1;width:0;padding:.6rem .5rem;border:1.5px solid var(--border-color);border-radius:8px;font-size:.9rem;text-align:center;background:var(--bg-card);color:var(--text-main)}.range-inputs-mobile[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{border-color:var(--primary-color);outline:none}.char-counter[_ngcontent-%COMP%]{font-size:.7rem;font-weight:600;color:var(--text-muted)}.char-counter.danger[_ngcontent-%COMP%]{color:#ef4444}.geocoder-container[_ngcontent-%COMP%]{width:100%;z-index:10;position:relative;margin-bottom:.5rem}.mapboxgl-ctrl-geocoder[_ngcontent-%COMP%]{width:100%!important;max-width:none!important;box-shadow:none!important;border:1.5px solid var(--border-color);border-radius:8px;background:var(--bg-card)!important}.mapboxgl-ctrl-geocoder--input[_ngcontent-%COMP%]{height:42px!important;padding:6px 35px!important;font-family:Inter,sans-serif!important}.address-preview[_ngcontent-%COMP%]{margin-top:.5rem;padding:.5rem;background:var(--bg-main);border-radius:6px;border:1px dashed var(--border-color);font-size:.85rem}.filters-modal[_ngcontent-%COMP%]{max-width:800px;max-height:90vh;overflow-y:auto}.filters-modal[_ngcontent-%COMP%]   .modal-body[_ngcontent-%COMP%]{padding:1.5rem}.filters-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(2,1fr);gap:1.5rem}.filters-grid[_ngcontent-%COMP%]   .filter-section[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.75rem}.filters-grid[_ngcontent-%COMP%]   .filter-section.full-width[_ngcontent-%COMP%]{grid-column:1 / -1}.filters-grid[_ngcontent-%COMP%]   .filter-section[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:.95rem;font-weight:600;color:var(--text-primary);margin:0;padding-bottom:.5rem;border-bottom:2px solid var(--border-color)}.checkbox-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.5rem}.checkbox-label[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;cursor:pointer;padding:.5rem;border-radius:6px;transition:background-color .2s}.checkbox-label[_ngcontent-%COMP%]:hover{background-color:var(--hover-bg)}.checkbox-label[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]{width:18px;height:18px;cursor:pointer}.checkbox-label[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:.9rem;color:var(--text-primary)}.data-filters-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(2,1fr);gap:1rem}.data-filter-item[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.5rem}.data-filter-item[_ngcontent-%COMP%] > span[_ngcontent-%COMP%]{font-size:.85rem;font-weight:500;color:var(--text-secondary)}.age-range-inputs[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.75rem}.age-range-inputs[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{flex:1;padding:.5rem;border:1px solid var(--border-color);border-radius:6px;font-size:.9rem}.age-range-inputs[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:var(--text-secondary);font-weight:500}.full-width-input[_ngcontent-%COMP%]{width:100%;padding:.75rem;border:1px solid var(--border-color);border-radius:6px;font-size:.9rem;font-family:Inter,sans-serif;background:var(--bg-input);color:var(--text-main)}.full-width-input[_ngcontent-%COMP%]:focus{outline:none;border-color:var(--primary);box-shadow:0 0 0 3px #3b82f61a}@media(max-width:768px){.filters-modal[_ngcontent-%COMP%]{max-width:95vw;max-height:85vh}.filters-grid[_ngcontent-%COMP%]{grid-template-columns:1fr;gap:1rem}.data-filters-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}}.ms-2[_ngcontent-%COMP%]{margin-left:.5rem}.badge-blue[_ngcontent-%COMP%]{background-color:#3b82f61a;color:#2563eb;border:1px solid rgba(37,99,235,.2)}.badge-pink[_ngcontent-%COMP%]{background-color:#ec48991a;color:#db2777;border:1px solid rgba(219,39,119,.2)}']})};function UA(t,r){if(t&1&&(d(0,"p"),j(1,"i",46),_(2),u()),t&2){let e=C().$implicit;g(2),je(" ",e.address)}}function VA(t,r){if(t&1){let e=Pe();d(0,"div",39),L("click",function(){let i=D(e).$implicit,a=C(2);return N(a.selectActiveEvent(i))}),d(1,"div",40),j(2,"i",41),u(),d(3,"div",42)(4,"h4"),_(5),u(),d(6,"p"),j(7,"i",43),_(8),Cr(9,"date"),u(),d(10,"p"),j(11,"i",44),_(12),u(),fe(13,UA,3,1,"p",26),u(),d(14,"div",45),j(15,"i",32),u()()}if(t&2){let e=r.$implicit;g(5),be(e.serviceName),g(3),je(" ",Qr(9,4,e.startDateTime,"h:mm a")),g(4),je(" ",e.branchName),g(),P("ngIf",e.address)}}function zA(t,r){if(t&1&&(d(0,"div",35)(1,"h3",36),_(2,"Seleccione un evento activo:"),u(),d(3,"div",37),fe(4,VA,16,7,"div",38),u()()),t&2){let e=C();g(4),P("ngForOf",e.activeEvents)}}function jA(t,r){if(t&1&&(d(0,"span",54),j(1,"i",46),_(2),u()),t&2){let e=C(2);g(2),je(" ",e.selectedActiveEvent.address," ")}}function HA(t,r){if(t&1){let e=Pe();d(0,"button",58),L("click",function(){D(e);let i=C(2);return N(i.clearActiveEventSelection())}),j(1,"i",59),_(2," Cambiar "),u()}}function WA(t,r){if(t&1){let e=Pe();d(0,"button",58),L("click",function(){D(e);let i=C(2);return N(i.togglePastEvents())}),j(1,"i",60),_(2," Historial "),u()}}function qA(t,r){if(t&1&&(d(0,"div",47)(1,"div",48)(2,"div",49),j(3,"i",41),u()(),d(4,"div",50)(5,"div",51),_(6),u(),d(7,"h2",52),_(8),u(),d(9,"div",53)(10,"span",54),j(11,"i",43),_(12),Cr(13,"date"),u(),d(14,"span",54),j(15,"i",44),_(16),u(),fe(17,jA,3,1,"span",55),u()(),d(18,"div",56),fe(19,HA,3,0,"button",57)(20,WA,3,0,"button",57),u()()),t&2){let e=C();g(5),wt("text-danger",e.isEventFinished)("text-success",!e.isEventFinished),g(),je(" ",e.isEventFinished?"EVENTO FINALIZADO":"EN CURSO"," "),g(2),be(e.selectedActiveEvent.serviceName),g(4),je(" ",Qr(13,11,e.selectedActiveEvent.startDateTime,"h:mm a")," "),g(4),je(" ",e.selectedActiveEvent.branchName," "),g(),P("ngIf",e.selectedActiveEvent.address),g(2),P("ngIf",e.activeEvents.length>1),g(),P("ngIf",e.isAdmin)}}function GA(t,r){t&1&&(d(0,"span"),_(1,"Espera a que inicie el servicio para registrar asistencia."),u())}function $A(t,r){t&1&&(d(0,"span"),_(1,"No se detect\xF3 un evento en curso. Puedes registrar asistencias pasadas."),u())}function XA(t,r){if(t&1){let e=Pe();d(0,"div",56)(1,"button",66),L("click",function(){D(e);let i=C(2);return N(i.togglePastEvents())}),_(2," Registrar Pasados "),u()()}}function YA(t,r){if(t&1&&(d(0,"div",61)(1,"div",48)(2,"div",62),j(3,"i",63),u()(),d(4,"div",50)(5,"h2",52),_(6,"No hay un servicio activo"),u(),d(7,"p",64),fe(8,GA,2,0,"span",26)(9,$A,2,0,"span",26),u()(),fe(10,XA,3,0,"div",65),u()),t&2){let e=C();g(8),P("ngIf",!e.isAdmin),g(),P("ngIf",e.isAdmin),g(),P("ngIf",e.isAdmin)}}function KA(t,r){if(t&1){let e=Pe();d(0,"div",67)(1,"div",68)(2,"h3"),j(3,"i",60),_(4," Seleccione un evento pasado"),u(),d(5,"button",69),L("click",function(){D(e);let i=C();return N(i.togglePastEvents())}),j(6,"i",70),_(7," Volver "),u()(),d(8,"div",71)(9,"app-service-calendar",72),L("eventSelected",function(i){D(e);let a=C();return N(a.selectActiveEvent(i))}),u()()()}if(t&2){let e=C();g(9),P("isAdmin",e.isAdmin)("isSelectionMode",!0)}}function ZA(t,r){if(t&1){let e=Pe();d(0,"input",73),ht("ngModelChange",function(i){D(e);let a=C();return ut(a.attendanceDate,i)||(a.attendanceDate=i),N(i)}),u()}if(t&2){let e=C();ft("ngModel",e.attendanceDate)}}function JA(t,r){t&1&&j(0,"span",74)}function QA(t,r){t&1&&(d(0,"tr")(1,"td",75)(2,"div",76),j(3,"div",77),d(4,"div"),_(5,"Cargando integrantes..."),u()()()())}function eT(t,r){if(t&1&&(d(0,"span",102),_(1),u()),t&2){let e=C().$implicit,n=C(2);g(),je("",n.getMemberAge(e)," a\xF1os")}}function tT(t,r){if(t&1&&(d(0,"span",103),_(1),u()),t&2){let e=C().$implicit;Ft("border-color",e.category.color)("color",e.category.color),g(),be(e.subCategory.name)}}function rT(t,r){if(t&1&&(d(0,"span",93),_(1),u()),t&2){let e=C().$implicit;Ft("border-color",e.category.color)("color",e.category.color),g(),je(" ",e.subCategory.name," ")}}function nT(t,r){if(t&1){let e=Pe();d(0,"tr")(1,"td")(2,"div",79)(3,"div",80),j(4,"img",81),u(),d(5,"div",82)(6,"span",83),_(7),u(),fe(8,eT,2,1,"span",84),d(9,"div",85)(10,"span",86),_(11),u(),fe(12,tT,2,5,"span",87),u()()()(),d(13,"td",24),_(14),u(),d(15,"td",88),_(16),u(),d(17,"td",24)(18,"div",89)(19,"span",90),_(20),u(),fe(21,rT,2,5,"span",91),u()(),d(22,"td",24)(23,"div",92)(24,"span",93),_(25),u()()(),d(26,"td",25)(27,"div",94)(28,"button",95),L("click",function(){let i=D(e).$implicit,a=C(2);return N(a.viewMember(i))}),j(29,"i",96),u(),d(30,"button",97),L("click",function(){let i=D(e).$implicit,a=C(2);return N(a.openNoteModal(i))}),j(31,"i",98),u(),d(32,"label",99)(33,"input",100),L("change",function(){let i=D(e).$implicit,a=C(2);return N(a.toggleSelection(i.id))}),u(),j(34,"span",101),u()()()()}if(t&2){let e=r.$implicit,n=C(2);g(4),P("src",e.pictureProfileUrl||"https://ui-avatars.com/api/?name="+e.completeName+"&background=random",pn),g(3),be(e.completeName),g(),P("ngIf",n.getMemberAge(e)!=="---"),g(2),Ft("background-color",e.category.color),g(),be(n.formatCategory(e.category)),g(),P("ngIf",e.subCategory),g(2),be(e.cellphone||"---"),g(2),be(n.formatAddress(e)),g(3),Ft("background-color",e.category.color),P("ngClass",n.getBadgeClass(e.category)),g(),je(" ",n.formatCategory(e.category)," "),g(),P("ngIf",e.subCategory),g(3),Ft("border-color",e.type.color)("color",e.type.color),g(),je(" ",e.type.name," "),g(5),wt("has-note",n.hasNote(e.id)),P("title",n.hasNote(e.id)?"Editar nota":"Agregar nota"),g(),P("ngClass",n.hasNote(e.id)?"fa-note-sticky":"fa-file-signature"),g(2),P("checked",n.isSelected(e.id))}}function iT(t,r){if(t&1&&(Ln(0),fe(1,nT,35,24,"tr",78),Bn()),t&2){let e=C();g(),P("ngForOf",e.members)}}function aT(t,r){t&1&&(d(0,"tr")(1,"td",104),j(2,"i",105),_(3," No se encontraron integrantes activos "),u()())}function oT(t,r){if(t&1&&(d(0,"span",117),_(1),u()),t&2){let e=C(3);Ft("border-color",e.selectedMember.category.color)("color",e.selectedMember.category.color),g(),je(" ",e.selectedMember.subCategory.name," ")}}function sT(t,r){if(t&1&&(d(0,"div",111)(1,"div",112),j(2,"img",113),d(3,"div",114)(4,"h3"),_(5),u(),d(6,"div",115)(7,"span",116),_(8),u(),d(9,"span",117),_(10),u(),fe(11,oT,2,5,"span",118),u()()(),d(12,"div",119)(13,"div",120)(14,"label"),_(15,"Id del sistema:"),u(),d(16,"span"),_(17),u()(),d(18,"div",120)(19,"label"),_(20,"C\xE9dula:"),u(),d(21,"span"),_(22),u()(),d(23,"div",120)(24,"label"),_(25,"Tipo:"),u(),d(26,"span"),_(27),u()(),d(28,"div",120)(29,"label"),_(30,"Tel\xE9fono:"),u(),d(31,"span"),_(32),u()(),d(33,"div",120)(34,"label"),_(35,"Nacimiento:"),u(),d(36,"span"),_(37),u()(),d(38,"div",121)(39,"label"),_(40,"Direcci\xF3n:"),u(),d(41,"span"),_(42),u()(),d(43,"div",120)(44,"label"),_(45,"Registrado:"),u(),d(46,"span"),_(47),Cr(48,"date"),u()(),d(49,"div",120)(50,"label"),_(51,"\xDAltima Actualizaci\xF3n:"),u(),d(52,"span"),_(53),Cr(54,"date"),u()(),d(55,"div",120)(56,"label"),_(57,"Estado:"),u(),d(58,"span"),_(59),u()()()()),t&2){let e=C(2);g(2),P("src",e.selectedMember.pictureProfileUrl||"https://ui-avatars.com/api/?name="+e.selectedMember.completeName+"&size=128&background=random",pn),g(3),be(e.selectedMember.completeName),g(2),Ft("background-color",e.selectedMember.category.color),P("ngClass",e.getBadgeClass(e.selectedMember.category)),g(),je(" ",e.formatCategory(e.selectedMember.category)," "),g(),Ft("border-color",e.selectedMember.type.color)("color",e.selectedMember.type.color),g(),je(" ",e.formatType(e.selectedMember.type)," "),g(),P("ngIf",e.selectedMember.subCategory),g(6),be(e.selectedMember.id),g(5),be(e.selectedMember.cc),g(5),be(e.formatType(e.selectedMember.type)),g(5),be(e.selectedMember.cellphone),g(5),be(e.selectedMember.birthdate),g(5),be(e.selectedMember.address||"---"),g(5),be(Qr(48,25,e.selectedMember.createdAt,"mediumDate")),g(6),be(Qr(54,28,e.selectedMember.updatedAt,"mediumDate")),g(5),wt("text-success",e.selectedMember.active)("text-danger",!e.selectedMember.active),g(),je(" ",e.selectedMember.active?"Activo":"Inactivo"," ")}}function lT(t,r){if(t&1){let e=Pe();d(0,"div",106),L("click",function(){D(e);let i=C();return N(i.closeModal())}),d(1,"div",107),L("click",function(i){return D(e),N(i.stopPropagation())}),d(2,"div",108)(3,"h2"),_(4,"Detalles del Integrante"),u(),d(5,"button",109),L("click",function(){D(e);let i=C();return N(i.closeModal())}),_(6,"\xD7"),u()(),fe(7,sT,60,31,"div",110),u()()}if(t&2){let e=C();g(7),P("ngIf",e.selectedMember)}}function cT(t,r){if(t&1){let e=Pe();d(0,"div",106),L("click",function(){D(e);let i=C();return N(i.closeNoteModal())}),d(1,"div",122),L("click",function(i){return D(e),N(i.stopPropagation())}),d(2,"div",108)(3,"h2"),_(4),u(),d(5,"button",109),L("click",function(){D(e);let i=C();return N(i.closeNoteModal())}),_(6,"\xD7"),u()(),d(7,"div",111)(8,"div",123)(9,"label"),_(10,"Escribe una nota para este integrante:"),u(),d(11,"textarea",124),ht("ngModelChange",function(i){D(e);let a=C();return ut(a.tempNote,i)||(a.tempNote=i),N(i)}),u()()(),d(12,"div",125)(13,"button",126),L("click",function(){D(e);let i=C();return N(i.closeNoteModal())}),_(14,"Cancelar"),u(),d(15,"button",127),L("click",function(){D(e);let i=C();return N(i.saveMemberNote())}),_(16,"Guardar Nota"),u()()()()}if(t&2){let e=C();g(4),je("Nota para ",e.noteEditingMember==null?null:e.noteEditingMember.completeName),g(7),ft("ngModel",e.tempNote)}}function dT(t,r){if(t&1&&(d(0,"option",146),_(1),u()),t&2){let e=r.$implicit;P("value",e.id),g(),be(e.name)}}function fT(t,r){if(t&1){let e=Pe();d(0,"div",106),L("click",function(){D(e);let i=C();return N(i.showConfigModal=!1)}),d(1,"div",128),L("click",function(i){return D(e),N(i.stopPropagation())}),d(2,"div",108)(3,"h2"),_(4,"Configuraci\xF3n de Asistencia"),u(),d(5,"button",109),L("click",function(){D(e);let i=C();return N(i.showConfigModal=!1)}),_(6,"\xD7"),u()(),d(7,"div",111)(8,"div",129)(9,"div",130)(10,"label"),_(11,"Tipo de Servicio"),u(),d(12,"div",131),j(13,"i",132),d(14,"select",133),ht("ngModelChange",function(i){D(e);let a=C();return ut(a.selectedServiceId,i)||(a.selectedServiceId=i),N(i)}),fe(15,dT,2,2,"option",134),u()()(),d(16,"div",130)(17,"label"),_(18,"Fecha del Servicio"),u(),d(19,"div",131),j(20,"i",135),d(21,"input",136),ht("ngModelChange",function(i){D(e);let a=C();return ut(a.serviceDate,i)||(a.serviceDate=i),N(i)}),u()()(),d(22,"div",130)(23,"div",137)(24,"label"),_(25,"Hora de Llegada"),u(),d(26,"div",138)(27,"span",139),_(28),u(),d(29,"label",140)(30,"input",141),ht("ngModelChange",function(i){D(e);let a=C();return ut(a.isManualAttendanceTime,i)||(a.isManualAttendanceTime=i),N(i)}),u(),j(31,"span",142),u()()(),d(32,"div",131),j(33,"i",143),d(34,"input",144),ht("ngModelChange",function(i){D(e);let a=C();return ut(a.attendanceDate,i)||(a.attendanceDate=i),N(i)}),u()()()()(),d(35,"div",125)(36,"button",145),L("click",function(){D(e);let i=C();return N(i.showConfigModal=!1)}),_(37," Listo "),u()()()()}if(t&2){let e=C();g(14),ft("ngModel",e.selectedServiceId),g(),P("ngForOf",e.services),g(6),ft("ngModel",e.serviceDate),g(7),be(e.isManualAttendanceTime?"Manual":"Auto"),g(2),ft("ngModel",e.isManualAttendanceTime),g(2),wt("disabled",!e.isManualAttendanceTime),g(2),ft("ngModel",e.attendanceDate),P("disabled",!e.isManualAttendanceTime)}}function uT(t,r){if(t&1&&(d(0,"option",146),_(1),u()),t&2){let e=r.$implicit;P("value",e.id),g(),be(e.name)}}function hT(t,r){if(t&1){let e=Pe();d(0,"div",150)(1,"h3"),_(2,"Sede"),u(),d(3,"div",165),j(4,"i",166),d(5,"select",167),ht("ngModelChange",function(i){D(e);let a=C(2);return ut(a.tempSelectedBranchId,i)||(a.tempSelectedBranchId=i),N(i)}),d(6,"option",168),_(7,"Todas las sedes"),u(),fe(8,uT,2,2,"option",134),u(),j(9,"i",169),u()()}if(t&2){let e=C(2);g(5),ft("ngModel",e.tempSelectedBranchId),g(3),P("ngForOf",e.branches)}}function pT(t,r){if(t&1){let e=Pe();d(0,"label",170)(1,"input",100),L("change",function(){let i=D(e).$implicit,a=C(2);return N(a.toggleAdvancedTypeSelection(i.id))}),u(),d(2,"span"),_(3),u()()}if(t&2){let e=r.$implicit,n=C(2);g(),P("checked",n.isAdvancedTypeSelected(e.id)),g(2),be(e.name)}}function mT(t,r){if(t&1){let e=Pe();d(0,"label",170)(1,"input",100),L("change",function(){let i=D(e).$implicit,a=C(2);return N(a.toggleAdvancedCategorySelection(i.id))}),u(),d(2,"span"),_(3),u()()}if(t&2){let e=r.$implicit,n=C(2);g(),P("checked",n.isAdvancedCategorySelected(e.id)),g(2),be(e.name)}}function gT(t,r){if(t&1){let e=Pe();d(0,"label",170)(1,"input",100),L("change",function(){let i=D(e).$implicit,a=C(5);return N(a.toggleAdvancedSubCategorySelection(i.id))}),u(),d(2,"span"),_(3),u()()}if(t&2){let e=r.$implicit,n=C(5);g(),P("checked",n.isAdvancedSubCategorySelected(e.id)),g(2),be(e.name)}}function _T(t,r){if(t&1&&(Ln(0),d(1,"h4",172),_(2),u(),d(3,"div",151),fe(4,gT,4,2,"label",152),u(),Bn()),t&2){let e=C().$implicit;g(2),be(e.name),g(2),P("ngForOf",e.subCategories)}}function vT(t,r){if(t&1&&(Ln(0),fe(1,_T,5,2,"ng-container",26),Bn()),t&2){let e=r.$implicit,n=C(3);g(),P("ngIf",e.subCategories&&e.subCategories.length>0&&(n.tempSelectedCategories.length===0||n.isAdvancedCategorySelected(e.id)))}}function xT(t,r){if(t&1&&(d(0,"div",150)(1,"h3"),_(2,"Sub-Categor\xEDa"),u(),d(3,"div",171),fe(4,vT,2,1,"ng-container",78),u()()),t&2){let e=C(2);g(4),P("ngForOf",e.availableCategories)}}function bT(t,r){if(t&1){let e=Pe();d(0,"button",154),L("click",function(){let i=D(e).$implicit,a=C(2);return N(a.tempSelectedGender=i.value)}),_(1),u()}if(t&2){let e=r.$implicit,n=C(2);wt("active",n.tempSelectedGender===e.value),g(),be(e.label)}}function wT(t,r){if(t&1){let e=Pe();d(0,"div",106),L("click",function(){D(e);let i=C();return N(i.closeAdvancedFilters())}),d(1,"div",147),L("click",function(i){return D(e),N(i.stopPropagation())}),d(2,"div",108)(3,"h2"),_(4,"Filtros Avanzados"),u(),d(5,"button",109),L("click",function(){D(e);let i=C();return N(i.closeAdvancedFilters())}),_(6,"\xD7"),u()(),d(7,"div",111)(8,"div",148),fe(9,hT,10,2,"div",149),d(10,"div",150)(11,"h3"),_(12,"Tipo"),u(),d(13,"div",151),fe(14,pT,4,2,"label",152),u()(),d(15,"div",150)(16,"h3"),_(17,"Categor\xEDa"),u(),d(18,"div",151),fe(19,mT,4,2,"label",152),u()(),fe(20,xT,5,1,"div",149),d(21,"div",150)(22,"h3"),_(23,"G\xE9nero"),u(),d(24,"div",153)(25,"button",154),L("click",function(){D(e);let i=C();return N(i.tempSelectedGender="")}),_(26,"Todos"),u(),fe(27,bT,2,3,"button",155),u()(),d(28,"div",156)(29,"h3"),_(30,"Datos Disponibles"),u(),d(31,"div",157)(32,"div",158)(33,"span"),_(34,"C\xE9dula:"),u(),d(35,"div",153)(36,"button",154),L("click",function(){D(e);let i=C();return N(i.setAdvancedFilterValue("tempHasCc",null))}),_(37,"Todos"),u(),d(38,"button",154),L("click",function(){D(e);let i=C();return N(i.setAdvancedFilterValue("tempHasCc",!0))}),_(39,"Con"),u(),d(40,"button",154),L("click",function(){D(e);let i=C();return N(i.setAdvancedFilterValue("tempHasCc",!1))}),_(41,"Sin"),u()()(),d(42,"div",158)(43,"span"),_(44,"Tel\xE9fono:"),u(),d(45,"div",153)(46,"button",154),L("click",function(){D(e);let i=C();return N(i.setAdvancedFilterValue("tempHasCellphone",null))}),_(47,"Todos"),u(),d(48,"button",154),L("click",function(){D(e);let i=C();return N(i.setAdvancedFilterValue("tempHasCellphone",!0))}),_(49,"Con"),u(),d(50,"button",154),L("click",function(){D(e);let i=C();return N(i.setAdvancedFilterValue("tempHasCellphone",!1))}),_(51,"Sin"),u()()(),d(52,"div",158)(53,"span"),_(54,"Direcci\xF3n:"),u(),d(55,"div",153)(56,"button",154),L("click",function(){D(e);let i=C();return N(i.setAdvancedFilterValue("tempHasAddress",null))}),_(57,"Todos"),u(),d(58,"button",154),L("click",function(){D(e);let i=C();return N(i.setAdvancedFilterValue("tempHasAddress",!0))}),_(59,"Con"),u(),d(60,"button",154),L("click",function(){D(e);let i=C();return N(i.setAdvancedFilterValue("tempHasAddress",!1))}),_(61,"Sin"),u()()(),d(62,"div",158)(63,"span"),_(64,"Nacimiento:"),u(),d(65,"div",153)(66,"button",154),L("click",function(){D(e);let i=C();return N(i.setAdvancedFilterValue("tempHasBirthdate",null))}),_(67,"Todos"),u(),d(68,"button",154),L("click",function(){D(e);let i=C();return N(i.setAdvancedFilterValue("tempHasBirthdate",!0))}),_(69,"Con"),u(),d(70,"button",154),L("click",function(){D(e);let i=C();return N(i.setAdvancedFilterValue("tempHasBirthdate",!1))}),_(71,"Sin"),u()()()()(),d(72,"div",150)(73,"h3"),_(74,"Rango de Edad"),u(),d(75,"div",159)(76,"input",160),ht("ngModelChange",function(i){D(e);let a=C();return ut(a.tempAgeRange1,i)||(a.tempAgeRange1=i),N(i)}),u(),d(77,"span"),_(78,"-"),u(),d(79,"input",161),ht("ngModelChange",function(i){D(e);let a=C();return ut(a.tempAgeRange2,i)||(a.tempAgeRange2=i),N(i)}),u()()(),d(80,"div",150)(81,"h3"),_(82,"Ubicaci\xF3n"),u(),d(83,"input",162),ht("ngModelChange",function(i){D(e);let a=C();return ut(a.tempLocation,i)||(a.tempLocation=i),N(i)}),u()(),d(84,"div",150)(85,"h3"),_(86,"Estado"),u(),d(87,"label",163)(88,"input",141),ht("ngModelChange",function(i){D(e);let a=C();return ut(a.tempOnlyActive,i)||(a.tempOnlyActive=i),N(i)}),u(),j(89,"span",142),u(),d(90,"span",139),_(91),u()()()(),d(92,"div",125)(93,"button",126),L("click",function(){D(e);let i=C();return i.clearFilters(),N(i.closeAdvancedFilters())}),_(94,"Limpiar Filtros"),u(),d(95,"button",127),L("click",function(){D(e);let i=C();return N(i.applyAdvancedFilters())}),j(96,"i",164),_(97," Aplicar Filtros "),u()()()()}if(t&2){let e=C();g(9),P("ngIf",e.isAdmin),g(5),P("ngForOf",e.availableTypes),g(5),P("ngForOf",e.availableCategories),g(),P("ngIf",e.hasVisibleSubCategories),g(5),wt("active",e.tempSelectedGender===""),g(2),P("ngForOf",e.availableGenders),g(9),wt("active",e.isAdvancedFilterActive("tempHasCc",null)),g(2),wt("active",e.isAdvancedFilterActive("tempHasCc",!0)),g(2),wt("active",e.isAdvancedFilterActive("tempHasCc",!1)),g(6),wt("active",e.isAdvancedFilterActive("tempHasCellphone",null)),g(2),wt("active",e.isAdvancedFilterActive("tempHasCellphone",!0)),g(2),wt("active",e.isAdvancedFilterActive("tempHasCellphone",!1)),g(6),wt("active",e.isAdvancedFilterActive("tempHasAddress",null)),g(2),wt("active",e.isAdvancedFilterActive("tempHasAddress",!0)),g(2),wt("active",e.isAdvancedFilterActive("tempHasAddress",!1)),g(6),wt("active",e.isAdvancedFilterActive("tempHasBirthdate",null)),g(2),wt("active",e.isAdvancedFilterActive("tempHasBirthdate",!0)),g(2),wt("active",e.isAdvancedFilterActive("tempHasBirthdate",!1)),g(6),ft("ngModel",e.tempAgeRange1),g(3),ft("ngModel",e.tempAgeRange2),g(4),ft("ngModel",e.tempLocation),g(5),ft("ngModel",e.tempOnlyActive),g(3),be(e.tempOnlyActive?"Solo Activos":"Todos")}}var yu=class t{constructor(r){this.memberConfigService=r}asistenciaService=Ce(no);integranteService=Ce(Ri);authService=Ce(fr);notificationService=Ce(Kr);serviceEventService=Ce(S1);branchService=Ce(ba);serviceDate=this.getNowForInput();attendanceDate=this.getNowForInput();isManualAttendanceTime=!1;selectedServiceId="";searchQuery="";searchSubject=new Bt;isAdmin=!1;activeEvents=[];selectedActiveEvent=null;pastEvents=[];showPastEvents=!1;noActiveEvent=!1;selectedEventId="";memberNotes=new Map;showNoteModal=!1;noteEditingMember;tempNote="";services=[];members=[];selectedMemberIds=new Set;selectedMember;showModal=!1;showConfigModal=!1;branches=[];selectedBranchId="";tempSelectedBranchId="";currentPage=0;totalPages=0;totalElements=0;isLoading=!1;showAdvancedFiltersModal=!1;availableTypes=[];availableCategories=[];selectedTypes=[];selectedCategories=[];selectedSubCategories=[];selectedGender="";availableGenders=[{value:"HOMBRE",label:"Hombre"},{value:"MUJER",label:"Mujer"}];hasCc=null;hasCellphone=null;hasAddress=null;hasBirthdate=null;ageFilterRange1=null;ageFilterRange2=null;filterLocation="";tempSelectedTypes=[];tempSelectedCategories=[];tempSelectedSubCategories=[];tempSelectedGender="";tempHasCc=null;tempHasCellphone=null;tempHasAddress=null;tempHasBirthdate=null;tempAgeRange1=null;tempAgeRange2=null;tempLocation="";tempOnlyActive=!0;ngOnInit(){this.checkPermissions(),this.setupSearchDebounce(),this.loadServices(),this.loadMemberConfigs(),this.loadMembers(),this.loadMembers(),this.loadActiveEvent(),this.isAdmin&&this.loadBranches()}loadBranches(){this.branchService.findAll().subscribe(r=>this.branches=r)}checkPermissions(){this.isAdmin=this.authService.can("ADMINISTRATOR")}loadActiveEvent(){this.serviceEventService.getActiveEvent().subscribe({next:r=>{this.activeEvents=r||[],this.activeEvents.length===0?(this.noActiveEvent=!0,this.selectedActiveEvent=null):this.activeEvents.length===1?(this.noActiveEvent=!1,this.selectActiveEvent(this.activeEvents[0])):(this.noActiveEvent=!1,this.selectedActiveEvent=null)},error:r=>{console.error("Error loading active events",r),this.noActiveEvent=!0,this.activeEvents=[],this.selectedActiveEvent=null}})}selectActiveEvent(r){this.selectedActiveEvent=r,this.selectedEventId=r.id,this.selectServiceFromEvent(r),this.showPastEvents&&(this.showPastEvents=!1)}clearActiveEventSelection(){this.selectedActiveEvent=null,this.selectedEventId="",this.selectedServiceId=""}loadAllEvents(){this.serviceEventService.findAll().subscribe({next:r=>{this.pastEvents=r},error:r=>{console.error("Error loading events",r),this.notificationService.error("Error al cargar eventos pasados")}})}togglePastEvents(){this.showPastEvents=!this.showPastEvents,this.showPastEvents?(this.selectedEventId="",this.selectedActiveEvent=null,this.noActiveEvent=!1,this.formReset()):this.loadActiveEvent()}onEventSelect(r){this.selectedEventId=r;let e=this.pastEvents.find(n=>n.id===r);e&&this.selectServiceFromEvent(e)}selectServiceFromEvent(r){let e=this.services.find(n=>n.name===r.serviceName);if(e&&(this.selectedServiceId=e.id),r.startDateTime){let n=r.startDateTime.substring(0,10),i=r.startDateTime.substring(11,16);this.serviceDate=`${n}T${i}`,new Date(r.endDateTime)<new Date?this.attendanceDate=`${n}T${i}`:this.attendanceDate=this.getNowForInput()}}formReset(){this.selectedServiceId="",this.selectedEventId=""}loadMemberConfigs(){this.memberConfigService.getTypes().subscribe(r=>this.availableTypes=r),this.memberConfigService.getCategories().subscribe(r=>this.availableCategories=r)}loadServices(){this.asistenciaService.getServices(!0).subscribe(r=>{this.services=r,this.services.length>0&&this.selectedServiceId})}getSelectedServiceName(){if(!this.selectedServiceId)return"Seleccionar Servicio";let r=this.services.find(e=>e.id===this.selectedServiceId);return r?r.name:"Servicio no encontrado"}get isEventFinished(){return this.selectedActiveEvent?new Date(this.selectedActiveEvent.endDateTime)<new Date:!1}getMemberAge(r){if(!r.birthdate)return"---";try{let e=new Date(r.birthdate),n=Date.now()-e.getTime(),i=new Date(n);return Math.abs(i.getUTCFullYear()-1970)}catch{return"---"}}formatAddress(r){return r.address||"---"}loadMembers(){this.isLoading=!0;let r={onlyActive:!0,query:this.searchQuery.trim()||void 0,memberType:this.selectedTypes.length>0?this.selectedTypes:void 0,memberCategory:this.selectedCategories.length>0?this.selectedCategories:void 0,subCategory:this.selectedSubCategories.length>0?this.selectedSubCategories:void 0,hasCc:this.hasCc,hasCellphone:this.hasCellphone,hasAddress:this.hasAddress,hasBirthdate:this.hasBirthdate,ageFilterRange1:this.ageFilterRange1,ageFilterRange2:this.ageFilterRange2,location:this.filterLocation||void 0,gender:this.selectedGender||void 0,branchId:this.selectedBranchId||void 0};this.showAdvancedFiltersModal?r.onlyActive=this.tempOnlyActive:r.onlyActive=this.tempOnlyActive,this.integranteService.searchMembers(r,this.currentPage).subscribe({next:e=>{this.members=e.data,this.totalPages=e.totalPages,this.totalElements=e.totalElements,this.isLoading=!1,this.scrollToTop()},error:()=>this.isLoading=!1})}openAdvancedFilters(){this.tempSelectedTypes=[...this.selectedTypes],this.tempSelectedCategories=[...this.selectedCategories],this.tempSelectedSubCategories=[...this.selectedSubCategories],this.tempSelectedGender=this.selectedGender,this.tempHasCc=this.hasCc,this.tempHasCellphone=this.hasCellphone,this.tempHasAddress=this.hasAddress,this.tempHasBirthdate=this.hasBirthdate,this.tempAgeRange1=this.ageFilterRange1,this.tempAgeRange2=this.ageFilterRange2,this.tempAgeRange2=this.ageFilterRange2,this.tempLocation=this.filterLocation,this.tempSelectedBranchId=this.selectedBranchId,this.showAdvancedFiltersModal=!0}closeAdvancedFilters(){this.showAdvancedFiltersModal=!1}applyAdvancedFilters(){this.selectedTypes=[...this.tempSelectedTypes],this.selectedCategories=[...this.tempSelectedCategories],this.selectedSubCategories=[...this.tempSelectedSubCategories],this.selectedGender=this.tempSelectedGender,this.hasCc=this.tempHasCc,this.hasCellphone=this.tempHasCellphone,this.hasAddress=this.tempHasAddress,this.hasBirthdate=this.tempHasBirthdate,this.ageFilterRange1=this.tempAgeRange1,this.ageFilterRange2=this.tempAgeRange2,this.filterLocation=this.tempLocation,this.selectedBranchId=this.tempSelectedBranchId,this.currentPage=0,this.loadMembers(),this.closeAdvancedFilters()}clearFilters(){this.selectedTypes=[],this.selectedCategories=[],this.selectedSubCategories=[],this.selectedGender="",this.hasCc=null,this.hasCellphone=null,this.hasAddress=null,this.hasBirthdate=null,this.ageFilterRange1=null,this.ageFilterRange2=null,this.filterLocation="",this.tempSelectedTypes=[],this.tempSelectedCategories=[],this.tempSelectedSubCategories=[],this.tempSelectedGender="",this.tempHasCc=null,this.tempHasCellphone=null,this.tempHasAddress=null,this.tempHasBirthdate=null,this.tempAgeRange1=null,this.tempAgeRange2=null,this.tempLocation="",this.tempOnlyActive=!0,this.selectedBranchId="",this.tempSelectedBranchId="",this.currentPage=0,this.loadMembers()}toggleAdvancedTypeSelection(r){let e=this.tempSelectedTypes.indexOf(r);e>-1?this.tempSelectedTypes.splice(e,1):this.tempSelectedTypes.push(r)}toggleAdvancedCategorySelection(r){let e=this.tempSelectedCategories.indexOf(r);e>-1?this.tempSelectedCategories.splice(e,1):this.tempSelectedCategories.push(r)}toggleAdvancedSubCategorySelection(r){let e=this.tempSelectedSubCategories.indexOf(r);e>-1?this.tempSelectedSubCategories.splice(e,1):this.tempSelectedSubCategories.push(r)}setAdvancedFilterValue(r,e){this[r]=e}isAdvancedTypeSelected(r){return this.tempSelectedTypes.includes(r)}isAdvancedCategorySelected(r){return this.tempSelectedCategories.includes(r)}isAdvancedSubCategorySelected(r){return this.tempSelectedSubCategories.includes(r)}isAdvancedFilterActive(r,e){return this[r]===e}get hasVisibleSubCategories(){return this.tempSelectedCategories.length>0?this.availableCategories.filter(r=>this.tempSelectedCategories.includes(r.id)).some(r=>r.subCategories&&r.subCategories.length>0):this.availableCategories.some(r=>r.subCategories&&r.subCategories.length>0)}setupSearchDebounce(){this.searchSubject.pipe(Ki(1e3),Oi()).subscribe(r=>{this.searchQuery=r,this.onSearch()})}onSearchInput(){this.searchSubject.next(this.searchQuery)}onSearch(){this.currentPage=0,this.loadMembers()}toggleSelection(r){this.selectedMemberIds.has(r)?this.selectedMemberIds.delete(r):this.selectedMemberIds.add(r)}isSelected(r){return this.selectedMemberIds.has(r)}viewMember(r){this.selectedMember=r,this.showModal=!0}closeModal(){this.showModal=!1,this.selectedMember=void 0}save(){if(!this.selectedEventId){this.notificationService.warning("Por favor seleccione un evento");return}if(this.selectedMemberIds.size===0){this.notificationService.warning("Por favor seleccione al menos un integrante");return}if(!this.isManualAttendanceTime)if(this.selectedActiveEvent&&new Date(this.selectedActiveEvent.endDateTime)<new Date){let i=this.selectedActiveEvent.startDateTime;this.attendanceDate=i.length>16?i.substring(0,16):i}else this.attendanceDate=this.getNowForInput();let r=this.serviceDate.includes(":")&&this.serviceDate.split(":").length===2?`${this.serviceDate}:00`:this.serviceDate,e=this.attendanceDate.includes(":")&&this.attendanceDate.split(":").length===2?`${this.attendanceDate}:00`:this.attendanceDate,n=Array.from(this.selectedMemberIds).map(i=>({serviceEventId:this.selectedEventId,memberId:i,serviceDate:r,attendanceDate:e,note:this.memberNotes.get(i)||void 0}));this.asistenciaService.saveAttendances(n).subscribe({next:()=>{this.isLoading=!0,this.selectedMemberIds.clear(),this.memberNotes.clear(),this.notificationService.success("Asistencia guardada exitosamente"),this.loadMembers()},error:i=>{console.error("Error saving attendance:",i)}})}getBadgeClass(r){switch(typeof r=="string"?r:r?.name){case"DAMAS":return"badge-damas";case"CABALLEROS":return"badge-caballeros";case"JOVENES":return"badge-jovenes";case"NI\xD1OS":return"badge-ninos";default:return""}}formatType(r){return r?typeof r=="string"?r.replace(/_/g," "):r.name||"":""}formatCategory(r){return r?typeof r=="string"?r:r.name||"":""}nextPage(){this.currentPage<this.totalPages-1&&(this.currentPage++,this.loadMembers())}prevPage(){this.currentPage>0&&(this.currentPage--,this.loadMembers())}getNowForInput(){let r=new Date,e=r.getFullYear(),n=String(r.getMonth()+1).padStart(2,"0"),i=String(r.getDate()).padStart(2,"0"),a=String(r.getHours()).padStart(2,"0"),o=String(r.getMinutes()).padStart(2,"0");return`${e}-${n}-${i}T${a}:${o}`}openNoteModal(r){this.noteEditingMember=r,this.tempNote=this.memberNotes.get(r.id)||"",this.showNoteModal=!0}saveMemberNote(){this.noteEditingMember&&(this.tempNote.trim()?this.memberNotes.set(this.noteEditingMember.id,this.tempNote):this.memberNotes.delete(this.noteEditingMember.id)),this.closeNoteModal()}closeNoteModal(){this.showNoteModal=!1,this.noteEditingMember=void 0,this.tempNote=""}hasNote(r){return this.memberNotes.has(r)}scrollToTop(){[".page-container",".table-container",".full-table",".list-container"].forEach(e=>{let n=document.querySelector(e);n&&n.scrollTo({top:0,behavior:"smooth"})}),window.scrollTo({top:0,behavior:"smooth"})}static \u0275fac=function(e){return new(e||t)(h0(wa))};static \u0275cmp=ir({type:t,selectors:[["app-asistencia"]],decls:59,vars:27,consts:[[1,"asistencia-container"],[1,"card","premium-card"],[1,"header-layout-v2"],["class","active-events-list fade-in",4,"ngIf"],["class","event-banner active-event fade-in",4,"ngIf"],["class","event-banner no-event fade-in",4,"ngIf"],["class","past-events-panel fade-in",4,"ngIf"],[1,"action-bar-v2"],[1,"search-container"],[1,"fa-solid","fa-magnifying-glass","search-icon"],["type","text","placeholder","Buscar por nombre, documento o celular...",1,"search-input-modern",3,"ngModelChange","keyup.enter","ngModel","disabled"],[1,"time-control-group"],["title","Modo Manual",1,"toggle-switch-wrapper"],[1,"switch-modern"],["type","checkbox",3,"ngModelChange","ngModel","disabled"],[1,"slider-modern"],[1,"toggle-label-modern"],["type","datetime-local","class","time-input-modern fade-in",3,"ngModel","ngModelChange",4,"ngIf"],[1,"btn-filter-modern",3,"click","disabled"],[1,"fa-solid","fa-sliders"],[1,"desktop-only"],["class","filter-dot",4,"ngIf"],[1,"table-container"],[1,"premium-table"],[1,"mobile-hide"],[1,"text-center"],[4,"ngIf"],[1,"asistencia-footer"],[1,"pagination-mini"],[1,"pagination-buttons"],[1,"btn-icon-sm",3,"click","disabled"],[1,"fa-solid","fa-chevron-left"],[1,"fa-solid","fa-chevron-right"],[1,"btn","btn-save-attendance",3,"click","disabled"],["class","modal-overlay",3,"click",4,"ngIf"],[1,"active-events-list","fade-in"],[1,"section-title"],[1,"events-grid"],["class","event-card-selection",3,"click",4,"ngFor","ngForOf"],[1,"event-card-selection",3,"click"],[1,"event-icon"],[1,"fa-solid","fa-wifi"],[1,"event-info"],[1,"fa-regular","fa-clock"],[1,"fa-solid","fa-location-dot"],[1,"event-action"],[1,"fa-solid","fa-map-pin"],[1,"event-banner","active-event","fade-in"],[1,"banner-icon"],[1,"icon-circle"],[1,"banner-content"],[1,"banner-label"],[1,"banner-title"],[1,"banner-meta"],[1,"meta-item"],["class","meta-item",4,"ngIf"],[1,"banner-actions"],["class","btn-text-action",3,"click",4,"ngIf"],[1,"btn-text-action",3,"click"],[1,"fa-solid","fa-arrow-right-arrow-left"],[1,"fa-solid","fa-clock-rotate-left"],[1,"event-banner","no-event","fade-in"],[1,"icon-circle","warning"],[1,"fa-solid","fa-moon"],[1,"banner-subtitle"],["class","banner-actions",4,"ngIf"],[1,"btn-primary-soft",3,"click"],[1,"past-events-panel","fade-in"],[1,"panel-header"],[1,"close-panel-btn",3,"click"],[1,"fa-solid","fa-xmark"],[1,"panel-body",2,"padding","0"],[3,"eventSelected","isAdmin","isSelectionMode"],["type","datetime-local",1,"time-input-modern","fade-in",3,"ngModelChange","ngModel"],[1,"filter-dot"],["colspan","6",2,"padding","0","border","none"],[1,"loading-container"],[1,"loading-spinner"],[4,"ngFor","ngForOf"],[1,"user-info-cell"],[1,"avatar-cell"],["alt","Avatar",3,"src"],[1,"user-details"],[1,"user-fullname"],["class","user-age-small",4,"ngIf"],[1,"mobile-category-info","mobile-only"],[1,"badge-mini"],["class","badge-mini-outline",3,"border-color","color",4,"ngIf"],[1,"mobile-hide","text-sm","text-muted",2,"max-width","200px","white-space","normal"],[1,"category-cell",2,"display","flex","flex-direction","column","gap","4px","align-items","flex-start"],[1,"badge",3,"ngClass"],["class","badge badge-outline",3,"border-color","color",4,"ngIf"],[1,"types-cell"],[1,"badge","badge-outline"],[1,"actions-mini","justify-center"],["title","Ver detalles",1,"action-btn-sm","view",3,"click"],[1,"fa-solid","fa-eye"],[1,"action-btn-sm","edit",3,"click","title"],[1,"fa-solid",3,"ngClass"],[1,"checkbox-container-mini"],["type","checkbox",3,"change","checked"],[1,"checkmark"],[1,"user-age-small"],[1,"badge-mini-outline"],["colspan","7",2,"text-align","center","padding","2rem","color","var(--text-muted)"],[1,"fa-solid","fa-users-slash",2,"font-size","2rem","display","block","margin-bottom","0.5rem","opacity","0.4"],[1,"modal-overlay",3,"click"],[1,"modal-content",3,"click"],[1,"modal-header"],[1,"close-btn",3,"click"],["class","modal-body",4,"ngIf"],[1,"modal-body"],[1,"profile-header"],["alt","Avatar Grande",3,"src"],[1,"profile-title"],[2,"display","flex","gap","0.5rem","flex-wrap","wrap","margin-top","0.5rem"],[1,"badge","badge-sm",3,"ngClass"],[1,"badge","badge-sm","badge-outline"],["class","badge badge-sm badge-outline",3,"border-color","color",4,"ngIf"],[1,"details-grid"],[1,"detail-item"],[1,"detail-item","full"],[1,"modal-content","small-modal",3,"click"],[1,"form-group"],["rows","4","placeholder","Ej: Devocional, escuela para padres, etc...",1,"premium-input",3,"ngModelChange","ngModel"],[1,"modal-footer"],[1,"btn","btn-muted",3,"click"],[1,"btn","btn-primary",3,"click"],[1,"modal-content","filter-modal",3,"click"],[1,"filter-form-stack"],[1,"input-with-label"],[1,"input-icon-wrapper"],[1,"fa-solid","fa-church"],[1,"premium-input",3,"ngModelChange","ngModel"],[3,"value",4,"ngFor","ngForOf"],[1,"fa-solid","fa-calendar-alt"],["type","datetime-local",1,"premium-input",3,"ngModelChange","ngModel"],[1,"label-with-toggle"],["title","Modo Autom\xE1tico/Manual",1,"toggle-wrapper"],[1,"toggle-label"],[1,"switch-xs"],["type","checkbox",3,"ngModelChange","ngModel"],[1,"slider","round"],[1,"fa-solid","fa-clock"],["type","datetime-local",1,"premium-input",3,"ngModelChange","ngModel","disabled"],[1,"btn","btn-primary","full-width",3,"click"],[3,"value"],[1,"modal-content","filters-modal",3,"click"],[1,"filters-grid"],["class","filter-section",4,"ngIf"],[1,"filter-section"],[1,"checkbox-group"],["class","checkbox-label",4,"ngFor","ngForOf"],[1,"trip-switch"],["type","button",3,"click"],["type","button",3,"active","click",4,"ngFor","ngForOf"],[1,"filter-section","full-width"],[1,"data-filters-grid"],[1,"data-filter-item"],[1,"age-range-inputs"],["type","number","placeholder","M\xEDn","min","0","max","120",3,"ngModelChange","ngModel"],["type","number","placeholder","M\xE1x","min","0","max","120",3,"ngModelChange","ngModel"],["type","text","placeholder","Barrio, ciudad, direcci\xF3n...",1,"full-width-input",3,"ngModelChange","ngModel"],[1,"status-switch"],[1,"fa-solid","fa-filter"],[1,"soft-input-wrapper","full-width"],[1,"fa-solid","fa-building","soft-input-icon"],[1,"soft-input",3,"ngModelChange","ngModel"],["value",""],[1,"fa-solid","fa-chevron-down","select-arrow"],[1,"checkbox-label"],[1,"filters-grid-nested"],[1,"nested-category-title"]],template:function(e,n){e&1&&(d(0,"div",0)(1,"div",1)(2,"div",2),fe(3,zA,5,1,"div",3)(4,qA,21,14,"div",4)(5,YA,11,3,"div",5)(6,KA,10,2,"div",6),d(7,"div",7)(8,"div",8),j(9,"i",9),d(10,"input",10),ht("ngModelChange",function(a){return ut(n.searchQuery,a)||(n.searchQuery=a),a}),L("ngModelChange",function(){return n.onSearchInput()})("keyup.enter",function(){return n.onSearch()}),u()(),d(11,"div",11)(12,"div",12)(13,"label",13)(14,"input",14),ht("ngModelChange",function(a){return ut(n.isManualAttendanceTime,a)||(n.isManualAttendanceTime=a),a}),u(),j(15,"span",15),u(),d(16,"span",16),_(17),u()(),fe(18,ZA,1,1,"input",17),u(),d(19,"button",18),L("click",function(){return n.openAdvancedFilters()}),j(20,"i",19),d(21,"span",20),_(22,"Filtros"),u(),fe(23,JA,1,0,"span",21),u()()(),d(24,"div",22)(25,"table",23)(26,"thead")(27,"tr")(28,"th"),_(29,"NOMBRE COMPLETO"),u(),d(30,"th",24),_(31,"TEL\xC9FONO"),u(),d(32,"th",24),_(33,"DIRECCI\xD3N"),u(),d(34,"th",24),_(35,"CATEGOR\xCDA"),u(),d(36,"th",24),_(37,"TIPO"),u(),d(38,"th",25),_(39,"ACCIONES"),u()()(),d(40,"tbody"),fe(41,QA,6,0,"tr",26)(42,iT,2,1,"ng-container",26)(43,aT,4,0,"tr",26),u()()(),d(44,"div",27)(45,"div",28)(46,"span"),_(47),u(),d(48,"div",29)(49,"button",30),L("click",function(){return n.prevPage()}),j(50,"i",31),u(),d(51,"button",30),L("click",function(){return n.nextPage()}),j(52,"i",32),u()()(),d(53,"button",33),L("click",function(){return n.save()}),_(54," Guardar Asistencia "),u()()()(),fe(55,lT,8,1,"div",34)(56,cT,17,2,"div",34)(57,fT,38,9,"div",34)(58,wT,98,36,"div",34)),e&2&&(g(3),P("ngIf",n.activeEvents.length>1&&!n.selectedActiveEvent&&!n.showPastEvents),g(),P("ngIf",n.selectedActiveEvent&&!n.showPastEvents),g(),P("ngIf",n.noActiveEvent&&!n.showPastEvents),g(),P("ngIf",n.showPastEvents),g(),wt("disabled",!n.selectedActiveEvent&&!n.selectedEventId),g(3),ft("ngModel",n.searchQuery),P("disabled",!n.selectedActiveEvent&&!n.selectedEventId),g(4),ft("ngModel",n.isManualAttendanceTime),P("disabled",!n.selectedActiveEvent&&!n.selectedEventId),g(3),be(n.isManualAttendanceTime?"Manual":"Auto"),g(),P("ngIf",n.isManualAttendanceTime),g(),P("disabled",!n.selectedActiveEvent&&!n.selectedEventId),g(4),P("ngIf",n.selectedTypes.length+n.selectedCategories.length+n.selectedSubCategories.length>0),g(18),P("ngIf",n.isLoading),g(),P("ngIf",!n.isLoading),g(),P("ngIf",n.members.length===0&&!n.isLoading),g(4),_a("P\xE1gina ",n.currentPage+1," de ",n.totalPages||1," (Total: ",n.totalElements,")"),g(2),P("disabled",n.currentPage===0),g(2),P("disabled",n.currentPage>=n.totalPages-1),g(2),P("disabled",n.isLoading),g(2),P("ngIf",n.showModal),g(),P("ngIf",n.showNoteModal),g(),P("ngIf",n.showConfigModal),g(),P("ngIf",n.showAdvancedFiltersModal))},dependencies:[gr,Tr,rn,mr,on,Fi,Di,nn,Gl,ys,Ii,an,$l,tf,Vn,Kl,Ji],styles:['[_nghost-%COMP%]{display:block;height:100%;width:100%;min-height:0}.btn-fixed-services[_ngcontent-%COMP%]{position:fixed;top:5.5rem;right:2rem;z-index:1000;background:var(--primary);color:#fff;border:none;padding:.75rem 1.25rem;border-radius:9999px;font-weight:700;display:flex;align-items:center;gap:.75rem;box-shadow:0 10px 15px -3px rgba(var(--primary-rgb),.3);cursor:pointer;transition:all .3s cubic-bezier(.4,0,.2,1);font-size:.85rem}.btn-fixed-services[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 20px 25px -5px rgba(var(--primary-rgb),.4);background:var(--primary-dark)}.btn-fixed-services[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:1rem;animation:_ngcontent-%COMP%_gear-spin 8s linear infinite}@keyframes _ngcontent-%COMP%_gear-spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.asistencia-container[_ngcontent-%COMP%]{height:100%;width:100%;display:flex;flex-direction:column;min-height:0;box-sizing:border-box;background:var(--bg-main)}.premium-card[_ngcontent-%COMP%]{background:var(--bg-card);border-radius:12px;box-shadow:var(--shadow-sm);padding:1.25rem;height:100%;display:flex;flex-direction:column;min-height:0;overflow:hidden}.asistencia-header[_ngcontent-%COMP%]{margin-bottom:1.25rem;width:100%}.asistencia-header-actions[_ngcontent-%COMP%]{display:flex;justify-content:flex-start;align-items:center;margin-bottom:.75rem;padding-bottom:.75rem;border-bottom:1px solid var(--border-color);flex-wrap:wrap;gap:1rem}.active-filters-row[_ngcontent-%COMP%]{margin-bottom:1.25rem;padding-bottom:1rem;border-bottom:1px dashed var(--border-color);width:100%}.active-filters-chips[_ngcontent-%COMP%]{display:flex;gap:.75rem;flex-wrap:wrap}.filter-chip[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;padding:.4rem .8rem;background:var(--primary);color:#fff;border-radius:9999px;font-size:.75rem;font-weight:700}.filter-chip[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background:none;border:none;color:#fff;cursor:pointer;font-size:1.1rem;display:flex;align-items:center;padding:0;line-height:1}.filter-group[_ngcontent-%COMP%]{display:flex;gap:1rem;align-items:flex-end;flex-wrap:wrap;width:100%}.registration-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(180px,1fr));gap:.75rem;align-items:flex-end;width:100%}.input-with-label[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.35rem}.input-with-label[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:.65rem;font-weight:700;color:var(--text-muted);text-transform:uppercase}.input-icon-wrapper[_ngcontent-%COMP%]{position:relative;display:flex;align-items:center}.input-icon-wrapper[_ngcontent-%COMP%] > i[_ngcontent-%COMP%]{position:absolute;left:.85rem;color:var(--primary);font-size:.9rem;pointer-events:none;z-index:5}.search-icon-btn[_ngcontent-%COMP%]{position:absolute;left:.65rem;top:50%;transform:translateY(-50%);width:2.25rem;height:100%;color:var(--primary);font-size:.9rem;background:transparent;border:none;cursor:pointer;display:flex;align-items:center;justify-content:center;z-index:10;padding:0;transition:all .2s ease}.search-icon-btn[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{position:static;pointer-events:none}.premium-input[_ngcontent-%COMP%]{padding:.5rem 1rem .5rem 2.5rem;border:1.5px solid var(--border-color);border-radius:10px;font-size:.8rem;background:var(--bg-input);color:var(--text-main);transition:all .3s ease}.premium-input[_ngcontent-%COMP%]:focus{border-color:var(--primary);box-shadow:0 0 0 4px rgba(var(--primary-rgb),.1);outline:none;background:var(--bg-card)}.search-wrapper[_ngcontent-%COMP%], .search-wrapper[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%}.search-group[_ngcontent-%COMP%]{min-width:250px}.table-container[_ngcontent-%COMP%]{flex:1;overflow:auto;border:1px solid var(--border-color);border-radius:8px;background:var(--bg-card);min-height:0}.premium-table[_ngcontent-%COMP%]{width:100%;border-collapse:separate;border-spacing:0}.premium-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{position:sticky;top:0;background:var(--bg-input);padding:.6rem .75rem;font-size:.65rem;font-weight:700;color:var(--text-muted);text-align:left;border-bottom:2px solid var(--border-color);text-transform:uppercase;z-index:10;text-align:center}.premium-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:.4rem .75rem;border-bottom:1px solid var(--border-color);vertical-align:middle;font-size:.8rem;color:var(--text-main);text-align:left}.user-info-cell[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.75rem}.avatar-cell[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:32px;height:32px;border-radius:50%;object-fit:cover;border:1px solid var(--bg-card);box-shadow:0 2px 4px -1px #0000001a}.user-fullname[_ngcontent-%COMP%]{font-weight:700;color:var(--text-main);font-size:.8rem}.actions-mini[_ngcontent-%COMP%]{display:flex;gap:.5rem;align-items:center}.label-with-toggle[_ngcontent-%COMP%]{display:flex;justify-content:left;align-items:center;width:100%;gap:.5rem}.toggle-wrapper[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem}.toggle-label[_ngcontent-%COMP%]{font-size:.65rem;font-weight:600;color:var(--primary)}.switch-xs[_ngcontent-%COMP%]{position:relative;display:inline-block;width:28px;height:16px}.switch-xs[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{opacity:0;width:0;height:0}.switch-xs[_ngcontent-%COMP%]   .slider[_ngcontent-%COMP%]{position:absolute;cursor:pointer;inset:0;background-color:var(--border-color);transition:.4s;border-radius:34px}.switch-xs[_ngcontent-%COMP%]   .slider[_ngcontent-%COMP%]:before{position:absolute;content:"";height:12px;width:12px;left:2px;bottom:2px;background-color:#fff;transition:.4s;border-radius:50%}.switch-xs[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:checked + .slider[_ngcontent-%COMP%]{background-color:var(--primary)}.switch-xs[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:checked + .slider[_ngcontent-%COMP%]:before{transform:translate(12px)}.input-icon-wrapper.disabled[_ngcontent-%COMP%]{opacity:.7;pointer-events:none;background:var(--bg-input);border-radius:10px}.action-btn-sm[_ngcontent-%COMP%]:hover{background:var(--bg-input);color:var(--primary)}.action-btn-sm.view[_ngcontent-%COMP%]:hover{color:var(--primary)}.action-btn-sm.edit[_ngcontent-%COMP%]:hover{color:var(--primary);background:var(--primary-bg)}.action-btn-sm.delete[_ngcontent-%COMP%]:hover{color:var(--danger);background:var(--danger-bg)}.text-center[_ngcontent-%COMP%]{text-align:center}.justify-center[_ngcontent-%COMP%]{justify-content:center}.flex-1[_ngcontent-%COMP%]{flex:1}.checkbox-container-mini[_ngcontent-%COMP%]{display:block;position:relative;width:20px;height:20px;cursor:pointer;-webkit-user-select:none;user-select:none}.checkbox-container-mini[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{position:absolute;opacity:0;cursor:pointer;height:0;width:0}.checkbox-container-mini[_ngcontent-%COMP%]   .checkmark[_ngcontent-%COMP%]{position:absolute;top:0;left:0;height:20px;width:20px;background-color:var(--bg-input);border:2px solid var(--border-color);border-radius:6px;transition:all .2s cubic-bezier(.4,0,.2,1)}.checkbox-container-mini[_ngcontent-%COMP%]:hover   input[_ngcontent-%COMP%] ~ .checkmark[_ngcontent-%COMP%]{border-color:var(--primary);background-color:var(--bg-card)}.checkbox-container-mini[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:checked ~ .checkmark[_ngcontent-%COMP%]{background-color:var(--primary);border-color:var(--primary)}.checkbox-container-mini[_ngcontent-%COMP%]   .checkmark[_ngcontent-%COMP%]:after{content:"";position:absolute;display:none;left:6px;top:2px;width:5px;height:10px;border:solid var(--white);border-width:0 2px 2px 0;transform:rotate(45deg)}.checkbox-container-mini[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:checked ~ .checkmark[_ngcontent-%COMP%]:after{display:block}.checkbox-container[_ngcontent-%COMP%]{display:block;position:relative;padding-left:28px;cursor:pointer;font-size:22px;-webkit-user-select:none;user-select:none}.checkbox-container[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{position:absolute;opacity:0;cursor:pointer;height:0;width:0}.checkmark[_ngcontent-%COMP%]{position:absolute;top:-12px;left:0;height:24px;width:24px;background-color:var(--bg-input);border:2px solid var(--border-color);border-radius:6px;transition:all .2s cubic-bezier(.4,0,.2,1)}.checkbox-container[_ngcontent-%COMP%]:hover   input[_ngcontent-%COMP%] ~ .checkmark[_ngcontent-%COMP%]{border-color:var(--primary);background-color:var(--bg-card)}.checkbox-container[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:checked ~ .checkmark[_ngcontent-%COMP%]{background-color:var(--primary);border-color:var(--primary);box-shadow:0 4px 6px -1px rgba(var(--primary-rgb),.3)}.checkmark[_ngcontent-%COMP%]:after{content:"";position:absolute;display:none}.checkbox-container[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:checked ~ .checkmark[_ngcontent-%COMP%]:after{display:block}.checkbox-container[_ngcontent-%COMP%]   .checkmark[_ngcontent-%COMP%]:after{left:7px;top:3px;width:6px;height:12px;border:solid var(--white);border-width:0 2.5px 2.5px 0;transform:rotate(45deg)}.asistencia-footer[_ngcontent-%COMP%]{border-top:1px solid var(--border-color);padding:.75rem 1rem;display:flex;justify-content:space-between;align-items:center;background:var(--bg-card);border-bottom-left-radius:12px;border-bottom-right-radius:12px;min-height:52px;flex-shrink:0;margin:0 -1.25rem -1.25rem;width:calc(100% + 2rem);box-sizing:border-box}.pagination-mini[_ngcontent-%COMP%]{display:flex;align-items:center;gap:1rem;font-size:.85rem;color:var(--text-muted);font-weight:500}.btn-save-attendance[_ngcontent-%COMP%]{background:var(--primary);color:#fff;padding:.6rem 1.75rem;border-radius:10px;font-weight:700;border:none;box-shadow:0 4px 6px -1px rgba(var(--primary-rgb),.3);cursor:pointer;transition:all .3s;font-size:.85rem}.btn-save-attendance[_ngcontent-%COMP%]:hover:not(:disabled){transform:translateY(-2px);box-shadow:0 20px 25px -5px rgba(var(--primary-rgb),.4)}.btn-save-attendance[_ngcontent-%COMP%]:active{transform:translateY(0)}.btn-save-attendance[_ngcontent-%COMP%]:disabled{opacity:.6;cursor:not-allowed}.modal-overlay[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;background-color:#0006;display:flex;align-items:center;justify-content:center;z-index:2000;-webkit-backdrop-filter:blur(4px);backdrop-filter:blur(4px)}.modal-content[_ngcontent-%COMP%]{background:var(--bg-card);width:90%;max-width:550px;max-height:85vh;border-radius:16px;box-shadow:var(--shadow-md);overflow:hidden;display:flex;flex-direction:column}.modal-header[_ngcontent-%COMP%]{padding:1.25rem 1.5rem;border-bottom:1px solid var(--border-color);display:flex;justify-content:space-between;align-items:center;background:var(--bg-input)}.modal-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:1.15rem;font-weight:700;color:var(--text-main)}.close-btn[_ngcontent-%COMP%]{background:var(--border-color);border:none;width:32px;height:32px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:1.25rem;cursor:pointer;color:var(--text-muted)}.modal-body[_ngcontent-%COMP%]{padding:1.5rem;overflow-y:auto}.filter-modal[_ngcontent-%COMP%]{max-width:600px!important}.filter-form-layout[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1.5rem}.date-range-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:1.25rem}@media(max-width:600px){.date-range-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}}.profile-header[_ngcontent-%COMP%]{display:flex;align-items:center;gap:1.5rem;margin-bottom:2rem;padding-bottom:1.25rem;border-bottom:1px dashed var(--border-color)}.profile-header[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:80px;height:80px;border-radius:12px;object-fit:cover;box-shadow:0 4px 6px -1px #0000001a}.profile-title[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin-bottom:.25rem;font-size:1.25rem;font-weight:800}.details-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:1.25rem}.detail-item[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.25rem}.detail-item.full[_ngcontent-%COMP%]{grid-column:span 2}.detail-item[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:.7rem;font-weight:700;color:var(--text-muted);text-transform:uppercase}.detail-item[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:.95rem;font-weight:600;color:var(--text-main)}.text-success[_ngcontent-%COMP%]{color:#10b981}.text-danger[_ngcontent-%COMP%]{color:#ef4444}.invalid-details-section[_ngcontent-%COMP%]{margin-top:2rem;padding-top:1.5rem;border-top:2px dashed var(--danger-bg);background:var(--danger-bg);padding:1.5rem;border-radius:12px}.invalid-details-section[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 1.25rem;font-size:1.1rem;font-weight:700;display:flex;align-items:center;gap:.5rem}.invalid-details-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr;gap:1rem}.invalid-details-grid[_ngcontent-%COMP%]   .detail-item[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.25rem}.reason-box[_ngcontent-%COMP%]{background:var(--bg-card);padding:.75rem 1rem;border-radius:8px;border:1px solid var(--danger-bg);margin:0;font-size:.9rem;color:var(--text-main);line-height:1.5}@media(min-width:768px){.invalid-details-grid[_ngcontent-%COMP%]{grid-template-columns:1fr 1fr}.invalid-details-grid[_ngcontent-%COMP%]   .detail-item[_ngcontent-%COMP%]:first-child{grid-column:span 2}}.services-modal[_ngcontent-%COMP%]{max-width:800px}.service-quick-form[_ngcontent-%COMP%]{background:var(--bg-input);padding:1.25rem;border-radius:12px;border:1px dashed var(--border-color);margin-bottom:1.5rem}.service-quick-form[_ngcontent-%COMP%]   .form-row[_ngcontent-%COMP%]{display:flex;align-items:flex-end;gap:1rem;flex-wrap:wrap}.service-quick-form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]{flex:1;min-width:200px;display:flex;flex-direction:column;gap:.35rem}.service-quick-form[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:.7rem;font-weight:700;color:var(--text-muted);text-transform:uppercase}.service-quick-form[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;padding:.65rem 1rem;border:1.5px solid #e2e8f0;border-radius:8px;font-size:.9rem;background:var(--bg-card);transition:all .2s}.service-quick-form[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{border-color:var(--primary);box-shadow:0 0 0 3px rgba(var(--primary-rgb),.1);outline:none}.btn-add-service[_ngcontent-%COMP%]{padding:.65rem 1.5rem;border-radius:8px;height:42px;display:flex;align-items:center;gap:.5rem;font-weight:600;border:none;cursor:pointer}.modal-divider[_ngcontent-%COMP%]{border:0;border-top:1px solid var(--border-color);margin:1.5rem 0}.services-list-container[_ngcontent-%COMP%]{max-height:400px;overflow-y:auto;border-radius:8px;border:1px solid var(--border-color)}.premium-table.compact[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{padding:.6rem 1rem;font-size:.65rem;background:#f1f5f9}.premium-table.compact[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:.6rem 1rem;font-size:.8rem}.inactive-row[_ngcontent-%COMP%]{background-color:#f9fafb;opacity:.6}.switch-sm[_ngcontent-%COMP%]{position:relative;display:inline-block;width:32px;height:16px;flex-shrink:0}.switch-sm[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{opacity:0;width:0;height:0}.switch-sm[_ngcontent-%COMP%]   .slider[_ngcontent-%COMP%]{position:absolute;cursor:pointer;inset:0;background-color:#cbd5e1;transition:.4s;border-radius:16px}.switch-sm[_ngcontent-%COMP%]   .slider[_ngcontent-%COMP%]:before{position:absolute;content:"";height:10px;width:10px;left:3px;bottom:3px;background-color:#fff;transition:.4s;border-radius:50%}.switch-sm[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:checked + .slider[_ngcontent-%COMP%]{background-color:#10b981}.switch-sm[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:checked + .slider[_ngcontent-%COMP%]:before{transform:translate(16px)}.badge-damas[_ngcontent-%COMP%]{background-color:#fce7f3;color:#be185d}.badge-caballeros[_ngcontent-%COMP%]{background-color:#dbeafe;color:#1d4ed8}.badge-jovenes[_ngcontent-%COMP%]{background-color:#fef3c7;color:#b45309}.badge-ninos[_ngcontent-%COMP%]{background-color:#dcfce7;color:#15803d}.badge[_ngcontent-%COMP%]{padding:.25rem .65rem;border-radius:9999px;font-size:.65rem;font-weight:700}.empty-notes[_ngcontent-%COMP%]{text-align:center;padding:2rem;color:var(--text-muted);font-style:italic;background:var(--bg-input);border-radius:10px;border:1px dashed var(--border-color)}.filters-modal[_ngcontent-%COMP%]{max-width:800px!important;width:90vw!important;max-height:85vh;display:flex;flex-direction:column}.filters-modal[_ngcontent-%COMP%]   .modal-body[_ngcontent-%COMP%]{padding:0;overflow-y:auto;background:var(--bg-card)}.filters-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(280px,1fr));gap:1.5rem}.filter-section[_ngcontent-%COMP%]{background:var(--bg-input);padding:1rem;border-radius:10px;border:1px solid var(--border-color)}.filter-section[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:.85rem;font-weight:700;color:var(--text-muted);text-transform:uppercase;margin-bottom:1rem;letter-spacing:.5px;display:flex;align-items:center;gap:.5rem}.filter-section[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]:before{content:"";display:block;width:4px;height:14px;background:var(--primary);border-radius:2px}.checkbox-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.6rem;max-height:200px;overflow-y:auto;padding-right:.5rem}.checkbox-group[_ngcontent-%COMP%]::-webkit-scrollbar{width:4px}.checkbox-group[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:transparent}.checkbox-group[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:var(--border-color);border-radius:4px}.checkbox-label[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.6rem;cursor:pointer;font-size:.9rem;color:var(--text-main);transition:all .2s;padding:.25rem 0}.checkbox-label[_ngcontent-%COMP%]:hover{color:var(--primary)}.checkbox-label[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]{width:16px;height:16px;accent-color:var(--primary);cursor:pointer}.filters-grid-nested[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1rem}.nested-category-title[_ngcontent-%COMP%]{font-size:.8rem;font-weight:700;color:var(--primary);margin-bottom:.5rem;padding-bottom:.25rem;border-bottom:1px dashed var(--border-color)}.full-width[_ngcontent-%COMP%]{grid-column:1 / -1}.data-filters-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:1rem}.data-filter-item[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.5rem}.data-filter-item[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:.8rem;font-weight:600;color:var(--text-muted)}.trip-switch[_ngcontent-%COMP%]{display:flex;background:var(--bg-card);padding:3px;border-radius:8px;border:1px solid var(--border-color);width:fit-content}.trip-switch[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:4px 12px;font-size:.8rem;font-weight:600;border:none;background:transparent;border-radius:6px;cursor:pointer;color:var(--text-muted);transition:all .2s;min-width:50px}.trip-switch[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{color:var(--text-main)}.trip-switch[_ngcontent-%COMP%]   button.active[_ngcontent-%COMP%]{background:var(--primary);color:#fff;box-shadow:0 2px 4px rgba(var(--primary-rgb),.3)}.age-range-inputs[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem}.age-range-inputs[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{flex:1;padding:.5rem;border:1px solid var(--border-color);border-radius:8px;background:var(--bg-card);font-size:.9rem;text-align:center}.age-range-inputs[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{border-color:var(--primary);outline:none}.full-width-input[_ngcontent-%COMP%]{width:100%;padding:.6rem;border:1px solid var(--border-color);border-radius:8px;background:var(--bg-card);font-size:.9rem}.full-width-input[_ngcontent-%COMP%]:focus{border-color:var(--primary);outline:none}.filters-modal[_ngcontent-%COMP%]   .modal-footer[_ngcontent-%COMP%]{padding:1rem 1.5rem;background:var(--bg-input);border-top:1px solid var(--border-color);display:flex;justify-content:flex-end;gap:1rem}@media(max-width:768px){.filters-modal[_ngcontent-%COMP%]{width:95%!important;max-width:95%!important}.filters-grid[_ngcontent-%COMP%]{grid-template-columns:1fr;gap:1rem}.data-filters-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}.premium-card[_ngcontent-%COMP%]{padding:.5rem}.header-section[_ngcontent-%COMP%]{padding:.5rem;gap:.5rem;margin-bottom:.5rem}.mobile-config-trigger[_ngcontent-%COMP%]{margin-bottom:.25rem!important}}.empty-state[_ngcontent-%COMP%]{padding:4rem!important;text-align:center;color:#94a3b8;border:none!important}.invalid-row[_ngcontent-%COMP%]{background-color:#dc35450d!important}.invalid-row[_ngcontent-%COMP%]:hover{background-color:#dc35451a!important}.status-indicator[_ngcontent-%COMP%]{padding:.25rem .75rem;border-radius:1rem;font-size:.75rem;font-weight:600;text-transform:uppercase;background:#28a7451a;color:#28a745}.status-indicator.invalid[_ngcontent-%COMP%]{background:#dc35451a;color:#dc3545}.highlight[_ngcontent-%COMP%]{font-weight:700;color:var(--primary-color);font-size:1.1rem}.note-box[_ngcontent-%COMP%], .reason-box[_ngcontent-%COMP%]{background:#f8f9fa;padding:.75rem;border-radius:.5rem;border-left:4px solid #2563eb;margin:.5rem 0}.reason-box[_ngcontent-%COMP%]{border-left-color:#dc3545}.invalid-details[_ngcontent-%COMP%]{margin-top:1.5rem;padding-top:1.5rem;border-top:2px dashed #dee2e6}.invalid-details[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:1rem;margin-bottom:1rem;display:flex;align-items:center;gap:.5rem}.modal-footer[_ngcontent-%COMP%]{padding:1.5rem;border-top:1px solid #dee2e6;display:flex;justify-content:flex-end;gap:1rem}.btn-danger[_ngcontent-%COMP%]{background:#dc3545;color:#fff;border:none;padding:.5rem 1rem;border-radius:.5rem;cursor:pointer}.btn-danger[_ngcontent-%COMP%]:hover{background:#c82333;box-shadow:0 4px 12px #dc35454d}.action-btn-sm.edit.has-note[_ngcontent-%COMP%]{background-color:#2563eb1a;color:#2563eb;border-color:#2563eb}.small-modal[_ngcontent-%COMP%]{max-width:400px!important}.member-filter-relative[_ngcontent-%COMP%]{position:relative}.clear-selection-btn[_ngcontent-%COMP%]{position:absolute;right:.75rem;background:#e2e8f0;border:none;border-radius:50%;width:20px;height:20px;display:flex;align-items:center;justify-content:center;cursor:pointer;font-size:14px;color:#64748b;z-index:10}.search-results-dropdown[_ngcontent-%COMP%]{position:absolute;top:100%;left:0;right:0;background:var(--bg-card);border-radius:12px;box-shadow:0 10px 15px -3px #0000001a;border:1px solid #e2e8f0;margin-top:.5rem;max-height:250px;overflow-y:auto;z-index:1000}.search-result-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.75rem;padding:.75rem 1rem;cursor:pointer;transition:background .2s}.search-result-item[_ngcontent-%COMP%]:hover{background:#f8fafc}.search-result-item[_ngcontent-%COMP%]   .avatar-sm[_ngcontent-%COMP%]{width:32px;height:32px;border-radius:50%;object-fit:cover}.result-info[_ngcontent-%COMP%]{display:flex;flex-direction:column}.result-info[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{font-size:.85rem;color:#1e293b}.result-info[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:.75rem;color:#64748b}.search-actions-row[_ngcontent-%COMP%]{margin-top:1.5rem;display:flex;justify-content:center;width:100%}.btn-filter-trigger[_ngcontent-%COMP%]{padding:.6rem 1.25rem;font-size:.85rem;font-weight:700;border-radius:10px;background:linear-gradient(135deg,var(--primary) 0%,#4338ca 100%);box-shadow:0 4px 6px -1px rgba(var(--primary-rgb),.2);transition:all .3s cubic-bezier(.4,0,.2,1);display:flex;align-items:center;justify-content:center;gap:.5rem;color:#fff;border:none;cursor:pointer}.btn-filter-trigger[_ngcontent-%COMP%]:hover:not(:disabled){transform:translateY(-1px);box-shadow:0 10px 15px -3px rgba(var(--primary-rgb),.3);filter:brightness(1.1)}.btn-filter-trigger[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:.9rem}.form-group-centered[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;gap:.75rem;text-align:center}.form-group-centered[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:.85rem;font-weight:700;color:var(--text-muted);text-transform:uppercase;letter-spacing:.5px}.premium-input.no-icon[_ngcontent-%COMP%]{padding-left:1rem;text-align:center;width:100%}@media(max-width:767px){.mobile-hide[_ngcontent-%COMP%]{display:none}.desktop-only[_ngcontent-%COMP%]{display:none!important}.registration-grid[_ngcontent-%COMP%]{grid-template-columns:1fr;gap:1rem}.mobile-config-trigger[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;width:100%;background:var(--bg-card);border:1px solid var(--border-color);padding:.5rem .75rem;border-radius:10px;margin-bottom:.5rem;box-shadow:0 1px 2px #0000000d;cursor:pointer;min-height:40px}.config-info[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:flex-start;gap:0}.service-name[_ngcontent-%COMP%]{font-weight:700;color:var(--text-main);font-size:.85rem}.service-date[_ngcontent-%COMP%]{font-size:.7rem;color:var(--text-muted)}.search-center[_ngcontent-%COMP%]{width:100%;margin-top:.25rem}.search-center[_ngcontent-%COMP%]   .soft-label[_ngcontent-%COMP%]{display:none}}@media(min-width:768px){.mobile-config-trigger[_ngcontent-%COMP%]{display:none}.mobile-only[_ngcontent-%COMP%]{display:none!important}}.filter-form-stack[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1.25rem}.full-width[_ngcontent-%COMP%]{width:100%;justify-content:center}.mobile-actions-wrapper[_ngcontent-%COMP%]{position:relative;display:inline-block}.action-dropdown[_ngcontent-%COMP%]{position:absolute;top:100%;right:0;z-index:1000;background:var(--bg-card);min-width:190px;border-radius:12px;box-shadow:0 10px 25px -5px #0000001a,0 8px 10px -6px #0000001a;border:1px solid var(--border-color);padding:.5rem 0;margin-top:.5rem;animation:_ngcontent-%COMP%_dropdown-fade-in .2s cubic-bezier(.16,1,.3,1)}@keyframes _ngcontent-%COMP%_dropdown-fade-in{0%{opacity:0;transform:translateY(-10px) scale(.95)}to{opacity:1;transform:translateY(0) scale(1)}}.dropdown-header-mobile[_ngcontent-%COMP%]{padding:.5rem 1rem;background:#f8fafc;border-bottom:1px solid var(--border-color);margin-bottom:.4rem;margin-top:-.5rem;border-radius:12px 12px 0 0}.member-name-small[_ngcontent-%COMP%]{font-size:.75rem;font-weight:700;color:var(--text-muted);display:block;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;text-align:left}.action-dropdown[_ngcontent-%COMP%]   .dropdown-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.75rem;padding:.75rem 1rem;width:100%;border:none;background:none;cursor:pointer;font-size:.85rem;font-weight:600;color:var(--text-main);transition:all .2s;text-align:left;position:relative;z-index:1}.dropdown-label[_ngcontent-%COMP%]{flex:1}.action-dropdown[_ngcontent-%COMP%]   .dropdown-item[_ngcontent-%COMP%]:hover{background:#f1f5f9;color:var(--primary)}.action-dropdown[_ngcontent-%COMP%]   .dropdown-item[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{width:16px;text-align:center;font-size:.9rem}[data-theme="dark"][_nghost-%COMP%]   .action-dropdown[_ngcontent-%COMP%], [data-theme="dark"]   [_nghost-%COMP%]   .action-dropdown[_ngcontent-%COMP%]{background:var(--bg-card);border-color:var(--border-color)}[data-theme="dark"][_nghost-%COMP%]   .dropdown-header-mobile[_ngcontent-%COMP%], [data-theme="dark"]   [_nghost-%COMP%]   .dropdown-header-mobile[_ngcontent-%COMP%]{background:var(--bg-input);border-color:var(--border-color)}[data-theme="dark"][_nghost-%COMP%]   .menu-trigger[_ngcontent-%COMP%], [data-theme="dark"]   [_nghost-%COMP%]   .menu-trigger[_ngcontent-%COMP%]{background:var(--bg-input);color:var(--text-muted)}[data-theme="dark"][_nghost-%COMP%]   .menu-trigger[_ngcontent-%COMP%]:hover, [data-theme="dark"]   [_nghost-%COMP%]   .menu-trigger[_ngcontent-%COMP%]:hover{background:var(--border-color);color:var(--text-main)}[data-theme="dark"][_nghost-%COMP%]   .action-dropdown[_ngcontent-%COMP%]   .dropdown-item[_ngcontent-%COMP%]:hover, [data-theme="dark"]   [_nghost-%COMP%]   .action-dropdown[_ngcontent-%COMP%]   .dropdown-item[_ngcontent-%COMP%]:hover{background:#ffffff0d;color:var(--primary)}.dropdown-divider[_ngcontent-%COMP%]{border:0;border-top:1px solid var(--border-color);margin:.4rem 0}.menu-trigger[_ngcontent-%COMP%]{width:28px;height:28px;border-radius:6px;background:#f1f5f9;color:var(--text-muted);display:flex;align-items:center;justify-content:center;transition:all .2s;border:none;cursor:pointer}.menu-trigger[_ngcontent-%COMP%]:hover{background:#e2e8f0;color:var(--text-main)}.status-indicator-small[_ngcontent-%COMP%]{padding:.2rem .5rem;border-radius:6px;font-size:.7rem;font-weight:700;background:#dcfce7;color:#166534}.status-indicator-small.invalid[_ngcontent-%COMP%]{background:#fee2e2;color:#991b1b}.arrival-time-small[_ngcontent-%COMP%]{font-size:.8rem;font-weight:700;color:var(--primary)}.desktop-actions[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem}.mobile-category-info[_ngcontent-%COMP%]{display:flex;gap:.25rem;margin-top:.25rem;flex-wrap:wrap}.badge-mini[_ngcontent-%COMP%]{font-size:.6rem;padding:.1rem .35rem;border-radius:4px;color:#fff;font-weight:700;text-transform:uppercase}.badge-mini-outline[_ngcontent-%COMP%]{font-size:.6rem;padding:.1rem .35rem;border-radius:4px;background:transparent;border:1px solid;font-weight:700;text-transform:uppercase}.user-info-cell[_ngcontent-%COMP%]{display:flex;align-items:center;gap:1rem}.user-details[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;line-height:1.2}.user-fullname[_ngcontent-%COMP%]{font-weight:600;color:var(--text-main);font-size:.95rem}.user-age-small[_ngcontent-%COMP%]{font-size:.75rem;color:var(--text-muted)}.category-cell[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:4px;align-items:flex-start}.header-layout-v2[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1.5rem;margin-bottom:2rem}.event-banner[_ngcontent-%COMP%]{display:flex;align-items:center;gap:1rem;padding:1rem 1.25rem;border-radius:12px;background:#fff;box-shadow:0 4px 6px -1px #0000000d;border:1px solid var(--border-color);position:relative;overflow:hidden}.event-banner.active-event[_ngcontent-%COMP%]{background:linear-gradient(135deg,#fff,#f8fafc);border-left:4px solid var(--success)}.event-banner.no-event[_ngcontent-%COMP%]{background:#fff;border-left:4px solid #94a3b8}.banner-icon[_ngcontent-%COMP%]   .icon-circle[_ngcontent-%COMP%]{width:36px;height:36px;border-radius:10px;background:#22c55e1a;color:var(--success);display:flex;align-items:center;justify-content:center;font-size:1rem}.banner-icon[_ngcontent-%COMP%]   .icon-circle.warning[_ngcontent-%COMP%]{background:#94a3b81a;color:#94a3b8}.banner-content[_ngcontent-%COMP%]{flex:1}.banner-label[_ngcontent-%COMP%]{font-size:.65rem;font-weight:700;text-transform:uppercase;letter-spacing:.05em;color:var(--success);margin-bottom:.15rem}.banner-title[_ngcontent-%COMP%]{font-size:1.1rem;font-weight:600;color:var(--text-color);margin:0;line-height:1.2}.banner-subtitle[_ngcontent-%COMP%]{color:#64748b;font-size:.9rem;margin:.25rem 0 0}.banner-meta[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:1rem;margin-top:.25rem}.meta-item[_ngcontent-%COMP%]{font-size:.85rem;color:#64748b;display:flex;align-items:center;gap:.35rem}.banner-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{font-weight:500;font-size:.9rem;display:flex;align-items:center;gap:.5rem;cursor:pointer;transition:all .2s}.btn-text-action[_ngcontent-%COMP%]{background:none;border:none;color:var(--primary);padding:.5rem 1rem;border-radius:8px}.btn-text-action[_ngcontent-%COMP%]:hover{background:#4f46e50d}.past-events-panel[_ngcontent-%COMP%]{background:#fff;border-radius:16px;padding:1.5rem;border:2px dashed var(--primary);background:#f8fafc;display:flex;flex-direction:column;height:600px;max-height:80vh;overflow:hidden}.past-events-panel[_ngcontent-%COMP%]   .panel-body[_ngcontent-%COMP%]{flex:1;min-height:0;overflow:hidden;position:relative;display:flex;flex-direction:column}.panel-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:1rem}.panel-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;font-size:1.1rem;color:var(--primary);display:flex;align-items:center;gap:.5rem}.close-panel-btn[_ngcontent-%COMP%]{background:none;border:none;color:#64748b;cursor:pointer;display:flex;align-items:center;gap:.4rem;font-size:.9rem}.close-panel-btn[_ngcontent-%COMP%]:hover{color:var(--danger)}.soft-input-wrapper.full-width[_ngcontent-%COMP%]{width:100%}.action-bar-v2[_ngcontent-%COMP%]{display:flex;align-items:center;gap:1rem;background:#fff;padding:.75rem;border-radius:14px;border:1px solid var(--border-color);box-shadow:0 2px 4px #00000005;transition:opacity .3s}.action-bar-v2.disabled[_ngcontent-%COMP%]{opacity:.6;pointer-events:none}.search-container[_ngcontent-%COMP%]{flex:1;position:relative;display:flex;align-items:center}.search-icon[_ngcontent-%COMP%]{position:absolute;left:1rem;color:#94a3b8;pointer-events:none}.search-input-modern[_ngcontent-%COMP%]{width:100%;padding:.75rem 1rem .75rem 2.8rem;border:1px solid #e2e8f0;border-radius:10px;font-size:.95rem;font-family:inherit;background:#f8fafc;transition:all .2s}.search-input-modern[_ngcontent-%COMP%]:focus{outline:none;background:#fff;border-color:var(--primary);box-shadow:0 0 0 3px #4f46e51a}.time-control-group[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.75rem;padding-right:.75rem;border-right:1px solid #e2e8f0}.toggle-switch-wrapper[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;cursor:pointer}.switch-modern[_ngcontent-%COMP%]{position:relative;display:inline-block;width:36px;height:20px}.switch-modern[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{opacity:0;width:0;height:0}.slider-modern[_ngcontent-%COMP%]{position:absolute;cursor:pointer;inset:0;background-color:#cbd5e1;transition:.4s;border-radius:20px}.slider-modern[_ngcontent-%COMP%]:before{position:absolute;content:"";height:16px;width:16px;left:2px;bottom:2px;background-color:#fff;transition:.4s;border-radius:50%}input[_ngcontent-%COMP%]:checked + .slider-modern[_ngcontent-%COMP%]{background-color:var(--primary)}input[_ngcontent-%COMP%]:checked + .slider-modern[_ngcontent-%COMP%]:before{transform:translate(16px)}.toggle-label-modern[_ngcontent-%COMP%]{font-size:.85rem;font-weight:500;color:#64748b}.time-input-modern[_ngcontent-%COMP%]{padding:.4rem .6rem;border:1px solid #e2e8f0;border-radius:8px;font-size:.85rem;color:#334155;background:var(--bg-input)}.btn-filter-modern[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.6rem;padding:.75rem 1.25rem;background:#fff;border:1px solid #e2e8f0;border-radius:10px;color:#334155;font-weight:500;cursor:pointer;transition:all .2s;position:relative}.btn-filter-modern[_ngcontent-%COMP%]:hover{background:#f8fafc;border-color:#cbd5e1}.filter-dot[_ngcontent-%COMP%]{position:absolute;top:8px;right:8px;width:8px;height:8px;background:var(--primary);border-radius:50%}[data-theme="dark"][_nghost-%COMP%]   .event-banner[_ngcontent-%COMP%], [data-theme="dark"]   [_nghost-%COMP%]   .event-banner[_ngcontent-%COMP%]{background:#1e293b;border-color:#334155}[data-theme="dark"][_nghost-%COMP%]   .event-banner.active-event[_ngcontent-%COMP%], [data-theme="dark"]   [_nghost-%COMP%]   .event-banner.active-event[_ngcontent-%COMP%]{background:linear-gradient(135deg,#1e293b,#0f172a);border-left-color:var(--success)}[data-theme="dark"][_nghost-%COMP%]   .event-banner.no-event[_ngcontent-%COMP%], [data-theme="dark"]   [_nghost-%COMP%]   .event-banner.no-event[_ngcontent-%COMP%]{background:#1e293b;border-left-color:#475569}[data-theme="dark"][_nghost-%COMP%]   .banner-label[_ngcontent-%COMP%], [data-theme="dark"]   [_nghost-%COMP%]   .banner-label[_ngcontent-%COMP%]{color:#4ade80}[data-theme="dark"][_nghost-%COMP%]   .banner-title[_ngcontent-%COMP%], [data-theme="dark"]   [_nghost-%COMP%]   .banner-title[_ngcontent-%COMP%]{color:#f8fafc}[data-theme="dark"][_nghost-%COMP%]   .banner-subtitle[_ngcontent-%COMP%], [data-theme="dark"]   [_nghost-%COMP%]   .banner-subtitle[_ngcontent-%COMP%]{color:#94a3b8}[data-theme="dark"][_nghost-%COMP%]   .action-bar-v2[_ngcontent-%COMP%], [data-theme="dark"]   [_nghost-%COMP%]   .action-bar-v2[_ngcontent-%COMP%]{background:#1e293b;border-color:#334155}[data-theme="dark"][_nghost-%COMP%]   .search-input-modern[_ngcontent-%COMP%], [data-theme="dark"]   [_nghost-%COMP%]   .search-input-modern[_ngcontent-%COMP%]{background:#0f172a;border-color:#334155;color:#f8fafc}[data-theme="dark"][_nghost-%COMP%]   .btn-filter-modern[_ngcontent-%COMP%], [data-theme="dark"]   [_nghost-%COMP%]   .btn-filter-modern[_ngcontent-%COMP%]{background:#1e293b;border-color:#334155;color:#cbd5e1}[data-theme="dark"][_nghost-%COMP%]   .time-input-modern[_ngcontent-%COMP%], [data-theme="dark"]   [_nghost-%COMP%]   .time-input-modern[_ngcontent-%COMP%]{background:#0f172a;border-color:#334155;color:#f8fafc}[data-theme="dark"][_nghost-%COMP%]   .past-events-panel[_ngcontent-%COMP%], [data-theme="dark"]   [_nghost-%COMP%]   .past-events-panel[_ngcontent-%COMP%]{background:#0f172a;border-color:var(--primary)}@media(max-width:768px){.action-bar-v2[_ngcontent-%COMP%]{flex-wrap:wrap}.search-container[_ngcontent-%COMP%]{width:100%;order:1}.time-control-group[_ngcontent-%COMP%]{order:2;flex:1;border-right:none}.btn-filter-modern[_ngcontent-%COMP%]{order:3}.banner-meta[_ngcontent-%COMP%]{flex-direction:column;gap:.5rem}.event-banner[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start;gap:1rem}.banner-icon[_ngcontent-%COMP%]{display:none}.header-layout-v2[_ngcontent-%COMP%]{margin-bottom:1rem;gap:1rem}}.calendar-selection-modal[_ngcontent-%COMP%]{max-width:900px!important;width:95%!important;height:90vh!important}.calendar-modal-body[_ngcontent-%COMP%]{padding:0!important;display:flex;flex-direction:column;height:100%;overflow:hidden}.calendar-modal-body[_ngcontent-%COMP%]   app-service-calendar[_ngcontent-%COMP%]{flex:1;min-height:0}.event-selection-display[_ngcontent-%COMP%]{width:100%;padding:.5rem 2.5rem;border:1.5px solid var(--border-color);border-radius:10px;background:var(--bg-input);cursor:pointer;min-height:38px;display:flex;align-items:center;transition:all .3s ease}.event-selection-display[_ngcontent-%COMP%]:hover{border-color:var(--primary);background:var(--bg-card)}.event-selection-display[_ngcontent-%COMP%]   .placeholder-text[_ngcontent-%COMP%]{color:var(--text-muted);font-size:.8rem;font-style:italic}.event-selection-display[_ngcontent-%COMP%]   .selected-text[_ngcontent-%COMP%]{color:var(--primary);font-weight:700;font-size:.8rem}.calendar-selection-modal[_ngcontent-%COMP%]{z-index:2050!important}.export-dropdown-wrapper[_ngcontent-%COMP%]{position:relative;display:inline-block}.export-btn[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.6rem;min-width:130px;justify-content:center}.export-dropdown-menu[_ngcontent-%COMP%]{position:absolute;top:100%;right:0;z-index:1050;background:var(--bg-card);min-width:180px;border-radius:12px;box-shadow:var(--shadow-md);border:1px solid var(--border-color);padding:.5rem 0;margin-top:.5rem;animation:_ngcontent-%COMP%_dropdown-fade-in .2s cubic-bezier(.16,1,.3,1)}.export-dropdown-menu[_ngcontent-%COMP%]   .dropdown-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.75rem;padding:.75rem 1rem;width:100%;border:none;background:none;cursor:pointer;font-size:.85rem;font-weight:600;color:var(--text-main);transition:all .2s;text-align:left}.export-dropdown-menu[_ngcontent-%COMP%]   .dropdown-item[_ngcontent-%COMP%]:hover{background:var(--bg-input);color:var(--primary)}.export-dropdown-menu[_ngcontent-%COMP%]   .dropdown-item[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{width:16px;text-align:center;font-size:1rem}.export-dropdown-menu[_ngcontent-%COMP%]   .dropdown-item[_ngcontent-%COMP%]   .text-success[_ngcontent-%COMP%]{color:#10b981}.export-dropdown-menu[_ngcontent-%COMP%]   .dropdown-item[_ngcontent-%COMP%]   .text-danger[_ngcontent-%COMP%]{color:#ef4444}@keyframes _ngcontent-%COMP%_dropdown-fade-in{0%{opacity:0;transform:translateY(-8px) scale(.95)}to{opacity:1;transform:translateY(0) scale(1)}}']})};function yT(t,r){if(t&1){let e=Pe();d(0,"div",24),L("click",function(i){return D(e),N(i.stopPropagation())}),d(1,"button",25),L("click",function(){D(e);let i=C();return N(i.exportData("excel"))}),j(2,"i",26),d(3,"span"),_(4,"Exportar a Excel"),u()(),d(5,"button",25),L("click",function(){D(e);let i=C();return N(i.exportData("pdf"))}),j(6,"i",27),d(7,"span"),_(8,"Exportar a PDF"),u()()()}}function CT(t,r){if(t&1){let e=Pe();d(0,"span",31),_(1),d(2,"button",32),L("click",function(){D(e);let i=C(2);return N(i.clearMemberFilter())}),_(3,"\xD7"),u()()}if(t&2){let e=C(2);g(),je(" ",e.selectedMemberName," ")}}function ST(t,r){if(t&1){let e=Pe();d(0,"span",31),j(1,"i",33),_(2),d(3,"button",32),L("click",function(){D(e);let i=C(2);return i.filters.branchId="",N(i.onSearch())}),_(4,"\xD7"),u()()}if(t&2){let e=C(2);g(2),je(" ",e.getBranchName(e.filters.branchId)," ")}}function kT(t,r){if(t&1){let e=Pe();d(0,"span",31),j(1,"i",34),_(2),d(3,"button",32),L("click",function(){D(e);let i=C(2);return N(i.clearEventFilter())}),_(4,"\xD7"),u()()}if(t&2){let e=C(2);g(2),je(" ",e.selectedEventLabel," ")}}function ET(t,r){if(t&1&&(d(0,"div",28)(1,"div",29),fe(2,CT,4,1,"span",30)(3,ST,5,1,"span",30)(4,kT,5,1,"span",30),u()()),t&2){let e=C();g(2),P("ngIf",e.selectedMemberName),g(),P("ngIf",e.filters.branchId),g(),P("ngIf",e.selectedEventLabel)}}function MT(t,r){t&1&&(d(0,"tr")(1,"td",35)(2,"div",36),j(3,"div",37),d(4,"div"),_(5,"Cargando asistencias..."),u()()()())}function PT(t,r){if(t&1&&(d(0,"span",55),_(1),u()),t&2){let e=C(2).$implicit;Ft("border-color",e.memberCategory.color)("color",e.memberCategory.color),g(),je(" ",e.subCategory.name," ")}}function OT(t,r){if(t&1&&(d(0,"div",52)(1,"span",53),_(2),u(),fe(3,PT,2,5,"span",54),u()),t&2){let e=C().$implicit;g(),Ft("background-color",e.memberCategory.color),g(),je(" ",e.memberCategory.name," "),g(),P("ngIf",e.subCategory)}}function AT(t,r){if(t&1){let e=Pe();d(0,"button",56),L("click",function(){D(e);let i=C().$implicit,a=C(2);return N(a.openInvalidateModal(i))}),j(1,"i",57),u()}}function TT(t,r){if(t&1){let e=Pe();d(0,"button",25),L("click",function(){D(e);let i=C(2).$implicit,a=C(2);return a.openInvalidateModal(i),N(a.closeDropdown())}),j(1,"i",68),d(2,"span",69),_(3,"Invalidar"),u()()}}function IT(t,r){if(t&1){let e=Pe();d(0,"div",58),L("click",function(i){return D(e),N(i.stopPropagation())}),d(1,"div",59)(2,"span",60),_(3),u()(),d(4,"div",61)(5,"span",62),_(6,"Estado"),u(),d(7,"span",63),_(8),u()(),d(9,"div",61)(10,"span",62),_(11,"Llegada"),u(),d(12,"span",64),_(13),Cr(14,"date"),u()(),j(15,"hr",65),d(16,"button",25),L("click",function(){D(e);let i=C().$implicit,a=C(2);return a.viewDetails(i),N(a.closeDropdown())}),j(17,"i",66),d(18,"span"),_(19,"Ver Detalles"),u()(),fe(20,TT,4,0,"button",67),u()}if(t&2){let e=C().$implicit,n=C(2);g(3),be(e.memberCompleteName),g(4),wt("invalid",e.invalid),g(),je(" ",e.invalid?"Invalida":"V\xE1lida"," "),g(5),be(Qr(14,6,e.attendanceDate,"shortTime")),g(7),P("ngIf",!e.invalid&&n.can("MANAGE_ATTENDANCE"))}}function FT(t,r){if(t&1){let e=Pe();d(0,"tr")(1,"td")(2,"div",39)(3,"span",40),_(4),u(),fe(5,OT,4,4,"div",41),u()(),d(6,"td"),_(7),u(),d(8,"td"),_(9),u(),d(10,"td",13),_(11),Cr(12,"date"),u(),d(13,"td",13),_(14),Cr(15,"date"),u(),d(16,"td",14)(17,"span",42),_(18),u()(),d(19,"td",15)(20,"div",43)(21,"div",44)(22,"button",45),L("click",function(){let i=D(e).$implicit,a=C(2);return N(a.viewDetails(i))}),j(23,"i",46),u(),fe(24,AT,2,0,"button",47),u(),d(25,"div",48)(26,"button",49),L("click",function(i){let a=D(e).$implicit,o=C(2);return N(o.toggleDropdown(i,a.id))}),j(27,"i",50),u(),fe(28,IT,21,9,"div",51),u()()()()}if(t&2){let e=r.$implicit,n=C(2);wt("invalid-row",e.invalid),g(4),be(e.memberCompleteName),g(),P("ngIf",e.memberCategory),g(2),be(e.serviceName),g(2),be(e.branchName),g(2),be(Qr(12,13,e.serviceDate,"short")),g(3),be(Qr(15,16,e.attendanceDate,"shortTime")),g(3),wt("invalid",e.invalid),g(),je(" ",e.invalid?"Invalida":"V\xE1lida"," "),g(6),P("ngIf",!e.invalid&&n.can("MANAGE_ATTENDANCE")),g(4),P("ngIf",n.activeDropdownId===e.id)}}function DT(t,r){if(t&1&&(Ln(0),fe(1,FT,29,19,"tr",38),Bn()),t&2){let e=C();g(),P("ngForOf",e.attendances)}}function NT(t,r){t&1&&(d(0,"tr")(1,"td",70),j(2,"i",71),_(3," No se encontraron asistencias "),u()())}function RT(t,r){if(t&1&&(d(0,"div",81)(1,"label"),_(2,"Sub-Categor\xEDa:"),u(),d(3,"span",83),_(4),u()()),t&2){let e=C(3);g(3),Ft("border-color",e.attendanceDetails.memberCategory.color)("color",e.attendanceDetails.memberCategory.color),g(),je(" ",e.attendanceDetails.subCategory.name," ")}}function LT(t,r){if(t&1&&(d(0,"div",79)(1,"label"),_(2,"Nota:"),u(),d(3,"p",87),_(4),u()()),t&2){let e=C(3);g(4),be(e.attendanceDetails.note)}}function BT(t,r){if(t&1&&(d(0,"div",88)(1,"h3",69),j(2,"i",89),_(3," Informaci\xF3n de Invalidaci\xF3n "),u(),d(4,"div",90)(5,"div",81)(6,"label"),_(7,"Motivo:"),u(),d(8,"p",91),_(9),u()(),d(10,"div",81)(11,"label"),_(12,"Invalidado en:"),u(),d(13,"span"),_(14),Cr(15,"date"),u()(),d(16,"div",81)(17,"label"),_(18,"Invalidado por:"),u(),d(19,"span"),_(20),u()()()()),t&2){let e=C(3);g(9),be(e.attendanceDetails.invalidReason),g(5),be(Qr(15,3,e.attendanceDetails.invalidAt,"medium")),g(6),be(e.attendanceDetails.invalidatedBy)}}function UT(t,r){if(t&1&&(d(0,"div",77)(1,"div",78)(2,"div",79)(3,"label"),_(4,"Integrante:"),u(),d(5,"span",80),_(6),u()(),d(7,"div",79)(8,"label"),_(9,"Servicio:"),u(),d(10,"span"),_(11),u()(),d(12,"div",79)(13,"label"),_(14,"Sede:"),u(),d(15,"span"),_(16),u()(),d(17,"div",81)(18,"label"),_(19,"Categor\xEDa:"),u(),d(20,"span",82),_(21),u()(),d(22,"div",81)(23,"label"),_(24,"Tipo:"),u(),d(25,"span",83),_(26),u()(),fe(27,RT,5,5,"div",84),d(28,"div",81)(29,"label"),_(30,"Fecha del Servicio:"),u(),d(31,"span"),_(32),Cr(33,"date"),u()(),d(34,"div",81)(35,"label"),_(36,"Hora de Llegada:"),u(),d(37,"span"),_(38),Cr(39,"date"),u()(),d(40,"div",81)(41,"label"),_(42,"Registrado por:"),u(),d(43,"span"),_(44),u()(),fe(45,LT,5,1,"div",85),u(),fe(46,BT,21,6,"div",86),u()),t&2){let e=C(2);g(6),be(e.attendanceDetails.memberCompleteName),g(5),be(e.attendanceDetails.serviceName),g(5),be(e.attendanceDetails.branchName),g(4),Ft("background-color",e.attendanceDetails.memberCategory.color),P("ngClass",e.getBadgeClass(e.attendanceDetails.memberCategory)),g(),je(" ",e.formatCategory(e.attendanceDetails.memberCategory)," "),g(4),Ft("border-color",e.attendanceDetails.memberType.color)("color",e.attendanceDetails.memberType.color),g(),je(" ",e.formatType(e.attendanceDetails.memberType)," "),g(),P("ngIf",e.attendanceDetails.subCategory),g(5),be(Qr(33,18,e.attendanceDetails.serviceDate,"medium")),g(6),be(Qr(39,21,e.attendanceDetails.attendanceDate,"medium")),g(6),be(e.attendanceDetails.registeredBy),g(),P("ngIf",e.attendanceDetails.note),g(),P("ngIf",e.attendanceDetails.invalid)}}function VT(t,r){if(t&1){let e=Pe();d(0,"div",72),L("click",function(){D(e);let i=C();return N(i.closeDetailsModal())}),d(1,"div",73),L("click",function(i){return D(e),N(i.stopPropagation())}),d(2,"div",74)(3,"h2"),_(4,"Detalles de Asistencia"),u(),d(5,"button",75),L("click",function(){D(e);let i=C();return N(i.closeDetailsModal())}),_(6,"\xD7"),u()(),fe(7,UT,47,24,"div",76),u()()}if(t&2){let e=C();g(7),P("ngIf",e.attendanceDetails)}}function zT(t,r){if(t&1){let e=Pe();d(0,"div",72),L("click",function(){D(e);let i=C();return N(i.closeInvalidateModal())}),d(1,"div",73),L("click",function(i){return D(e),N(i.stopPropagation())}),d(2,"div",74)(3,"h2"),_(4,"Invalidar Asistencia"),u(),d(5,"button",75),L("click",function(){D(e);let i=C();return N(i.closeInvalidateModal())}),_(6,"\xD7"),u()(),d(7,"div",77)(8,"p"),_(9,"\xBFEst\xE1s seguro de que deseas invalidar la asistencia de "),d(10,"strong"),_(11),u(),_(12,"?"),u(),d(13,"div",92)(14,"label"),_(15,"Motivo de la invalidaci\xF3n:"),u(),d(16,"textarea",93),ht("ngModelChange",function(i){D(e);let a=C();return ut(a.invalidReason,i)||(a.invalidReason=i),N(i)}),u()()(),d(17,"div",94)(18,"button",95),L("click",function(){D(e);let i=C();return N(i.closeInvalidateModal())}),_(19,"Cancelar"),u(),d(20,"button",96),L("click",function(){D(e);let i=C();return N(i.confirmInvalidate())}),_(21),u()()()()}if(t&2){let e=C();g(11),be(e.selectedAttendance==null?null:e.selectedAttendance.memberCompleteName),g(5),ft("ngModel",e.invalidReason),g(4),P("disabled",e.isInvalidating||!e.invalidReason.trim()),g(),je(" ",e.isInvalidating?"Invalidando...":"Confirmar Invalidaci\xF3n"," ")}}function jT(t,r){if(t&1){let e=Pe();d(0,"button",132),L("click",function(){D(e);let i=C(2);return N(i.clearMemberFilter())}),_(1," \xD7 "),u()}}function HT(t,r){if(t&1){let e=Pe();d(0,"div",135),L("click",function(){let i=D(e).$implicit,a=C(3);return N(a.selectMember(i))}),j(1,"img",136),d(2,"div",137)(3,"strong"),_(4),u(),d(5,"span"),_(6),u()()()}if(t&2){let e=r.$implicit;g(),P("src",e.pictureProfileUrl||"https://ui-avatars.com/api/?name="+e.completeName,pn),g(3),be(e.completeName),g(2),be(e.cc)}}function WT(t,r){if(t&1&&(d(0,"div",133),fe(1,HT,7,3,"div",134),u()),t&2){let e=C(2);g(),P("ngForOf",e.memberSearchResults)}}function qT(t,r){if(t&1&&(d(0,"option",138),_(1),u()),t&2){let e=r.$implicit;P("value",e.id),g(),be(e.name)}}function GT(t,r){if(t&1){let e=Pe();d(0,"div",107)(1,"label"),_(2,"Sede"),u(),d(3,"div",101),j(4,"i",33),d(5,"select",109),ht("ngModelChange",function(i){D(e);let a=C(2);return ut(a.filters.branchId,i)||(a.filters.branchId=i),N(i)}),d(6,"option",110),_(7,"Todas las sedes"),u(),fe(8,qT,2,2,"option",111),u()()()}if(t&2){let e=C(2);g(5),ft("ngModel",e.filters.branchId),g(3),P("ngForOf",e.branches)}}function $T(t,r){if(t&1&&(d(0,"option",138),_(1),u()),t&2){let e=r.$implicit;P("value",e.id),g(),be(e.name)}}function XT(t,r){t&1&&(d(0,"span",139),_(1,"Seleccionar evento en calendario..."),u())}function YT(t,r){if(t&1&&(d(0,"span",140),_(1),u()),t&2){let e=C(2);g(),be(e.selectedEventLabel)}}function KT(t,r){if(t&1){let e=Pe();d(0,"button",132),L("click",function(i){return D(e),C(2).clearEventFilter(),N(i.stopPropagation())}),_(1," \xD7 "),u()}}function ZT(t,r){if(t&1){let e=Pe();d(0,"label",141)(1,"input",142),L("change",function(){let i=D(e).$implicit,a=C(2);return N(a.toggleTempCategory(i.id))}),u(),d(2,"span"),_(3),u()()}if(t&2){let e=r.$implicit,n=C(2);g(),P("checked",n.isTempCategorySelected(e.id)),g(2),be(e.name)}}function JT(t,r){if(t&1){let e=Pe();d(0,"label",141)(1,"input",142),L("change",function(){let i=D(e).$implicit,a=C(5);return N(a.toggleTempSubCategory(i.id))}),u(),d(2,"span"),_(3),u()()}if(t&2){let e=r.$implicit,n=C(5);g(),P("checked",n.isTempSubCategorySelected(e.id)),g(2),be(e.name)}}function QT(t,r){if(t&1&&(Ln(0),d(1,"h4",146),_(2),u(),d(3,"div",123),fe(4,JT,4,2,"label",124),u(),Bn()),t&2){let e=C().$implicit;g(2),be(e.name),g(2),P("ngForOf",e.subCategories)}}function e7(t,r){if(t&1&&(Ln(0),fe(1,QT,5,2,"ng-container",16),Bn()),t&2){let e=r.$implicit,n=C(3);g(),P("ngIf",e.subCategories&&e.subCategories.length>0&&(n.tempSelectedCategories.length===0||n.isTempCategorySelected(e.id)))}}function t7(t,r){if(t&1&&(d(0,"div",121)(1,"h3"),j(2,"i",143),_(3," Sub-Categor\xEDa"),u(),d(4,"div",144),fe(5,e7,2,1,"ng-container",145),u()()),t&2){let e=C(2);g(5),P("ngForOf",e.categorias)}}function r7(t,r){if(t&1){let e=Pe();d(0,"button",128),L("click",function(){let i=D(e).$implicit,a=C(2);return N(a.tempSelectedGender=i.value)}),_(1),u()}if(t&2){let e=r.$implicit,n=C(2);wt("active",n.tempSelectedGender===e.value),g(),be(e.label)}}function n7(t,r){if(t&1){let e=Pe();d(0,"div",72),L("click",function(){D(e);let i=C();return N(i.closeFilterModal())}),d(1,"div",97),L("click",function(i){return D(e),N(i.stopPropagation())}),d(2,"div",74)(3,"h2"),j(4,"i",98),_(5," Filtros de B\xFAsqueda"),u(),d(6,"button",75),L("click",function(){D(e);let i=C();return N(i.closeFilterModal())}),_(7,"\xD7"),u()(),d(8,"div",77)(9,"div",99)(10,"div",100)(11,"label"),_(12,"Integrante"),u(),d(13,"div",101),j(14,"i",102),d(15,"input",103),ht("ngModelChange",function(i){D(e);let a=C();return ut(a.memberSearchQuery,i)||(a.memberSearchQuery=i),N(i)}),L("input",function(){D(e);let i=C();return N(i.onMemberSearchInput())})("focus",function(){D(e);let i=C();return N(i.showMemberResults=i.memberSearchResults.length>0)}),u(),fe(16,jT,2,0,"button",104),u(),fe(17,WT,2,1,"div",105),u(),fe(18,GT,9,2,"div",106),d(19,"div",107)(20,"label"),_(21,"Servicio"),u(),d(22,"div",101),j(23,"i",108),d(24,"select",109),ht("ngModelChange",function(i){D(e);let a=C();return ut(a.filters.serviceId,i)||(a.filters.serviceId=i),N(i)}),d(25,"option",110),_(26,"Todos los servicios"),u(),fe(27,$T,2,2,"option",111),u()()(),d(28,"div",107)(29,"label"),_(30,"Evento Espec\xEDfico"),u(),d(31,"div",101),j(32,"i",34),d(33,"div",112),L("click",function(){D(e);let i=C();return N(i.openCalendarModal())}),fe(34,XT,2,0,"span",113)(35,YT,2,1,"span",114),u(),fe(36,KT,2,0,"button",104),u()(),d(37,"div",107)(38,"label"),_(39,"Estado de Validez"),u(),d(40,"div",101),j(41,"i",115),d(42,"select",109),ht("ngModelChange",function(i){D(e);let a=C();return ut(a.filters.invalid,i)||(a.filters.invalid=i),N(i)}),d(43,"option",116),_(44,"Todos los estados"),u(),d(45,"option",116),_(46,"Solo V\xE1lidas"),u(),d(47,"option",116),_(48,"Solo Invalidadas"),u()()()(),d(49,"div",117)(50,"div",107)(51,"label"),_(52,"Fecha Inicio"),u(),d(53,"div",101),j(54,"i",118),d(55,"input",119),ht("ngModelChange",function(i){D(e);let a=C();return ut(a.filters.startDate,i)||(a.filters.startDate=i),N(i)}),u()()(),d(56,"div",107)(57,"label"),_(58,"Fecha Fin"),u(),d(59,"div",101),j(60,"i",118),d(61,"input",119),ht("ngModelChange",function(i){D(e);let a=C();return ut(a.filters.endDate,i)||(a.filters.endDate=i),N(i)}),u()()()()(),d(62,"div",120)(63,"div",121)(64,"h3"),j(65,"i",122),_(66," Categor\xEDa"),u(),d(67,"div",123),fe(68,ZT,4,2,"label",124),u()(),fe(69,t7,6,1,"div",125),d(70,"div",121)(71,"h3"),j(72,"i",126),_(73," G\xE9nero"),u(),d(74,"div",127)(75,"button",128),L("click",function(){D(e);let i=C();return N(i.tempSelectedGender="")}),_(76,"Todos"),u(),fe(77,r7,2,3,"button",129),u()()()(),d(78,"div",94)(79,"button",95),L("click",function(){D(e);let i=C();return N(i.closeFilterModal())}),_(80,"Cancelar"),u(),d(81,"button",130),L("click",function(){D(e);let i=C();return N(i.onSearch())}),j(82,"i",131),_(83," Aplicar Filtros "),u()()()()}if(t&2){let e=C();g(15),ft("ngModel",e.memberSearchQuery),P("placeholder",e.selectedMemberName||"Buscar integrante..."),g(),P("ngIf",e.filters.memberId),g(),P("ngIf",e.showMemberResults),g(),P("ngIf",e.isAdmin),g(6),ft("ngModel",e.filters.serviceId),g(3),P("ngForOf",e.services),g(7),P("ngIf",!e.selectedEventLabel),g(),P("ngIf",e.selectedEventLabel),g(),P("ngIf",e.filters.eventId),g(6),ft("ngModel",e.filters.invalid),g(),P("ngValue",void 0),g(2),P("ngValue",!1),g(2),P("ngValue",!0),g(8),ft("ngModel",e.filters.startDate),g(6),ft("ngModel",e.filters.endDate),g(7),P("ngForOf",e.categorias),g(),P("ngIf",e.hasVisibleSubCategories),g(6),wt("active",e.tempSelectedGender===""),g(2),P("ngForOf",e.availableGenders),g(4),P("disabled",e.isLoading)}}function i7(t,r){if(t&1){let e=Pe();d(0,"div",72),L("click",function(){D(e);let i=C();return N(i.closeCalendarModal())}),d(1,"div",147),L("click",function(i){return D(e),N(i.stopPropagation())}),d(2,"div",74)(3,"h2"),_(4,"Seleccionar Evento"),u(),d(5,"button",75),L("click",function(){D(e);let i=C();return N(i.closeCalendarModal())}),_(6,"\xD7"),u()(),d(7,"div",148)(8,"app-service-calendar",149),L("eventSelected",function(i){D(e);let a=C();return N(a.onEventSelected(i))}),u()()()()}if(t&2){let e=C();g(8),P("isAdmin",e.isAdmin)("isSelectionMode",!0)}}var Cu=class t{asistenciaService=Ce(no);authService=Ce(fr);integranteService=Ce(Ri);notificationService=Ce(Kr);branchService=Ce(ba);memberConfigService=Ce(wa);filters={serviceId:"",eventId:"",startDate:"",endDate:"",memberId:"",branchId:"",category:[],subCategory:[],invalid:void 0,gender:""};tempSelectedCategories=[];tempSelectedSubCategories=[];tempSelectedGender="";availableGenders=[{value:"HOMBRE",label:"Hombre"},{value:"MUJER",label:"Mujer"}];showFilterModal=!1;showCalendarModal=!1;selectedEventLabel="";memberSearchQuery="";memberSearchResults=[];selectedMemberName="";showMemberResults=!1;memberSearchSubject=new Bt;services=[];branches=[];attendances=[];categorias=[];isAdmin=!1;currentPage=0;totalPages=0;totalElements=0;isLoading=!1;showInvalidateModal=!1;selectedAttendance;invalidReason="";isInvalidating=!1;showDetailsModal=!1;attendanceDetails;activeDropdownId=null;showExportDropdown=!1;isExporting=!1;ngOnInit(){this.checkPermissions(),this.loadServices(),this.loadAttendances(),this.setupMemberSearch(),this.loadMemberConfigs(),this.isAdmin&&this.loadBranches()}loadMemberConfigs(){this.memberConfigService.getCategories().subscribe({next:r=>this.categorias=r,error:()=>this.notificationService.error("Error al cargar configuraciones de integrantes")})}get availableSubCategories(){if(!this.tempSelectedCategories||this.tempSelectedCategories.length===0){let e=[];for(let n of this.categorias)n.subCategories&&e.push(...n.subCategories);return e}let r=[];for(let e of this.tempSelectedCategories){let n=this.categorias.find(i=>i.id===e);n&&n.subCategories&&r.push(...n.subCategories)}return r}get hasVisibleSubCategories(){return this.tempSelectedCategories.length>0?this.categorias.filter(r=>this.tempSelectedCategories.includes(r.id)).some(r=>r.subCategories&&r.subCategories.length>0):this.categorias.some(r=>r.subCategories&&r.subCategories.length>0)}isTempCategorySelected(r){return this.tempSelectedCategories.includes(r)}toggleTempCategory(r){let e=this.tempSelectedCategories.indexOf(r);if(e>-1){this.tempSelectedCategories.splice(e,1);let n=this.categorias.find(i=>i.id===r);if(n&&n.subCategories){let i=n.subCategories.map(a=>a.id);this.tempSelectedSubCategories=this.tempSelectedSubCategories.filter(a=>!i.includes(a))}}else this.tempSelectedCategories.push(r)}isTempSubCategorySelected(r){return this.tempSelectedSubCategories.includes(r)}toggleTempSubCategory(r){let e=this.tempSelectedSubCategories.indexOf(r);e>-1?this.tempSelectedSubCategories.splice(e,1):this.tempSelectedSubCategories.push(r)}checkPermissions(){this.isAdmin=this.authService.can("ADMINISTRATOR")}loadBranches(){this.branchService.findAll().subscribe({next:r=>this.branches=r,error:()=>this.notificationService.error("Error al cargar las sedes")})}setupMemberSearch(){this.memberSearchSubject.pipe(Ki(1e3),Oi(),Zi(r=>{if(r.length<2)return[{data:[],page:0,size:0,totalPages:0,totalElements:0}];let e={onlyActive:!0,query:r};return this.integranteService.searchMembers(e,0)})).subscribe(r=>{this.memberSearchResults=r.data,this.showMemberResults=this.memberSearchResults.length>0})}onMemberSearchInput(){this.memberSearchSubject.next(this.memberSearchQuery)}selectMember(r){this.filters.memberId=r.id,this.selectedMemberName=r.completeName,this.showMemberResults=!1,this.memberSearchQuery="",this.memberSearchResults=[],this.onSearch()}clearMemberFilter(){this.filters.memberId="",this.selectedMemberName="",this.onSearch()}can(r){return this.authService.can(r)}loadServices(){this.asistenciaService.getServices(!0).subscribe(r=>{this.services=r})}loadAttendances(){this.isLoading=!0;let r={serviceId:this.filters.serviceId||void 0,eventId:this.filters.eventId||void 0,startDate:this.filters.startDate?`${this.filters.startDate}:00`:void 0,endDate:this.filters.endDate?`${this.filters.endDate}:00`:void 0,memberId:this.filters.memberId||void 0,branchId:this.filters.branchId||void 0,category:this.filters.category?.length?this.filters.category:void 0,subCategory:this.filters.subCategory?.length?this.filters.subCategory:void 0,invalid:this.filters.invalid!==void 0&&this.filters.invalid!==null?this.filters.invalid:void 0,gender:this.filters.gender||void 0};console.log("Sending Filters Body:",r),this.asistenciaService.getAttendances(r,this.currentPage).subscribe({next:e=>{this.attendances=e.data,this.totalPages=e.totalPages,this.totalElements=e.totalElements,this.isLoading=!1,this.scrollToTop()},error:e=>{console.error("Error loading attendances:",e),this.isLoading=!1}})}onSearch(){this.filters.category=[...this.tempSelectedCategories],this.filters.subCategory=[...this.tempSelectedSubCategories],this.filters.gender=this.tempSelectedGender,this.currentPage=0,this.loadAttendances(),this.closeFilterModal()}openFilterModal(){this.tempSelectedCategories=[...this.filters.category||[]],this.tempSelectedSubCategories=[...this.filters.subCategory||[]],this.tempSelectedGender=this.filters.gender||"",this.showFilterModal=!0}closeFilterModal(){this.showFilterModal=!1}openCalendarModal(){this.showCalendarModal=!0}closeCalendarModal(){this.showCalendarModal=!1}onEventSelected(r){this.filters.eventId=r.id;let e=new Date(r.startDateTime).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),n=new Date(r.startDateTime).toLocaleDateString();this.selectedEventLabel=`${r.serviceName} (${n} ${e})`,this.showCalendarModal=!1}clearEventFilter(){this.filters.eventId="",this.selectedEventLabel="",this.onSearch()}nextPage(){this.currentPage<this.totalPages-1&&(this.currentPage++,this.loadAttendances())}prevPage(){this.currentPage>0&&(this.currentPage--,this.loadAttendances())}viewDetails(r){this.attendanceDetails=r,this.showDetailsModal=!0}closeDetailsModal(){this.showDetailsModal=!1,this.attendanceDetails=void 0}openInvalidateModal(r){r.invalid||(this.selectedAttendance=r,this.invalidReason="",this.showInvalidateModal=!0)}closeInvalidateModal(){this.showInvalidateModal=!1,this.selectedAttendance=void 0,this.invalidReason=""}confirmInvalidate(){!this.selectedAttendance||!this.invalidReason.trim()||(this.isInvalidating=!0,this.asistenciaService.invalidateAttendance({attendanceId:this.selectedAttendance.id,invalidReason:this.invalidReason}).subscribe({next:()=>{this.isInvalidating=!1,this.closeInvalidateModal(),this.loadAttendances(),this.notificationService.success("Asistencia invalidada correctamente")},error:r=>{console.error("Error invalidating attendance:",r),this.isInvalidating=!1}}))}getBadgeClass(r){switch(typeof r=="string"?r:r?.name){case"DAMAS":return"badge-damas";case"CABALLEROS":return"badge-caballeros";case"JOVENES":return"badge-jovenes";case"NI\xD1OS":return"badge-ninos";default:return""}}formatType(r){return r?typeof r=="string"?r.replace(/_/g," "):r.name||"":""}formatCategory(r){return r?typeof r=="string"?r:r.name||"":""}toggleDropdown(r,e){r.stopPropagation(),this.activeDropdownId=this.activeDropdownId===e?null:e}closeDropdown(){this.activeDropdownId=null}getBranchName(r){if(!r)return"";let e=this.branches.find(n=>n.id===r);return e?e.name:"Desconocido"}exportData(r){this.isExporting=!0,this.showExportDropdown=!1;let e={serviceId:this.filters.serviceId||void 0,eventId:this.filters.eventId||void 0,startDate:this.filters.startDate?`${this.filters.startDate}:00`:void 0,endDate:this.filters.endDate?`${this.filters.endDate}:00`:void 0,memberId:this.filters.memberId||void 0,branchId:this.filters.branchId||void 0,category:this.filters.category?.length?this.filters.category:void 0,subCategory:this.filters.subCategory?.length?this.filters.subCategory:void 0,invalid:this.filters.invalid!==void 0&&this.filters.invalid!==null?this.filters.invalid:void 0,gender:this.filters.gender||void 0};this.asistenciaService.exportAttendances(e).subscribe({next:n=>{let i=n.data;r==="excel"?this.downloadExcel(i):this.downloadPDF(i),this.isExporting=!1,this.notificationService.success(`Asistencias exportadas a ${r==="excel"?"Excel":"PDF"}`)},error:n=>{console.error("Error exporting attendances:",n),this.isExporting=!1,this.notificationService.error("Error al exportar las asistencias")}})}downloadExcel(r){let e=r.map(o=>({Integrante:o.memberCompleteName,Servicio:o.serviceName,Sede:o.branchName,Categor\u00EDa:o.memberCategory?.name||"","Sub-Categor\xEDa":o.subCategory?.name||"","Fecha Servicio":ws(o.serviceDate,"dd/MM/yyyy HH:mm","en-US"),"Hora Llegada":ws(o.attendanceDate,"HH:mm","en-US"),Estado:o.invalid?"Inv\xE1lida":"V\xE1lida","Registrada Por":o.registeredBy,Nota:o.note||""})),n=lo.json_to_sheet(e),i=lo.book_new();lo.book_append_sheet(i,n,"Asistencias");let a=e.reduce((o,s)=>Math.max(o,...Object.values(s).map(l=>l?l.toString().length:0)),10);n["!cols"]=Object.keys(e[0]).map(()=>({wch:a+5})),Rf(i,`Asistencias_${ws(new Date,"yyyyMMdd_HHmm","en-US")}.xlsx`)}downloadPDF(r){let e=new bt("l","mm","a4");e.setFontSize(18),e.text("Reporte de Asistencias",14,22),e.setFontSize(11),e.setTextColor(100),e.text(`Generado el: ${ws(new Date,"dd/MM/yyyy HH:mm","en-US")}`,14,30);let n=r.map(i=>[i.memberCompleteName,i.serviceName,i.branchName,i.memberCategory?.name||"",i.serviceDate?ws(i.serviceDate,"dd/MM/yyyy HH:mm","en-US"):"",i.attendanceDate?ws(i.attendanceDate,"HH:mm","en-US"):"",i.invalid?"Inv\xE1lida":"V\xE1lida"]);sd(e,{startY:35,head:[["Integrante","Servicio","Sede","Categor\xEDa","Fecha Serv.","Llegada","Estado"]],body:n,theme:"striped",headStyles:{fillColor:[63,81,181],textColor:[255,255,255]},alternateRowStyles:{fillColor:[245,245,245]},margin:{top:35}}),e.save(`Asistencias_${ws(new Date,"yyyyMMdd_HHmm","en-US")}.pdf`)}toggleExportDropdown(r){r.stopPropagation(),this.showExportDropdown=!this.showExportDropdown,this.activeDropdownId=null}scrollToTop(){[".page-container",".table-container",".full-table",".list-container"].forEach(e=>{let n=document.querySelector(e);n&&n.scrollTo({top:0,behavior:"smooth"})}),window.scrollTo({top:0,behavior:"smooth"})}static \u0275fac=function(e){return new(e||t)};static \u0275cmp=ir({type:t,selectors:[["app-administrar-asistencias"]],hostBindings:function(e,n){e&1&&L("click",function(){return n.closeDropdown()},to)},decls:48,vars:22,consts:[[1,"asistencia-container"],[1,"card","premium-card"],[1,"asistencia-header-actions"],[1,"btn","btn-action-soft",3,"click"],[1,"fa-solid","fa-sliders"],[1,"export-dropdown-wrapper"],[1,"btn","btn-action-soft","export-btn",3,"click","disabled"],[1,"fa-solid"],[1,"fa-solid","fa-chevron-down",2,"font-size","0.6rem","margin-left","4px"],["class","export-dropdown-menu",3,"click",4,"ngIf"],["class","active-filters-row",4,"ngIf"],[1,"table-container"],[1,"premium-table"],[1,"desktop-only"],[1,"text-center","desktop-only"],[1,"text-center"],[4,"ngIf"],[1,"asistencia-footer"],[1,"pagination-mini"],[1,"pagination-buttons"],[1,"btn-icon-sm",3,"click","disabled"],[1,"fa-solid","fa-chevron-left"],[1,"fa-solid","fa-chevron-right"],["class","modal-overlay",3,"click",4,"ngIf"],[1,"export-dropdown-menu",3,"click"],[1,"dropdown-item",3,"click"],[1,"fa-solid","fa-file-excel","text-success"],[1,"fa-solid","fa-file-pdf","text-danger"],[1,"active-filters-row"],[1,"active-filters-chips"],["class","filter-chip",4,"ngIf"],[1,"filter-chip"],[3,"click"],[1,"fa-solid","fa-building"],[1,"fa-solid","fa-calendar-check"],["colspan","7",2,"padding","0","border","none"],[1,"loading-container"],[1,"loading-spinner"],[3,"invalid-row",4,"ngFor","ngForOf"],[1,"user-info-cell"],[1,"user-fullname"],["class","member-types-badges","style","margin-top: 4px; display: flex; gap: 4px; flex-wrap: wrap;",4,"ngIf"],[1,"status-indicator"],[1,"actions-mini","justify-center"],[1,"desktop-only","desktop-actions"],["title","Ver detalles",1,"action-btn-sm","view",3,"click"],[1,"fa-solid","fa-eye"],["class","action-btn-sm delete","title","Invalidar",3,"click",4,"ngIf"],[1,"mobile-only","mobile-actions-wrapper"],[1,"menu-trigger",3,"click"],[1,"fa-solid","fa-ellipsis-vertical"],["class","action-dropdown",3,"click",4,"ngIf"],[1,"member-types-badges",2,"margin-top","4px","display","flex","gap","4px","flex-wrap","wrap"],[1,"badge","badge-category"],["class","badge badge-outline",3,"borderColor","color",4,"ngIf"],[1,"badge","badge-outline"],["title","Invalidar",1,"action-btn-sm","delete",3,"click"],[1,"fa-solid","fa-ban"],[1,"action-dropdown",3,"click"],[1,"dropdown-header-mobile"],[1,"member-name-small"],[1,"dropdown-item","status-row"],[1,"dropdown-label"],[1,"status-indicator-small"],[1,"arrival-time-small"],[1,"dropdown-divider"],[1,"fa-solid","fa-eye","text-primary"],["class","dropdown-item",3,"click",4,"ngIf"],[1,"fa-solid","fa-ban","text-danger"],[1,"text-danger"],["colspan","7",1,"empty-state",2,"text-align","center","padding","2rem","color","var(--text-muted)"],[1,"fa-solid","fa-calendar-xmark",2,"font-size","2rem","display","block","margin-bottom","0.5rem","opacity","0.4"],[1,"modal-overlay",3,"click"],[1,"modal-content",3,"click"],[1,"modal-header"],[1,"close-btn",3,"click"],["class","modal-body",4,"ngIf"],[1,"modal-body"],[1,"details-grid"],[1,"detail-item","full"],[1,"highlight"],[1,"detail-item"],[1,"badge","badge-sm",3,"ngClass"],[1,"badge","badge-sm","badge-outline"],["class","detail-item",4,"ngIf"],["class","detail-item full",4,"ngIf"],["class","invalid-details-section",4,"ngIf"],[1,"note-box"],[1,"invalid-details-section"],[1,"fa-solid","fa-circle-exclamation"],[1,"invalid-details-grid"],[1,"reason-box"],[1,"form-group-centered",2,"margin-top","1.5rem"],["rows","4","placeholder","Escribe el motivo aqu\xED...","maxlength","240",1,"premium-input","no-icon",2,"resize","vertical",3,"ngModelChange","ngModel"],[1,"modal-footer"],[1,"btn","btn-muted",3,"click"],[1,"btn","btn-danger",3,"click","disabled"],[1,"modal-content","filter-modal",3,"click"],[1,"fa-solid","fa-filter"],[1,"filter-form-layout"],[1,"input-with-label","member-filter-relative"],[1,"input-icon-wrapper"],[1,"fa-solid","fa-user"],["type","text",1,"premium-input",3,"ngModelChange","input","focus","ngModel","placeholder"],["class","clear-selection-btn",3,"click",4,"ngIf"],["class","search-results-dropdown",4,"ngIf"],["class","input-with-label",4,"ngIf"],[1,"input-with-label"],[1,"fa-solid","fa-church"],[1,"premium-input",3,"ngModelChange","ngModel"],["value",""],[3,"value",4,"ngFor","ngForOf"],[1,"event-selection-display",3,"click"],["class","placeholder-text",4,"ngIf"],["class","selected-text",4,"ngIf"],[1,"fa-solid","fa-check-double"],[3,"ngValue"],[1,"date-range-grid"],[1,"fa-solid","fa-calendar"],["type","datetime-local",1,"premium-input",3,"ngModelChange","ngModel"],[1,"filters-grid",2,"margin-top","1rem"],[1,"filter-section"],[1,"fa-solid","fa-users-rectangle"],[1,"checkbox-group"],["class","checkbox-label",4,"ngFor","ngForOf"],["class","filter-section",4,"ngIf"],[1,"fa-solid","fa-venus-mars"],[1,"trip-switch"],["type","button",3,"click"],["type","button",3,"active","click",4,"ngFor","ngForOf"],[1,"btn","btn-primary",3,"click","disabled"],[1,"fa-solid","fa-magnifying-glass"],[1,"clear-selection-btn",3,"click"],[1,"search-results-dropdown"],["class","search-result-item",3,"click",4,"ngFor","ngForOf"],[1,"search-result-item",3,"click"],[1,"avatar-sm",3,"src"],[1,"result-info"],[3,"value"],[1,"placeholder-text"],[1,"selected-text"],[1,"checkbox-label"],["type","checkbox",3,"change","checked"],[1,"fa-solid","fa-users-viewfinder"],[1,"filters-grid-nested"],[4,"ngFor","ngForOf"],[1,"nested-category-title"],[1,"modal-content","calendar-selection-modal",3,"click"],[1,"modal-body","calendar-modal-body"],[3,"eventSelected","isAdmin","isSelectionMode"]],template:function(e,n){e&1&&(d(0,"div",0)(1,"div",1)(2,"div",2)(3,"button",3),L("click",function(){return n.openFilterModal()}),j(4,"i",4),_(5," Filtros Avanzados "),u(),d(6,"div",5)(7,"button",6),L("click",function(a){return n.toggleExportDropdown(a)}),j(8,"i",7),_(9),j(10,"i",8),u(),fe(11,yT,9,0,"div",9),u()(),fe(12,ET,5,3,"div",10),d(13,"div",11)(14,"table",12)(15,"thead")(16,"tr")(17,"th"),_(18,"INTEGRANTE"),u(),d(19,"th"),_(20,"SERVICIO"),u(),d(21,"th"),_(22,"SEDE"),u(),d(23,"th",13),_(24,"INICIO DE SERVICIO"),u(),d(25,"th",13),_(26,"HORA DE LLEGADA"),u(),d(27,"th",14),_(28,"ESTADO"),u(),d(29,"th",15),_(30,"ACCIONES"),u()()(),d(31,"tbody"),fe(32,MT,6,0,"tr",16)(33,DT,2,1,"ng-container",16)(34,NT,4,0,"tr",16),u()()(),d(35,"div",17)(36,"div",18)(37,"span"),_(38),u(),d(39,"div",19)(40,"button",20),L("click",function(){return n.prevPage()}),j(41,"i",21),u(),d(42,"button",20),L("click",function(){return n.nextPage()}),j(43,"i",22),u()()()()()(),fe(44,VT,8,1,"div",23)(45,zT,22,4,"div",23)(46,n7,84,22,"div",23)(47,i7,9,2,"div",23)),e&2&&(g(7),P("disabled",n.isExporting),g(),wt("fa-file-export",!n.isExporting)("fa-spinner",n.isExporting)("fa-spin",n.isExporting),g(),je(" ",n.isExporting?"Exportando...":"Exportar"," "),g(2),P("ngIf",n.showExportDropdown),g(),P("ngIf",n.selectedMemberName||n.filters.serviceId||n.filters.startDate||n.filters.endDate||n.filters.branchId||n.selectedEventLabel),g(20),P("ngIf",n.isLoading),g(),P("ngIf",!n.isLoading),g(),P("ngIf",n.attendances.length===0&&!n.isLoading),g(4),_a("P\xE1gina ",n.currentPage+1," de ",n.totalPages||1," (Total: ",n.totalElements,")"),g(2),P("disabled",n.currentPage===0),g(2),P("disabled",n.currentPage>=n.totalPages-1),g(2),P("ngIf",n.showDetailsModal),g(),P("ngIf",n.showInvalidateModal),g(),P("ngIf",n.showFilterModal),g(),P("ngIf",n.showCalendarModal))},dependencies:[gr,Tr,rn,mr,on,Fi,Di,nn,Ii,an,Yl,Vn,Kl,Ji],styles:['[_nghost-%COMP%]{display:block;height:100%;width:100%;min-height:0}.btn-fixed-services[_ngcontent-%COMP%]{position:fixed;top:5.5rem;right:2rem;z-index:1000;background:var(--primary);color:#fff;border:none;padding:.75rem 1.25rem;border-radius:9999px;font-weight:700;display:flex;align-items:center;gap:.75rem;box-shadow:0 10px 15px -3px rgba(var(--primary-rgb),.3);cursor:pointer;transition:all .3s cubic-bezier(.4,0,.2,1);font-size:.85rem}.btn-fixed-services[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 20px 25px -5px rgba(var(--primary-rgb),.4);background:var(--primary-dark)}.btn-fixed-services[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:1rem;animation:_ngcontent-%COMP%_gear-spin 8s linear infinite}@keyframes _ngcontent-%COMP%_gear-spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.asistencia-container[_ngcontent-%COMP%]{height:100%;width:100%;display:flex;flex-direction:column;min-height:0;box-sizing:border-box;background:var(--bg-main)}.premium-card[_ngcontent-%COMP%]{background:var(--bg-card);border-radius:12px;box-shadow:var(--shadow-sm);padding:1.25rem;height:100%;display:flex;flex-direction:column;min-height:0;overflow:hidden}.asistencia-header[_ngcontent-%COMP%]{margin-bottom:1.25rem;width:100%}.asistencia-header-actions[_ngcontent-%COMP%]{display:flex;justify-content:flex-start;align-items:center;margin-bottom:.75rem;padding-bottom:.75rem;border-bottom:1px solid var(--border-color);flex-wrap:wrap;gap:1rem}.active-filters-row[_ngcontent-%COMP%]{margin-bottom:1.25rem;padding-bottom:1rem;border-bottom:1px dashed var(--border-color);width:100%}.active-filters-chips[_ngcontent-%COMP%]{display:flex;gap:.75rem;flex-wrap:wrap}.filter-chip[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;padding:.4rem .8rem;background:var(--primary);color:#fff;border-radius:9999px;font-size:.75rem;font-weight:700}.filter-chip[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background:none;border:none;color:#fff;cursor:pointer;font-size:1.1rem;display:flex;align-items:center;padding:0;line-height:1}.filter-group[_ngcontent-%COMP%]{display:flex;gap:1rem;align-items:flex-end;flex-wrap:wrap;width:100%}.registration-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(180px,1fr));gap:.75rem;align-items:flex-end;width:100%}.input-with-label[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.35rem}.input-with-label[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:.65rem;font-weight:700;color:var(--text-muted);text-transform:uppercase}.input-icon-wrapper[_ngcontent-%COMP%]{position:relative;display:flex;align-items:center}.input-icon-wrapper[_ngcontent-%COMP%] > i[_ngcontent-%COMP%]{position:absolute;left:.85rem;color:var(--primary);font-size:.9rem;pointer-events:none;z-index:5}.search-icon-btn[_ngcontent-%COMP%]{position:absolute;left:.65rem;top:50%;transform:translateY(-50%);width:2.25rem;height:100%;color:var(--primary);font-size:.9rem;background:transparent;border:none;cursor:pointer;display:flex;align-items:center;justify-content:center;z-index:10;padding:0;transition:all .2s ease}.search-icon-btn[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{position:static;pointer-events:none}.premium-input[_ngcontent-%COMP%]{padding:.5rem 1rem .5rem 2.5rem;border:1.5px solid var(--border-color);border-radius:10px;font-size:.8rem;background:var(--bg-input);color:var(--text-main);transition:all .3s ease}.premium-input[_ngcontent-%COMP%]:focus{border-color:var(--primary);box-shadow:0 0 0 4px rgba(var(--primary-rgb),.1);outline:none;background:var(--bg-card)}.search-wrapper[_ngcontent-%COMP%], .search-wrapper[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%}.search-group[_ngcontent-%COMP%]{min-width:250px}.table-container[_ngcontent-%COMP%]{flex:1;overflow:auto;border:1px solid var(--border-color);border-radius:8px;background:var(--bg-card);min-height:0}.premium-table[_ngcontent-%COMP%]{width:100%;border-collapse:separate;border-spacing:0}.premium-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{position:sticky;top:0;background:var(--bg-input);padding:.6rem .75rem;font-size:.65rem;font-weight:700;color:var(--text-muted);text-align:left;border-bottom:2px solid var(--border-color);text-transform:uppercase;z-index:10;text-align:center}.premium-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:.4rem .75rem;border-bottom:1px solid var(--border-color);vertical-align:middle;font-size:.8rem;color:var(--text-main);text-align:left}.user-info-cell[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.75rem}.avatar-cell[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:32px;height:32px;border-radius:50%;object-fit:cover;border:1px solid var(--bg-card);box-shadow:0 2px 4px -1px #0000001a}.user-fullname[_ngcontent-%COMP%]{font-weight:700;color:var(--text-main);font-size:.8rem}.actions-mini[_ngcontent-%COMP%]{display:flex;gap:.5rem;align-items:center}.label-with-toggle[_ngcontent-%COMP%]{display:flex;justify-content:left;align-items:center;width:100%;gap:.5rem}.toggle-wrapper[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem}.toggle-label[_ngcontent-%COMP%]{font-size:.65rem;font-weight:600;color:var(--primary)}.switch-xs[_ngcontent-%COMP%]{position:relative;display:inline-block;width:28px;height:16px}.switch-xs[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{opacity:0;width:0;height:0}.switch-xs[_ngcontent-%COMP%]   .slider[_ngcontent-%COMP%]{position:absolute;cursor:pointer;inset:0;background-color:var(--border-color);transition:.4s;border-radius:34px}.switch-xs[_ngcontent-%COMP%]   .slider[_ngcontent-%COMP%]:before{position:absolute;content:"";height:12px;width:12px;left:2px;bottom:2px;background-color:#fff;transition:.4s;border-radius:50%}.switch-xs[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:checked + .slider[_ngcontent-%COMP%]{background-color:var(--primary)}.switch-xs[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:checked + .slider[_ngcontent-%COMP%]:before{transform:translate(12px)}.input-icon-wrapper.disabled[_ngcontent-%COMP%]{opacity:.7;pointer-events:none;background:var(--bg-input);border-radius:10px}.action-btn-sm[_ngcontent-%COMP%]:hover{background:var(--bg-input);color:var(--primary)}.action-btn-sm.view[_ngcontent-%COMP%]:hover{color:var(--primary)}.action-btn-sm.edit[_ngcontent-%COMP%]:hover{color:var(--primary);background:var(--primary-bg)}.action-btn-sm.delete[_ngcontent-%COMP%]:hover{color:var(--danger);background:var(--danger-bg)}.text-center[_ngcontent-%COMP%]{text-align:center}.justify-center[_ngcontent-%COMP%]{justify-content:center}.flex-1[_ngcontent-%COMP%]{flex:1}.checkbox-container-mini[_ngcontent-%COMP%]{display:block;position:relative;width:20px;height:20px;cursor:pointer;-webkit-user-select:none;user-select:none}.checkbox-container-mini[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{position:absolute;opacity:0;cursor:pointer;height:0;width:0}.checkbox-container-mini[_ngcontent-%COMP%]   .checkmark[_ngcontent-%COMP%]{position:absolute;top:0;left:0;height:20px;width:20px;background-color:var(--bg-input);border:2px solid var(--border-color);border-radius:6px;transition:all .2s cubic-bezier(.4,0,.2,1)}.checkbox-container-mini[_ngcontent-%COMP%]:hover   input[_ngcontent-%COMP%] ~ .checkmark[_ngcontent-%COMP%]{border-color:var(--primary);background-color:var(--bg-card)}.checkbox-container-mini[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:checked ~ .checkmark[_ngcontent-%COMP%]{background-color:var(--primary);border-color:var(--primary)}.checkbox-container-mini[_ngcontent-%COMP%]   .checkmark[_ngcontent-%COMP%]:after{content:"";position:absolute;display:none;left:6px;top:2px;width:5px;height:10px;border:solid var(--white);border-width:0 2px 2px 0;transform:rotate(45deg)}.checkbox-container-mini[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:checked ~ .checkmark[_ngcontent-%COMP%]:after{display:block}.checkbox-container[_ngcontent-%COMP%]{display:block;position:relative;padding-left:28px;cursor:pointer;font-size:22px;-webkit-user-select:none;user-select:none}.checkbox-container[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{position:absolute;opacity:0;cursor:pointer;height:0;width:0}.checkmark[_ngcontent-%COMP%]{position:absolute;top:-12px;left:0;height:24px;width:24px;background-color:var(--bg-input);border:2px solid var(--border-color);border-radius:6px;transition:all .2s cubic-bezier(.4,0,.2,1)}.checkbox-container[_ngcontent-%COMP%]:hover   input[_ngcontent-%COMP%] ~ .checkmark[_ngcontent-%COMP%]{border-color:var(--primary);background-color:var(--bg-card)}.checkbox-container[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:checked ~ .checkmark[_ngcontent-%COMP%]{background-color:var(--primary);border-color:var(--primary);box-shadow:0 4px 6px -1px rgba(var(--primary-rgb),.3)}.checkmark[_ngcontent-%COMP%]:after{content:"";position:absolute;display:none}.checkbox-container[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:checked ~ .checkmark[_ngcontent-%COMP%]:after{display:block}.checkbox-container[_ngcontent-%COMP%]   .checkmark[_ngcontent-%COMP%]:after{left:7px;top:3px;width:6px;height:12px;border:solid var(--white);border-width:0 2.5px 2.5px 0;transform:rotate(45deg)}.asistencia-footer[_ngcontent-%COMP%]{border-top:1px solid var(--border-color);padding:.75rem 1rem;display:flex;justify-content:space-between;align-items:center;background:var(--bg-card);border-bottom-left-radius:12px;border-bottom-right-radius:12px;min-height:52px;flex-shrink:0;margin:0 -1.25rem -1.25rem;width:calc(100% + 2rem);box-sizing:border-box}.pagination-mini[_ngcontent-%COMP%]{display:flex;align-items:center;gap:1rem;font-size:.85rem;color:var(--text-muted);font-weight:500}.btn-save-attendance[_ngcontent-%COMP%]{background:var(--primary);color:#fff;padding:.6rem 1.75rem;border-radius:10px;font-weight:700;border:none;box-shadow:0 4px 6px -1px rgba(var(--primary-rgb),.3);cursor:pointer;transition:all .3s;font-size:.85rem}.btn-save-attendance[_ngcontent-%COMP%]:hover:not(:disabled){transform:translateY(-2px);box-shadow:0 20px 25px -5px rgba(var(--primary-rgb),.4)}.btn-save-attendance[_ngcontent-%COMP%]:active{transform:translateY(0)}.btn-save-attendance[_ngcontent-%COMP%]:disabled{opacity:.6;cursor:not-allowed}.modal-overlay[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;background-color:#0006;display:flex;align-items:center;justify-content:center;z-index:2000;-webkit-backdrop-filter:blur(4px);backdrop-filter:blur(4px)}.modal-content[_ngcontent-%COMP%]{background:var(--bg-card);width:90%;max-width:550px;max-height:85vh;border-radius:16px;box-shadow:var(--shadow-md);overflow:hidden;display:flex;flex-direction:column}.modal-header[_ngcontent-%COMP%]{padding:1.25rem 1.5rem;border-bottom:1px solid var(--border-color);display:flex;justify-content:space-between;align-items:center;background:var(--bg-input)}.modal-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:1.15rem;font-weight:700;color:var(--text-main)}.close-btn[_ngcontent-%COMP%]{background:var(--border-color);border:none;width:32px;height:32px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:1.25rem;cursor:pointer;color:var(--text-muted)}.modal-body[_ngcontent-%COMP%]{padding:1.5rem;overflow-y:auto}.filter-modal[_ngcontent-%COMP%]{max-width:600px!important}.filter-form-layout[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1.5rem}.date-range-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:1.25rem}@media(max-width:600px){.date-range-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}}.profile-header[_ngcontent-%COMP%]{display:flex;align-items:center;gap:1.5rem;margin-bottom:2rem;padding-bottom:1.25rem;border-bottom:1px dashed var(--border-color)}.profile-header[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:80px;height:80px;border-radius:12px;object-fit:cover;box-shadow:0 4px 6px -1px #0000001a}.profile-title[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin-bottom:.25rem;font-size:1.25rem;font-weight:800}.details-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:1.25rem}.detail-item[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.25rem}.detail-item.full[_ngcontent-%COMP%]{grid-column:span 2}.detail-item[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:.7rem;font-weight:700;color:var(--text-muted);text-transform:uppercase}.detail-item[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:.95rem;font-weight:600;color:var(--text-main)}.text-success[_ngcontent-%COMP%]{color:#10b981}.text-danger[_ngcontent-%COMP%]{color:#ef4444}.invalid-details-section[_ngcontent-%COMP%]{margin-top:2rem;padding-top:1.5rem;border-top:2px dashed var(--danger-bg);background:var(--danger-bg);padding:1.5rem;border-radius:12px}.invalid-details-section[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 1.25rem;font-size:1.1rem;font-weight:700;display:flex;align-items:center;gap:.5rem}.invalid-details-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr;gap:1rem}.invalid-details-grid[_ngcontent-%COMP%]   .detail-item[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.25rem}.reason-box[_ngcontent-%COMP%]{background:var(--bg-card);padding:.75rem 1rem;border-radius:8px;border:1px solid var(--danger-bg);margin:0;font-size:.9rem;color:var(--text-main);line-height:1.5}@media(min-width:768px){.invalid-details-grid[_ngcontent-%COMP%]{grid-template-columns:1fr 1fr}.invalid-details-grid[_ngcontent-%COMP%]   .detail-item[_ngcontent-%COMP%]:first-child{grid-column:span 2}}.services-modal[_ngcontent-%COMP%]{max-width:800px}.service-quick-form[_ngcontent-%COMP%]{background:var(--bg-input);padding:1.25rem;border-radius:12px;border:1px dashed var(--border-color);margin-bottom:1.5rem}.service-quick-form[_ngcontent-%COMP%]   .form-row[_ngcontent-%COMP%]{display:flex;align-items:flex-end;gap:1rem;flex-wrap:wrap}.service-quick-form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]{flex:1;min-width:200px;display:flex;flex-direction:column;gap:.35rem}.service-quick-form[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:.7rem;font-weight:700;color:var(--text-muted);text-transform:uppercase}.service-quick-form[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;padding:.65rem 1rem;border:1.5px solid #e2e8f0;border-radius:8px;font-size:.9rem;background:var(--bg-card);transition:all .2s}.service-quick-form[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{border-color:var(--primary);box-shadow:0 0 0 3px rgba(var(--primary-rgb),.1);outline:none}.btn-add-service[_ngcontent-%COMP%]{padding:.65rem 1.5rem;border-radius:8px;height:42px;display:flex;align-items:center;gap:.5rem;font-weight:600;border:none;cursor:pointer}.modal-divider[_ngcontent-%COMP%]{border:0;border-top:1px solid var(--border-color);margin:1.5rem 0}.services-list-container[_ngcontent-%COMP%]{max-height:400px;overflow-y:auto;border-radius:8px;border:1px solid var(--border-color)}.premium-table.compact[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{padding:.6rem 1rem;font-size:.65rem;background:#f1f5f9}.premium-table.compact[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:.6rem 1rem;font-size:.8rem}.inactive-row[_ngcontent-%COMP%]{background-color:#f9fafb;opacity:.6}.switch-sm[_ngcontent-%COMP%]{position:relative;display:inline-block;width:32px;height:16px;flex-shrink:0}.switch-sm[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{opacity:0;width:0;height:0}.switch-sm[_ngcontent-%COMP%]   .slider[_ngcontent-%COMP%]{position:absolute;cursor:pointer;inset:0;background-color:#cbd5e1;transition:.4s;border-radius:16px}.switch-sm[_ngcontent-%COMP%]   .slider[_ngcontent-%COMP%]:before{position:absolute;content:"";height:10px;width:10px;left:3px;bottom:3px;background-color:#fff;transition:.4s;border-radius:50%}.switch-sm[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:checked + .slider[_ngcontent-%COMP%]{background-color:#10b981}.switch-sm[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:checked + .slider[_ngcontent-%COMP%]:before{transform:translate(16px)}.badge-damas[_ngcontent-%COMP%]{background-color:#fce7f3;color:#be185d}.badge-caballeros[_ngcontent-%COMP%]{background-color:#dbeafe;color:#1d4ed8}.badge-jovenes[_ngcontent-%COMP%]{background-color:#fef3c7;color:#b45309}.badge-ninos[_ngcontent-%COMP%]{background-color:#dcfce7;color:#15803d}.badge[_ngcontent-%COMP%]{padding:.25rem .65rem;border-radius:9999px;font-size:.65rem;font-weight:700}.empty-notes[_ngcontent-%COMP%]{text-align:center;padding:2rem;color:var(--text-muted);font-style:italic;background:var(--bg-input);border-radius:10px;border:1px dashed var(--border-color)}.filters-modal[_ngcontent-%COMP%]{max-width:800px!important;width:90vw!important;max-height:85vh;display:flex;flex-direction:column}.filters-modal[_ngcontent-%COMP%]   .modal-body[_ngcontent-%COMP%]{padding:0;overflow-y:auto;background:var(--bg-card)}.filters-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(280px,1fr));gap:1.5rem}.filter-section[_ngcontent-%COMP%]{background:var(--bg-input);padding:1rem;border-radius:10px;border:1px solid var(--border-color)}.filter-section[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:.85rem;font-weight:700;color:var(--text-muted);text-transform:uppercase;margin-bottom:1rem;letter-spacing:.5px;display:flex;align-items:center;gap:.5rem}.filter-section[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]:before{content:"";display:block;width:4px;height:14px;background:var(--primary);border-radius:2px}.checkbox-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.6rem;max-height:200px;overflow-y:auto;padding-right:.5rem}.checkbox-group[_ngcontent-%COMP%]::-webkit-scrollbar{width:4px}.checkbox-group[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:transparent}.checkbox-group[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:var(--border-color);border-radius:4px}.checkbox-label[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.6rem;cursor:pointer;font-size:.9rem;color:var(--text-main);transition:all .2s;padding:.25rem 0}.checkbox-label[_ngcontent-%COMP%]:hover{color:var(--primary)}.checkbox-label[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]{width:16px;height:16px;accent-color:var(--primary);cursor:pointer}.filters-grid-nested[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1rem}.nested-category-title[_ngcontent-%COMP%]{font-size:.8rem;font-weight:700;color:var(--primary);margin-bottom:.5rem;padding-bottom:.25rem;border-bottom:1px dashed var(--border-color)}.full-width[_ngcontent-%COMP%]{grid-column:1 / -1}.data-filters-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:1rem}.data-filter-item[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.5rem}.data-filter-item[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:.8rem;font-weight:600;color:var(--text-muted)}.trip-switch[_ngcontent-%COMP%]{display:flex;background:var(--bg-card);padding:3px;border-radius:8px;border:1px solid var(--border-color);width:fit-content}.trip-switch[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:4px 12px;font-size:.8rem;font-weight:600;border:none;background:transparent;border-radius:6px;cursor:pointer;color:var(--text-muted);transition:all .2s;min-width:50px}.trip-switch[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{color:var(--text-main)}.trip-switch[_ngcontent-%COMP%]   button.active[_ngcontent-%COMP%]{background:var(--primary);color:#fff;box-shadow:0 2px 4px rgba(var(--primary-rgb),.3)}.age-range-inputs[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem}.age-range-inputs[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{flex:1;padding:.5rem;border:1px solid var(--border-color);border-radius:8px;background:var(--bg-card);font-size:.9rem;text-align:center}.age-range-inputs[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{border-color:var(--primary);outline:none}.full-width-input[_ngcontent-%COMP%]{width:100%;padding:.6rem;border:1px solid var(--border-color);border-radius:8px;background:var(--bg-card);font-size:.9rem}.full-width-input[_ngcontent-%COMP%]:focus{border-color:var(--primary);outline:none}.filters-modal[_ngcontent-%COMP%]   .modal-footer[_ngcontent-%COMP%]{padding:1rem 1.5rem;background:var(--bg-input);border-top:1px solid var(--border-color);display:flex;justify-content:flex-end;gap:1rem}@media(max-width:768px){.filters-modal[_ngcontent-%COMP%]{width:95%!important;max-width:95%!important}.filters-grid[_ngcontent-%COMP%]{grid-template-columns:1fr;gap:1rem}.data-filters-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}.premium-card[_ngcontent-%COMP%]{padding:.5rem}.header-section[_ngcontent-%COMP%]{padding:.5rem;gap:.5rem;margin-bottom:.5rem}.mobile-config-trigger[_ngcontent-%COMP%]{margin-bottom:.25rem!important}}.empty-state[_ngcontent-%COMP%]{padding:4rem!important;text-align:center;color:#94a3b8;border:none!important}.invalid-row[_ngcontent-%COMP%]{background-color:#dc35450d!important}.invalid-row[_ngcontent-%COMP%]:hover{background-color:#dc35451a!important}.status-indicator[_ngcontent-%COMP%]{padding:.25rem .75rem;border-radius:1rem;font-size:.75rem;font-weight:600;text-transform:uppercase;background:#28a7451a;color:#28a745}.status-indicator.invalid[_ngcontent-%COMP%]{background:#dc35451a;color:#dc3545}.highlight[_ngcontent-%COMP%]{font-weight:700;color:var(--primary-color);font-size:1.1rem}.note-box[_ngcontent-%COMP%], .reason-box[_ngcontent-%COMP%]{background:#f8f9fa;padding:.75rem;border-radius:.5rem;border-left:4px solid #2563eb;margin:.5rem 0}.reason-box[_ngcontent-%COMP%]{border-left-color:#dc3545}.invalid-details[_ngcontent-%COMP%]{margin-top:1.5rem;padding-top:1.5rem;border-top:2px dashed #dee2e6}.invalid-details[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:1rem;margin-bottom:1rem;display:flex;align-items:center;gap:.5rem}.modal-footer[_ngcontent-%COMP%]{padding:1.5rem;border-top:1px solid #dee2e6;display:flex;justify-content:flex-end;gap:1rem}.btn-danger[_ngcontent-%COMP%]{background:#dc3545;color:#fff;border:none;padding:.5rem 1rem;border-radius:.5rem;cursor:pointer}.btn-danger[_ngcontent-%COMP%]:hover{background:#c82333;box-shadow:0 4px 12px #dc35454d}.action-btn-sm.edit.has-note[_ngcontent-%COMP%]{background-color:#2563eb1a;color:#2563eb;border-color:#2563eb}.small-modal[_ngcontent-%COMP%]{max-width:400px!important}.member-filter-relative[_ngcontent-%COMP%]{position:relative}.clear-selection-btn[_ngcontent-%COMP%]{position:absolute;right:.75rem;background:#e2e8f0;border:none;border-radius:50%;width:20px;height:20px;display:flex;align-items:center;justify-content:center;cursor:pointer;font-size:14px;color:#64748b;z-index:10}.search-results-dropdown[_ngcontent-%COMP%]{position:absolute;top:100%;left:0;right:0;background:var(--bg-card);border-radius:12px;box-shadow:0 10px 15px -3px #0000001a;border:1px solid #e2e8f0;margin-top:.5rem;max-height:250px;overflow-y:auto;z-index:1000}.search-result-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.75rem;padding:.75rem 1rem;cursor:pointer;transition:background .2s}.search-result-item[_ngcontent-%COMP%]:hover{background:#f8fafc}.search-result-item[_ngcontent-%COMP%]   .avatar-sm[_ngcontent-%COMP%]{width:32px;height:32px;border-radius:50%;object-fit:cover}.result-info[_ngcontent-%COMP%]{display:flex;flex-direction:column}.result-info[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{font-size:.85rem;color:#1e293b}.result-info[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:.75rem;color:#64748b}.search-actions-row[_ngcontent-%COMP%]{margin-top:1.5rem;display:flex;justify-content:center;width:100%}.btn-filter-trigger[_ngcontent-%COMP%]{padding:.6rem 1.25rem;font-size:.85rem;font-weight:700;border-radius:10px;background:linear-gradient(135deg,var(--primary) 0%,#4338ca 100%);box-shadow:0 4px 6px -1px rgba(var(--primary-rgb),.2);transition:all .3s cubic-bezier(.4,0,.2,1);display:flex;align-items:center;justify-content:center;gap:.5rem;color:#fff;border:none;cursor:pointer}.btn-filter-trigger[_ngcontent-%COMP%]:hover:not(:disabled){transform:translateY(-1px);box-shadow:0 10px 15px -3px rgba(var(--primary-rgb),.3);filter:brightness(1.1)}.btn-filter-trigger[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:.9rem}.form-group-centered[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;gap:.75rem;text-align:center}.form-group-centered[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:.85rem;font-weight:700;color:var(--text-muted);text-transform:uppercase;letter-spacing:.5px}.premium-input.no-icon[_ngcontent-%COMP%]{padding-left:1rem;text-align:center;width:100%}@media(max-width:767px){.mobile-hide[_ngcontent-%COMP%]{display:none}.desktop-only[_ngcontent-%COMP%]{display:none!important}.registration-grid[_ngcontent-%COMP%]{grid-template-columns:1fr;gap:1rem}.mobile-config-trigger[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;width:100%;background:var(--bg-card);border:1px solid var(--border-color);padding:.5rem .75rem;border-radius:10px;margin-bottom:.5rem;box-shadow:0 1px 2px #0000000d;cursor:pointer;min-height:40px}.config-info[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:flex-start;gap:0}.service-name[_ngcontent-%COMP%]{font-weight:700;color:var(--text-main);font-size:.85rem}.service-date[_ngcontent-%COMP%]{font-size:.7rem;color:var(--text-muted)}.search-center[_ngcontent-%COMP%]{width:100%;margin-top:.25rem}.search-center[_ngcontent-%COMP%]   .soft-label[_ngcontent-%COMP%]{display:none}}@media(min-width:768px){.mobile-config-trigger[_ngcontent-%COMP%]{display:none}.mobile-only[_ngcontent-%COMP%]{display:none!important}}.filter-form-stack[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1.25rem}.full-width[_ngcontent-%COMP%]{width:100%;justify-content:center}.mobile-actions-wrapper[_ngcontent-%COMP%]{position:relative;display:inline-block}.action-dropdown[_ngcontent-%COMP%]{position:absolute;top:100%;right:0;z-index:1000;background:var(--bg-card);min-width:190px;border-radius:12px;box-shadow:0 10px 25px -5px #0000001a,0 8px 10px -6px #0000001a;border:1px solid var(--border-color);padding:.5rem 0;margin-top:.5rem;animation:_ngcontent-%COMP%_dropdown-fade-in .2s cubic-bezier(.16,1,.3,1)}@keyframes _ngcontent-%COMP%_dropdown-fade-in{0%{opacity:0;transform:translateY(-10px) scale(.95)}to{opacity:1;transform:translateY(0) scale(1)}}.dropdown-header-mobile[_ngcontent-%COMP%]{padding:.5rem 1rem;background:#f8fafc;border-bottom:1px solid var(--border-color);margin-bottom:.4rem;margin-top:-.5rem;border-radius:12px 12px 0 0}.member-name-small[_ngcontent-%COMP%]{font-size:.75rem;font-weight:700;color:var(--text-muted);display:block;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;text-align:left}.action-dropdown[_ngcontent-%COMP%]   .dropdown-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.75rem;padding:.75rem 1rem;width:100%;border:none;background:none;cursor:pointer;font-size:.85rem;font-weight:600;color:var(--text-main);transition:all .2s;text-align:left;position:relative;z-index:1}.dropdown-label[_ngcontent-%COMP%]{flex:1}.action-dropdown[_ngcontent-%COMP%]   .dropdown-item[_ngcontent-%COMP%]:hover{background:#f1f5f9;color:var(--primary)}.action-dropdown[_ngcontent-%COMP%]   .dropdown-item[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{width:16px;text-align:center;font-size:.9rem}[data-theme="dark"][_nghost-%COMP%]   .action-dropdown[_ngcontent-%COMP%], [data-theme="dark"]   [_nghost-%COMP%]   .action-dropdown[_ngcontent-%COMP%]{background:var(--bg-card);border-color:var(--border-color)}[data-theme="dark"][_nghost-%COMP%]   .dropdown-header-mobile[_ngcontent-%COMP%], [data-theme="dark"]   [_nghost-%COMP%]   .dropdown-header-mobile[_ngcontent-%COMP%]{background:var(--bg-input);border-color:var(--border-color)}[data-theme="dark"][_nghost-%COMP%]   .menu-trigger[_ngcontent-%COMP%], [data-theme="dark"]   [_nghost-%COMP%]   .menu-trigger[_ngcontent-%COMP%]{background:var(--bg-input);color:var(--text-muted)}[data-theme="dark"][_nghost-%COMP%]   .menu-trigger[_ngcontent-%COMP%]:hover, [data-theme="dark"]   [_nghost-%COMP%]   .menu-trigger[_ngcontent-%COMP%]:hover{background:var(--border-color);color:var(--text-main)}[data-theme="dark"][_nghost-%COMP%]   .action-dropdown[_ngcontent-%COMP%]   .dropdown-item[_ngcontent-%COMP%]:hover, [data-theme="dark"]   [_nghost-%COMP%]   .action-dropdown[_ngcontent-%COMP%]   .dropdown-item[_ngcontent-%COMP%]:hover{background:#ffffff0d;color:var(--primary)}.dropdown-divider[_ngcontent-%COMP%]{border:0;border-top:1px solid var(--border-color);margin:.4rem 0}.menu-trigger[_ngcontent-%COMP%]{width:28px;height:28px;border-radius:6px;background:#f1f5f9;color:var(--text-muted);display:flex;align-items:center;justify-content:center;transition:all .2s;border:none;cursor:pointer}.menu-trigger[_ngcontent-%COMP%]:hover{background:#e2e8f0;color:var(--text-main)}.status-indicator-small[_ngcontent-%COMP%]{padding:.2rem .5rem;border-radius:6px;font-size:.7rem;font-weight:700;background:#dcfce7;color:#166534}.status-indicator-small.invalid[_ngcontent-%COMP%]{background:#fee2e2;color:#991b1b}.arrival-time-small[_ngcontent-%COMP%]{font-size:.8rem;font-weight:700;color:var(--primary)}.desktop-actions[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem}.mobile-category-info[_ngcontent-%COMP%]{display:flex;gap:.25rem;margin-top:.25rem;flex-wrap:wrap}.badge-mini[_ngcontent-%COMP%]{font-size:.6rem;padding:.1rem .35rem;border-radius:4px;color:#fff;font-weight:700;text-transform:uppercase}.badge-mini-outline[_ngcontent-%COMP%]{font-size:.6rem;padding:.1rem .35rem;border-radius:4px;background:transparent;border:1px solid;font-weight:700;text-transform:uppercase}.user-info-cell[_ngcontent-%COMP%]{display:flex;align-items:center;gap:1rem}.user-details[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;line-height:1.2}.user-fullname[_ngcontent-%COMP%]{font-weight:600;color:var(--text-main);font-size:.95rem}.user-age-small[_ngcontent-%COMP%]{font-size:.75rem;color:var(--text-muted)}.category-cell[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:4px;align-items:flex-start}.header-layout-v2[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1.5rem;margin-bottom:2rem}.event-banner[_ngcontent-%COMP%]{display:flex;align-items:center;gap:1rem;padding:1rem 1.25rem;border-radius:12px;background:#fff;box-shadow:0 4px 6px -1px #0000000d;border:1px solid var(--border-color);position:relative;overflow:hidden}.event-banner.active-event[_ngcontent-%COMP%]{background:linear-gradient(135deg,#fff,#f8fafc);border-left:4px solid var(--success)}.event-banner.no-event[_ngcontent-%COMP%]{background:#fff;border-left:4px solid #94a3b8}.banner-icon[_ngcontent-%COMP%]   .icon-circle[_ngcontent-%COMP%]{width:36px;height:36px;border-radius:10px;background:#22c55e1a;color:var(--success);display:flex;align-items:center;justify-content:center;font-size:1rem}.banner-icon[_ngcontent-%COMP%]   .icon-circle.warning[_ngcontent-%COMP%]{background:#94a3b81a;color:#94a3b8}.banner-content[_ngcontent-%COMP%]{flex:1}.banner-label[_ngcontent-%COMP%]{font-size:.65rem;font-weight:700;text-transform:uppercase;letter-spacing:.05em;color:var(--success);margin-bottom:.15rem}.banner-title[_ngcontent-%COMP%]{font-size:1.1rem;font-weight:600;color:var(--text-color);margin:0;line-height:1.2}.banner-subtitle[_ngcontent-%COMP%]{color:#64748b;font-size:.9rem;margin:.25rem 0 0}.banner-meta[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:1rem;margin-top:.25rem}.meta-item[_ngcontent-%COMP%]{font-size:.85rem;color:#64748b;display:flex;align-items:center;gap:.35rem}.banner-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{font-weight:500;font-size:.9rem;display:flex;align-items:center;gap:.5rem;cursor:pointer;transition:all .2s}.btn-text-action[_ngcontent-%COMP%]{background:none;border:none;color:var(--primary);padding:.5rem 1rem;border-radius:8px}.btn-text-action[_ngcontent-%COMP%]:hover{background:#4f46e50d}.past-events-panel[_ngcontent-%COMP%]{background:#fff;border-radius:16px;padding:1.5rem;border:2px dashed var(--primary);background:#f8fafc;display:flex;flex-direction:column;height:600px;max-height:80vh;overflow:hidden}.past-events-panel[_ngcontent-%COMP%]   .panel-body[_ngcontent-%COMP%]{flex:1;min-height:0;overflow:hidden;position:relative;display:flex;flex-direction:column}.panel-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:1rem}.panel-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;font-size:1.1rem;color:var(--primary);display:flex;align-items:center;gap:.5rem}.close-panel-btn[_ngcontent-%COMP%]{background:none;border:none;color:#64748b;cursor:pointer;display:flex;align-items:center;gap:.4rem;font-size:.9rem}.close-panel-btn[_ngcontent-%COMP%]:hover{color:var(--danger)}.soft-input-wrapper.full-width[_ngcontent-%COMP%]{width:100%}.action-bar-v2[_ngcontent-%COMP%]{display:flex;align-items:center;gap:1rem;background:#fff;padding:.75rem;border-radius:14px;border:1px solid var(--border-color);box-shadow:0 2px 4px #00000005;transition:opacity .3s}.action-bar-v2.disabled[_ngcontent-%COMP%]{opacity:.6;pointer-events:none}.search-container[_ngcontent-%COMP%]{flex:1;position:relative;display:flex;align-items:center}.search-icon[_ngcontent-%COMP%]{position:absolute;left:1rem;color:#94a3b8;pointer-events:none}.search-input-modern[_ngcontent-%COMP%]{width:100%;padding:.75rem 1rem .75rem 2.8rem;border:1px solid #e2e8f0;border-radius:10px;font-size:.95rem;font-family:inherit;background:#f8fafc;transition:all .2s}.search-input-modern[_ngcontent-%COMP%]:focus{outline:none;background:#fff;border-color:var(--primary);box-shadow:0 0 0 3px #4f46e51a}.time-control-group[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.75rem;padding-right:.75rem;border-right:1px solid #e2e8f0}.toggle-switch-wrapper[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;cursor:pointer}.switch-modern[_ngcontent-%COMP%]{position:relative;display:inline-block;width:36px;height:20px}.switch-modern[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{opacity:0;width:0;height:0}.slider-modern[_ngcontent-%COMP%]{position:absolute;cursor:pointer;inset:0;background-color:#cbd5e1;transition:.4s;border-radius:20px}.slider-modern[_ngcontent-%COMP%]:before{position:absolute;content:"";height:16px;width:16px;left:2px;bottom:2px;background-color:#fff;transition:.4s;border-radius:50%}input[_ngcontent-%COMP%]:checked + .slider-modern[_ngcontent-%COMP%]{background-color:var(--primary)}input[_ngcontent-%COMP%]:checked + .slider-modern[_ngcontent-%COMP%]:before{transform:translate(16px)}.toggle-label-modern[_ngcontent-%COMP%]{font-size:.85rem;font-weight:500;color:#64748b}.time-input-modern[_ngcontent-%COMP%]{padding:.4rem .6rem;border:1px solid #e2e8f0;border-radius:8px;font-size:.85rem;color:#334155;background:var(--bg-input)}.btn-filter-modern[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.6rem;padding:.75rem 1.25rem;background:#fff;border:1px solid #e2e8f0;border-radius:10px;color:#334155;font-weight:500;cursor:pointer;transition:all .2s;position:relative}.btn-filter-modern[_ngcontent-%COMP%]:hover{background:#f8fafc;border-color:#cbd5e1}.filter-dot[_ngcontent-%COMP%]{position:absolute;top:8px;right:8px;width:8px;height:8px;background:var(--primary);border-radius:50%}[data-theme="dark"][_nghost-%COMP%]   .event-banner[_ngcontent-%COMP%], [data-theme="dark"]   [_nghost-%COMP%]   .event-banner[_ngcontent-%COMP%]{background:#1e293b;border-color:#334155}[data-theme="dark"][_nghost-%COMP%]   .event-banner.active-event[_ngcontent-%COMP%], [data-theme="dark"]   [_nghost-%COMP%]   .event-banner.active-event[_ngcontent-%COMP%]{background:linear-gradient(135deg,#1e293b,#0f172a);border-left-color:var(--success)}[data-theme="dark"][_nghost-%COMP%]   .event-banner.no-event[_ngcontent-%COMP%], [data-theme="dark"]   [_nghost-%COMP%]   .event-banner.no-event[_ngcontent-%COMP%]{background:#1e293b;border-left-color:#475569}[data-theme="dark"][_nghost-%COMP%]   .banner-label[_ngcontent-%COMP%], [data-theme="dark"]   [_nghost-%COMP%]   .banner-label[_ngcontent-%COMP%]{color:#4ade80}[data-theme="dark"][_nghost-%COMP%]   .banner-title[_ngcontent-%COMP%], [data-theme="dark"]   [_nghost-%COMP%]   .banner-title[_ngcontent-%COMP%]{color:#f8fafc}[data-theme="dark"][_nghost-%COMP%]   .banner-subtitle[_ngcontent-%COMP%], [data-theme="dark"]   [_nghost-%COMP%]   .banner-subtitle[_ngcontent-%COMP%]{color:#94a3b8}[data-theme="dark"][_nghost-%COMP%]   .action-bar-v2[_ngcontent-%COMP%], [data-theme="dark"]   [_nghost-%COMP%]   .action-bar-v2[_ngcontent-%COMP%]{background:#1e293b;border-color:#334155}[data-theme="dark"][_nghost-%COMP%]   .search-input-modern[_ngcontent-%COMP%], [data-theme="dark"]   [_nghost-%COMP%]   .search-input-modern[_ngcontent-%COMP%]{background:#0f172a;border-color:#334155;color:#f8fafc}[data-theme="dark"][_nghost-%COMP%]   .btn-filter-modern[_ngcontent-%COMP%], [data-theme="dark"]   [_nghost-%COMP%]   .btn-filter-modern[_ngcontent-%COMP%]{background:#1e293b;border-color:#334155;color:#cbd5e1}[data-theme="dark"][_nghost-%COMP%]   .time-input-modern[_ngcontent-%COMP%], [data-theme="dark"]   [_nghost-%COMP%]   .time-input-modern[_ngcontent-%COMP%]{background:#0f172a;border-color:#334155;color:#f8fafc}[data-theme="dark"][_nghost-%COMP%]   .past-events-panel[_ngcontent-%COMP%], [data-theme="dark"]   [_nghost-%COMP%]   .past-events-panel[_ngcontent-%COMP%]{background:#0f172a;border-color:var(--primary)}@media(max-width:768px){.action-bar-v2[_ngcontent-%COMP%]{flex-wrap:wrap}.search-container[_ngcontent-%COMP%]{width:100%;order:1}.time-control-group[_ngcontent-%COMP%]{order:2;flex:1;border-right:none}.btn-filter-modern[_ngcontent-%COMP%]{order:3}.banner-meta[_ngcontent-%COMP%]{flex-direction:column;gap:.5rem}.event-banner[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start;gap:1rem}.banner-icon[_ngcontent-%COMP%]{display:none}.header-layout-v2[_ngcontent-%COMP%]{margin-bottom:1rem;gap:1rem}}.calendar-selection-modal[_ngcontent-%COMP%]{max-width:900px!important;width:95%!important;height:90vh!important}.calendar-modal-body[_ngcontent-%COMP%]{padding:0!important;display:flex;flex-direction:column;height:100%;overflow:hidden}.calendar-modal-body[_ngcontent-%COMP%]   app-service-calendar[_ngcontent-%COMP%]{flex:1;min-height:0}.event-selection-display[_ngcontent-%COMP%]{width:100%;padding:.5rem 2.5rem;border:1.5px solid var(--border-color);border-radius:10px;background:var(--bg-input);cursor:pointer;min-height:38px;display:flex;align-items:center;transition:all .3s ease}.event-selection-display[_ngcontent-%COMP%]:hover{border-color:var(--primary);background:var(--bg-card)}.event-selection-display[_ngcontent-%COMP%]   .placeholder-text[_ngcontent-%COMP%]{color:var(--text-muted);font-size:.8rem;font-style:italic}.event-selection-display[_ngcontent-%COMP%]   .selected-text[_ngcontent-%COMP%]{color:var(--primary);font-weight:700;font-size:.8rem}.calendar-selection-modal[_ngcontent-%COMP%]{z-index:2050!important}.export-dropdown-wrapper[_ngcontent-%COMP%]{position:relative;display:inline-block}.export-btn[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.6rem;min-width:130px;justify-content:center}.export-dropdown-menu[_ngcontent-%COMP%]{position:absolute;top:100%;right:0;z-index:1050;background:var(--bg-card);min-width:180px;border-radius:12px;box-shadow:var(--shadow-md);border:1px solid var(--border-color);padding:.5rem 0;margin-top:.5rem;animation:_ngcontent-%COMP%_dropdown-fade-in .2s cubic-bezier(.16,1,.3,1)}.export-dropdown-menu[_ngcontent-%COMP%]   .dropdown-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.75rem;padding:.75rem 1rem;width:100%;border:none;background:none;cursor:pointer;font-size:.85rem;font-weight:600;color:var(--text-main);transition:all .2s;text-align:left}.export-dropdown-menu[_ngcontent-%COMP%]   .dropdown-item[_ngcontent-%COMP%]:hover{background:var(--bg-input);color:var(--primary)}.export-dropdown-menu[_ngcontent-%COMP%]   .dropdown-item[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{width:16px;text-align:center;font-size:1rem}.export-dropdown-menu[_ngcontent-%COMP%]   .dropdown-item[_ngcontent-%COMP%]   .text-success[_ngcontent-%COMP%]{color:#10b981}.export-dropdown-menu[_ngcontent-%COMP%]   .dropdown-item[_ngcontent-%COMP%]   .text-danger[_ngcontent-%COMP%]{color:#ef4444}@keyframes _ngcontent-%COMP%_dropdown-fade-in{0%{opacity:0;transform:translateY(-8px) scale(.95)}to{opacity:1;transform:translateY(0) scale(1)}}']})};var Dc=class t{http=Ce(Ai);baseUrl=`${Ti.baseUrl}/reports`;lastReportData=null;lastFilters=null;lastStats=null;lastMemberSelection=null;generateReport(r){return this.http.post(this.baseUrl,r)}static \u0275fac=function(e){return new(e||t)};static \u0275prov=nr({token:t,factory:t.\u0275fac,providedIn:"root"})};var a7=["chart"],Su=(()=>{class t{constructor(){this.chart=qr(),this.annotations=qr(),this.colors=qr(),this.dataLabels=qr(),this.series=qr(),this.stroke=qr(),this.labels=qr(),this.legend=qr(),this.markers=qr(),this.noData=qr(),this.parsing=qr(),this.fill=qr(),this.tooltip=qr(),this.plotOptions=qr(),this.responsive=qr(),this.xaxis=qr(),this.yaxis=qr(),this.forecastDataPoints=qr(),this.grid=qr(),this.states=qr(),this.title=qr(),this.subtitle=qr(),this.theme=qr(),this.autoUpdateSeries=qr(!0),this.chartReady=s1(),this.chartInstance=ga(null),this.chartElement=l1.required("chart"),this.ngZone=Ce(ma),this.isBrowser=Zd(Ce(Yd)),this._destroyed=!1,this._injector=Ce(La),this.waitingForConnectedRef=null}ngOnChanges(e){this.isBrowser&&this.hydrate(e)}ngOnDestroy(){this.destroy(),this._destroyed=!0}get isConnected(){return this.chartElement()?.nativeElement.isConnected}hydrate(e){if(this.waitingForConnectedRef)return;if(this.chartInstance()&&this.autoUpdateSeries()&&Object.keys(e).filter(i=>i!=="series").length===0){this.updateSeries(this.series(),!0);return}f0({read:()=>this.createElement()},{injector:this._injector})}createElement(){return Cn(this,null,function*(){let{default:e}=yield import("./chunk-HXALNZ2F.js");if(window.ApexCharts||=e,this._destroyed)return;if(!this.isConnected){this.waitForConnected();return}let n={};["annotations","chart","colors","dataLabels","series","stroke","labels","legend","fill","tooltip","plotOptions","responsive","markers","noData","parsing","xaxis","yaxis","forecastDataPoints","grid","states","title","subtitle","theme"].forEach(o=>{let s=this[o]();s&&(n[o]=s)}),this.destroy();let a=this.ngZone.runOutsideAngular(()=>new e(this.chartElement().nativeElement,n));this.chartInstance.set(a),this.render(),this.chartReady.emit({chartObj:a})})}render(){if(this.isConnected)return this.ngZone.runOutsideAngular(()=>this.chartInstance()?.render());this.waitForConnected()}updateOptions(e,n,i,a){return this.ngZone.runOutsideAngular(()=>this.chartInstance()?.updateOptions(e,n,i,a))}updateSeries(e,n){return this.ngZone.runOutsideAngular(()=>this.chartInstance()?.updateSeries(e,n))}appendSeries(e,n){this.ngZone.runOutsideAngular(()=>this.chartInstance()?.appendSeries(e,n))}appendData(e){this.ngZone.runOutsideAngular(()=>this.chartInstance()?.appendData(e))}highlightSeries(e){return this.ngZone.runOutsideAngular(()=>this.chartInstance()?.highlightSeries(e))}toggleSeries(e){return this.ngZone.runOutsideAngular(()=>this.chartInstance()?.toggleSeries(e))}showSeries(e){this.ngZone.runOutsideAngular(()=>this.chartInstance()?.showSeries(e))}hideSeries(e){this.ngZone.runOutsideAngular(()=>this.chartInstance()?.hideSeries(e))}resetSeries(){this.ngZone.runOutsideAngular(()=>this.chartInstance()?.resetSeries())}zoomX(e,n){this.ngZone.runOutsideAngular(()=>this.chartInstance()?.zoomX(e,n))}toggleDataPointSelection(e,n){this.ngZone.runOutsideAngular(()=>this.chartInstance()?.toggleDataPointSelection(e,n))}destroy(){this.chartInstance()?.destroy(),this.chartInstance.set(null)}setLocale(e){this.ngZone.runOutsideAngular(()=>this.chartInstance()?.setLocale(e))}paper(){this.ngZone.runOutsideAngular(()=>this.chartInstance()?.paper())}addXaxisAnnotation(e,n,i){this.ngZone.runOutsideAngular(()=>this.chartInstance()?.addXaxisAnnotation(e,n,i))}addYaxisAnnotation(e,n,i){this.ngZone.runOutsideAngular(()=>this.chartInstance()?.addYaxisAnnotation(e,n,i))}addPointAnnotation(e,n,i){this.ngZone.runOutsideAngular(()=>this.chartInstance()?.addPointAnnotation(e,n,i))}removeAnnotation(e,n){this.ngZone.runOutsideAngular(()=>this.chartInstance()?.removeAnnotation(e,n))}clearAnnotations(e){this.ngZone.runOutsideAngular(()=>this.chartInstance()?.clearAnnotations(e))}dataURI(e){return this.chartInstance()?.dataURI(e)}waitForConnected(){this.waitingForConnectedRef||(this.waitingForConnectedRef=Zg({read:()=>{this.isConnected&&(this.waitingForConnectedRef.destroy(),this.waitingForConnectedRef=null,this.createElement())}},{injector:this._injector}))}static{this.\u0275fac=function(n){return new(n||t)}}static{this.\u0275cmp=ir({type:t,selectors:[["apx-chart"]],viewQuery:function(n,i){n&1&&t1(i.chartElement,a7,5),n&2&&r1()},inputs:{chart:[1,"chart"],annotations:[1,"annotations"],colors:[1,"colors"],dataLabels:[1,"dataLabels"],series:[1,"series"],stroke:[1,"stroke"],labels:[1,"labels"],legend:[1,"legend"],markers:[1,"markers"],noData:[1,"noData"],parsing:[1,"parsing"],fill:[1,"fill"],tooltip:[1,"tooltip"],plotOptions:[1,"plotOptions"],responsive:[1,"responsive"],xaxis:[1,"xaxis"],yaxis:[1,"yaxis"],forecastDataPoints:[1,"forecastDataPoints"],grid:[1,"grid"],states:[1,"states"],title:[1,"title"],subtitle:[1,"subtitle"],theme:[1,"theme"],autoUpdateSeries:[1,"autoUpdateSeries"]},outputs:{chartReady:"chartReady"},features:[d0],decls:2,vars:0,consts:[["chart",""]],template:function(n,i){n&1&&Lh(0,"div",null,0)},encapsulation:2,changeDetection:0})}}return t})();var ku=(()=>{class t{static{this.\u0275fac=function(n){return new(n||t)}}static{this.\u0275mod=cl({type:t})}static{this.\u0275inj=sl({})}}return t})();var Vm;function o7(){if(Vm==null){let t=typeof document<"u"?document.head:null;Vm=!!(t&&(t.createShadowRoot||t.attachShadow))}return Vm}function Eu(t){if(o7()){let r=t.getRootNode?t.getRootNode():null;if(typeof ShadowRoot<"u"&&ShadowRoot&&r instanceof ShadowRoot)return r}return null}function ld(t){return t.composedPath?t.composedPath()[0]:t.target}var Mu=new WeakMap,Bb=(()=>{class t{_appRef;_injector=Ce(La);_environmentInjector=Ce(Xg);load(e){let n=this._appRef=this._appRef||this._injector.get(ql),i=Mu.get(n);i||(i={loaders:new Set,refs:[]},Mu.set(n,i),n.onDestroy(()=>{Mu.get(n)?.refs.forEach(a=>a.destroy()),Mu.delete(n)})),i.loaders.has(e)||(i.loaders.add(e),i.refs.push(u1(e,{environmentInjector:this._environmentInjector})))}static \u0275fac=function(n){return new(n||t)};static \u0275prov=nr({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();function Ub(t){return t.buttons===0||t.detail===0}function Vb(t){let r=t.touches&&t.touches[0]||t.changedTouches&&t.changedTouches[0];return!!r&&r.identifier===-1&&(r.radiusX==null||r.radiusX===1)&&(r.radiusY==null||r.radiusY===1)}function Pu(t,r=0){return s7(t)?Number(t):arguments.length===2?r:0}function s7(t){return!isNaN(parseFloat(t))&&!isNaN(Number(t))}function $a(t){return t instanceof Ro?t.nativeElement:t}var zm;try{zm=typeof Intl<"u"&&Intl.v8BreakIterator}catch{zm=!1}var jm=(()=>{class t{_platformId=Ce(Yd);isBrowser=this._platformId?Zd(this._platformId):typeof document=="object"&&!!document;EDGE=this.isBrowser&&/(edge)/i.test(navigator.userAgent);TRIDENT=this.isBrowser&&/(msie|trident)/i.test(navigator.userAgent);BLINK=this.isBrowser&&!!(window.chrome||zm)&&typeof CSS<"u"&&!this.EDGE&&!this.TRIDENT;WEBKIT=this.isBrowser&&/AppleWebKit/i.test(navigator.userAgent)&&!this.BLINK&&!this.EDGE&&!this.TRIDENT;IOS=this.isBrowser&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!("MSStream"in window);FIREFOX=this.isBrowser&&/(firefox|minefield)/i.test(navigator.userAgent);ANDROID=this.isBrowser&&/android/i.test(navigator.userAgent)&&!this.TRIDENT;SAFARI=this.isBrowser&&/safari/i.test(navigator.userAgent)&&this.WEBKIT;constructor(){}static \u0275fac=function(n){return new(n||t)};static \u0275prov=nr({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();var l7=new pa("cdk-dir-doc",{providedIn:"root",factory:()=>Ce(gs)}),c7=/^(ar|ckb|dv|he|iw|fa|nqo|ps|sd|ug|ur|yi|.*[-_](Adlm|Arab|Hebr|Nkoo|Rohg|Thaa))(?!.*[-_](Latn|Cyrl)($|-|_))($|-|_)/i;function d7(t){let r=t?.toLowerCase()||"";return r==="auto"&&typeof navigator<"u"&&navigator?.language?c7.test(navigator.language)?"rtl":"ltr":r==="rtl"?"rtl":"ltr"}var Hm=(()=>{class t{get value(){return this.valueSignal()}valueSignal=ga("ltr");change=new Fn;constructor(){let e=Ce(l7,{optional:!0});if(e){let n=e.body?e.body.dir:null,i=e.documentElement?e.documentElement.dir:null;this.valueSignal.set(d7(n||i||"ltr"))}}ngOnDestroy(){this.change.complete()}static \u0275fac=function(n){return new(n||t)};static \u0275prov=nr({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();var f7=20,zb=(()=>{class t{_ngZone=Ce(ma);_platform=Ce(jm);_renderer=Ce(Wl).createRenderer(null,null);_cleanupGlobalListener;constructor(){}_scrolled=new Bt;_scrolledCount=0;scrollContainers=new Map;register(e){this.scrollContainers.has(e)||this.scrollContainers.set(e,e.elementScrolled().subscribe(()=>this._scrolled.next(e)))}deregister(e){let n=this.scrollContainers.get(e);n&&(n.unsubscribe(),this.scrollContainers.delete(e))}scrolled(e=f7){return this._platform.isBrowser?new Do(n=>{this._cleanupGlobalListener||(this._cleanupGlobalListener=this._ngZone.runOutsideAngular(()=>this._renderer.listen("document","scroll",()=>this._scrolled.next())));let i=e>0?this._scrolled.pipe(Dh(e)).subscribe(n):this._scrolled.subscribe(n);return this._scrolledCount++,()=>{i.unsubscribe(),this._scrolledCount--,this._scrolledCount||(this._cleanupGlobalListener?.(),this._cleanupGlobalListener=void 0)}}):zg()}ngOnDestroy(){this._cleanupGlobalListener?.(),this._cleanupGlobalListener=void 0,this.scrollContainers.forEach((e,n)=>this.deregister(n)),this._scrolled.complete()}ancestorScrolled(e,n){let i=this.getAncestorScrollContainers(e);return this.scrolled(n).pipe(al(a=>!a||i.indexOf(a)>-1))}getAncestorScrollContainers(e){let n=[];return this.scrollContainers.forEach((i,a)=>{this._scrollableContainsElement(a,e)&&n.push(a)}),n}_scrollableContainsElement(e,n){let i=$a(n),a=e.getElementRef().nativeElement;do if(i==a)return!0;while(i=i.parentElement);return!1}static \u0275fac=function(n){return new(n||t)};static \u0275prov=nr({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();var u7=20,Wm=(()=>{class t{_platform=Ce(jm);_listeners;_viewportSize=null;_change=new Bt;_document=Ce(gs);constructor(){let e=Ce(ma),n=Ce(Wl).createRenderer(null,null);e.runOutsideAngular(()=>{if(this._platform.isBrowser){let i=a=>this._change.next(a);this._listeners=[n.listen("window","resize",i),n.listen("window","orientationchange",i)]}this.change().subscribe(()=>this._viewportSize=null)})}ngOnDestroy(){this._listeners?.forEach(e=>e()),this._change.complete()}getViewportSize(){this._viewportSize||this._updateViewportSize();let e={width:this._viewportSize.width,height:this._viewportSize.height};return this._platform.isBrowser||(this._viewportSize=null),e}getViewportRect(){let e=this.getViewportScrollPosition(),{width:n,height:i}=this.getViewportSize();return{top:e.top,left:e.left,bottom:e.top+i,right:e.left+n,height:i,width:n}}getViewportScrollPosition(){if(!this._platform.isBrowser)return{top:0,left:0};let e=this._document,n=this._getWindow(),i=e.documentElement,a=i.getBoundingClientRect(),o=-a.top||e.body?.scrollTop||n.scrollY||i.scrollTop||0,s=-a.left||e.body?.scrollLeft||n.scrollX||i.scrollLeft||0;return{top:o,left:s}}change(e=u7){return e>0?this._change.pipe(Dh(e)):this._change}_getWindow(){return this._document.defaultView||window}_updateViewportSize(){let e=this._getWindow();this._viewportSize=this._platform.isBrowser?{width:e.innerWidth,height:e.innerHeight}:{width:0,height:0}}static \u0275fac=function(n){return new(n||t)};static \u0275prov=nr({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();var jb=(()=>{class t{static \u0275fac=function(n){return new(n||t)};static \u0275mod=cl({type:t});static \u0275inj=sl({})}return t})();var qm={},Ou=class t{_appId=Ce(Yg);static _infix=`a${Math.floor(Math.random()*1e5).toString()}`;getId(r,e=!1){return this._appId!=="ng"&&(r+=this._appId),qm.hasOwnProperty(r)||(qm[r]=0),`${r}${e?t._infix+"-":""}${qm[r]++}`}static \u0275fac=function(e){return new(e||t)};static \u0275prov=nr({token:t,factory:t.\u0275fac,providedIn:"root"})};function Hb(t){return Array.isArray(t)?t:[t]}function Xm(t){let r=t.cloneNode(!0),e=r.querySelectorAll("[id]"),n=t.nodeName.toLowerCase();r.removeAttribute("id");for(let i=0;i<e.length;i++)e[i].removeAttribute("id");return n==="canvas"?Gb(t,r):(n==="input"||n==="select"||n==="textarea")&&qb(t,r),Wb("canvas",t,r,Gb),Wb("input, textarea, select",t,r,qb),r}function Wb(t,r,e,n){let i=r.querySelectorAll(t);if(i.length){let a=e.querySelectorAll(t);for(let o=0;o<i.length;o++)n(i[o],a[o])}}var h7=0;function qb(t,r){r.type!=="file"&&(r.value=t.value),r.type==="radio"&&r.name&&(r.name=`mat-clone-${r.name}-${h7++}`)}function Gb(t,r){let e=r.getContext("2d");if(e)try{e.drawImage(t,0,0)}catch{}}function eg(t){let r=t.getBoundingClientRect();return{top:r.top,right:r.right,bottom:r.bottom,left:r.left,width:r.width,height:r.height,x:r.x,y:r.y}}function Ym(t,r,e){let{top:n,bottom:i,left:a,right:o}=t;return e>=n&&e<=i&&r>=a&&r<=o}function p7(t,r){let e=r.left<t.left,n=r.left+r.width>t.right,i=r.top<t.top,a=r.top+r.height>t.bottom;return e||n||i||a}function fd(t,r,e){t.top+=r,t.bottom=t.top+t.height,t.left+=e,t.right=t.left+t.width}function $b(t,r,e,n){let{top:i,right:a,bottom:o,left:s,width:l,height:c}=t,f=l*r,v=c*r;return n>i-v&&n<o+v&&e>s-f&&e<a+f}var Au=class{_document;positions=new Map;constructor(r){this._document=r}clear(){this.positions.clear()}cache(r){this.clear(),this.positions.set(this._document,{scrollPosition:this.getViewportScrollPosition()}),r.forEach(e=>{this.positions.set(e,{scrollPosition:{top:e.scrollTop,left:e.scrollLeft},clientRect:eg(e)})})}handleScroll(r){let e=ld(r),n=this.positions.get(e);if(!n)return null;let i=n.scrollPosition,a,o;if(e===this._document){let c=this.getViewportScrollPosition();a=c.top,o=c.left}else a=e.scrollTop,o=e.scrollLeft;let s=i.top-a,l=i.left-o;return this.positions.forEach((c,f)=>{c.clientRect&&e!==f&&e.contains(f)&&fd(c.clientRect,s,l)}),i.top=a,i.left=o,{top:s,left:l}}getViewportScrollPosition(){return{top:window.scrollY,left:window.scrollX}}};function a5(t,r){let e=t.rootNodes;if(e.length===1&&e[0].nodeType===r.ELEMENT_NODE)return e[0];let n=r.createElement("div");return e.forEach(i=>n.appendChild(i)),n}function tg(t,r,e){for(let n in r)if(r.hasOwnProperty(n)){let i=r[n];i?t.setProperty(n,i,e?.has(n)?"important":""):t.removeProperty(n)}return t}function Nc(t,r){let e=r?"":"none";tg(t.style,{"touch-action":r?"":"none","-webkit-user-drag":r?"":"none","-webkit-tap-highlight-color":r?"":"transparent","user-select":e,"-ms-user-select":e,"-webkit-user-select":e,"-moz-user-select":e})}function Xb(t,r,e){tg(t.style,{position:r?"":"fixed",top:r?"":"0",opacity:r?"":"0",left:r?"":"-999em"},e)}function Tu(t,r){return r&&r!="none"?t+" "+r:t}function Yb(t,r){t.style.width=`${r.width}px`,t.style.height=`${r.height}px`,t.style.transform=ud(r.left,r.top)}function ud(t,r){return`translate3d(${Math.round(t)}px, ${Math.round(r)}px, 0)`}var cd={capture:!0},Gm={passive:!1,capture:!0},m7=(()=>{class t{static \u0275fac=function(n){return new(n||t)};static \u0275cmp=ir({type:t,selectors:[["ng-component"]],hostAttrs:["cdk-drag-resets-container",""],decls:0,vars:0,template:function(n,i){},styles:[`@layer cdk-resets{.cdk-drag-preview{background:none;border:none;padding:0;color:inherit;inset:auto}}.cdk-drag-placeholder *,.cdk-drag-preview *{pointer-events:none !important}
`],encapsulation:2,changeDetection:0})}return t})(),Du=(()=>{class t{_ngZone=Ce(ma);_document=Ce(gs);_styleLoader=Ce(Bb);_renderer=Ce(Wl).createRenderer(null,null);_cleanupDocumentTouchmove;_scroll=new Bt;_dropInstances=new Set;_dragInstances=new Set;_activeDragInstances=ga([]);_globalListeners;_draggingPredicate=e=>e.isDragging();_domNodesToDirectives=null;pointerMove=new Bt;pointerUp=new Bt;constructor(){}registerDropContainer(e){this._dropInstances.has(e)||this._dropInstances.add(e)}registerDragItem(e){this._dragInstances.add(e),this._dragInstances.size===1&&this._ngZone.runOutsideAngular(()=>{this._cleanupDocumentTouchmove?.(),this._cleanupDocumentTouchmove=this._renderer.listen(this._document,"touchmove",this._persistentTouchmoveListener,Gm)})}removeDropContainer(e){this._dropInstances.delete(e)}removeDragItem(e){this._dragInstances.delete(e),this.stopDragging(e),this._dragInstances.size===0&&this._cleanupDocumentTouchmove?.()}startDragging(e,n){if(!(this._activeDragInstances().indexOf(e)>-1)&&(this._styleLoader.load(m7),this._activeDragInstances.update(i=>[...i,e]),this._activeDragInstances().length===1)){let i=n.type.startsWith("touch"),a=s=>this.pointerUp.next(s),o=[["scroll",s=>this._scroll.next(s),cd],["selectstart",this._preventDefaultWhileDragging,Gm]];i?o.push(["touchend",a,cd],["touchcancel",a,cd]):o.push(["mouseup",a,cd]),i||o.push(["mousemove",s=>this.pointerMove.next(s),Gm]),this._ngZone.runOutsideAngular(()=>{this._globalListeners=o.map(([s,l,c])=>this._renderer.listen(this._document,s,l,c))})}}stopDragging(e){this._activeDragInstances.update(n=>{let i=n.indexOf(e);return i>-1?(n.splice(i,1),[...n]):n}),this._activeDragInstances().length===0&&this._clearGlobalListeners()}isDragging(e){return this._activeDragInstances().indexOf(e)>-1}scrolled(e){let n=[this._scroll];return e&&e!==this._document&&n.push(new Do(i=>this._ngZone.runOutsideAngular(()=>{let a=this._renderer.listen(e,"scroll",o=>{this._activeDragInstances().length&&i.next(o)},cd);return()=>{a()}}))),$d(...n)}registerDirectiveNode(e,n){this._domNodesToDirectives??=new WeakMap,this._domNodesToDirectives.set(e,n)}removeDirectiveNode(e){this._domNodesToDirectives?.delete(e)}getDragDirectiveForNode(e){return this._domNodesToDirectives?.get(e)||null}ngOnDestroy(){this._dragInstances.forEach(e=>this.removeDragItem(e)),this._dropInstances.forEach(e=>this.removeDropContainer(e)),this._domNodesToDirectives=null,this._clearGlobalListeners(),this.pointerMove.complete(),this.pointerUp.complete()}_preventDefaultWhileDragging=e=>{this._activeDragInstances().length>0&&e.preventDefault()};_persistentTouchmoveListener=e=>{this._activeDragInstances().length>0&&(this._activeDragInstances().some(this._draggingPredicate)&&e.preventDefault(),this.pointerMove.next(e))};_clearGlobalListeners(){this._globalListeners?.forEach(e=>e()),this._globalListeners=void 0}static \u0275fac=function(n){return new(n||t)};static \u0275prov=nr({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();function Kb(t){let r=t.toLowerCase().indexOf("ms")>-1?1:1e3;return parseFloat(t)*r}function g7(t){let r=getComputedStyle(t),e=$m(r,"transition-property"),n=e.find(s=>s==="transform"||s==="all");if(!n)return 0;let i=e.indexOf(n),a=$m(r,"transition-duration"),o=$m(r,"transition-delay");return Kb(a[i])+Kb(o[i])}function $m(t,r){return t.getPropertyValue(r).split(",").map(n=>n.trim())}var _7=new Set(["position"]),Km=class{_document;_rootElement;_direction;_initialDomRect;_previewTemplate;_previewClass;_pickupPositionOnPage;_initialTransform;_zIndex;_renderer;_previewEmbeddedView=null;_preview;get element(){return this._preview}constructor(r,e,n,i,a,o,s,l,c,f){this._document=r,this._rootElement=e,this._direction=n,this._initialDomRect=i,this._previewTemplate=a,this._previewClass=o,this._pickupPositionOnPage=s,this._initialTransform=l,this._zIndex=c,this._renderer=f}attach(r){this._preview=this._createPreview(),r.appendChild(this._preview),Zb(this._preview)&&this._preview.showPopover()}destroy(){this._preview.remove(),this._previewEmbeddedView?.destroy(),this._preview=this._previewEmbeddedView=null}setTransform(r){this._preview.style.transform=r}getBoundingClientRect(){return this._preview.getBoundingClientRect()}addClass(r){this._preview.classList.add(r)}getTransitionDuration(){return g7(this._preview)}addEventListener(r,e){return this._renderer.listen(this._preview,r,e)}_createPreview(){let r=this._previewTemplate,e=this._previewClass,n=r?r.template:null,i;if(n&&r){let a=r.matchSize?this._initialDomRect:null,o=r.viewContainer.createEmbeddedView(n,r.context);o.detectChanges(),i=a5(o,this._document),this._previewEmbeddedView=o,r.matchSize?Yb(i,a):i.style.transform=ud(this._pickupPositionOnPage.x,this._pickupPositionOnPage.y)}else i=Xm(this._rootElement),Yb(i,this._initialDomRect),this._initialTransform&&(i.style.transform=this._initialTransform);return tg(i.style,{"pointer-events":"none",margin:Zb(i)?"0 auto 0 0":"0",position:"fixed",top:"0",left:"0","z-index":this._zIndex+""},_7),Nc(i,!1),i.classList.add("cdk-drag-preview"),i.setAttribute("popover","manual"),i.setAttribute("dir",this._direction),e&&(Array.isArray(e)?e.forEach(a=>i.classList.add(a)):i.classList.add(e)),i}};function Zb(t){return"showPopover"in t}var v7={passive:!0},Jb={passive:!1},x7={passive:!1,capture:!0},b7=800,Qb="cdk-drag-placeholder",e5=new Set(["position"]);function o5(t,r,e={dragStartThreshold:5,pointerDirectionChangeThreshold:5}){let n=t.get(u0,null,{optional:!0})||t.get(Wl).createRenderer(null,null);return new Zm(r,e,t.get(gs),t.get(ma),t.get(Wm),t.get(Du),n)}var Zm=class{_config;_document;_ngZone;_viewportRuler;_dragDropRegistry;_renderer;_rootElementCleanups;_cleanupShadowRootSelectStart;_preview=null;_previewContainer;_placeholderRef=null;_placeholder;_pickupPositionInElement;_pickupPositionOnPage;_marker;_anchor=null;_passiveTransform={x:0,y:0};_activeTransform={x:0,y:0};_initialTransform;_hasStartedDragging=ga(!1);_hasMoved=!1;_initialContainer;_initialIndex;_parentPositions;_moveEvents=new Bt;_pointerDirectionDelta;_pointerPositionAtLastDirectionChange;_lastKnownPointerPosition;_rootElement;_ownerSVGElement=null;_rootElementTapHighlight;_pointerMoveSubscription=il.EMPTY;_pointerUpSubscription=il.EMPTY;_scrollSubscription=il.EMPTY;_resizeSubscription=il.EMPTY;_lastTouchEventTime;_dragStartTime;_boundaryElement=null;_nativeInteractionsEnabled=!0;_initialDomRect;_previewRect;_boundaryRect;_previewTemplate;_placeholderTemplate;_handles=[];_disabledHandles=new Set;_dropContainer;_direction="ltr";_parentDragRef=null;_cachedShadowRoot;lockAxis=null;dragStartDelay=0;previewClass;scale=1;get disabled(){return this._disabled||!!(this._dropContainer&&this._dropContainer.disabled)}set disabled(r){r!==this._disabled&&(this._disabled=r,this._toggleNativeDragInteractions(),this._handles.forEach(e=>Nc(e,r)))}_disabled=!1;beforeStarted=new Bt;started=new Bt;released=new Bt;ended=new Bt;entered=new Bt;exited=new Bt;dropped=new Bt;moved=this._moveEvents;data;constrainPosition;constructor(r,e,n,i,a,o,s){this._config=e,this._document=n,this._ngZone=i,this._viewportRuler=a,this._dragDropRegistry=o,this._renderer=s,this.withRootElement(r).withParent(e.parentDragRef||null),this._parentPositions=new Au(n),o.registerDragItem(this)}getPlaceholderElement(){return this._placeholder}getRootElement(){return this._rootElement}getVisibleElement(){return this.isDragging()?this.getPlaceholderElement():this.getRootElement()}withHandles(r){this._handles=r.map(n=>$a(n)),this._handles.forEach(n=>Nc(n,this.disabled)),this._toggleNativeDragInteractions();let e=new Set;return this._disabledHandles.forEach(n=>{this._handles.indexOf(n)>-1&&e.add(n)}),this._disabledHandles=e,this}withPreviewTemplate(r){return this._previewTemplate=r,this}withPlaceholderTemplate(r){return this._placeholderTemplate=r,this}withRootElement(r){let e=$a(r);if(e!==this._rootElement){this._removeRootElementListeners();let n=this._renderer;this._rootElementCleanups=this._ngZone.runOutsideAngular(()=>[n.listen(e,"mousedown",this._pointerDown,Jb),n.listen(e,"touchstart",this._pointerDown,v7),n.listen(e,"dragstart",this._nativeDragStart,Jb)]),this._initialTransform=void 0,this._rootElement=e}return typeof SVGElement<"u"&&this._rootElement instanceof SVGElement&&(this._ownerSVGElement=this._rootElement.ownerSVGElement),this}withBoundaryElement(r){return this._boundaryElement=r?$a(r):null,this._resizeSubscription.unsubscribe(),r&&(this._resizeSubscription=this._viewportRuler.change(10).subscribe(()=>this._containInsideBoundaryOnResize())),this}withParent(r){return this._parentDragRef=r,this}dispose(){this._removeRootElementListeners(),this.isDragging()&&this._rootElement?.remove(),this._marker?.remove(),this._destroyPreview(),this._destroyPlaceholder(),this._dragDropRegistry.removeDragItem(this),this._removeListeners(),this.beforeStarted.complete(),this.started.complete(),this.released.complete(),this.ended.complete(),this.entered.complete(),this.exited.complete(),this.dropped.complete(),this._moveEvents.complete(),this._handles=[],this._disabledHandles.clear(),this._dropContainer=void 0,this._resizeSubscription.unsubscribe(),this._parentPositions.clear(),this._boundaryElement=this._rootElement=this._ownerSVGElement=this._placeholderTemplate=this._previewTemplate=this._marker=this._parentDragRef=null}isDragging(){return this._hasStartedDragging()&&this._dragDropRegistry.isDragging(this)}reset(){this._rootElement.style.transform=this._initialTransform||"",this._activeTransform={x:0,y:0},this._passiveTransform={x:0,y:0}}resetToBoundary(){if(this._boundaryElement&&this._rootElement&&p7(this._boundaryElement.getBoundingClientRect(),this._rootElement.getBoundingClientRect())){let r=this._boundaryElement.getBoundingClientRect(),e=this._rootElement.getBoundingClientRect(),n=0,i=0;e.left<r.left?n=r.left-e.left:e.right>r.right&&(n=r.right-e.right),e.top<r.top?i=r.top-e.top:e.bottom>r.bottom&&(i=r.bottom-e.bottom);let a=this._activeTransform.x,o=this._activeTransform.y,s=a+n,l=o+i;this._rootElement.style.transform=ud(s,l),this._activeTransform={x:s,y:l},this._passiveTransform={x:s,y:l}}}disableHandle(r){!this._disabledHandles.has(r)&&this._handles.indexOf(r)>-1&&(this._disabledHandles.add(r),Nc(r,!0))}enableHandle(r){this._disabledHandles.has(r)&&(this._disabledHandles.delete(r),Nc(r,this.disabled))}withDirection(r){return this._direction=r,this}_withDropContainer(r){this._dropContainer=r}getFreeDragPosition(){let r=this.isDragging()?this._activeTransform:this._passiveTransform;return{x:r.x,y:r.y}}setFreeDragPosition(r){return this._activeTransform={x:0,y:0},this._passiveTransform.x=r.x,this._passiveTransform.y=r.y,this._dropContainer||this._applyRootElementTransform(r.x,r.y),this}withPreviewContainer(r){return this._previewContainer=r,this}_sortFromLastPointerPosition(){let r=this._lastKnownPointerPosition;r&&this._dropContainer&&this._updateActiveDropContainer(this._getConstrainedPointerPosition(r),r)}_removeListeners(){this._pointerMoveSubscription.unsubscribe(),this._pointerUpSubscription.unsubscribe(),this._scrollSubscription.unsubscribe(),this._cleanupShadowRootSelectStart?.(),this._cleanupShadowRootSelectStart=void 0}_destroyPreview(){this._preview?.destroy(),this._preview=null}_destroyPlaceholder(){this._anchor?.remove(),this._placeholder?.remove(),this._placeholderRef?.destroy(),this._placeholder=this._anchor=this._placeholderRef=null}_pointerDown=r=>{if(this.beforeStarted.next(),this._handles.length){let e=this._getTargetHandle(r);e&&!this._disabledHandles.has(e)&&!this.disabled&&this._initializeDragSequence(e,r)}else this.disabled||this._initializeDragSequence(this._rootElement,r)};_pointerMove=r=>{let e=this._getPointerPositionOnPage(r);if(!this._hasStartedDragging()){let i=Math.abs(e.x-this._pickupPositionOnPage.x),a=Math.abs(e.y-this._pickupPositionOnPage.y);if(i+a>=this._config.dragStartThreshold){let s=Date.now()>=this._dragStartTime+this._getDragStartDelay(r),l=this._dropContainer;if(!s){this._endDragSequence(r);return}(!l||!l.isDragging()&&!l.isReceiving())&&(r.cancelable&&r.preventDefault(),this._hasStartedDragging.set(!0),this._ngZone.run(()=>this._startDragSequence(r)))}return}r.cancelable&&r.preventDefault();let n=this._getConstrainedPointerPosition(e);if(this._hasMoved=!0,this._lastKnownPointerPosition=e,this._updatePointerDirectionDelta(n),this._dropContainer)this._updateActiveDropContainer(n,e);else{let i=this.constrainPosition?this._initialDomRect:this._pickupPositionOnPage,a=this._activeTransform;a.x=n.x-i.x+this._passiveTransform.x,a.y=n.y-i.y+this._passiveTransform.y,this._applyRootElementTransform(a.x,a.y)}this._moveEvents.observers.length&&this._ngZone.run(()=>{this._moveEvents.next({source:this,pointerPosition:n,event:r,distance:this._getDragDistance(n),delta:this._pointerDirectionDelta})})};_pointerUp=r=>{this._endDragSequence(r)};_endDragSequence(r){if(this._dragDropRegistry.isDragging(this)&&(this._removeListeners(),this._dragDropRegistry.stopDragging(this),this._toggleNativeDragInteractions(),this._handles&&(this._rootElement.style.webkitTapHighlightColor=this._rootElementTapHighlight),!!this._hasStartedDragging()))if(this.released.next({source:this,event:r}),this._dropContainer)this._dropContainer._stopScrolling(),this._animatePreviewToPlaceholder().then(()=>{this._cleanupDragArtifacts(r),this._cleanupCachedDimensions(),this._dragDropRegistry.stopDragging(this)});else{this._passiveTransform.x=this._activeTransform.x;let e=this._getPointerPositionOnPage(r);this._passiveTransform.y=this._activeTransform.y,this._ngZone.run(()=>{this.ended.next({source:this,distance:this._getDragDistance(e),dropPoint:e,event:r})}),this._cleanupCachedDimensions(),this._dragDropRegistry.stopDragging(this)}}_startDragSequence(r){dd(r)&&(this._lastTouchEventTime=Date.now()),this._toggleNativeDragInteractions();let e=this._getShadowRoot(),n=this._dropContainer;if(e&&this._ngZone.runOutsideAngular(()=>{this._cleanupShadowRootSelectStart=this._renderer.listen(e,"selectstart",w7,x7)}),n){let i=this._rootElement,a=i.parentNode,o=this._placeholder=this._createPlaceholderElement(),s=this._marker=this._marker||this._document.createComment("");a.insertBefore(s,i),this._initialTransform=i.style.transform||"",this._preview=new Km(this._document,this._rootElement,this._direction,this._initialDomRect,this._previewTemplate||null,this.previewClass||null,this._pickupPositionOnPage,this._initialTransform,this._config.zIndex||1e3,this._renderer),this._preview.attach(this._getPreviewInsertionPoint(a,e)),Xb(i,!1,e5),this._document.body.appendChild(a.replaceChild(o,i)),this.started.next({source:this,event:r}),n.start(),this._initialContainer=n,this._initialIndex=n.getItemIndex(this)}else this.started.next({source:this,event:r}),this._initialContainer=this._initialIndex=void 0;this._parentPositions.cache(n?n.getScrollableParents():[])}_initializeDragSequence(r,e){this._parentDragRef&&e.stopPropagation();let n=this.isDragging(),i=dd(e),a=!i&&e.button!==0,o=this._rootElement,s=ld(e),l=!i&&this._lastTouchEventTime&&this._lastTouchEventTime+b7>Date.now(),c=i?Vb(e):Ub(e);if(s&&s.draggable&&e.type==="mousedown"&&e.preventDefault(),n||a||l||c)return;if(this._handles.length){let x=o.style;this._rootElementTapHighlight=x.webkitTapHighlightColor||"",x.webkitTapHighlightColor="transparent"}this._hasMoved=!1,this._hasStartedDragging.set(this._hasMoved),this._removeListeners(),this._initialDomRect=this._rootElement.getBoundingClientRect(),this._pointerMoveSubscription=this._dragDropRegistry.pointerMove.subscribe(this._pointerMove),this._pointerUpSubscription=this._dragDropRegistry.pointerUp.subscribe(this._pointerUp),this._scrollSubscription=this._dragDropRegistry.scrolled(this._getShadowRoot()).subscribe(x=>this._updateOnScroll(x)),this._boundaryElement&&(this._boundaryRect=eg(this._boundaryElement));let f=this._previewTemplate;this._pickupPositionInElement=f&&f.template&&!f.matchSize?{x:0,y:0}:this._getPointerPositionInElement(this._initialDomRect,r,e);let v=this._pickupPositionOnPage=this._lastKnownPointerPosition=this._getPointerPositionOnPage(e);this._pointerDirectionDelta={x:0,y:0},this._pointerPositionAtLastDirectionChange={x:v.x,y:v.y},this._dragStartTime=Date.now(),this._dragDropRegistry.startDragging(this,e)}_cleanupDragArtifacts(r){Xb(this._rootElement,!0,e5),this._marker.parentNode.replaceChild(this._rootElement,this._marker),this._destroyPreview(),this._destroyPlaceholder(),this._initialDomRect=this._boundaryRect=this._previewRect=this._initialTransform=void 0,this._ngZone.run(()=>{let e=this._dropContainer,n=e.getItemIndex(this),i=this._getPointerPositionOnPage(r),a=this._getDragDistance(i),o=e._isOverContainer(i.x,i.y);this.ended.next({source:this,distance:a,dropPoint:i,event:r}),this.dropped.next({item:this,currentIndex:n,previousIndex:this._initialIndex,container:e,previousContainer:this._initialContainer,isPointerOverContainer:o,distance:a,dropPoint:i,event:r}),e.drop(this,n,this._initialIndex,this._initialContainer,o,a,i,r),this._dropContainer=this._initialContainer})}_updateActiveDropContainer({x:r,y:e},{x:n,y:i}){let a=this._initialContainer._getSiblingContainerFromPosition(this,r,e);!a&&this._dropContainer!==this._initialContainer&&this._initialContainer._isOverContainer(r,e)&&(a=this._initialContainer),a&&a!==this._dropContainer&&this._ngZone.run(()=>{let o=this._dropContainer.getItemIndex(this),s=this._dropContainer.getItemAtIndex(o+1)?.getVisibleElement()||null;this.exited.next({item:this,container:this._dropContainer}),this._dropContainer.exit(this),this._conditionallyInsertAnchor(a,this._dropContainer,s),this._dropContainer=a,this._dropContainer.enter(this,r,e,a===this._initialContainer&&a.sortingDisabled?this._initialIndex:void 0),this.entered.next({item:this,container:a,currentIndex:a.getItemIndex(this)})}),this.isDragging()&&(this._dropContainer._startScrollingIfNecessary(n,i),this._dropContainer._sortItem(this,r,e,this._pointerDirectionDelta),this.constrainPosition?this._applyPreviewTransform(r,e):this._applyPreviewTransform(r-this._pickupPositionInElement.x,e-this._pickupPositionInElement.y))}_animatePreviewToPlaceholder(){if(!this._hasMoved)return Promise.resolve();let r=this._placeholder.getBoundingClientRect();this._preview.addClass("cdk-drag-animating"),this._applyPreviewTransform(r.left,r.top);let e=this._preview.getTransitionDuration();return e===0?Promise.resolve():this._ngZone.runOutsideAngular(()=>new Promise(n=>{let i=s=>{(!s||this._preview&&ld(s)===this._preview.element&&s.propertyName==="transform")&&(o(),n(),clearTimeout(a))},a=setTimeout(i,e*1.5),o=this._preview.addEventListener("transitionend",i)}))}_createPlaceholderElement(){let r=this._placeholderTemplate,e=r?r.template:null,n;return e?(this._placeholderRef=r.viewContainer.createEmbeddedView(e,r.context),this._placeholderRef.detectChanges(),n=a5(this._placeholderRef,this._document)):n=Xm(this._rootElement),n.style.pointerEvents="none",n.classList.add(Qb),n}_getPointerPositionInElement(r,e,n){let i=e===this._rootElement?null:e,a=i?i.getBoundingClientRect():r,o=dd(n)?n.targetTouches[0]:n,s=this._getViewportScrollPosition(),l=o.pageX-a.left-s.left,c=o.pageY-a.top-s.top;return{x:a.left-r.left+l,y:a.top-r.top+c}}_getPointerPositionOnPage(r){let e=this._getViewportScrollPosition(),n=dd(r)?r.touches[0]||r.changedTouches[0]||{pageX:0,pageY:0}:r,i=n.pageX-e.left,a=n.pageY-e.top;if(this._ownerSVGElement){let o=this._ownerSVGElement.getScreenCTM();if(o){let s=this._ownerSVGElement.createSVGPoint();return s.x=i,s.y=a,s.matrixTransform(o.inverse())}}return{x:i,y:a}}_getConstrainedPointerPosition(r){let e=this._dropContainer?this._dropContainer.lockAxis:null,{x:n,y:i}=this.constrainPosition?this.constrainPosition(r,this,this._initialDomRect,this._pickupPositionInElement):r;if(this.lockAxis==="x"||e==="x"?i=this._pickupPositionOnPage.y-(this.constrainPosition?this._pickupPositionInElement.y:0):(this.lockAxis==="y"||e==="y")&&(n=this._pickupPositionOnPage.x-(this.constrainPosition?this._pickupPositionInElement.x:0)),this._boundaryRect){let{x:a,y:o}=this.constrainPosition?{x:0,y:0}:this._pickupPositionInElement,s=this._boundaryRect,{width:l,height:c}=this._getPreviewRect(),f=s.top+o,v=s.bottom-(c-o),x=s.left+a,p=s.right-(l-a);n=t5(n,x,p),i=t5(i,f,v)}return{x:n,y:i}}_updatePointerDirectionDelta(r){let{x:e,y:n}=r,i=this._pointerDirectionDelta,a=this._pointerPositionAtLastDirectionChange,o=Math.abs(e-a.x),s=Math.abs(n-a.y);return o>this._config.pointerDirectionChangeThreshold&&(i.x=e>a.x?1:-1,a.x=e),s>this._config.pointerDirectionChangeThreshold&&(i.y=n>a.y?1:-1,a.y=n),i}_toggleNativeDragInteractions(){if(!this._rootElement||!this._handles)return;let r=this._handles.length>0||!this.isDragging();r!==this._nativeInteractionsEnabled&&(this._nativeInteractionsEnabled=r,Nc(this._rootElement,r))}_removeRootElementListeners(){this._rootElementCleanups?.forEach(r=>r()),this._rootElementCleanups=void 0}_applyRootElementTransform(r,e){let n=1/this.scale,i=ud(r*n,e*n),a=this._rootElement.style;this._initialTransform==null&&(this._initialTransform=a.transform&&a.transform!="none"?a.transform:""),a.transform=Tu(i,this._initialTransform)}_applyPreviewTransform(r,e){let n=this._previewTemplate?.template?void 0:this._initialTransform,i=ud(r,e);this._preview.setTransform(Tu(i,n))}_getDragDistance(r){let e=this._pickupPositionOnPage;return e?{x:r.x-e.x,y:r.y-e.y}:{x:0,y:0}}_cleanupCachedDimensions(){this._boundaryRect=this._previewRect=void 0,this._parentPositions.clear()}_containInsideBoundaryOnResize(){let{x:r,y:e}=this._passiveTransform;if(r===0&&e===0||this.isDragging()||!this._boundaryElement)return;let n=this._rootElement.getBoundingClientRect(),i=this._boundaryElement.getBoundingClientRect();if(i.width===0&&i.height===0||n.width===0&&n.height===0)return;let a=i.left-n.left,o=n.right-i.right,s=i.top-n.top,l=n.bottom-i.bottom;i.width>n.width?(a>0&&(r+=a),o>0&&(r-=o)):r=0,i.height>n.height?(s>0&&(e+=s),l>0&&(e-=l)):e=0,(r!==this._passiveTransform.x||e!==this._passiveTransform.y)&&this.setFreeDragPosition({y:e,x:r})}_getDragStartDelay(r){let e=this.dragStartDelay;return typeof e=="number"?e:dd(r)?e.touch:e?e.mouse:0}_updateOnScroll(r){let e=this._parentPositions.handleScroll(r);if(e){let n=ld(r);this._boundaryRect&&n!==this._boundaryElement&&n.contains(this._boundaryElement)&&fd(this._boundaryRect,e.top,e.left),this._pickupPositionOnPage.x+=e.left,this._pickupPositionOnPage.y+=e.top,this._dropContainer||(this._activeTransform.x-=e.left,this._activeTransform.y-=e.top,this._applyRootElementTransform(this._activeTransform.x,this._activeTransform.y))}}_getViewportScrollPosition(){return this._parentPositions.positions.get(this._document)?.scrollPosition||this._parentPositions.getViewportScrollPosition()}_getShadowRoot(){return this._cachedShadowRoot===void 0&&(this._cachedShadowRoot=Eu(this._rootElement)),this._cachedShadowRoot}_getPreviewInsertionPoint(r,e){let n=this._previewContainer||"global";if(n==="parent")return r;if(n==="global"){let i=this._document;return e||i.fullscreenElement||i.webkitFullscreenElement||i.mozFullScreenElement||i.msFullscreenElement||i.body}return $a(n)}_getPreviewRect(){return(!this._previewRect||!this._previewRect.width&&!this._previewRect.height)&&(this._previewRect=this._preview?this._preview.getBoundingClientRect():this._initialDomRect),this._previewRect}_nativeDragStart=r=>{if(this._handles.length){let e=this._getTargetHandle(r);e&&!this._disabledHandles.has(e)&&!this.disabled&&r.preventDefault()}else this.disabled||r.preventDefault()};_getTargetHandle(r){return this._handles.find(e=>r.target&&(r.target===e||e.contains(r.target)))}_conditionallyInsertAnchor(r,e,n){if(r===this._initialContainer)this._anchor?.remove(),this._anchor=null;else if(e===this._initialContainer&&e.hasAnchor){let i=this._anchor??=Xm(this._placeholder);i.classList.remove(Qb),i.classList.add("cdk-drag-anchor"),i.style.transform="",n?n.before(i):$a(e.element).appendChild(i)}}};function t5(t,r,e){return Math.max(r,Math.min(e,t))}function dd(t){return t.type[0]==="t"}function w7(t){t.preventDefault()}function Nu(t,r,e){let n=r5(r,t.length-1),i=r5(e,t.length-1);if(n===i)return;let a=t[n],o=i<n?-1:1;for(let s=n;s!==i;s+=o)t[s]=t[s+o];t[i]=a}function r5(t,r){return Math.max(0,Math.min(r,t))}var Iu=class{_dragDropRegistry;_element;_sortPredicate;_itemPositions=[];_activeDraggables;orientation="vertical";direction="ltr";constructor(r){this._dragDropRegistry=r}_previousSwap={drag:null,delta:0,overlaps:!1};start(r){this.withItems(r)}sort(r,e,n,i){let a=this._itemPositions,o=this._getItemIndexFromPointerPosition(r,e,n,i);if(o===-1&&a.length>0)return null;let s=this.orientation==="horizontal",l=a.findIndex(k=>k.drag===r),c=a[o],f=a[l].clientRect,v=c.clientRect,x=l>o?1:-1,p=this._getItemOffsetPx(f,v,x),S=this._getSiblingOffsetPx(l,a,x),w=a.slice();return Nu(a,l,o),a.forEach((k,O)=>{if(w[O]===k)return;let H=k.drag===r,q=H?p:S,X=H?r.getPlaceholderElement():k.drag.getRootElement();k.offset+=q;let he=Math.round(k.offset*(1/k.drag.scale));s?(X.style.transform=Tu(`translate3d(${he}px, 0, 0)`,k.initialTransform),fd(k.clientRect,0,q)):(X.style.transform=Tu(`translate3d(0, ${he}px, 0)`,k.initialTransform),fd(k.clientRect,q,0))}),this._previousSwap.overlaps=Ym(v,e,n),this._previousSwap.drag=c.drag,this._previousSwap.delta=s?i.x:i.y,{previousIndex:l,currentIndex:o}}enter(r,e,n,i){let a=i==null||i<0?this._getItemIndexFromPointerPosition(r,e,n):i,o=this._activeDraggables,s=o.indexOf(r),l=r.getPlaceholderElement(),c=o[a];if(c===r&&(c=o[a+1]),!c&&(a==null||a===-1||a<o.length-1)&&this._shouldEnterAsFirstChild(e,n)&&(c=o[0]),s>-1&&o.splice(s,1),c&&!this._dragDropRegistry.isDragging(c)){let f=c.getRootElement();f.parentElement.insertBefore(l,f),o.splice(a,0,r)}else this._element.appendChild(l),o.push(r);l.style.transform="",this._cacheItemPositions()}withItems(r){this._activeDraggables=r.slice(),this._cacheItemPositions()}withSortPredicate(r){this._sortPredicate=r}reset(){this._activeDraggables?.forEach(r=>{let e=r.getRootElement();if(e){let n=this._itemPositions.find(i=>i.drag===r)?.initialTransform;e.style.transform=n||""}}),this._itemPositions=[],this._activeDraggables=[],this._previousSwap.drag=null,this._previousSwap.delta=0,this._previousSwap.overlaps=!1}getActiveItemsSnapshot(){return this._activeDraggables}getItemIndex(r){return this._getVisualItemPositions().findIndex(e=>e.drag===r)}getItemAtIndex(r){return this._getVisualItemPositions()[r]?.drag||null}updateOnScroll(r,e){this._itemPositions.forEach(({clientRect:n})=>{fd(n,r,e)}),this._itemPositions.forEach(({drag:n})=>{this._dragDropRegistry.isDragging(n)&&n._sortFromLastPointerPosition()})}withElementContainer(r){this._element=r}_cacheItemPositions(){let r=this.orientation==="horizontal";this._itemPositions=this._activeDraggables.map(e=>{let n=e.getVisibleElement();return{drag:e,offset:0,initialTransform:n.style.transform||"",clientRect:eg(n)}}).sort((e,n)=>r?e.clientRect.left-n.clientRect.left:e.clientRect.top-n.clientRect.top)}_getVisualItemPositions(){return this.orientation==="horizontal"&&this.direction==="rtl"?this._itemPositions.slice().reverse():this._itemPositions}_getItemOffsetPx(r,e,n){let i=this.orientation==="horizontal",a=i?e.left-r.left:e.top-r.top;return n===-1&&(a+=i?e.width-r.width:e.height-r.height),a}_getSiblingOffsetPx(r,e,n){let i=this.orientation==="horizontal",a=e[r].clientRect,o=e[r+n*-1],s=a[i?"width":"height"]*n;if(o){let l=i?"left":"top",c=i?"right":"bottom";n===-1?s-=o.clientRect[l]-a[c]:s+=a[l]-o.clientRect[c]}return s}_shouldEnterAsFirstChild(r,e){if(!this._activeDraggables.length)return!1;let n=this._itemPositions,i=this.orientation==="horizontal";if(n[0].drag!==this._activeDraggables[0]){let o=n[n.length-1].clientRect;return i?r>=o.right:e>=o.bottom}else{let o=n[0].clientRect;return i?r<=o.left:e<=o.top}}_getItemIndexFromPointerPosition(r,e,n,i){let a=this.orientation==="horizontal",o=this._itemPositions.findIndex(({drag:s,clientRect:l})=>{if(s===r)return!1;if(i){let c=a?i.x:i.y;if(s===this._previousSwap.drag&&this._previousSwap.overlaps&&c===this._previousSwap.delta)return!1}return a?e>=Math.floor(l.left)&&e<Math.floor(l.right):n>=Math.floor(l.top)&&n<Math.floor(l.bottom)});return o===-1||!this._sortPredicate(o,r)?-1:o}},Jm=class{_document;_dragDropRegistry;_element;_sortPredicate;_rootNode;_activeItems;_previousSwap={drag:null,deltaX:0,deltaY:0,overlaps:!1};_relatedNodes=[];constructor(r,e){this._document=r,this._dragDropRegistry=e}start(r){let e=this._element.childNodes;this._relatedNodes=[];for(let n=0;n<e.length;n++){let i=e[n];this._relatedNodes.push([i,i.nextSibling])}this.withItems(r)}sort(r,e,n,i){let a=this._getItemIndexFromPointerPosition(r,e,n),o=this._previousSwap;if(a===-1||this._activeItems[a]===r)return null;let s=this._activeItems[a];if(o.drag===s&&o.overlaps&&o.deltaX===i.x&&o.deltaY===i.y)return null;let l=this.getItemIndex(r),c=r.getPlaceholderElement(),f=s.getRootElement();a>l?f.after(c):f.before(c),Nu(this._activeItems,l,a);let v=this._getRootNode().elementFromPoint(e,n);return o.deltaX=i.x,o.deltaY=i.y,o.drag=s,o.overlaps=f===v||f.contains(v),{previousIndex:l,currentIndex:a}}enter(r,e,n,i){let a=this._activeItems.indexOf(r);a>-1&&this._activeItems.splice(a,1);let o=i==null||i<0?this._getItemIndexFromPointerPosition(r,e,n):i;o===-1&&(o=this._getClosestItemIndexToPointer(r,e,n));let s=this._activeItems[o];s&&!this._dragDropRegistry.isDragging(s)?(this._activeItems.splice(o,0,r),s.getRootElement().before(r.getPlaceholderElement())):(this._activeItems.push(r),this._element.appendChild(r.getPlaceholderElement()))}withItems(r){this._activeItems=r.slice()}withSortPredicate(r){this._sortPredicate=r}reset(){let r=this._element,e=this._previousSwap;for(let n=this._relatedNodes.length-1;n>-1;n--){let[i,a]=this._relatedNodes[n];i.parentNode===r&&i.nextSibling!==a&&(a===null?r.appendChild(i):a.parentNode===r&&r.insertBefore(i,a))}this._relatedNodes=[],this._activeItems=[],e.drag=null,e.deltaX=e.deltaY=0,e.overlaps=!1}getActiveItemsSnapshot(){return this._activeItems}getItemIndex(r){return this._activeItems.indexOf(r)}getItemAtIndex(r){return this._activeItems[r]||null}updateOnScroll(){this._activeItems.forEach(r=>{this._dragDropRegistry.isDragging(r)&&r._sortFromLastPointerPosition()})}withElementContainer(r){r!==this._element&&(this._element=r,this._rootNode=void 0)}_getItemIndexFromPointerPosition(r,e,n){let i=this._getRootNode().elementFromPoint(Math.floor(e),Math.floor(n)),a=i?this._activeItems.findIndex(o=>{let s=o.getRootElement();return i===s||s.contains(i)}):-1;return a===-1||!this._sortPredicate(a,r)?-1:a}_getRootNode(){return this._rootNode||(this._rootNode=Eu(this._element)||this._document),this._rootNode}_getClosestItemIndexToPointer(r,e,n){if(this._activeItems.length===0)return-1;if(this._activeItems.length===1)return 0;let i=1/0,a=-1;for(let o=0;o<this._activeItems.length;o++){let s=this._activeItems[o];if(s!==r){let{x:l,y:c}=s.getRootElement().getBoundingClientRect(),f=Math.hypot(e-l,n-c);f<i&&(i=f,a=o)}}return a}},n5=.05,s5=.05,Ma=(function(t){return t[t.NONE=0]="NONE",t[t.UP=1]="UP",t[t.DOWN=2]="DOWN",t})(Ma||{}),Si=(function(t){return t[t.NONE=0]="NONE",t[t.LEFT=1]="LEFT",t[t.RIGHT=2]="RIGHT",t})(Si||{});function l5(t,r){return new Qm(r,t.get(Du),t.get(gs),t.get(ma),t.get(Wm))}var Qm=class{_dragDropRegistry;_ngZone;_viewportRuler;element;disabled=!1;sortingDisabled=!1;lockAxis=null;autoScrollDisabled=!1;autoScrollStep=2;hasAnchor=!1;enterPredicate=()=>!0;sortPredicate=()=>!0;beforeStarted=new Bt;entered=new Bt;exited=new Bt;dropped=new Bt;sorted=new Bt;receivingStarted=new Bt;receivingStopped=new Bt;data;_container;_isDragging=!1;_parentPositions;_sortStrategy;_domRect;_draggables=[];_siblings=[];_activeSiblings=new Set;_viewportScrollSubscription=il.EMPTY;_verticalScrollDirection=Ma.NONE;_horizontalScrollDirection=Si.NONE;_scrollNode;_stopScrollTimers=new Bt;_cachedShadowRoot=null;_document;_scrollableElements=[];_initialScrollSnap;_direction="ltr";constructor(r,e,n,i,a){this._dragDropRegistry=e,this._ngZone=i,this._viewportRuler=a;let o=this.element=$a(r);this._document=n,this.withOrientation("vertical").withElementContainer(o),e.registerDropContainer(this),this._parentPositions=new Au(n)}dispose(){this._stopScrolling(),this._stopScrollTimers.complete(),this._viewportScrollSubscription.unsubscribe(),this.beforeStarted.complete(),this.entered.complete(),this.exited.complete(),this.dropped.complete(),this.sorted.complete(),this.receivingStarted.complete(),this.receivingStopped.complete(),this._activeSiblings.clear(),this._scrollNode=null,this._parentPositions.clear(),this._dragDropRegistry.removeDropContainer(this)}isDragging(){return this._isDragging}start(){this._draggingStarted(),this._notifyReceivingSiblings()}enter(r,e,n,i){this._draggingStarted(),i==null&&this.sortingDisabled&&(i=this._draggables.indexOf(r)),this._sortStrategy.enter(r,e,n,i),this._cacheParentPositions(),this._notifyReceivingSiblings(),this.entered.next({item:r,container:this,currentIndex:this.getItemIndex(r)})}exit(r){this._reset(),this.exited.next({item:r,container:this})}drop(r,e,n,i,a,o,s,l={}){this._reset(),this.dropped.next({item:r,currentIndex:e,previousIndex:n,container:this,previousContainer:i,isPointerOverContainer:a,distance:o,dropPoint:s,event:l})}withItems(r){let e=this._draggables;return this._draggables=r,r.forEach(n=>n._withDropContainer(this)),this.isDragging()&&(e.filter(i=>i.isDragging()).every(i=>r.indexOf(i)===-1)?this._reset():this._sortStrategy.withItems(this._draggables)),this}withDirection(r){return this._direction=r,this._sortStrategy instanceof Iu&&(this._sortStrategy.direction=r),this}connectedTo(r){return this._siblings=r.slice(),this}withOrientation(r){if(r==="mixed")this._sortStrategy=new Jm(this._document,this._dragDropRegistry);else{let e=new Iu(this._dragDropRegistry);e.direction=this._direction,e.orientation=r,this._sortStrategy=e}return this._sortStrategy.withElementContainer(this._container),this._sortStrategy.withSortPredicate((e,n)=>this.sortPredicate(e,n,this)),this}withScrollableParents(r){let e=this._container;return this._scrollableElements=r.indexOf(e)===-1?[e,...r]:r.slice(),this}withElementContainer(r){if(r===this._container)return this;let e=$a(this.element),n=this._scrollableElements.indexOf(this._container),i=this._scrollableElements.indexOf(r);return n>-1&&this._scrollableElements.splice(n,1),i>-1&&this._scrollableElements.splice(i,1),this._sortStrategy&&this._sortStrategy.withElementContainer(r),this._cachedShadowRoot=null,this._scrollableElements.unshift(r),this._container=r,this}getScrollableParents(){return this._scrollableElements}getItemIndex(r){return this._isDragging?this._sortStrategy.getItemIndex(r):this._draggables.indexOf(r)}getItemAtIndex(r){return this._isDragging?this._sortStrategy.getItemAtIndex(r):this._draggables[r]||null}isReceiving(){return this._activeSiblings.size>0}_sortItem(r,e,n,i){if(this.sortingDisabled||!this._domRect||!$b(this._domRect,n5,e,n))return;let a=this._sortStrategy.sort(r,e,n,i);a&&this.sorted.next({previousIndex:a.previousIndex,currentIndex:a.currentIndex,container:this,item:r})}_startScrollingIfNecessary(r,e){if(this.autoScrollDisabled)return;let n,i=Ma.NONE,a=Si.NONE;if(this._parentPositions.positions.forEach((o,s)=>{s===this._document||!o.clientRect||n||$b(o.clientRect,n5,r,e)&&([i,a]=y7(s,o.clientRect,this._direction,r,e),(i||a)&&(n=s))}),!i&&!a){let{width:o,height:s}=this._viewportRuler.getViewportSize(),l={width:o,height:s,top:0,right:o,bottom:s,left:0};i=c5(l,e),a=d5(l,r),n=window}n&&(i!==this._verticalScrollDirection||a!==this._horizontalScrollDirection||n!==this._scrollNode)&&(this._verticalScrollDirection=i,this._horizontalScrollDirection=a,this._scrollNode=n,(i||a)&&n?this._ngZone.runOutsideAngular(this._startScrollInterval):this._stopScrolling())}_stopScrolling(){this._stopScrollTimers.next()}_draggingStarted(){let r=this._container.style;this.beforeStarted.next(),this._isDragging=!0,this._initialScrollSnap=r.msScrollSnapType||r.scrollSnapType||"",r.scrollSnapType=r.msScrollSnapType="none",this._sortStrategy.start(this._draggables),this._cacheParentPositions(),this._viewportScrollSubscription.unsubscribe(),this._listenToScrollEvents()}_cacheParentPositions(){this._parentPositions.cache(this._scrollableElements),this._domRect=this._parentPositions.positions.get(this._container).clientRect}_reset(){this._isDragging=!1;let r=this._container.style;r.scrollSnapType=r.msScrollSnapType=this._initialScrollSnap,this._siblings.forEach(e=>e._stopReceiving(this)),this._sortStrategy.reset(),this._stopScrolling(),this._viewportScrollSubscription.unsubscribe(),this._parentPositions.clear()}_startScrollInterval=()=>{this._stopScrolling(),Gd(0,Fh).pipe(ms(this._stopScrollTimers)).subscribe(()=>{let r=this._scrollNode,e=this.autoScrollStep;this._verticalScrollDirection===Ma.UP?r.scrollBy(0,-e):this._verticalScrollDirection===Ma.DOWN&&r.scrollBy(0,e),this._horizontalScrollDirection===Si.LEFT?r.scrollBy(-e,0):this._horizontalScrollDirection===Si.RIGHT&&r.scrollBy(e,0)})};_isOverContainer(r,e){return this._domRect!=null&&Ym(this._domRect,r,e)}_getSiblingContainerFromPosition(r,e,n){return this._siblings.find(i=>i._canReceive(r,e,n))}_canReceive(r,e,n){if(!this._domRect||!Ym(this._domRect,e,n)||!this.enterPredicate(r,this))return!1;let i=this._getShadowRoot().elementFromPoint(e,n);return i?i===this._container||this._container.contains(i):!1}_startReceiving(r,e){let n=this._activeSiblings;!n.has(r)&&e.every(i=>this.enterPredicate(i,this)||this._draggables.indexOf(i)>-1)&&(n.add(r),this._cacheParentPositions(),this._listenToScrollEvents(),this.receivingStarted.next({initiator:r,receiver:this,items:e}))}_stopReceiving(r){this._activeSiblings.delete(r),this._viewportScrollSubscription.unsubscribe(),this.receivingStopped.next({initiator:r,receiver:this})}_listenToScrollEvents(){this._viewportScrollSubscription=this._dragDropRegistry.scrolled(this._getShadowRoot()).subscribe(r=>{if(this.isDragging()){let e=this._parentPositions.handleScroll(r);e&&this._sortStrategy.updateOnScroll(e.top,e.left)}else this.isReceiving()&&this._cacheParentPositions()})}_getShadowRoot(){if(!this._cachedShadowRoot){let r=Eu(this._container);this._cachedShadowRoot=r||this._document}return this._cachedShadowRoot}_notifyReceivingSiblings(){let r=this._sortStrategy.getActiveItemsSnapshot().filter(e=>e.isDragging());this._siblings.forEach(e=>e._startReceiving(this,r))}};function c5(t,r){let{top:e,bottom:n,height:i}=t,a=i*s5;return r>=e-a&&r<=e+a?Ma.UP:r>=n-a&&r<=n+a?Ma.DOWN:Ma.NONE}function d5(t,r){let{left:e,right:n,width:i}=t,a=i*s5;return r>=e-a&&r<=e+a?Si.LEFT:r>=n-a&&r<=n+a?Si.RIGHT:Si.NONE}function y7(t,r,e,n,i){let a=c5(r,i),o=d5(r,n),s=Ma.NONE,l=Si.NONE;if(a){let c=t.scrollTop;a===Ma.UP?c>0&&(s=Ma.UP):t.scrollHeight-c>t.clientHeight&&(s=Ma.DOWN)}if(o){let c=t.scrollLeft;e==="rtl"?o===Si.RIGHT?c<0&&(l=Si.RIGHT):t.scrollWidth+c>t.clientWidth&&(l=Si.LEFT):o===Si.LEFT?c>0&&(l=Si.LEFT):t.scrollWidth-c>t.clientWidth&&(l=Si.RIGHT)}return[s,l]}var C7=(()=>{class t{_injector=Ce(La);constructor(){}createDrag(e,n){return o5(this._injector,e,n)}createDropList(e){return l5(this._injector,e)}static \u0275fac=function(n){return new(n||t)};static \u0275prov=nr({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})(),Fu=new pa("CDK_DRAG_PARENT");var f5=new pa("CdkDragHandle"),u5=(()=>{class t{element=Ce(Ro);_parentDrag=Ce(Fu,{optional:!0,skipSelf:!0});_dragDropRegistry=Ce(Du);_stateChanges=new Bt;get disabled(){return this._disabled}set disabled(e){this._disabled=e,this._stateChanges.next(this)}_disabled=!1;constructor(){this._parentDrag?._addHandle(this)}ngAfterViewInit(){if(!this._parentDrag){let e=this.element.nativeElement.parentElement;for(;e;){let n=this._dragDropRegistry.getDragDirectiveForNode(e);if(n){this._parentDrag=n,n._addHandle(this);break}e=e.parentElement}}}ngOnDestroy(){this._parentDrag?._removeHandle(this),this._stateChanges.complete()}static \u0275fac=function(n){return new(n||t)};static \u0275dir=_s({type:t,selectors:[["","cdkDragHandle",""]],hostAttrs:[1,"cdk-drag-handle"],inputs:{disabled:[2,"cdkDragHandleDisabled","disabled",bs]},features:[vs([{provide:f5,useExisting:t}])]})}return t})(),h5=new pa("CDK_DRAG_CONFIG"),p5=new pa("CdkDropList"),m5=(()=>{class t{element=Ce(Ro);dropContainer=Ce(p5,{optional:!0,skipSelf:!0});_ngZone=Ce(ma);_viewContainerRef=Ce(Rh);_dir=Ce(Hm,{optional:!0});_changeDetectorRef=Ce(Un);_selfHandle=Ce(f5,{optional:!0,self:!0});_parentDrag=Ce(Fu,{optional:!0,skipSelf:!0});_dragDropRegistry=Ce(Du);_destroyed=new Bt;_handles=new qd([]);_previewTemplate=null;_placeholderTemplate=null;_dragRef;data;lockAxis=null;rootElementSelector;boundaryElement;dragStartDelay;freeDragPosition;get disabled(){return this._disabled||!!(this.dropContainer&&this.dropContainer.disabled)}set disabled(e){this._disabled=e,this._dragRef.disabled=this._disabled}_disabled=!1;constrainPosition;previewClass;previewContainer;scale=1;started=new Fn;released=new Fn;ended=new Fn;entered=new Fn;exited=new Fn;dropped=new Fn;moved=new Do(e=>{let n=this._dragRef.moved.pipe(No(i=>({source:this,pointerPosition:i.pointerPosition,event:i.event,delta:i.delta,distance:i.distance}))).subscribe(e);return()=>{n.unsubscribe()}});_injector=Ce(La);constructor(){let e=this.dropContainer,n=Ce(h5,{optional:!0});this._dragRef=o5(this._injector,this.element,{dragStartThreshold:n&&n.dragStartThreshold!=null?n.dragStartThreshold:5,pointerDirectionChangeThreshold:n&&n.pointerDirectionChangeThreshold!=null?n.pointerDirectionChangeThreshold:5,zIndex:n?.zIndex}),this._dragRef.data=this,this._dragDropRegistry.registerDirectiveNode(this.element.nativeElement,this),n&&this._assignDefaults(n),e&&(e.addItem(this),e._dropListRef.beforeStarted.pipe(ms(this._destroyed)).subscribe(()=>{this._dragRef.scale=this.scale})),this._syncInputs(this._dragRef),this._handleEvents(this._dragRef)}getPlaceholderElement(){return this._dragRef.getPlaceholderElement()}getRootElement(){return this._dragRef.getRootElement()}reset(){this._dragRef.reset()}resetToBoundary(){this._dragRef.resetToBoundary()}getFreeDragPosition(){return this._dragRef.getFreeDragPosition()}setFreeDragPosition(e){this._dragRef.setFreeDragPosition(e)}ngAfterViewInit(){f0(()=>{this._updateRootElement(),this._setupHandlesListener(),this._dragRef.scale=this.scale,this.freeDragPosition&&this._dragRef.setFreeDragPosition(this.freeDragPosition)},{injector:this._injector})}ngOnChanges(e){let n=e.rootElementSelector,i=e.freeDragPosition;n&&!n.firstChange&&this._updateRootElement(),this._dragRef.scale=this.scale,i&&!i.firstChange&&this.freeDragPosition&&this._dragRef.setFreeDragPosition(this.freeDragPosition)}ngOnDestroy(){this.dropContainer&&this.dropContainer.removeItem(this),this._dragDropRegistry.removeDirectiveNode(this.element.nativeElement),this._ngZone.runOutsideAngular(()=>{this._handles.complete(),this._destroyed.next(),this._destroyed.complete(),this._dragRef.dispose()})}_addHandle(e){let n=this._handles.getValue();n.push(e),this._handles.next(n)}_removeHandle(e){let n=this._handles.getValue(),i=n.indexOf(e);i>-1&&(n.splice(i,1),this._handles.next(n))}_setPreviewTemplate(e){this._previewTemplate=e}_resetPreviewTemplate(e){e===this._previewTemplate&&(this._previewTemplate=null)}_setPlaceholderTemplate(e){this._placeholderTemplate=e}_resetPlaceholderTemplate(e){e===this._placeholderTemplate&&(this._placeholderTemplate=null)}_updateRootElement(){let e=this.element.nativeElement,n=e;this.rootElementSelector&&(n=e.closest!==void 0?e.closest(this.rootElementSelector):e.parentElement?.closest(this.rootElementSelector)),this._dragRef.withRootElement(n||e)}_getBoundaryElement(){let e=this.boundaryElement;return e?typeof e=="string"?this.element.nativeElement.closest(e):$a(e):null}_syncInputs(e){e.beforeStarted.subscribe(()=>{if(!e.isDragging()){let n=this._dir,i=this.dragStartDelay,a=this._placeholderTemplate?{template:this._placeholderTemplate.templateRef,context:this._placeholderTemplate.data,viewContainer:this._viewContainerRef}:null,o=this._previewTemplate?{template:this._previewTemplate.templateRef,context:this._previewTemplate.data,matchSize:this._previewTemplate.matchSize,viewContainer:this._viewContainerRef}:null;e.disabled=this.disabled,e.lockAxis=this.lockAxis,e.scale=this.scale,e.dragStartDelay=typeof i=="object"&&i?i:Pu(i),e.constrainPosition=this.constrainPosition,e.previewClass=this.previewClass,e.withBoundaryElement(this._getBoundaryElement()).withPlaceholderTemplate(a).withPreviewTemplate(o).withPreviewContainer(this.previewContainer||"global"),n&&e.withDirection(n.value)}}),e.beforeStarted.pipe(eo(1)).subscribe(()=>{if(this._parentDrag){e.withParent(this._parentDrag._dragRef);return}let n=this.element.nativeElement.parentElement;for(;n;){let i=this._dragDropRegistry.getDragDirectiveForNode(n);if(i){e.withParent(i._dragRef);break}n=n.parentElement}})}_handleEvents(e){e.started.subscribe(n=>{this.started.emit({source:this,event:n.event}),this._changeDetectorRef.markForCheck()}),e.released.subscribe(n=>{this.released.emit({source:this,event:n.event})}),e.ended.subscribe(n=>{this.ended.emit({source:this,distance:n.distance,dropPoint:n.dropPoint,event:n.event}),this._changeDetectorRef.markForCheck()}),e.entered.subscribe(n=>{this.entered.emit({container:n.container.data,item:this,currentIndex:n.currentIndex})}),e.exited.subscribe(n=>{this.exited.emit({container:n.container.data,item:this})}),e.dropped.subscribe(n=>{this.dropped.emit({previousIndex:n.previousIndex,currentIndex:n.currentIndex,previousContainer:n.previousContainer.data,container:n.container.data,isPointerOverContainer:n.isPointerOverContainer,item:this,distance:n.distance,dropPoint:n.dropPoint,event:n.event})})}_assignDefaults(e){let{lockAxis:n,dragStartDelay:i,constrainPosition:a,previewClass:o,boundaryElement:s,draggingDisabled:l,rootElementSelector:c,previewContainer:f}=e;this.disabled=l??!1,this.dragStartDelay=i||0,this.lockAxis=n||null,a&&(this.constrainPosition=a),o&&(this.previewClass=o),s&&(this.boundaryElement=s),c&&(this.rootElementSelector=c),f&&(this.previewContainer=f)}_setupHandlesListener(){this._handles.pipe(Wg(e=>{let n=e.map(i=>i.element);this._selfHandle&&this.rootElementSelector&&n.push(this.element),this._dragRef.withHandles(n)}),Zi(e=>$d(...e.map(n=>n._stateChanges.pipe(Xd(n))))),ms(this._destroyed)).subscribe(e=>{let n=this._dragRef,i=e.element.nativeElement;e.disabled?n.disableHandle(i):n.enableHandle(i)})}static \u0275fac=function(n){return new(n||t)};static \u0275dir=_s({type:t,selectors:[["","cdkDrag",""]],hostAttrs:[1,"cdk-drag"],hostVars:4,hostBindings:function(n,i){n&2&&wt("cdk-drag-disabled",i.disabled)("cdk-drag-dragging",i._dragRef.isDragging())},inputs:{data:[0,"cdkDragData","data"],lockAxis:[0,"cdkDragLockAxis","lockAxis"],rootElementSelector:[0,"cdkDragRootElement","rootElementSelector"],boundaryElement:[0,"cdkDragBoundary","boundaryElement"],dragStartDelay:[0,"cdkDragStartDelay","dragStartDelay"],freeDragPosition:[0,"cdkDragFreeDragPosition","freeDragPosition"],disabled:[2,"cdkDragDisabled","disabled",bs],constrainPosition:[0,"cdkDragConstrainPosition","constrainPosition"],previewClass:[0,"cdkDragPreviewClass","previewClass"],previewContainer:[0,"cdkDragPreviewContainer","previewContainer"],scale:[2,"cdkDragScale","scale",f1]},outputs:{started:"cdkDragStarted",released:"cdkDragReleased",ended:"cdkDragEnded",entered:"cdkDragEntered",exited:"cdkDragExited",dropped:"cdkDragDropped",moved:"cdkDragMoved"},exportAs:["cdkDrag"],features:[vs([{provide:Fu,useExisting:t}]),d0]})}return t})(),i5=new pa("CdkDropListGroup");var g5=(()=>{class t{element=Ce(Ro);_changeDetectorRef=Ce(Un);_scrollDispatcher=Ce(zb);_dir=Ce(Hm,{optional:!0});_group=Ce(i5,{optional:!0,skipSelf:!0});_latestSortedRefs;_destroyed=new Bt;_scrollableParentsResolved=!1;static _dropLists=[];_dropListRef;connectedTo=[];data;orientation="vertical";id=Ce(Ou).getId("cdk-drop-list-");lockAxis=null;get disabled(){return this._disabled||!!this._group&&this._group.disabled}set disabled(e){this._dropListRef.disabled=this._disabled=e}_disabled=!1;sortingDisabled=!1;enterPredicate=()=>!0;sortPredicate=()=>!0;autoScrollDisabled=!1;autoScrollStep;elementContainerSelector=null;hasAnchor=!1;dropped=new Fn;entered=new Fn;exited=new Fn;sorted=new Fn;_unsortedItems=new Set;constructor(){let e=Ce(h5,{optional:!0}),n=Ce(La);this._dropListRef=l5(n,this.element),this._dropListRef.data=this,e&&this._assignDefaults(e),this._dropListRef.enterPredicate=(i,a)=>this.enterPredicate(i.data,a.data),this._dropListRef.sortPredicate=(i,a,o)=>this.sortPredicate(i,a.data,o.data),this._setupInputSyncSubscription(this._dropListRef),this._handleEvents(this._dropListRef),t._dropLists.push(this),this._group&&this._group._items.add(this)}addItem(e){this._unsortedItems.add(e),e._dragRef._withDropContainer(this._dropListRef),this._dropListRef.isDragging()&&this._syncItemsWithRef(this.getSortedItems().map(n=>n._dragRef))}removeItem(e){if(this._unsortedItems.delete(e),this._latestSortedRefs){let n=this._latestSortedRefs.indexOf(e._dragRef);n>-1&&(this._latestSortedRefs.splice(n,1),this._syncItemsWithRef(this._latestSortedRefs))}}getSortedItems(){return Array.from(this._unsortedItems).sort((e,n)=>e._dragRef.getVisibleElement().compareDocumentPosition(n._dragRef.getVisibleElement())&Node.DOCUMENT_POSITION_FOLLOWING?-1:1)}ngOnDestroy(){let e=t._dropLists.indexOf(this);e>-1&&t._dropLists.splice(e,1),this._group&&this._group._items.delete(this),this._latestSortedRefs=void 0,this._unsortedItems.clear(),this._dropListRef.dispose(),this._destroyed.next(),this._destroyed.complete()}_setupInputSyncSubscription(e){this._dir&&this._dir.change.pipe(Xd(this._dir.value),ms(this._destroyed)).subscribe(n=>e.withDirection(n)),e.beforeStarted.subscribe(()=>{let n=Hb(this.connectedTo).map(i=>{if(typeof i=="string"){let a=t._dropLists.find(o=>o.id===i);return a}return i});if(this._group&&this._group._items.forEach(i=>{n.indexOf(i)===-1&&n.push(i)}),!this._scrollableParentsResolved){let i=this._scrollDispatcher.getAncestorScrollContainers(this.element).map(a=>a.getElementRef().nativeElement);this._dropListRef.withScrollableParents(i),this._scrollableParentsResolved=!0}if(this.elementContainerSelector){let i=this.element.nativeElement.querySelector(this.elementContainerSelector);e.withElementContainer(i)}e.disabled=this.disabled,e.lockAxis=this.lockAxis,e.sortingDisabled=this.sortingDisabled,e.autoScrollDisabled=this.autoScrollDisabled,e.autoScrollStep=Pu(this.autoScrollStep,2),e.hasAnchor=this.hasAnchor,e.connectedTo(n.filter(i=>i&&i!==this).map(i=>i._dropListRef)).withOrientation(this.orientation)})}_handleEvents(e){e.beforeStarted.subscribe(()=>{this._syncItemsWithRef(this.getSortedItems().map(n=>n._dragRef)),this._changeDetectorRef.markForCheck()}),e.entered.subscribe(n=>{this.entered.emit({container:this,item:n.item.data,currentIndex:n.currentIndex})}),e.exited.subscribe(n=>{this.exited.emit({container:this,item:n.item.data}),this._changeDetectorRef.markForCheck()}),e.sorted.subscribe(n=>{this.sorted.emit({previousIndex:n.previousIndex,currentIndex:n.currentIndex,container:this,item:n.item.data})}),e.dropped.subscribe(n=>{this.dropped.emit({previousIndex:n.previousIndex,currentIndex:n.currentIndex,previousContainer:n.previousContainer.data,container:n.container.data,item:n.item.data,isPointerOverContainer:n.isPointerOverContainer,distance:n.distance,dropPoint:n.dropPoint,event:n.event}),this._changeDetectorRef.markForCheck()}),$d(e.receivingStarted,e.receivingStopped).subscribe(()=>this._changeDetectorRef.markForCheck())}_assignDefaults(e){let{lockAxis:n,draggingDisabled:i,sortingDisabled:a,listAutoScrollDisabled:o,listOrientation:s}=e;this.disabled=i??!1,this.sortingDisabled=a??!1,this.autoScrollDisabled=o??!1,this.orientation=s||"vertical",this.lockAxis=n||null}_syncItemsWithRef(e){this._latestSortedRefs=e,this._dropListRef.withItems(e)}static \u0275fac=function(n){return new(n||t)};static \u0275dir=_s({type:t,selectors:[["","cdkDropList",""],["cdk-drop-list"]],hostAttrs:[1,"cdk-drop-list"],hostVars:7,hostBindings:function(n,i){n&2&&(e1("id",i.id),wt("cdk-drop-list-disabled",i.disabled)("cdk-drop-list-dragging",i._dropListRef.isDragging())("cdk-drop-list-receiving",i._dropListRef.isReceiving()))},inputs:{connectedTo:[0,"cdkDropListConnectedTo","connectedTo"],data:[0,"cdkDropListData","data"],orientation:[0,"cdkDropListOrientation","orientation"],id:"id",lockAxis:[0,"cdkDropListLockAxis","lockAxis"],disabled:[2,"cdkDropListDisabled","disabled",bs],sortingDisabled:[2,"cdkDropListSortingDisabled","sortingDisabled",bs],enterPredicate:[0,"cdkDropListEnterPredicate","enterPredicate"],sortPredicate:[0,"cdkDropListSortPredicate","sortPredicate"],autoScrollDisabled:[2,"cdkDropListAutoScrollDisabled","autoScrollDisabled",bs],autoScrollStep:[0,"cdkDropListAutoScrollStep","autoScrollStep"],elementContainerSelector:[0,"cdkDropListElementContainer","elementContainerSelector"],hasAnchor:[2,"cdkDropListHasAnchor","hasAnchor",bs]},outputs:{dropped:"cdkDropListDropped",entered:"cdkDropListEntered",exited:"cdkDropListExited",sorted:"cdkDropListSorted"},exportAs:["cdkDropList"],features:[vs([{provide:i5,useValue:void 0},{provide:p5,useExisting:t}])]})}return t})();var S7=new pa("CdkDragPlaceholder"),_5=(()=>{class t{templateRef=Ce(Nh);_drag=Ce(Fu,{optional:!0});data;constructor(){this._drag?._setPlaceholderTemplate(this)}ngOnDestroy(){this._drag?._resetPlaceholderTemplate(this)}static \u0275fac=function(n){return new(n||t)};static \u0275dir=_s({type:t,selectors:[["ng-template","cdkDragPlaceholder",""]],inputs:{data:"data"},features:[vs([{provide:S7,useExisting:t}])]})}return t})();var v5=(()=>{class t{static \u0275fac=function(n){return new(n||t)};static \u0275mod=cl({type:t});static \u0275inj=sl({providers:[C7],imports:[jb]})}return t})();var Hs=class t{THEME_KEY="theme-preference";isDarkMode=ga(this.loadTheme());constructor(){ll(()=>{this.applyTheme(this.isDarkMode())})}toggleTheme(){this.isDarkMode.update(r=>!r),localStorage.setItem(this.THEME_KEY,JSON.stringify(this.isDarkMode()))}loadTheme(){let r=localStorage.getItem(this.THEME_KEY);return r!==null?JSON.parse(r):!1}applyTheme(r){r?document.documentElement.setAttribute("data-theme","dark"):document.documentElement.removeAttribute("data-theme")}static \u0275fac=function(e){return new(e||t)};static \u0275prov=nr({token:t,factory:t.\u0275fac,providedIn:"root"})};var E7=["chart"];function M7(t,r){if(t&1&&(d(0,"tr")(1,"td"),_(2),u(),d(3,"td")(4,"span",25),_(5),u()()()),t&2){let e=r.$implicit;g(2),be(e.name),g(3),be(e.total)}}function P7(t,r){if(t&1&&(d(0,"tr")(1,"td"),_(2),u(),d(3,"td")(4,"span",25),_(5),u()()()),t&2){let e=r.$implicit;g(2),be(e.name),g(3),be(e.total)}}function O7(t,r){if(t&1&&(d(0,"tr")(1,"td"),_(2),u(),d(3,"td")(4,"span",25),_(5),u()()()),t&2){let e=r.$implicit;g(2),be(e.name),g(3),be(e.total)}}function A7(t,r){if(t&1&&(d(0,"div",15)(1,"div",16)(2,"div",17)(3,"div",18),j(4,"i",19),d(5,"span"),_(6,"Asistencia por Sede"),u()()(),d(7,"div",20)(8,"table",21)(9,"thead")(10,"tr")(11,"th"),_(12,"Sede"),u(),d(13,"th"),_(14,"Total"),u()()(),d(15,"tbody"),fe(16,M7,6,2,"tr",22),u()()()(),d(17,"div",16)(18,"div",17)(19,"div",18),j(20,"i",23),d(21,"span"),_(22,"Top Categor\xEDas"),u()()(),d(23,"div",20)(24,"table",21)(25,"thead")(26,"tr")(27,"th"),_(28,"Categor\xEDa"),u(),d(29,"th"),_(30,"Total"),u()()(),d(31,"tbody"),fe(32,P7,6,2,"tr",22),u()()()(),d(33,"div",16)(34,"div",17)(35,"div",18),j(36,"i",24),d(37,"span"),_(38,"Distribuci\xF3n por Tipo"),u()()(),d(39,"div",20)(40,"table",21)(41,"thead")(42,"tr")(43,"th"),_(44,"Tipo"),u(),d(45,"th"),_(46,"Total"),u()()(),d(47,"tbody"),fe(48,O7,6,2,"tr",22),u()()()()()),t&2){let e=C();g(16),P("ngForOf",e.branchWidgetData),g(16),P("ngForOf",e.categoryWidgetData),g(16),P("ngForOf",e.topMembersWidgetData)}}function T7(t,r){if(t&1&&(d(0,"div",26)(1,"div",27)(2,"div",28)(3,"span",29),_(4,"Total"),u(),d(5,"h2",30),_(6),u()()(),d(7,"div",27)(8,"div",28)(9,"span",29),_(10,"Pico M\xE1ximo"),u(),d(11,"h2",30),_(12),u()()(),d(13,"div",27)(14,"div",28)(15,"span",29),_(16,"Promedio"),u(),d(17,"h2",30),_(18),u()()()()),t&2){let e=C();g(6),be(e.stats.totalAttendance),g(6),be(e.stats.peakAttendance),g(6),be(e.stats.avgAttendance)}}function I7(t,r){if(t&1){let e=Pe();d(0,"div",38)(1,"button",39),L("click",function(){D(e);let i=C(2);return N(i.prevPage())}),j(2,"i",40),u(),d(3,"span",41),_(4),u(),d(5,"button",39),L("click",function(){D(e);let i=C(2);return N(i.nextPage())}),j(6,"i",42),u()()}if(t&2){let e=C(2);g(),P("disabled",e.currentPage===0),g(3),_a(" Servicios ",e.currentPage*e.pageSize+1," - ",e.Math.min((e.currentPage+1)*e.pageSize,e.allXLabels.length)," de ",e.allXLabels.length," "),g(),P("disabled",(e.currentPage+1)*e.pageSize>=e.allXLabels.length)}}function F7(t,r){if(t&1&&(d(0,"div",31)(1,"div",32)(2,"div",33),j(3,"i",34),d(4,"span"),_(5,"Visualizaci\xF3n de Servicios"),u()(),fe(6,I7,7,5,"div",35),u(),d(7,"div",36),j(8,"apx-chart",37,0),u()()),t&2){let e=C();g(6),P("ngIf",e.totalPages>1),g(2),P("series",e.chartOptions.series)("chart",e.chartOptions.chart)("xaxis",e.chartOptions.xaxis)("dataLabels",e.chartOptions.dataLabels)("grid",e.chartOptions.grid)("stroke",e.chartOptions.stroke)("tooltip",e.chartOptions.tooltip)("yaxis",e.chartOptions.yaxis)("plotOptions",e.chartOptions.plotOptions)("fill",e.chartOptions.fill)("colors",e.chartOptions.colors)("legend",e.chartOptions.legend)}}function D7(t,r){t&1&&(d(0,"div",31)(1,"div",36)(2,"div",43),j(3,"i",44),d(4,"p"),_(5,"Procesando datos..."),u()()()())}function N7(t,r){if(t&1){let e=Pe();d(0,"div",45),j(1,"i",46),d(2,"h3"),_(3,"No hay datos para mostrar"),u(),d(4,"p"),_(5,"Utilice los filtros avanzados para generar un reporte de asistencia."),u(),d(6,"button",47),L("click",function(){D(e);let i=C();return N(i.openFilterModal())}),_(7," Configurar Filtros "),u()()}}function R7(t,r){if(t&1&&(d(0,"option",92),_(1),u()),t&2){let e=r.$implicit;P("value",e.id),g(),be(e.name)}}function L7(t,r){if(t&1){let e=Pe();d(0,"div",56)(1,"label"),j(2,"i",91),_(3," Sede"),u(),d(4,"div",58)(5,"select",59),ht("ngModelChange",function(i){D(e);let a=C(2);return ut(a.filters.branchId,i)||(a.filters.branchId=i),N(i)}),d(6,"option",60),_(7,"Todas las Sedes"),u(),fe(8,R7,2,2,"option",61),u()()()}if(t&2){let e=C(2);g(5),ft("ngModel",e.filters.branchId),g(),P("ngValue",void 0),g(2),P("ngForOf",e.branches)}}function B7(t,r){if(t&1&&(d(0,"option",92),_(1),u()),t&2){let e=r.$implicit;P("value",e.id),g(),be(e.name)}}function U7(t,r){if(t&1&&(d(0,"option",92),_(1),u()),t&2){let e=r.$implicit;P("value",e.id),g(),be(e.name)}}function V7(t,r){if(t&1&&(d(0,"option",92),_(1),u()),t&2){let e=r.$implicit;P("value",e.id),g(),be(e.name)}}function z7(t,r){if(t&1){let e=Pe();d(0,"div",56)(1,"label"),j(2,"i",62),_(3," Sub-Categor\xEDa"),u(),d(4,"div",58)(5,"select",59),ht("ngModelChange",function(i){D(e);let a=C(2);return ut(a.filters.subCategory,i)||(a.filters.subCategory=i),N(i)}),d(6,"option",60),_(7,"Todas las sub-categor\xEDas"),u(),fe(8,V7,2,2,"option",61),u()()()}if(t&2){let e=C(2);g(5),ft("ngModel",e.filters.subCategory),g(),P("ngValue",void 0),g(2),P("ngForOf",e.availableSubCategories)}}function j7(t,r){if(t&1&&(d(0,"option",92),_(1),u()),t&2){let e=r.$implicit;P("value",e.id),g(),be(e.name)}}function H7(t,r){t&1&&(d(0,"span",93),_(1,"Seleccionar evento en calendario..."),u())}function W7(t,r){if(t&1&&(d(0,"span",94),_(1),u()),t&2){let e=C(2);g(),be(e.selectedEventLabel)}}function q7(t,r){if(t&1){let e=Pe();d(0,"button",95),L("click",function(i){return D(e),C(2).clearEventFilter(),N(i.stopPropagation())}),_(1," \xD7 "),u()}}function G7(t,r){if(t&1){let e=Pe();d(0,"label",73)(1,"input",96),L("change",function(i){let a=D(e).$implicit,o=C(2);return N(o.onGroupByChange(a.id,i))}),u(),j(2,"span",75),_(3),u()}if(t&2){let e=r.$implicit,n=C(2);g(),P("value",e.id)("checked",n.filters.groupBy==null?null:n.filters.groupBy.includes(e.id)),g(2),je(" ",e.label," ")}}function $7(t,r){if(t&1){let e=Pe();d(0,"div",97)(1,"span"),_(2),u(),d(3,"button",98),L("click",function(){D(e);let i=C(2);return N(i.clearMemberSelection())}),_(4,"\xD7"),u()()}if(t&2){let e=C(2);g(2),be(e.selectedMemberName)}}function X7(t,r){t&1&&j(0,"i",103)}function Y7(t,r){if(t&1){let e=Pe();d(0,"div",99),j(1,"i",100),d(2,"input",101),ht("ngModelChange",function(i){D(e);let a=C(2);return ut(a.memberSearchQuery,i)||(a.memberSearchQuery=i),N(i)}),L("input",function(){D(e);let i=C(2);return N(i.onMemberSearch())}),u(),fe(3,X7,1,0,"i",102),u()}if(t&2){let e=C(2);g(2),ft("ngModel",e.memberSearchQuery),g(),P("ngIf",e.isSearchingMembers)}}function K7(t,r){if(t&1&&(d(0,"span"),_(1),u()),t&2){let e=C().$implicit;g(),je(" \u2022 ",e.subCategory.name)}}function Z7(t,r){if(t&1){let e=Pe();d(0,"div",106),L("click",function(){let i=D(e).$implicit,a=C(3);return N(a.selectMember(i))}),j(1,"img",107),d(2,"div",108)(3,"span",109),_(4),u(),d(5,"span",110),_(6),fe(7,K7,2,1,"span",111),_(8),u()()()}if(t&2){let e=r.$implicit;g(),P("src",e.pictureProfileUrl||"https://ui-avatars.com/api/?name="+e.completeName+"&background=random",pn),g(3),be(e.completeName),g(2),je("",e.category.name," "),g(),P("ngIf",e.subCategory),g(),je(" \u2022 ",e.cc)}}function J7(t,r){if(t&1&&(d(0,"div",104),fe(1,Z7,9,5,"div",105),u()),t&2){let e=C(2);g(),P("ngForOf",e.memberResults)}}function Q7(t,r){t&1&&(d(0,"div",112)(1,"div",113),j(2,"div",114),d(3,"p"),_(4,"Generando reporte..."),u()()())}function eI(t,r){if(t&1){let e=Pe();d(0,"div",48),L("click",function(){D(e);let i=C();return N(i.closeFilterModal())}),d(1,"div",49),L("click",function(i){return D(e),N(i.stopPropagation())}),d(2,"div",50)(3,"h3"),j(4,"i",6),_(5," Filtros de Reporte"),u(),d(6,"button",51),L("click",function(){D(e);let i=C();return N(i.closeFilterModal())}),_(7,"\xD7"),u()(),d(8,"div",52)(9,"div",53),fe(10,L7,9,3,"div",54),d(11,"div",55)(12,"div",56)(13,"label"),j(14,"i",57),_(15," Tipo de Persona"),u(),d(16,"div",58)(17,"select",59),ht("ngModelChange",function(i){D(e);let a=C();return ut(a.filters.typeOfPeople,i)||(a.filters.typeOfPeople=i),N(i)}),d(18,"option",60),_(19,"Todos los tipos"),u(),fe(20,B7,2,2,"option",61),u()()(),d(21,"div",56)(22,"label"),j(23,"i",62),_(24," Categor\xEDa"),u(),d(25,"div",58)(26,"select",63),ht("ngModelChange",function(i){D(e);let a=C();return ut(a.filters.category,i)||(a.filters.category=i),N(i)}),L("change",function(){D(e);let i=C();return N(i.filters.subCategory=void 0)}),d(27,"option",60),_(28,"Todas las categor\xEDas"),u(),fe(29,U7,2,2,"option",61),u()()(),fe(30,z7,9,3,"div",54),u(),d(31,"div",56)(32,"label"),j(33,"i",64),_(34," Servicio Espec\xEDfico"),u(),d(35,"div",58)(36,"select",59),ht("ngModelChange",function(i){D(e);let a=C();return ut(a.filters.serviceId,i)||(a.filters.serviceId=i),N(i)}),d(37,"option",60),_(38,"Todos los servicios disponibles"),u(),fe(39,j7,2,2,"option",61),u()()(),d(40,"div",56)(41,"label"),j(42,"i",65),_(43," Evento Espec\xEDfico"),u(),d(44,"div",66),L("click",function(){D(e);let i=C();return N(i.openCalendarModal())}),fe(45,H7,2,0,"span",67)(46,W7,2,1,"span",68),u(),fe(47,q7,2,0,"button",69),u(),d(48,"div",56)(49,"label"),j(50,"i",70),_(51," Agrupar Resultados (Nivel de Detalle)"),u(),d(52,"div",71),fe(53,G7,4,3,"label",72),u()(),d(54,"div",56)(55,"label",73)(56,"input",74),ht("ngModelChange",function(i){D(e);let a=C();return ut(a.separateByDate,i)||(a.separateByDate=i),N(i)}),L("change",function(){D(e);let i=C();return N(i.updateChart())}),u(),j(57,"span",75)(58,"i",76),_(59," Separar por Fecha de Servicio (Vista Dashboard) "),u(),d(60,"small",77),_(61," Muestra cada servicio por separado con su desglose de categor\xEDas, tal como en el inicio. "),u()(),d(62,"div",78)(63,"label"),j(64,"i",79),_(65," Filtrar por Integrante"),u(),d(66,"div",80),fe(67,$7,5,1,"div",81)(68,Y7,4,2,"div",82)(69,J7,2,1,"div",83),u()(),d(70,"div",55)(71,"div",56)(72,"label"),j(73,"i",84),_(74," Desde"),u(),d(75,"input",85),ht("ngModelChange",function(i){D(e);let a=C();return ut(a.filters.startDate,i)||(a.filters.startDate=i),N(i)}),u()(),d(76,"div",56)(77,"label"),j(78,"i",86),_(79," Hasta"),u(),d(80,"input",85),ht("ngModelChange",function(i){D(e);let a=C();return ut(a.filters.endDate,i)||(a.filters.endDate=i),N(i)}),u()()(),d(81,"div",87)(82,"label",73)(83,"input",88),ht("ngModelChange",function(i){D(e);let a=C();return ut(a.filters.onlyActive,i)||(a.filters.onlyActive=i),N(i)}),u(),j(84,"span",75),_(85," Solo integrantes activos "),u()()()(),d(86,"div",89)(87,"button",5),L("click",function(){D(e);let i=C();return N(i.closeFilterModal())}),_(88,"Cancelar"),u(),d(89,"button",7),L("click",function(){D(e);let i=C();return N(i.applyFilters())}),_(90),u()(),fe(91,Q7,5,0,"div",90),u()()}if(t&2){let e=C();g(10),P("ngIf",e.can("ADMINISTRATOR")),g(7),ft("ngModel",e.filters.typeOfPeople),g(),P("ngValue",void 0),g(2),P("ngForOf",e.tipos),g(6),ft("ngModel",e.filters.category),g(),P("ngValue",void 0),g(2),P("ngForOf",e.categorias),g(),P("ngIf",e.filters.category),g(6),ft("ngModel",e.filters.serviceId),g(),P("ngValue",void 0),g(2),P("ngForOf",e.services),g(6),P("ngIf",!e.selectedEventLabel),g(),P("ngIf",e.selectedEventLabel),g(),P("ngIf",e.filters.eventId),g(6),P("ngForOf",e.groupByOptions),g(3),ft("ngModel",e.separateByDate),g(11),P("ngIf",e.filters.userId),g(),P("ngIf",!e.filters.userId),g(),P("ngIf",e.memberResults.length>0&&!e.filters.userId),g(6),ft("ngModel",e.filters.startDate),g(5),ft("ngModel",e.filters.endDate),g(3),ft("ngModel",e.filters.onlyActive),g(6),P("disabled",e.isLoading),g(),je(" ",e.isLoading?"Generando...":"Generar Reporte"," "),g(),P("ngIf",e.isLoading)}}function tI(t,r){t&1&&j(0,"div",143)}function rI(t,r){if(t&1){let e=Pe();d(0,"div",137)(1,"div",138),j(2,"i",139),u(),d(3,"div",140)(4,"label",141)(5,"input",88),ht("ngModelChange",function(i){let a=D(e).$implicit;return ut(a.visible,i)||(a.visible=i),N(i)}),u(),j(6,"span",75),_(7),u()(),fe(8,tI,1,0,"div",142),u()}if(t&2){let e=r.$implicit;g(5),ft("ngModel",e.visible),g(2),je(" ",e.label," ")}}function nI(t,r){if(t&1){let e=Pe();d(0,"div",48),L("click",function(){D(e);let i=C();return N(i.closeReportModal())}),d(1,"div",115),L("click",function(i){return D(e),N(i.stopPropagation())}),d(2,"div",50)(3,"div",116)(4,"h3"),j(5,"i",117),_(6," Configurar Reporte"),u(),d(7,"p"),_(8,"Personaliza las columnas y el orden de la informaci\xF3n."),u()(),d(9,"button",51),L("click",function(){D(e);let i=C();return N(i.closeReportModal())}),_(10,"\xD7"),u()(),d(11,"div",52)(12,"div",118)(13,"div",119)(14,"div",56)(15,"label"),j(16,"i",62),_(17," Agrupar por (Tablas separadas)"),u(),d(18,"div",58)(19,"select",59),ht("ngModelChange",function(i){D(e);let a=C();return ut(a.groupBy,i)||(a.groupBy=i),N(i)}),d(20,"option",120),_(21,"Sin Agrupar"),u(),d(22,"option",121),_(23,"Fecha"),u(),d(24,"option",122),_(25,"Sede"),u(),d(26,"option",123),_(27,"Servicio"),u(),d(28,"option",124),_(29,"Categor\xEDa"),u(),d(30,"option",125),_(31,"Tipo de Persona"),u()()()(),d(32,"div",126)(33,"label",73)(34,"input",88),ht("ngModelChange",function(i){D(e);let a=C();return ut(a.includeTotals,i)||(a.includeTotals=i),N(i)}),u(),j(35,"span",75),_(36," Incluir Totales y Promedios "),u(),d(37,"label",73)(38,"input",88),ht("ngModelChange",function(i){D(e);let a=C();return ut(a.separateByDate,i)||(a.separateByDate=i),N(i)}),u(),j(39,"span",75),_(40," Separar por Fecha de Servicio "),u()()(),d(41,"div",127),L("cdkDropListDropped",function(i){D(e);let a=C();return N(a.dropColumn(i))}),fe(42,rI,9,2,"div",128),u(),d(43,"div",129),j(44,"i",130),d(45,"p"),_(46,"Arrastra las columnas para cambiar su orden en el reporte final (solo afecta la exportaci\xF3n)."),u()()()(),d(47,"div",131)(48,"div",132)(49,"button",133),L("click",function(){D(e);let i=C();return N(i.exportReport("excel"))}),j(50,"i",134),_(51," Exportar a Excel "),u(),d(52,"button",135),L("click",function(){D(e);let i=C();return N(i.exportReport("pdf"))}),j(53,"i",136),_(54," Exportar a PDF "),u()()()()()}if(t&2){let e=C();g(19),ft("ngModel",e.groupBy),g(15),ft("ngModel",e.includeTotals),g(4),ft("ngModel",e.separateByDate),g(4),P("ngForOf",e.reportColumns),g(7),P("disabled",e.exportLoading),g(3),P("disabled",e.exportLoading)}}function iI(t,r){if(t&1){let e=Pe();d(0,"div",48),L("click",function(){D(e);let i=C();return N(i.closeCalendarModal())}),d(1,"div",144),L("click",function(i){return D(e),N(i.stopPropagation())}),d(2,"div",50)(3,"h3"),_(4,"Seleccionar Evento"),u(),d(5,"button",51),L("click",function(){D(e);let i=C();return N(i.closeCalendarModal())}),_(6,"\xD7"),u()(),d(7,"div",145)(8,"app-service-calendar",146),L("eventSelected",function(i){D(e);let a=C();return N(a.onEventSelected(i))}),u()()()()}t&2&&(g(8),P("isAdmin",!0)("isSelectionMode",!0))}var Ru=class t{integranteService=Ce(Ri);asistenciaService=Ce(no);reporteService=Ce(Dc);reportService=Ce(Fc);datePipe=Ce(Ji);cdr=Ce(Un);notificationService=Ce(Kr);memberConfigService=Ce(wa);themeService=Ce(Hs);branchService=Ce(ba);authService=Ce(fr);chart;onGroupByChange(r,e){let n=e.target.checked;if(this.filters.groupBy||(this.filters.groupBy=[]),n)this.filters.groupBy.includes(r)||this.filters.groupBy.push(r);else{let i=this.filters.groupBy.indexOf(r);i!==-1&&this.filters.groupBy.splice(i,1)}}showFilterModal=!1;showCalendarModal=!1;isLoading=!1;renderChart=!1;services=[];branches=[];reportData=[];branchWidgetData=[];categoryWidgetData=[];topMembersWidgetData=[];Math=Math;stats={totalAttendance:0,peakAttendance:0,avgAttendance:0,topCategory:{name:"-",value:0}};currentPage=0;pageSize=15;totalStatsCalculated=!1;allXLabels=[];allSeries=[];filters={onlyActive:!0,typeOfPeople:void 0,category:void 0,subCategory:void 0,serviceId:void 0,branchId:void 0,groupBy:[],startDate:"",endDate:"",userId:"",eventId:""};selectedEventLabel="";separateByDate=!0;groupByOptions=[{id:"BRANCH",label:"Por Sede"},{id:"CATEGORY",label:"Por Categor\xEDa"},{id:"SUBCATEGORY",label:"Por Sub-Categor\xEDa"},{id:"TYPE",label:"Por Tipo"},{id:"SERVICE",label:"Por Servicio"}];memberSearchQuery="";memberResults=[];selectedMemberName="";isSearchingMembers=!1;memberSearchSubject=new Bt;showReportModal=!1;exportLoading=!1;reportColumns=[{id:"date",label:"Fecha",visible:!0,order:0},{id:"branchName",label:"Sede",visible:!0,order:1},{id:"serviceName",label:"Servicio",visible:!0,order:2},{id:"category",label:"Categor\xEDa",visible:!0,order:3},{id:"subCategory",label:"Sub-categor\xEDa",visible:!0,order:4},{id:"typePeople",label:"Tipo",visible:!0,order:5},{id:"total",label:"Total",visible:!0,order:6}];groupBy="";includeTotals=!0;tipos=[];categorias=[];get availableSubCategories(){return this.filters.category?this.categorias.find(e=>e.id===this.filters.category)?.subCategories||[]:[]}chartOptions;themeEffect=ll(()=>{let r=this.themeService.isDarkMode();this.reportData.length>0?this.updateChart():this.chartOptions=this.getPremiumChartOptions([],[],r)});ngOnInit(){this.adjustPageSize(),this.setupMemberSearchDebounce(),this.chartOptions=this.getPremiumChartOptions([],[],this.themeService.isDarkMode()),this.loadServices(),this.can("ADMINISTRATOR")&&this.loadBranches(),this.loadMemberConfigs();let r=new Date,e=new Date(r.getFullYear(),r.getMonth(),1,0,0,0),n=new Date(r.getFullYear(),r.getMonth(),r.getDate(),23,59,59);this.filters.startDate=this.toLocalISOString(e),this.filters.endDate=this.toLocalISOString(n),this.applyFilters()}can(r){return this.authService.can(r)}toLocalISOString(r){let e=r.getTimezoneOffset()*6e4;return new Date(r.getTime()-e).toISOString().slice(0,16)}loadBranches(){this.branchService.findAll().subscribe(r=>{this.branches=r})}loadMemberConfigs(){jg({categories:this.memberConfigService.getCategories(),types:this.memberConfigService.getTypes()}).subscribe({next:r=>{this.categorias=r.categories,this.tipos=r.types,this.cdr.detectChanges()},error:r=>{console.error("Error loading member configurations:",r),this.notificationService.error("Error al cargar las categor\xEDas y tipos.")}})}onResize(r){this.adjustPageSize(),this.reportData.length>0&&this.updateChart()}adjustPageSize(){this.pageSize=window.innerWidth<=768?5:15}loadServices(){this.asistenciaService.getServices(!1).subscribe(r=>{this.services=r})}getPremiumChartOptions(r,e,n){let i=r&&r.length>0?r:[{name:"Sin Datos",data:[]}],a=e&&e.length>0?e:["-"];return{series:i,chart:{height:450,type:"bar",stacked:!0,toolbar:{show:!1,tools:{download:!0,selection:!1,zoom:!1,zoomin:!1,zoomout:!1,pan:!1,reset:!1}},animations:{enabled:!0,easing:"easeinout",speed:800},fontFamily:"Inter, sans-serif"},theme:{mode:n?"dark":"light"},plotOptions:{bar:{horizontal:!1,columnWidth:"55%",borderRadius:6,dataLabels:{total:{enabled:!0,style:{fontWeight:900,color:n?"#ffffff":"#000000"}}}}},dataLabels:{enabled:!0,style:{fontSize:"10px",fontWeight:"bold",colors:["#ffffff"]},dropShadow:{enabled:!0,top:1,left:1,blur:1,color:"#000",opacity:.45},formatter:function(o){return o>0?o:""}},stroke:{show:!0,width:2,colors:["transparent"]},xaxis:{type:"category",categories:a,labels:{show:!0,formatter:o=>this.separateByDate&&o&&o.includes("-")&&o.split(" ")[0].split("-")[2]||o,rotate:-90,rotateAlways:!0,style:{fontSize:"11px",cssClass:"chart-xaxis-label"},trim:!1,minHeight:100,maxHeight:180,hideOverlappingLabels:!1},axisBorder:{show:!0,color:n?"rgba(255,255,255,0.1)":"rgba(0,0,0,0.1)"},axisTicks:{show:!0,color:n?"rgba(255,255,255,0.1)":"rgba(0,0,0,0.1)"},tooltip:{enabled:!1}},yaxis:{title:{text:"Asistencia",style:{color:n?"#f8fafc":"#1e293b"}},labels:{style:{fontSize:"11px"}},min:0,forceNiceScale:!0},fill:{opacity:1},legend:{position:"top",horizontalAlign:"left",fontSize:"13px",fontWeight:600,labels:{fontSize:"13px"},markers:{radius:12}},grid:{borderColor:n?"rgba(255,255,255,0.1)":"#f1f5f9",strokeDashArray:4,xaxis:{lines:{show:!1}}},tooltip:{theme:n?"dark":"light",shared:!0,intersect:!1,x:{show:!0,formatter:o=>typeof o=="number"?e[o-1]||`${o}`:o}},colors:["#10b981","#3b82f6","#f472b6","#fbbf24","#6366f1"]}}openFilterModal(){this.showFilterModal=!0}closeFilterModal(){this.showFilterModal=!1,this.memberResults=[],this.memberSearchQuery=""}setupMemberSearchDebounce(){this.memberSearchSubject.pipe(Ki(1e3),Oi()).subscribe(r=>{if(!r||r.length<2){this.memberResults=[];return}this.isSearchingMembers=!0;let e={onlyActive:!0,query:r};this.integranteService.searchMembers(e,0).subscribe({next:n=>{this.memberResults=n.data,this.isSearchingMembers=!1},error:()=>{this.isSearchingMembers=!1,this.memberResults=[]}})})}onMemberSearch(){this.memberSearchSubject.next(this.memberSearchQuery)}selectMember(r){this.filters.userId=r.id,this.selectedMemberName=r.completeName,this.reporteService.lastMemberSelection={id:r.id,name:r.completeName},this.memberResults=[],this.memberSearchQuery=""}clearMemberSelection(){this.filters.userId="",this.selectedMemberName="",this.reporteService.lastMemberSelection=null,this.memberResults=[],this.memberSearchQuery=""}applyFilters(){this.isLoading=!0;let r={onlyActive:this.filters.onlyActive,userId:this.filters.userId||void 0,typePeoples:this.filters.typeOfPeople?[this.filters.typeOfPeople]:void 0,categories:this.filters.category?[this.filters.category]:void 0,subCategories:this.filters.subCategory?[this.filters.subCategory]:void 0,serviceIds:this.filters.serviceId?[this.filters.serviceId]:void 0,branchIds:this.filters.branchId?[this.filters.branchId]:void 0,eventId:this.filters.eventId||void 0,groupBy:this.getFinalGroupBy()},e=n=>{if(n)return n.includes("T")?n.split(":").length===2?`${n}:00`:n:`${n}T00:00:00`};r.startDate=e(this.filters.startDate),r.endDate=e(this.filters.endDate),this.reporteService.generateReport(r).subscribe({next:n=>{this.reportData=n,this.calculateStats(),this.reporteService.lastReportData=n,this.reporteService.lastFilters=Yr({},this.filters),this.reporteService.lastStats=Yr({},this.stats),this.calculateWidgetData(),this.updateChart(),this.isLoading=!1,this.closeFilterModal()},error:n=>{console.error("Error fetching report:",n),this.isLoading=!1}})}updateChart(){if(!this.reportData||this.reportData.length===0){this.renderChart=!1,this.resetStats(),this.cdr.detectChanges();return}this.calculateStats();let r=!this.filters.groupBy||this.filters.groupBy.includes("DATE")||this.filters.groupBy.includes("SERVICE")||this.separateByDate,e=new Map;this.reportData.forEach(o=>{let s="",l="";if(r){s=o.serviceTime||`${o.date}_${o.serviceName}`;let c=o.date||"";if(o.serviceTime&&o.serviceTime.includes("T")){let f=o.serviceTime.split("T")[1].substring(0,5);c=`${o.date} ${f}`}l=`${c} ${o.serviceName?"- "+o.serviceName:""}`}else this.filters.groupBy.includes("BRANCH")?(s=o.branchName||"Sin Sede",l=o.branchName||"Sin Sede"):this.filters.groupBy.includes("CATEGORY")?(s=typeof o.category=="string"?o.category:o.category?.name||"Sin Categor\xEDa",l=s):(s="Total",l="Total");e.has(s)||e.set(s,l)});let n=Array.from(e.keys()).sort();this.allXLabels=n.map(o=>e.get(o));let i=o=>{if(this.separateByDate){if(o.category){let l=typeof o.category=="string"?o.category:o.category?.name||"Sin Categor\xEDa",c=o.subCategory;return c?`${l} \u2022 ${c}`:l}return"Total"}let s=[];if(this.filters.groupBy?.includes("BRANCH")&&r&&s.push(o.branchName||"-"),this.filters.groupBy?.includes("CATEGORY")){let l=typeof o.category=="string"?o.category:o.category?.name||"-";s.push(l)}if(this.filters.groupBy?.includes("SUBCATEGORY")&&s.push(o.subCategory||"-"),this.filters.groupBy?.includes("TYPE")){let l=typeof o.typePeople=="string"?o.typePeople:o.typePeople?.name||"-";s.push(l)}return s.length>0?s.join(" \u2022 "):"Total"},a=Array.from(new Set(this.reportData.map(o=>i(o)))).sort();this.allSeries=a.map(o=>{let s=n.map(l=>this.reportData.filter(f=>{let v=!1;return r?v=(f.serviceTime||`${f.date}_${f.serviceName}`)===l:this.filters.groupBy?.includes("BRANCH")?v=(f.branchName||"Sin Sede")===l:this.filters.groupBy?.includes("CATEGORY")?v=(typeof f.category=="string"?f.category:f.category?.name||"Sin Categor\xEDa")===l:v=!0,v&&i(f)===o}).reduce((f,v)=>f+(v.total||0),0));return{name:o,data:s}}),this.renderChartPage()}renderChartPage(){this.renderChart=!1,this.cdr.detectChanges();let r=this.currentPage*this.pageSize,e=r+this.pageSize,n=this.allXLabels.slice(r,e),i=this.allSeries.map(a=>({name:a.name,data:a.data.slice(r,e)}));setTimeout(()=>{this.chartOptions=this.getPremiumChartOptions(i,n,this.themeService.isDarkMode()),this.renderChart=!0,this.cdr.detectChanges()},50)}nextPage(){(this.currentPage+1)*this.pageSize<this.allXLabels.length&&(this.currentPage++,this.renderChartPage())}prevPage(){this.currentPage>0&&(this.currentPage--,this.renderChartPage())}get totalPages(){return Math.ceil(this.allXLabels.length/this.pageSize)}calculateStats(){let r=this.reportData.reduce((c,f)=>c+(f.total||0),0),e=c=>c.serviceTime?c.serviceTime:c.date?c.date+(c.serviceName||""):c.branchName?c.branchName:"Total",n=new Map,i=new Map;this.reportData.forEach(c=>{let f=e(c);if(n.set(f,(n.get(f)||0)+(c.total||0)),c.category){let v=typeof c.category=="string"?c.category:c.category?.name||"-",x=c.subCategory?`${v} \u2022 ${c.subCategory}`:v;i.set(x,(i.get(x)||0)+(c.total||0))}});let a=Array.from(n.values()),o=a.length>0?Math.max(...a):0,s=a.length>0?r/a.length:0,l={name:"-",value:0};i.forEach((c,f)=>{c>l.value&&(l={name:f,value:c})}),this.stats={totalAttendance:r,peakAttendance:o,avgAttendance:Math.round(s),topCategory:l}}getFinalGroupBy(){let r=this.filters.groupBy?[...this.filters.groupBy]:[];return r.length>0?r:void 0}calculateWidgetData(){let r=new Map;this.reportData.forEach(i=>{let a=i.branchName||"Sin Sede";r.set(a,(r.get(a)||0)+(i.total||0))}),this.branchWidgetData=Array.from(r.entries()).map(([i,a])=>({name:i,total:a})).sort((i,a)=>a.total-i.total).slice(0,5);let e=new Map;this.reportData.forEach(i=>{let a=typeof i.category=="string"?i.category:i.category?.name||"Sin Categor\xEDa";e.set(a,(e.get(a)||0)+(i.total||0))}),this.categoryWidgetData=Array.from(e.entries()).map(([i,a])=>({name:i,total:a})).sort((i,a)=>a.total-i.total).slice(0,5);let n=new Map;this.reportData.forEach(i=>{let a=typeof i.typePeople=="string"?i.typePeople:i.typePeople?.name||"Otro";n.set(a,(n.get(a)||0)+(i.total||0))}),this.topMembersWidgetData=Array.from(n.entries()).map(([i,a])=>({name:i,total:a})).sort((i,a)=>a.total-i.total).slice(0,5)}resetStats(){this.stats={totalAttendance:0,peakAttendance:0,avgAttendance:0,topCategory:{name:"-",value:0}}}isExporting=!1;openReportModal(){!this.reportData||this.reportData.length===0||(this.showReportModal=!0)}closeReportModal(){this.showReportModal=!1}dropColumn(r){Nu(this.reportColumns,r.previousIndex,r.currentIndex),this.reportColumns.forEach((e,n)=>e.order=n)}exportReport(r){if(!this.reportData||this.reportData.length===0)return;this.exportLoading=!0;let e=`Reporte_Asistencia_${this.datePipe.transform(new Date,"yyyyMMdd_HHmm")}`,n=this.reportColumns.filter(i=>i.id==="total"?!0:this.reportData.some(a=>{let o=a[i.id];return o!=null&&o!==""}));r==="excel"?this.reportService.exportToExcel(this.reportData,n,e,this.groupBy||(this.separateByDate?"date":void 0),this.includeTotals,this.separateByDate):this.reportService.exportToPdf(this.reportData,n,e,"Reporte de Asistencias",this.groupBy||(this.separateByDate?"date":void 0),this.includeTotals,this.separateByDate),this.exportLoading=!1,this.closeReportModal()}downloadReport(){this.openReportModal()}openCalendarModal(){this.showCalendarModal=!0}closeCalendarModal(){this.showCalendarModal=!1}onEventSelected(r){this.filters.eventId=r.id;let e=new Date(r.startDateTime).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),n=new Date(r.startDateTime).toLocaleDateString();this.selectedEventLabel=`${r.serviceName} (${n} ${e})`,this.showCalendarModal=!1}clearEventFilter(){this.filters.eventId="",this.selectedEventLabel=""}static \u0275fac=function(e){return new(e||t)};static \u0275cmp=ir({type:t,selectors:[["app-reportes"]],viewQuery:function(e,n){if(e&1&&Bh(E7,5),e&2){let i;Uh(i=Vh())&&(n.chart=i.first)}},hostBindings:function(e,n){e&1&&L("resize",function(a){return n.onResize(a)},Kg)},features:[vs([Ji])],decls:19,vars:11,consts:[["chart",""],[1,"reportes-container"],[1,"card","main-report-card"],[1,"card-header","spread","justify-end"],[1,"header-right","buttons"],[1,"btn","btn-secondary",3,"click"],[1,"fa-solid","fa-filter"],[1,"btn","btn-primary",3,"click","disabled"],[1,"fa-solid",3,"ngClass"],[1,"card-body-scroll"],["class","widgets-grid",4,"ngIf"],["class","stats-grid compact-stats",4,"ngIf"],["class","chart-section mt-4",4,"ngIf"],["class","empty-state mt-4",4,"ngIf"],["class","modal-overlay",3,"click",4,"ngIf"],[1,"widgets-grid"],[1,"widget-card"],[1,"widget-header"],[1,"widget-title"],[1,"fa-solid","fa-building-circle-check"],[1,"widget-content"],[1,"widget-table"],[4,"ngFor","ngForOf"],[1,"fa-solid","fa-tags"],[1,"fa-solid","fa-users-viewfinder"],[1,"value-badge"],[1,"stats-grid","compact-stats"],[1,"stat-card","mini"],[1,"stat-info"],[1,"stat-label"],[1,"stat-value","mini"],[1,"chart-section","mt-4"],[1,"chart-header"],[1,"chart-title"],[1,"fa-solid","fa-chart-line"],["class","chart-pagination",4,"ngIf"],["id","chart",1,"chart-container"],[3,"series","chart","xaxis","dataLabels","grid","stroke","tooltip","yaxis","plotOptions","fill","colors","legend"],[1,"chart-pagination"],[1,"btn-icon",3,"click","disabled"],[1,"fa-solid","fa-chevron-left"],[1,"page-info"],[1,"fa-solid","fa-chevron-right"],[1,"chart-loading"],[1,"fa-solid","fa-circle-notch","fa-spin"],[1,"empty-state","mt-4"],[1,"fa-solid","fa-chart-column"],[1,"btn","btn-outline-primary","mt-3",3,"click"],[1,"modal-overlay",3,"click"],[1,"modal-content","filter-modal",3,"click"],[1,"modal-header"],[1,"btn-close",3,"click"],[1,"modal-body"],[1,"filter-form","premium-form"],["class","form-group premium-group",4,"ngIf"],[1,"form-row"],[1,"form-group","premium-group"],[1,"fa-solid","fa-user-tag"],[1,"select-wrapper"],[1,"form-control","premium-select",3,"ngModelChange","ngModel"],[3,"ngValue"],[3,"value",4,"ngFor","ngForOf"],[1,"fa-solid","fa-layer-group"],[1,"form-control","premium-select",3,"ngModelChange","change","ngModel"],[1,"fa-solid","fa-church"],[1,"fa-solid","fa-calendar-check"],[1,"event-selection-display",3,"click"],["class","placeholder-text",4,"ngIf"],["class","selected-text",4,"ngIf"],["class","clear-selection-btn-report",3,"click",4,"ngIf"],[1,"fa-solid","fa-list-check"],[1,"grouping-options-grid"],["class","premium-checkbox",4,"ngFor","ngForOf"],[1,"premium-checkbox"],["type","checkbox",3,"ngModelChange","change","ngModel"],[1,"checkmark"],[1,"fa-solid","fa-calendar-day",2,"margin-right","5px"],[1,"text-muted",2,"display","block","margin-top","5px","font-size","0.75rem"],[1,"form-group","premium-group","search-member-group"],[1,"fa-solid","fa-user-magnifying-glass"],[1,"search-input-container"],["class","selected-member-chip",4,"ngIf"],["class","input-relative",4,"ngIf"],["class","search-results-dropdown",4,"ngIf"],[1,"fa-solid","fa-calendar-plus"],["type","datetime-local",1,"form-control","premium-date",3,"ngModelChange","ngModel"],[1,"fa-solid","fa-calendar-minus"],[1,"form-group"],["type","checkbox",3,"ngModelChange","ngModel"],[1,"modal-footer"],["class","modal-loading-overlay",4,"ngIf"],[1,"fa-solid","fa-building-flag"],[3,"value"],[1,"placeholder-text"],[1,"selected-text"],[1,"clear-selection-btn-report",3,"click"],["type","checkbox",3,"change","value","checked"],[1,"selected-member-chip"],[1,"remove-chip",3,"click"],[1,"input-relative"],[1,"fa-solid","fa-magnifying-glass","search-icon"],["type","text","placeholder","Escribe el nombre del integrante...",1,"form-control","premium-input-icon",3,"ngModelChange","input","ngModel"],["class","fa-solid fa-circle-notch fa-spin loader-icon",4,"ngIf"],[1,"fa-solid","fa-circle-notch","fa-spin","loader-icon"],[1,"search-results-dropdown"],["class","result-item",3,"click",4,"ngFor","ngForOf"],[1,"result-item",3,"click"],["alt","",3,"src"],[1,"result-info"],[1,"result-name"],[1,"result-meta"],[4,"ngIf"],[1,"modal-loading-overlay"],[1,"spinner-wrapper"],[1,"spinner-circle"],[1,"modal-content","report-modal",3,"click"],[1,"report-header-info"],[1,"fa-solid","fa-gears"],[1,"report-config-layout"],[1,"report-grouping-section"],["value",""],["value","date"],["value","branchName"],["value","serviceName"],["value","category"],["value","typePeople"],[1,"export-extra-options"],["cdkDropList","",1,"column-selection-list",3,"cdkDropListDropped"],["class","column-item","cdkDrag","",4,"ngFor","ngForOf"],[1,"report-preview-note"],[1,"fa-solid","fa-circle-info"],[1,"modal-footer","report-footer"],[1,"export-actions"],[1,"btn","btn-excel",3,"click","disabled"],[1,"fa-solid","fa-file-excel"],[1,"btn","btn-pdf",3,"click","disabled"],[1,"fa-solid","fa-file-pdf"],["cdkDrag","",1,"column-item"],["cdkDragHandle","",1,"column-drag-handle"],[1,"fa-solid","fa-grip-vertical"],[1,"column-info"],[1,"custom-checkbox"],["class","column-placeholder",4,"cdkDragPlaceholder"],[1,"column-placeholder"],[1,"modal-content","calendar-selection-modal",3,"click"],[1,"modal-body","calendar-modal-body"],[3,"eventSelected","isAdmin","isSelectionMode"]],template:function(e,n){e&1&&(d(0,"div",1)(1,"div",2)(2,"div",3)(3,"div",4)(4,"button",5),L("click",function(){return n.openFilterModal()}),j(5,"i",6),_(6," Filtros Avanzados "),u(),d(7,"button",7),L("click",function(){return n.openReportModal()}),j(8,"i",8),_(9),u()()(),d(10,"div",9),fe(11,A7,49,3,"div",10)(12,T7,19,3,"div",11)(13,F7,10,13,"div",12)(14,D7,6,0,"div",12)(15,N7,8,0,"div",13),u()()(),fe(16,eI,92,25,"div",14)(17,nI,55,6,"div",14)(18,iI,9,2,"div",14)),e&2&&(g(7),P("disabled",n.reportData.length===0||n.exportLoading),g(),P("ngClass",n.exportLoading?"fa-circle-notch fa-spin":"fa-file-export"),g(),je(" ",n.exportLoading?"Exportando...":"Exportar Reporte"," "),g(2),P("ngIf",n.reportData.length>0),g(),P("ngIf",n.reportData.length>0),g(),P("ngIf",n.renderChart&&n.reportData.length>0),g(),P("ngIf",n.isLoading),g(),P("ngIf",n.reportData.length===0),g(),P("ngIf",n.showFilterModal),g(),P("ngIf",n.showReportModal),g(),P("ngIf",n.showCalendarModal))},dependencies:[gr,Tr,rn,mr,on,Fi,Di,nn,ys,Ii,an,Vn,ku,Su,v5,g5,m5,u5,_5,Kl],styles:['[_nghost-%COMP%]{display:block;height:100%;width:100%;min-height:0}.reportes-container[_ngcontent-%COMP%]{height:100%;display:flex;flex-direction:column;max-width:1200px;margin:0 auto}.main-report-card[_ngcontent-%COMP%]{display:flex;flex-direction:column;min-height:0;height:100%;overflow:hidden}.card-body-scroll[_ngcontent-%COMP%]{flex:1;overflow-y:auto;padding:.75rem;margin:0}.stats-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:1rem;margin-bottom:1rem}.stat-card[_ngcontent-%COMP%]{background:var(--bg-card);padding:1.25rem;border-radius:16px;border:1px solid var(--border-color);display:flex;align-items:center;gap:1rem;transition:transform .2s}.stat-card[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 10px 15px -3px #0000000d}.stat-icon[_ngcontent-%COMP%]{width:48px;height:48px;border-radius:12px;display:flex;align-items:center;justify-content:center;font-size:1.25rem}.stat-icon.total[_ngcontent-%COMP%]{background:var(--bg-input);color:#3b82f6}.stat-icon.peak[_ngcontent-%COMP%]{background:var(--bg-input);color:#db2777}.stat-icon.avg[_ngcontent-%COMP%]{background:var(--bg-input);color:#16a34a}.stat-icon.cat[_ngcontent-%COMP%]{background:var(--bg-input);color:#f59e0b}.stat-info[_ngcontent-%COMP%]{display:flex;flex-direction:column}.stat-label[_ngcontent-%COMP%]{font-size:.75rem;font-weight:600;color:var(--text-muted);text-transform:uppercase}.stat-value[_ngcontent-%COMP%]{font-size:1.5rem;font-weight:800;color:var(--text-main);margin:.1rem 0}.stat-trend[_ngcontent-%COMP%]{font-size:.7rem;font-weight:500}.stat-trend.positive[_ngcontent-%COMP%]{color:#16a34a}.chart-section[_ngcontent-%COMP%]{background:var(--bg-card);padding:1rem;border-radius:16px;border:1px solid var(--border-color);box-shadow:var(--shadow-sm);margin:0;min-height:380px;display:flex;flex-direction:column}.chart-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:1rem;padding:0 .5rem;flex-direction:column}.chart-title[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;font-weight:700;color:var(--text-main)}.chart-pagination[_ngcontent-%COMP%]{display:flex;align-items:center;gap:1rem;background:var(--bg-input);padding:.25rem .75rem;border-radius:10px}.page-info[_ngcontent-%COMP%]{font-size:.8rem;font-weight:600;color:var(--text-muted)}.btn-icon[_ngcontent-%COMP%]{background:none;border:none;cursor:pointer;color:var(--primary);padding:.25rem;border-radius:4px;transition:background .2s}.btn-icon[_ngcontent-%COMP%]:hover:not(:disabled){background:var(--border-color)}.btn-icon[_ngcontent-%COMP%]:disabled{color:#cbd5e1;cursor:not-allowed}.chart-container[_ngcontent-%COMP%]{flex:1;width:100%;min-height:280px;position:relative;margin:0 auto}  .apexcharts-xaxis-label,   .apexcharts-yaxis-label,   .apexcharts-legend-text,   .apexcharts-xaxis-title-text,   .apexcharts-yaxis-title-text,   .apexcharts-datalabel{fill:var(--text-main)!important;color:var(--text-main)!important}  .apexcharts-tooltip{background:var(--bg-card)!important;border:1px solid var(--border-color)!important;box-shadow:var(--shadow-md)!important;color:var(--text-main)!important}  .apexcharts-tooltip-title{background:var(--bg-input)!important;border-bottom:1px solid var(--border-color)!important;color:var(--text-main)!important}  .apexcharts-xaxistooltip{background:var(--bg-card)!important;color:var(--text-main)!important;border-color:var(--border-color)!important}.chart-loading[_ngcontent-%COMP%]{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);text-align:center;color:var(--primary)}.chart-loading[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:2.5rem;margin-bottom:1rem}.report-table-container[_ngcontent-%COMP%]{background:var(--bg-card);border-radius:12px;border:1px solid var(--border-color);overflow:hidden}.report-table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;font-size:.875rem}.report-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background-color:var(--bg-input);padding:.75rem 1rem;text-align:left;font-weight:600;color:var(--text-muted);border-bottom:1px solid var(--border-color)}.report-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:.75rem 1rem;border-bottom:1px solid var(--border-color)}.report-table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:last-child   td[_ngcontent-%COMP%]{border-bottom:none}.modal-overlay[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;background-color:#00000080;display:flex;align-items:center;justify-content:center;z-index:2000;-webkit-backdrop-filter:blur(4px);backdrop-filter:blur(4px)}.modal-content[_ngcontent-%COMP%]{background:var(--bg-card);width:90%;max-width:600px;max-height:90vh;border-radius:16px;box-shadow:var(--shadow-md);overflow:hidden;display:flex;flex-direction:column;animation:_ngcontent-%COMP%_modal-slide-up .3s ease-out}@keyframes _ngcontent-%COMP%_modal-slide-up{0%{transform:translateY(30px);opacity:0}to{transform:translateY(0);opacity:1}}.modal-header[_ngcontent-%COMP%]{padding:1.25rem 1.5rem;border-bottom:1px solid var(--border-color);display:flex;justify-content:space-between;align-items:center;background:var(--bg-input)}.modal-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:1.15rem;font-weight:700;color:var(--text-main);display:flex;align-items:center;gap:.75rem}.btn-close[_ngcontent-%COMP%]{background:var(--border-color);border:none;width:28px;height:28px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:1.2rem;cursor:pointer;color:var(--text-muted);transition:all .2s}.btn-close[_ngcontent-%COMP%]:hover{background:var(--text-muted);color:var(--white)}.modal-body[_ngcontent-%COMP%]{padding:1.5rem;overflow-y:auto;flex:1}.modal-footer[_ngcontent-%COMP%]{padding:1rem 1.5rem;border-top:1px solid var(--border-color);display:flex;justify-content:flex-end;gap:1rem;background:var(--bg-input)}.filter-modal[_ngcontent-%COMP%]{max-width:550px!important;overflow:visible!important}.filter-form[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1.25rem}.form-row[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:1rem}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;font-size:.875rem;font-weight:500;margin-bottom:.5rem}.checkbox-label[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;cursor:pointer;font-size:.875rem;font-weight:500}.checkbox-label[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:1.125rem;height:1.125rem;margin:0}.premium-form[_ngcontent-%COMP%]{padding:.5rem}.premium-group[_ngcontent-%COMP%]{margin-bottom:1.25rem}.premium-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;font-size:.85rem;font-weight:700;color:var(--text-main);margin-bottom:.5rem;text-transform:uppercase;letter-spacing:.02em}.premium-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:var(--primary);width:16px}.premium-select[_ngcontent-%COMP%], .premium-input-icon[_ngcontent-%COMP%], .premium-date[_ngcontent-%COMP%]{width:100%;padding:.75rem 1rem;border:1px solid var(--border-color);border-radius:12px;font-size:.9rem;color:var(--text-main);background-color:var(--bg-input);transition:all .2s;appearance:none}.premium-select[_ngcontent-%COMP%]:focus, .premium-input-icon[_ngcontent-%COMP%]:focus, .premium-date[_ngcontent-%COMP%]:focus{background-color:var(--bg-card);border-color:var(--primary);box-shadow:0 0 0 4px #3b82f61a;outline:none}.select-wrapper[_ngcontent-%COMP%]{position:relative}.select-wrapper[_ngcontent-%COMP%]:after{content:"\\f078";font-family:"Font Awesome 6 Free";font-weight:900;position:absolute;right:1rem;top:50%;transform:translateY(-50%);color:var(--text-muted);font-size:.7rem;pointer-events:none}.search-member-group[_ngcontent-%COMP%], .input-relative[_ngcontent-%COMP%]{position:relative}.search-icon[_ngcontent-%COMP%]{position:absolute;left:1rem;top:50%;transform:translateY(-50%);color:var(--text-muted)}.loader-icon[_ngcontent-%COMP%]{position:absolute;right:1rem;top:50%;transform:translateY(-50%);color:var(--primary)}.premium-input-icon[_ngcontent-%COMP%]{padding-left:2.75rem}.search-results-dropdown[_ngcontent-%COMP%]{position:absolute;top:calc(100% + 5px);left:0;right:0;background:var(--bg-card);border:1px solid var(--border-color);border-radius:12px;box-shadow:var(--shadow-md);z-index:1000;max-height:250px;overflow-y:auto;animation:_ngcontent-%COMP%_dropdown-fade-in .2s ease-out}@keyframes _ngcontent-%COMP%_dropdown-fade-in{0%{opacity:0;transform:translateY(-5px)}to{opacity:1;transform:translateY(0)}}.result-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:1rem;padding:.75rem 1rem;cursor:pointer;transition:background .2s}.result-item[_ngcontent-%COMP%]:hover{background-color:var(--bg-input)}.result-item[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:32px;height:32px;border-radius:50%;object-fit:cover}.result-info[_ngcontent-%COMP%]{display:flex;flex-direction:column}.result-name[_ngcontent-%COMP%]{font-weight:600;font-size:.85rem;color:var(--text-main)}.result-meta[_ngcontent-%COMP%]{font-size:.7rem;color:var(--text-muted)}.selected-member-chip[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.75rem;background:var(--bg-input);border:1px solid var(--border-color);padding:.5rem 1rem;border-radius:12px;color:var(--primary);font-weight:600;font-size:.9rem}.remove-chip[_ngcontent-%COMP%]{background:none;border:none;font-size:1.25rem;cursor:pointer;color:var(--primary);display:flex;align-items:center}.premium-checkbox[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.75rem;cursor:pointer;font-size:.9rem;font-weight:500;color:var(--text-muted);-webkit-user-select:none;user-select:none}.premium-checkbox[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{height:18px;width:18px;cursor:pointer;accent-color:var(--primary)}.empty-state[_ngcontent-%COMP%]{text-align:center;padding:3rem 2rem;background-color:var(--bg-input);border-radius:16px;border:2px dashed var(--border-color);color:var(--text-muted)}.empty-state[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:4rem;margin-bottom:1.5rem;color:#cbd5e1}.empty-state[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{color:var(--text-main);margin-bottom:.5rem}.mt-3[_ngcontent-%COMP%]{margin-top:1rem}.mt-4[_ngcontent-%COMP%]{margin-top:2rem}@media(max-width:768px){.form-row[_ngcontent-%COMP%]{grid-template-columns:1fr}}.report-modal[_ngcontent-%COMP%]{max-width:600px}.report-header-info[_ngcontent-%COMP%]{display:flex;flex-direction:column}.report-header-info[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:.85rem;color:var(--text-muted);margin:0;font-weight:500}.report-config-layout[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1.5rem}.column-selection-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.75rem;background:var(--bg-main);padding:1rem;border-radius:12px;border:1.5px solid var(--border-color)}.column-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:1rem;padding:.75rem 1rem;background:var(--bg-card);border:1px solid var(--border-color);border-radius:10px;transition:all .2s ease;cursor:default}.cdk-drag-preview[_ngcontent-%COMP%]{box-sizing:border-box;border-radius:10px;box-shadow:0 5px 5px -3px #0003,0 8px 10px 1px #00000024,0 3px 14px 2px #0000001f}.cdk-drag-placeholder[_ngcontent-%COMP%]{opacity:.3}.cdk-drag-animating[_ngcontent-%COMP%]{transition:transform .25s cubic-bezier(0,0,.2,1)}.column-drag-handle[_ngcontent-%COMP%]{color:#cbd5e1;cursor:grab;padding:.25rem}.column-drag-handle[_ngcontent-%COMP%]:active{cursor:grabbing}.column-info[_ngcontent-%COMP%]{flex:1}.custom-checkbox[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.75rem;cursor:pointer;font-size:.95rem;font-weight:600;color:var(--text-main);margin:0}.checkmark[_ngcontent-%COMP%]{position:relative!important;top:0!important}.report-preview-note[_ngcontent-%COMP%]{display:flex;align-items:flex-start;gap:.75rem;padding:1rem;background:var(--bg-input);border-radius:10px;color:var(--primary);font-size:.85rem}.report-preview-note[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{margin-top:2px}.report-footer[_ngcontent-%COMP%]{padding:1.5rem;border-top:1px solid var(--border-color)}.export-actions[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:1rem;width:100%}.btn-excel[_ngcontent-%COMP%]{background:#15803d;color:#fff}.btn-pdf[_ngcontent-%COMP%]{background:#b91c1c;color:#fff}.btn-excel[_ngcontent-%COMP%], .btn-pdf[_ngcontent-%COMP%]{padding:.75rem;border-radius:10px;font-weight:700;border:none;display:flex;align-items:center;justify-content:center;gap:.5rem;cursor:pointer;transition:all .2s}.btn-excel[_ngcontent-%COMP%]:hover, .btn-pdf[_ngcontent-%COMP%]:hover{filter:brightness(1.1);transform:translateY(-1px)}.modal-loading-overlay[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;background:rgba(var(--bg-card-rgb),.82);display:flex;align-items:center;justify-content:center;z-index:100;animation:_ngcontent-%COMP%_fadeIn .2s ease-out;border-radius:16px;-webkit-backdrop-filter:blur(2px);backdrop-filter:blur(2px)}.spinner-wrapper[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center}.grouping-options-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(140px,1fr));gap:.75rem;background:var(--bg-card);padding:.75rem;border-radius:12px;border:1px solid var(--border-color)}.spinner-circle[_ngcontent-%COMP%]{width:48px;height:48px;border:4px solid #f3f3f3;border-top:4px solid var(--primary, #3b82f6);border-radius:50%;animation:_ngcontent-%COMP%_spin .8s linear infinite}.spinner-wrapper[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:.95rem;font-weight:600;color:var(--primary, #3b82f6)}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0}to{opacity:1}}.widgets-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(300px,1fr));gap:1.5rem;margin-bottom:2rem}.widget-card[_ngcontent-%COMP%]{background:var(--bg-card);border-radius:20px;border:1px solid var(--border-color);padding:1.5rem;box-shadow:var(--shadow-sm);display:flex;flex-direction:column;gap:1rem;transition:all .3s ease}.widget-card[_ngcontent-%COMP%]:hover{box-shadow:var(--shadow-md);border-color:var(--primary)}.widget-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;border-bottom:1px solid var(--border-color);padding-bottom:.75rem}.widget-title[_ngcontent-%COMP%]{font-size:.9rem;font-weight:700;color:var(--text-main);display:flex;align-items:center;gap:.6rem}.widget-title[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:var(--primary)}.widget-content[_ngcontent-%COMP%]{flex:1}.event-selection-display[_ngcontent-%COMP%]{width:100%;padding:.75rem 1rem;border:1.5px solid var(--border-color);border-radius:12px;background:var(--bg-input);cursor:pointer;min-height:42px;display:flex;align-items:center;transition:all .3s ease;position:relative}.event-selection-display[_ngcontent-%COMP%]:hover{border-color:var(--primary);background:var(--bg-card)}.event-selection-display[_ngcontent-%COMP%]   .placeholder-text[_ngcontent-%COMP%]{color:var(--text-muted);font-size:.85rem;font-style:italic}.event-selection-display[_ngcontent-%COMP%]   .selected-text[_ngcontent-%COMP%]{color:var(--primary);font-weight:700;font-size:.85rem}.clear-selection-btn-report[_ngcontent-%COMP%]{position:absolute;right:.75rem;top:50%;transform:translateY(-50%);background:var(--border-color);border:none;border-radius:50%;width:20px;height:20px;display:flex;align-items:center;justify-content:center;cursor:pointer;color:var(--text-muted);z-index:10}.export-extra-options[_ngcontent-%COMP%]{margin-top:1rem;padding:1rem;background:var(--bg-input);border-radius:12px;display:flex;flex-direction:column;gap:.75rem}.export-extra-options[_ngcontent-%COMP%]   .premium-checkbox[_ngcontent-%COMP%]{color:var(--text-main);font-weight:600}.calendar-selection-modal[_ngcontent-%COMP%]{max-width:900px!important;width:95%!important;height:90vh!important}.calendar-modal-body[_ngcontent-%COMP%]{padding:0!important;display:flex;flex-direction:column;height:100%;overflow:hidden}.calendar-modal-body[_ngcontent-%COMP%]   app-service-calendar[_ngcontent-%COMP%]{flex:1;min-height:0}.widget-table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse}.widget-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{text-align:left;font-size:.7rem;color:var(--text-muted);padding:.5rem;text-transform:uppercase}.widget-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:.75rem .5rem;font-size:.85rem;border-bottom:1px solid var(--border-color)}.widget-table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:last-child   td[_ngcontent-%COMP%]{border-bottom:none}.value-badge[_ngcontent-%COMP%]{background:var(--primary-light);color:var(--primary);padding:.2rem .6rem;border-radius:12px;font-weight:700}']})};var Lu=class t{constructor(r){this.http=r}apiUrl=`${Ti.baseUrl}/baptisms`;create(r){let e=new FormData;return e.append("memberId",r.memberId),e.append("date",r.date.toISOString().split("T")[0]),r.imageUrl&&e.append("imageUrl",r.imageUrl),r.note&&e.append("note",r.note),r.address&&e.append("address",r.address),r.neighborhood&&e.append("neighborhood",r.neighborhood),r.city&&e.append("city",r.city),r.municipality&&e.append("municipality",r.municipality),r.district&&e.append("district",r.district),r.postalCode&&e.append("postalCode",r.postalCode),r.latitude&&e.append("latitude",r.latitude),r.longitude&&e.append("longitude",r.longitude),this.http.post(this.apiUrl,e)}search(r,e){let n=new dl().set("page",e.toString());return this.http.post(`${this.apiUrl}/search`,r,{params:n})}invalidate(r){return this.http.post(`${this.apiUrl}/invalidate`,r)}static \u0275fac=function(e){return new(e||t)(c0(Ai))};static \u0275prov=nr({token:t,factory:t.\u0275fac,providedIn:"root"})};var Bu=class t{constructor(){}generateBaptismCertificate(r,e,n,i="CC"){return Cn(this,null,function*(){let a=new bt({orientation:"portrait",unit:"mm",format:"letter"}),o=yield this.loadImage("/img/certificate-template.jpg"),s=a.internal.pageSize.getWidth(),l=a.internal.pageSize.getHeight();a.addImage(o,"PNG",0,0,s,l);let c=`Barranquilla, ${this.formatDateFull(new Date)}`;a.setFont("helvetica","normal"),a.setFontSize(12),a.text(c,20,105),a.setFont("helvetica","normal"),a.setFontSize(12);let f=r.memberName.toUpperCase(),v=this.getDocumentTypeName(i),x=`Que el se\xF1or(a) ${f}, identificado(a) con ${v} No. ${e} expedida en ${n}, recibi\xF3 el Bautismo en agua en conformidad con el mandato del Se\xF1or Jesucristo (Mateo 28:19), el d\xEDa ${this.formatDateFull(new Date(r.date))}, siendo miembro activo de nuestra congregaci\xF3n.`,p=20,S=a.splitTextToSize(x,s-p*2);a.text(S,p,145,{align:"justify",maxWidth:s-p*2});let w=`La presente certificaci\xF3n se expide a solicitud del interesado, al ${this.formatDateFull(new Date)}.`;a.text(w,p,185),a.save(`Certificado_Bautismo_${r.memberName.replace(/\s+/g,"_")}.pdf`)})}loadImage(r){return new Promise((e,n)=>{let i=new Image;i.src=r,i.onload=()=>{let a=document.createElement("canvas");a.width=i.width,a.height=i.height,a.getContext("2d")?.drawImage(i,0,0),e(a.toDataURL("image/png"))},i.onerror=a=>n(a)})}formatDateFull(r){let e={day:"numeric",month:"long",year:"numeric"};return r.toLocaleDateString("es-ES",e)}getDocumentTypeName(r){switch(r){case"CC":return"C\xE9dula de Ciudadan\xEDa";case"TI":return"Tarjeta de Identidad";case"CE":return"C\xE9dula de Extranjer\xEDa";case"PA":return"Pasaporte";case"RC":return"Registro Civil";case"PEP":return"Permiso Especial de Permanencia";case"PPT":return"Permiso por Protecci\xF3n Temporal";default:return"Documento de Identidad"}}static \u0275fac=function(e){return new(e||t)};static \u0275prov=nr({token:t,factory:t.\u0275fac,providedIn:"root"})};var aI=()=>({standalone:!0});function oI(t,r){t&1&&(d(0,"div",28)(1,"div",29),j(2,"div",30),d(3,"p"),_(4,"Procesando..."),u()()())}function sI(t,r){if(t&1){let e=Pe();d(0,"button",31),L("click",function(){D(e);let i=C();return N(i.openCreateModal())}),j(1,"i",32),u()}}function lI(t,r){if(t&1){let e=Pe();d(0,"button",33),L("click",function(){D(e);let i=C();return N(i.openCreateModal())}),j(1,"i",32),d(2,"span",18),_(3,"Nuevo Bautismo"),u()()}}function cI(t,r){t&1&&(d(0,"tr")(1,"td",34)(2,"div",35),j(3,"div",36),d(4,"div"),_(5,"Cargando bautismos..."),u()()()())}function dI(t,r){t&1&&(d(0,"tr")(1,"td",37),_(2,"No se encontraron bautismos"),u()())}function fI(t,r){if(t&1){let e=Pe();d(0,"button",47),L("click",function(){D(e);let i=C(2).$implicit,a=C(2);return a.downloadCertificate(i),N(a.toggleDropdown(i.id))}),j(1,"i",51),_(2," Certificado "),u()}}function uI(t,r){if(t&1){let e=Pe();d(0,"button",52),L("click",function(){D(e);let i=C(2).$implicit,a=C(2);return a.openInvalidateModal(i),N(a.toggleDropdown(i.id))}),j(1,"i",53),_(2," Invalidar "),u()}}function hI(t,r){if(t&1){let e=Pe();d(0,"div",46)(1,"button",47),L("click",function(){D(e);let i=C().$implicit,a=C(2);return a.openDetailsModal(i),N(a.toggleDropdown(i.id))}),j(2,"i",48),_(3," Ver Detalles "),u(),fe(4,fI,3,0,"button",49)(5,uI,3,0,"button",50),u()}if(t&2){let e=C().$implicit,n=C(2);g(4),P("ngIf",!e.invalid),g(),P("ngIf",!e.invalid&&n.can("BAPTISM_INVALIDATE"))}}function pI(t,r){if(t&1){let e=Pe();d(0,"tr")(1,"td",39),L("click",function(){let i=D(e).$implicit,a=C(2);return N(a.openDetailsModal(i))}),d(2,"span",40),_(3),u()(),d(4,"td"),_(5),u(),d(6,"td",18),_(7),u(),d(8,"td",18),_(9),u(),d(10,"td",18),_(11),u(),d(12,"td",18)(13,"span",41),_(14),u()(),d(15,"td",19)(16,"div",42)(17,"button",43),L("click",function(){let i=D(e).$implicit,a=C(2);return N(a.toggleDropdown(i.id))}),j(18,"i",44),u(),fe(19,hI,6,2,"div",45),u()()()}if(t&2){let e=r.$implicit,n=C(2);wt("inactive-row",e.invalid),g(3),be(e.memberName),g(2),be(e.branchName||"---"),g(2),be(n.formatDate(e.date)),g(2),be(e.address||e.city||e.neighborhood||"---"),g(2),be(e.registeredBy),g(2),wt("badge-success",!e.invalid)("badge-danger",e.invalid),g(),je(" ",e.invalid?"Invalidado":"V\xE1lido"," "),g(5),P("ngIf",n.activeDropdownId===e.id)}}function mI(t,r){if(t&1&&(Ln(0),fe(1,pI,20,13,"tr",38),Bn()),t&2){let e=C();g(),P("ngForOf",e.baptisms)}}function gI(t,r){if(t&1&&(d(0,"option",80),_(1),u()),t&2){let e=r.$implicit;P("value",e.id),g(),be(e.name)}}function _I(t,r){if(t&1){let e=Pe();d(0,"div",61)(1,"label",62),_(2,"Sede"),u(),d(3,"div",63),j(4,"i",76),d(5,"select",77),ht("ngModelChange",function(i){D(e);let a=C(2);return ut(a.filterBranchId,i)||(a.filterBranchId=i),N(i)}),d(6,"option",78),_(7,"Todas las sedes"),u(),fe(8,gI,2,2,"option",79),u()()()}if(t&2){let e=C(2);g(5),ft("ngModel",e.filterBranchId),g(3),P("ngForOf",e.branches)}}function vI(t,r){if(t&1){let e=Pe();d(0,"button",81),L("click",function(){D(e);let i=C(2);return i.clearFilters(),N(i.closeFilterModal())}),_(1," Limpiar "),u()}}function xI(t,r){if(t&1){let e=Pe();d(0,"div",54),L("click",function(){D(e);let i=C();return N(i.closeFilterModal())}),d(1,"div",55),L("click",function(i){return D(e),N(i.stopPropagation())}),d(2,"div",56)(3,"h2"),_(4,"Filtros"),u(),d(5,"button",57),L("click",function(){D(e);let i=C();return N(i.closeFilterModal())}),_(6,"\xD7"),u()(),d(7,"div",58)(8,"div",59),fe(9,_I,9,2,"div",60),d(10,"div",61)(11,"label",62),_(12,"Fecha (Desde)"),u(),d(13,"div",63),j(14,"i",64),d(15,"input",65),ht("ngModelChange",function(i){D(e);let a=C();return ut(a.filterStartDate,i)||(a.filterStartDate=i),N(i)}),u()()(),d(16,"div",61)(17,"label",62),_(18,"Fecha (Hasta)"),u(),d(19,"div",63),j(20,"i",64),d(21,"input",65),ht("ngModelChange",function(i){D(e);let a=C();return ut(a.filterEndDate,i)||(a.filterEndDate=i),N(i)}),u()()(),d(22,"div",66)(23,"span",67),_(24,"Estado"),u(),d(25,"div",68)(26,"label",69)(27,"input",70),ht("ngModelChange",function(i){D(e);let a=C();return ut(a.filterActive,i)||(a.filterActive=i),N(i)}),u(),j(28,"span",71),u(),d(29,"span",72),_(30),u()()()()(),d(31,"div",73),fe(32,vI,2,0,"button",74),d(33,"button",75),L("click",function(){D(e);let i=C();return i.onSearch(),N(i.closeFilterModal())}),_(34," Aplicar "),u()()()()}if(t&2){let e=C();g(9),P("ngIf",e.isAdmin),g(6),ft("ngModel",e.filterStartDate),g(6),ft("ngModel",e.filterEndDate),g(6),ft("ngModel",e.filterActive),g(3),je(" ",e.filterActive?"Solo V\xE1lidos":"Todos"," "),g(2),P("ngIf",e.filterStartDate||e.filterEndDate||e.filterBranchId)}}function bI(t,r){if(t&1){let e=Pe();d(0,"div",99),L("click",function(){let i=D(e).$implicit,a=C(3);return N(a.selectMember(i))}),d(1,"strong"),_(2),u(),d(3,"span",100),_(4),u()()}if(t&2){let e=r.$implicit,n=C(3);g(2),be(e.completeName),g(2),be(n.formatType(e.type))}}function wI(t,r){if(t&1&&(d(0,"div",97),fe(1,bI,5,2,"div",98),u()),t&2){let e=C(2);g(),P("ngForOf",e.memberSearchResults)}}function yI(t,r){if(t&1){let e=Pe();d(0,"div",101),j(1,"i",102),_(2),d(3,"button",103),L("click",function(){D(e);let i=C(2);return N(i.clearMemberSelection())}),_(4,"\xD7"),u()()}if(t&2){let e=C(2);g(2),je(" ",e.selectedMember.completeName," ")}}function CI(t,r){if(t&1){let e=Pe();d(0,"div",54),L("click",function(){D(e);let i=C();return N(i.closeCreateModal())}),d(1,"div",82),L("click",function(i){return D(e),N(i.stopPropagation())}),d(2,"div",56)(3,"h2"),_(4,"Registrar Bautismo"),u(),d(5,"button",57),L("click",function(){D(e);let i=C();return N(i.closeCreateModal())}),_(6,"\xD7"),u()(),d(7,"div",58)(8,"form",83)(9,"div",84)(10,"label"),_(11,"Miembro Bautizado *"),u(),d(12,"div",85)(13,"input",86),ht("ngModelChange",function(i){D(e);let a=C();return ut(a.memberSearchQuery,i)||(a.memberSearchQuery=i),N(i)}),L("input",function(){D(e);let i=C();return N(i.searchMembers())}),u(),fe(14,wI,2,1,"div",87),u(),fe(15,yI,5,1,"div",88),u(),d(16,"div",84)(17,"label",89),_(18,"Fecha del Bautismo *"),u(),j(19,"input",90),u(),d(20,"div",84)(21,"label",91),_(22,"Ubicaci\xF3n del Bautismo"),u(),d(23,"input",92),L("keydown.enter",function(i){return D(e),N(i.preventDefault())}),u()(),d(24,"div",84)(25,"label",93),_(26,"Notas"),u(),j(27,"textarea",94),u()()(),d(28,"div",73)(29,"button",81),L("click",function(){D(e);let i=C();return N(i.closeCreateModal())}),_(30,"Cancelar"),u(),d(31,"button",95),L("click",function(){D(e);let i=C();return N(i.saveBaptism())}),j(32,"i",96),_(33),u()()()()}if(t&2){let e=C();g(8),P("formGroup",e.baptismForm),g(5),ft("ngModel",e.memberSearchQuery),P("ngModelOptions",i1(7,aI)),g(),P("ngIf",e.showMemberSearchDropdown&&e.memberSearchResults.length>0),g(),P("ngIf",e.selectedMember),g(16),P("disabled",e.isSaving),g(2),je(" ",e.isSaving?"Guardando...":"Guardar"," ")}}function SI(t,r){if(t&1){let e=Pe();d(0,"div",54),L("click",function(){D(e);let i=C();return N(i.closeInvalidateModal())}),d(1,"div",55),L("click",function(i){return D(e),N(i.stopPropagation())}),d(2,"div",56)(3,"h2"),_(4,"Invalidar Bautismo"),u(),d(5,"button",57),L("click",function(){D(e);let i=C();return N(i.closeInvalidateModal())}),_(6,"\xD7"),u()(),d(7,"div",58)(8,"p"),_(9,"\xBFEst\xE1 seguro que desea invalidar el bautismo de "),d(10,"strong"),_(11),u(),_(12,"?"),u(),d(13,"form",83)(14,"div",84)(15,"label",104),_(16,"Raz\xF3n de Invalidaci\xF3n *"),u(),j(17,"textarea",105),u()()(),d(18,"div",73)(19,"button",81),L("click",function(){D(e);let i=C();return N(i.closeInvalidateModal())}),_(20,"Cancelar"),u(),d(21,"button",106),L("click",function(){D(e);let i=C();return N(i.invalidateBaptism())}),j(22,"i",53),_(23),u()()()()}if(t&2){let e=C();g(11),be(e.selectedBaptism==null?null:e.selectedBaptism.memberName),g(2),P("formGroup",e.invalidateForm),g(8),P("disabled",e.isSaving||e.invalidateForm.invalid),g(2),je(" ",e.isSaving?"Invalidando...":"Invalidar"," ")}}function kI(t,r){if(t&1&&(d(0,"div",112)(1,"label"),_(2,"Notas:"),u(),d(3,"span"),_(4),u()()),t&2){let e=C(3);g(4),be(e.selectedBaptism.note)}}function EI(t,r){if(t&1&&(d(0,"div",112)(1,"label"),_(2,"Ubicaci\xF3n:"),u(),d(3,"span"),_(4),u()()),t&2){let e=C(3);g(4),be(e.selectedBaptism.address)}}function MI(t,r){if(t&1&&(d(0,"div",114)(1,"div",115)(2,"p")(3,"strong"),_(4,"Raz\xF3n:"),u(),_(5),u(),d(6,"p")(7,"strong"),_(8,"Invalidado por:"),u(),_(9),u(),d(10,"p")(11,"strong"),_(12,"Fecha:"),u(),_(13),u()()()),t&2){let e=C(3);g(5),je(" ",e.selectedBaptism.invalidReason),g(4),je(" ",e.selectedBaptism.invalidatedBy),g(4),je(" ",e.formatDate(e.selectedBaptism.invalidAt))}}function PI(t,r){if(t&1&&(d(0,"div",58)(1,"div",109)(2,"div",110)(3,"label"),_(4,"Miembro:"),u(),d(5,"span"),_(6),u()(),d(7,"div",110)(8,"label"),_(9,"Sede:"),u(),d(10,"span"),_(11),u()(),d(12,"div",110)(13,"label"),_(14,"Fecha:"),u(),d(15,"span"),_(16),u()(),d(17,"div",110)(18,"label"),_(19,"Registrado Por:"),u(),d(20,"span"),_(21),u()(),d(22,"div",110)(23,"label"),_(24,"Fecha de Registro:"),u(),d(25,"span"),_(26),u()(),fe(27,kI,5,1,"div",111)(28,EI,5,1,"div",111),d(29,"div",112)(30,"label"),_(31,"Estado:"),u(),d(32,"div")(33,"span",41),_(34),u()()(),fe(35,MI,14,3,"div",113),u()()),t&2){let e=C(2);g(6),be(e.selectedBaptism.memberName),g(5),be(e.selectedBaptism.branchName||"---"),g(5),be(e.formatDate(e.selectedBaptism.date)),g(5),be(e.selectedBaptism.registeredBy),g(5),be(e.formatDate(e.selectedBaptism.createdAt)),g(),P("ngIf",e.selectedBaptism.note),g(),P("ngIf",e.selectedBaptism.address),g(5),wt("badge-success",!e.selectedBaptism.invalid)("badge-danger",e.selectedBaptism.invalid),g(),je(" ",e.selectedBaptism.invalid?"Invalidado":"V\xE1lido"," "),g(),P("ngIf",e.selectedBaptism.invalid)}}function OI(t,r){if(t&1){let e=Pe();d(0,"button",75),L("click",function(){D(e);let i=C(2);return N(i.downloadCertificate(i.selectedBaptism))}),j(1,"i",51),_(2," Descargar Certificado "),u()}}function AI(t,r){if(t&1){let e=Pe();d(0,"div",54),L("click",function(){D(e);let i=C();return N(i.closeDetailsModal())}),d(1,"div",82),L("click",function(i){return D(e),N(i.stopPropagation())}),d(2,"div",56)(3,"h2"),_(4,"Detalles del Bautismo"),u(),d(5,"button",57),L("click",function(){D(e);let i=C();return N(i.closeDetailsModal())}),_(6,"\xD7"),u()(),fe(7,PI,36,13,"div",107),d(8,"div",73)(9,"button",81),L("click",function(){D(e);let i=C();return N(i.closeDetailsModal())}),_(10,"Cerrar"),u(),fe(11,OI,3,0,"button",108),u()()()}if(t&2){let e=C();g(7),P("ngIf",e.selectedBaptism),g(4),P("ngIf",!(e.selectedBaptism!=null&&e.selectedBaptism.invalid))}}function TI(t,r){if(t&1){let e=Pe();d(0,"div",54),L("click",function(){D(e);let i=C();return N(i.closeCertificateModal())}),d(1,"div",55),L("click",function(i){return D(e),N(i.stopPropagation())}),d(2,"div",56)(3,"h2"),_(4,"Generar Certificado"),u(),d(5,"button",57),L("click",function(){D(e);let i=C();return N(i.closeCertificateModal())}),_(6,"\xD7"),u()(),d(7,"div",58)(8,"p",116),_(9,"Por favor ingrese los datos faltantes para completar el certificado de "),d(10,"strong"),_(11),u(),_(12,"."),u(),d(13,"div",84)(14,"label"),_(15,"Tipo de Documento *"),u(),d(16,"select",117),ht("ngModelChange",function(i){D(e);let a=C();return ut(a.certDocumentType,i)||(a.certDocumentType=i),N(i)}),d(17,"option",118),_(18,"C\xE9dula de Ciudadan\xEDa"),u(),d(19,"option",119),_(20,"Tarjeta de Identidad"),u(),d(21,"option",120),_(22,"C\xE9dula de Extranjer\xEDa"),u(),d(23,"option",121),_(24,"Pasaporte"),u(),d(25,"option",122),_(26,"Registro Civil"),u(),d(27,"option",123),_(28,"Permiso Especial de Permanencia"),u(),d(29,"option",124),_(30,"Permiso por Protecci\xF3n Temporal"),u()()(),d(31,"div",84)(32,"label"),_(33,"No. Documento *"),u(),d(34,"input",125),ht("ngModelChange",function(i){D(e);let a=C();return ut(a.certCedula,i)||(a.certCedula=i),N(i)}),u()(),d(35,"div",84)(36,"label"),_(37,"Lugar de Expedici\xF3n *"),u(),d(38,"input",126),ht("ngModelChange",function(i){D(e);let a=C();return ut(a.certExpedition,i)||(a.certExpedition=i),N(i)}),u()()(),d(39,"div",73)(40,"button",81),L("click",function(){D(e);let i=C();return N(i.closeCertificateModal())}),_(41,"Cancelar"),u(),d(42,"button",127),L("click",function(){D(e);let i=C();return N(i.confirmDownloadCertificate())}),j(43,"i",51),_(44," Generar PDF "),u()()()()}if(t&2){let e=C();g(11),be(e.selectedBaptism==null?null:e.selectedBaptism.memberName),g(5),ft("ngModel",e.certDocumentType),g(18),ft("ngModel",e.certCedula),g(4),ft("ngModel",e.certExpedition),g(4),P("disabled",!e.certCedula||!e.certExpedition)}}var Uu=class t{fb=Ce(ks);baptismService=Ce(Lu);integranteService=Ce(Ri);authService=Ce(fr);confirmationService=Ce(Ni);notificationService=Ce(Kr);certificateService=Ce(Bu);branchService=Ce(ba);cdr=Ce(Un);baptisms=[];branches=[];permissions={};isAdmin=!1;totalPages=0;totalElements=0;currentPage=0;isLoading=!1;activeDropdownId=null;filterMemberId="";filterStartDate=null;filterEndDate=null;filterQuery="";filterActive=!0;filterBranchId="";memberSearchQuery="";memberSearchResults=[];showMemberSearchDropdown=!1;selectedMember=null;showCreateModal=!1;showInvalidateModal=!1;showDetailsModal=!1;showMobileFilterModal=!1;showFilterModal=!1;selectedBaptism;baptismForm;invalidateForm;isSaving=!1;searchSubject=new Bt;ngOnInit(){this.checkPermissions(),this.initForms(),this.setupSearchDebounce(),this.loadBaptisms(),this.setupClickOutsideListener(),this.isAdmin&&this.loadBranches()}checkPermissions(){this.isAdmin=this.authService.can("ADMINISTRATOR")}setupSearchDebounce(){this.searchSubject.pipe(Ki(1e3),Oi()).subscribe(r=>{this.filterQuery=r,this.onSearch()})}onSearchInput(){this.searchSubject.next(this.filterQuery)}loadBranches(){this.branchService.findAll().subscribe({next:r=>this.branches=r,error:()=>this.notificationService.error("Error al cargar las sedes")})}can(r){return this.authService.can(r)}initForms(){this.baptismForm=this.fb.group({date:["",or.required],note:[""],address:[""],neighborhood:[""],city:[""],municipality:[""],district:[""],postalCode:[""],latitude:[""],longitude:[""]}),this.invalidateForm=this.fb.group({invalidReason:["",[or.required,or.maxLength(255)]]})}loadBaptisms(){this.isLoading=!0;let r={memberId:this.filterMemberId||void 0,startDate:this.filterStartDate||void 0,endDate:this.filterEndDate||void 0,query:this.filterQuery||void 0,active:this.filterActive,branchId:this.filterBranchId||void 0};this.baptismService.search(r,this.currentPage).subscribe({next:e=>{this.baptisms=e.data,this.totalPages=e.totalPages,this.totalElements=e.totalElements,this.isLoading=!1,this.scrollToTop()},error:e=>{console.error("Error loading baptisms:",e),this.notificationService.error("Error al cargar los bautismos"),this.isLoading=!1}})}onSearch(){this.currentPage=0,this.loadBaptisms()}clearFilters(){this.filterMemberId="",this.filterStartDate=null,this.filterEndDate=null,this.filterQuery="",this.filterActive=!0,this.filterBranchId="",this.currentPage=0,this.loadBaptisms()}openFilterModal(){this.showFilterModal=!0}closeFilterModal(){this.showFilterModal=!1}nextPage(){this.currentPage<this.totalPages-1&&(this.currentPage++,this.loadBaptisms())}previousPage(){this.currentPage>0&&(this.currentPage--,this.loadBaptisms())}goToPage(r){this.currentPage=r,this.loadBaptisms()}get pages(){return Array.from({length:this.totalPages},(r,e)=>e)}searchMembers(){if(this.memberSearchQuery.trim().length<2){this.memberSearchResults=[],this.showMemberSearchDropdown=!1;return}this.integranteService.searchMembers({query:this.memberSearchQuery,onlyActive:!0},0).subscribe({next:r=>{this.memberSearchResults=r.data.slice(0,10),this.showMemberSearchDropdown=!0},error:r=>{console.error("Error searching members:",r)}})}selectMember(r){this.selectedMember=r,this.memberSearchQuery=r.completeName,this.showMemberSearchDropdown=!1}clearMemberSelection(){this.selectedMember=null,this.memberSearchQuery="",this.memberSearchResults=[]}openCreateModal(){this.resetForm(),this.showCreateModal=!0,this.cdr.detectChanges(),setTimeout(()=>this.initGoogleAutocomplete(),300)}closeCreateModal(){this.showCreateModal=!1,this.resetForm()}resetForm(){this.baptismForm.reset(),this.selectedMember=null,this.memberSearchQuery=""}saveBaptism(){if(!this.selectedMember){this.notificationService.error("Debe seleccionar un miembro");return}if(this.baptismForm.invalid){this.notificationService.error("Complete los campos requeridos");return}this.isSaving=!0;let r=this.baptismForm.value,e={memberId:this.selectedMember.id,date:new Date(r.date),note:r.note,imageUrl:void 0,address:r.address,neighborhood:r.neighborhood,city:r.city,municipality:r.municipality,district:r.district,postalCode:r.postalCode,latitude:r.latitude,longitude:r.longitude};this.baptismService.create(e).subscribe({next:n=>{this.notificationService.success("Bautismo registrado exitosamente"),this.closeCreateModal(),this.loadBaptisms(),this.isSaving=!1},error:n=>{console.error("Error creating baptism:",n),this.notificationService.error("Error al registrar el bautismo"),this.isSaving=!1}})}openInvalidateModal(r){this.selectedBaptism=r,this.invalidateForm.reset(),this.showInvalidateModal=!0}closeInvalidateModal(){this.showInvalidateModal=!1,this.selectedBaptism=void 0}invalidateBaptism(){if(!this.selectedBaptism||this.invalidateForm.invalid)return;this.isSaving=!0;let r={baptismId:this.selectedBaptism.id,invalidReason:this.invalidateForm.value.invalidReason};this.baptismService.invalidate(r).subscribe({next:e=>{this.notificationService.success("Bautismo invalidado exitosamente"),this.closeInvalidateModal(),this.loadBaptisms(),this.isSaving=!1},error:e=>{console.error("Error invalidating baptism:",e),this.notificationService.error("Error al invalidar el bautismo"),this.isSaving=!1}})}openDetailsModal(r){this.selectedBaptism=r,this.showDetailsModal=!0}closeDetailsModal(){this.showDetailsModal=!1,this.selectedBaptism=void 0}showCertificateModal=!1;certCedula="";certExpedition="";certDocumentType="CC";downloadCertificate(r){if(r.invalid){this.notificationService.error("No se puede generar certificado de un bautismo inv\xE1lido");return}this.selectedBaptism=r,this.certCedula="",this.certExpedition="",this.certDocumentType="CC",this.showCertificateModal=!0}closeCertificateModal(){this.showCertificateModal=!1,this.showDetailsModal||(this.selectedBaptism=void 0)}confirmDownloadCertificate(){return Cn(this,null,function*(){if(this.selectedBaptism){if(!this.certCedula||!this.certExpedition||!this.certDocumentType){this.notificationService.error("Debe completar todos los campos para el certificado");return}try{yield this.certificateService.generateBaptismCertificate(this.selectedBaptism,this.certCedula,this.certExpedition,this.certDocumentType),this.notificationService.success("Certificado generado correctamente"),this.closeCertificateModal()}catch(r){console.error("Error generating certificate:",r),this.notificationService.error("Error al generar el certificado")}}})}toggleDropdown(r){this.activeDropdownId=this.activeDropdownId===r?null:r}onDocumentClick(r){r.target.closest(".action-dropdown")||(this.activeDropdownId=null)}setupClickOutsideListener(){}initGoogleAutocomplete(){let r=document.getElementById("googleAddress");if(!r){console.error("Google Maps input element not found");return}if(typeof google>"u"||!google.maps||!google.maps.places){console.error("Google Maps API not loaded");return}try{let e=new google.maps.places.Autocomplete(r,{componentRestrictions:{country:"co"},fields:["address_components","geometry","formatted_address"]});e.addListener("place_changed",()=>{let n=e.getPlace();this.handleGoogleResult(n)}),console.log("Google Maps autocomplete initialized successfully")}catch(e){console.error("Error initializing Google Maps autocomplete:",e)}}handleGoogleResult(r){if(!r||!r.address_components)return;let e="",n="",i="",a="",o="";console.log("Google Maps components:",r.address_components);for(let c of r.address_components){let f=c.types,v=c.long_name;!e&&(f.includes("neighborhood")||f.includes("sublocality")||f.includes("sublocality_level_1")||f.includes("sublocality_level_2")||f.includes("sublocality_level_3")||f.includes("route")||f.includes("point_of_interest")||f.includes("establishment")||f.includes("natural_feature"))&&(e=v),!n&&f.includes("locality")&&(n=v),!i&&f.includes("administrative_area_level_2")&&(i=v),!a&&f.includes("administrative_area_level_1")&&(a=v),!o&&f.includes("postal_code")&&(o=v)}!n&&i&&(n=i),console.log("Parsed address:",{neighborhood:e,city:n,municipality:i,district:a,postalCode:o});let s=r.geometry?.location?.lat()?.toString()||"",l=r.geometry?.location?.lng()?.toString()||"";this.baptismForm.patchValue({address:r.formatted_address||"",neighborhood:e,city:n,municipality:i,district:a,postalCode:o,latitude:s,longitude:l}),this.cdr.detectChanges()}formatDate(r){return r?new Date(r).toLocaleDateString("es-CO"):""}formatType(r){return r?typeof r=="string"?r.replace(/_/g," "):r.name||"":""}formatCategory(r){return r?typeof r=="string"?r:r.name||"":""}openMobileFilterModal(){this.showMobileFilterModal=!0}closeMobileFilterModal(){this.showMobileFilterModal=!1}scrollToTop(){[".page-container",".table-container",".full-table",".list-container"].forEach(e=>{let n=document.querySelector(e);n&&n.scrollTo({top:0,behavior:"smooth"})}),window.scrollTo({top:0,behavior:"smooth"})}static \u0275fac=function(e){return new(e||t)};static \u0275cmp=ir({type:t,selectors:[["app-bautismos"]],hostBindings:function(e,n){e&1&&L("click",function(a){return n.onDocumentClick(a)},to)},decls:54,vars:17,consts:[["class","full-viewport-loading",4,"ngIf"],[1,"bautismos-container","full-width"],[1,"full-card"],[1,"header-section"],[1,"filters-left","desktop-only"],[1,"btn","btn-action-soft",3,"click"],[1,"fa-solid","fa-sliders"],[1,"search-center"],[2,"display","flex","gap","0.35rem","width","100%"],[1,"soft-input-wrapper",2,"flex","1"],[1,"fa-solid","fa-magnifying-glass","soft-input-icon"],["type","text","placeholder","Buscar por nombre, cedula...",1,"soft-input",3,"ngModelChange","keyup.enter","ngModel"],[1,"btn-icon-soft","mobile-only",2,"height","42px","width","42px","flex-shrink","0","display","flex","align-items","center","justify-content","center","border","1px solid var(--border-color)","border-radius","12px","background","var(--bg-input)","color","var(--text-muted)","cursor","pointer",3,"click"],["class","btn-icon-soft mobile-only","style","height: 42px; width: 42px; flex-shrink: 0; display: flex; align-items: center; justify-content: center; border: none; border-radius: 12px; background: var(--primary); color: white; cursor: pointer;",3,"click",4,"ngIf"],[1,"actions-right","desktop-only"],["class","btn btn-primary btn-action-soft",3,"click",4,"ngIf"],[1,"table-container"],[1,"data-table"],[1,"desktop-only"],[1,"actions-col"],[4,"ngIf"],[1,"bautismos-footer"],[1,"pagination-mini"],[1,"pagination-buttons"],[1,"btn-icon-sm",3,"click","disabled"],[1,"fa-solid","fa-chevron-left"],[1,"fa-solid","fa-chevron-right"],["class","modal-overlay",3,"click",4,"ngIf"],[1,"full-viewport-loading"],[1,"spinner-wrapper"],[1,"spinner-circle"],[1,"btn-icon-soft","mobile-only",2,"height","42px","width","42px","flex-shrink","0","display","flex","align-items","center","justify-content","center","border","none","border-radius","12px","background","var(--primary)","color","white","cursor","pointer",3,"click"],[1,"fa-solid","fa-plus"],[1,"btn","btn-primary","btn-action-soft",3,"click"],["colspan","7",2,"padding","0","border","none"],[1,"loading-container"],[1,"loading-spinner"],["colspan","7",1,"text-center"],[3,"inactive-row",4,"ngFor","ngForOf"],[2,"cursor","pointer",3,"click"],[2,"font-weight","600","color","var(--primary)"],[1,"badge"],[1,"action-dropdown"],[1,"action-btn",3,"click"],[1,"fa-solid","fa-ellipsis-vertical"],["class","action-menu",4,"ngIf"],[1,"action-menu"],[3,"click"],[1,"fa-solid","fa-eye"],[3,"click",4,"ngIf"],["safeClick","",3,"click",4,"ngIf"],[1,"fa-solid","fa-file-pdf"],["safeClick","",3,"click"],[1,"fa-solid","fa-ban"],[1,"modal-overlay",3,"click"],[1,"modal-content","modal-sm",3,"click"],[1,"modal-header"],[1,"close-btn",3,"click"],[1,"modal-body"],[2,"display","flex","flex-direction","column","gap","1rem"],["class","soft-input-group",4,"ngIf"],[1,"soft-input-group"],[1,"soft-label"],[1,"soft-input-wrapper"],[1,"fa-regular","fa-calendar","soft-input-icon"],["type","date",1,"soft-input",3,"ngModelChange","ngModel"],[1,"toggle-wrapper",2,"flex-direction","row","align-items","center","justify-content","space-between"],[1,"toggle-label","toggle-label-soft"],[1,"toggle-container",2,"width","auto"],[1,"status-switch"],["type","checkbox",3,"ngModelChange","ngModel"],[1,"slider","round"],[1,"toggle-label","toggle-label-soft",2,"margin-left","0.5rem"],[1,"modal-footer"],["class","btn btn-muted",3,"click",4,"ngIf"],[1,"btn","btn-primary",3,"click"],[1,"fa-solid","fa-building","soft-input-icon"],[1,"soft-input",3,"ngModelChange","ngModel"],["value",""],[3,"value",4,"ngFor","ngForOf"],[3,"value"],[1,"btn","btn-muted",3,"click"],[1,"modal-content",3,"click"],[3,"formGroup"],[1,"form-group"],[1,"member-search-container"],["type","text","placeholder","Buscar miembro...",1,"form-control",3,"ngModelChange","input","ngModel","ngModelOptions"],["class","member-search-dropdown",4,"ngIf"],["class","selected-member",4,"ngIf"],["for","date"],["id","date","type","date","formControlName","date",1,"form-control"],["for","googleAddress"],["id","googleAddress","type","text","placeholder","Buscar direcci\xF3n...",1,"form-control",3,"keydown.enter"],["for","note"],["id","note","formControlName","note","rows","3","placeholder","Notas adicionales...",1,"form-control"],["safeClick","",1,"btn","btn-primary",3,"click","disabled"],[1,"fa-solid","fa-save"],[1,"member-search-dropdown"],["class","member-search-item",3,"click",4,"ngFor","ngForOf"],[1,"member-search-item",3,"click"],[1,"member-type"],[1,"selected-member"],[1,"fa-solid","fa-check-circle"],["type","button",1,"clear-btn",3,"click"],["for","invalidReason"],["id","invalidReason","formControlName","invalidReason","rows","3","placeholder","Ingrese la raz\xF3n...","maxlength","255",1,"form-control"],["safeClick","",1,"btn","btn-danger",3,"click","disabled"],["class","modal-body",4,"ngIf"],["class","btn btn-primary",3,"click",4,"ngIf"],[1,"details-grid"],[1,"detail-item"],["class","detail-item full-width",4,"ngIf"],[1,"detail-item","full-width"],["class","detail-item full-width invalid-section",4,"ngIf"],[1,"detail-item","full-width","invalid-section"],[1,"invalid-details"],[2,"margin-bottom","1rem","color","#64748b"],[1,"form-control",3,"ngModelChange","ngModel"],["value","CC"],["value","TI"],["value","CE"],["value","PA"],["value","RC"],["value","PEP"],["value","PPT"],["type","text","placeholder","Ej: 1.234.567.890",1,"form-control",3,"ngModelChange","ngModel"],["type","text","placeholder","Ej: Barranquilla, Atl\xE1ntico",1,"form-control",3,"ngModelChange","ngModel"],[1,"btn","btn-primary",3,"click","disabled"]],template:function(e,n){e&1&&(fe(0,oI,5,0,"div",0),d(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"button",5),L("click",function(){return n.openFilterModal()}),j(6,"i",6),_(7," Filtros "),u()(),d(8,"div",7)(9,"div",8)(10,"div",9),j(11,"i",10),d(12,"input",11),ht("ngModelChange",function(a){return ut(n.filterQuery,a)||(n.filterQuery=a),a}),L("ngModelChange",function(){return n.onSearchInput()})("keyup.enter",function(){return n.onSearch()}),u()(),d(13,"button",12),L("click",function(){return n.openFilterModal()}),j(14,"i",6),u(),fe(15,sI,2,0,"button",13),u()(),d(16,"div",14),fe(17,lI,4,0,"button",15),u()(),d(18,"div",16)(19,"table",17)(20,"thead")(21,"tr")(22,"th"),_(23,"Miembro"),u(),d(24,"th"),_(25,"Sede"),u(),d(26,"th",18),_(27,"Fecha"),u(),d(28,"th",18),_(29,"Ubicaci\xF3n"),u(),d(30,"th",18),_(31,"Registrado Por"),u(),d(32,"th",18),_(33,"Estado"),u(),d(34,"th",19),_(35,"Acciones"),u()()(),d(36,"tbody"),fe(37,cI,6,0,"tr",20)(38,dI,3,0,"tr",20)(39,mI,2,1,"ng-container",20),u()()(),d(40,"div",21)(41,"div",22)(42,"span"),_(43),u(),d(44,"div",23)(45,"button",24),L("click",function(){return n.previousPage()}),j(46,"i",25),u(),d(47,"button",24),L("click",function(){return n.nextPage()}),j(48,"i",26),u()()()()()(),fe(49,xI,35,6,"div",27)(50,CI,34,8,"div",27)(51,SI,24,4,"div",27)(52,AI,12,2,"div",27)(53,TI,45,5,"div",27)),e&2&&(P("ngIf",n.isSaving),g(12),ft("ngModel",n.filterQuery),g(3),P("ngIf",n.can("BAPTISM_CREATE")),g(2),P("ngIf",n.can("BAPTISM_CREATE")),g(20),P("ngIf",n.isLoading),g(),P("ngIf",!n.isLoading&&n.baptisms.length===0),g(),P("ngIf",!n.isLoading),g(4),_a("P\xE1gina ",n.currentPage+1," de ",n.totalPages||1," (Total: ",n.totalElements,")"),g(2),P("disabled",n.currentPage===0),g(2),P("disabled",n.currentPage>=n.totalPages-1),g(2),P("ngIf",n.showFilterModal),g(),P("ngIf",n.showCreateModal),g(),P("ngIf",n.showInvalidateModal),g(),P("ngIf",n.showDetailsModal),g(),P("ngIf",n.showCertificateModal))},dependencies:[gr,rn,mr,Es,xa,Fi,Di,nn,ys,Ii,an,va,Yl,Ss,Cs,on,Vn],styles:["[_nghost-%COMP%]{display:block;height:100%;width:100%;min-height:0}.bautismos-container.full-width[_ngcontent-%COMP%]{padding:0;height:100%;width:100%;display:flex;flex-direction:column;min-height:0;box-sizing:border-box;background:var(--bg-main)}.full-card[_ngcontent-%COMP%]{padding:1.25rem;display:flex;flex-direction:column;height:100%;min-height:0;background:var(--bg-card);border-radius:12px;box-shadow:var(--shadow-sm);overflow:hidden}.table-section[_ngcontent-%COMP%]{height:100%;min-height:0;display:flex;flex-direction:column;overflow:hidden}.header-section[_ngcontent-%COMP%]{display:flex;align-items:center;gap:1rem;margin-bottom:1rem;background:var(--bg-card);padding:.75rem;border-radius:12px;box-shadow:var(--shadow-sm)}.filters-left[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.75rem;flex-shrink:0}.search-center[_ngcontent-%COMP%]{flex:1;min-width:0}.actions-right[_ngcontent-%COMP%]{flex-shrink:0}.member-search-container[_ngcontent-%COMP%]{position:relative}.member-search-dropdown[_ngcontent-%COMP%]{position:absolute;top:100%;left:0;right:0;background:var(--bg-card);border:1px solid var(--border-color);border-radius:6px;max-height:300px;overflow-y:auto;z-index:1000;box-shadow:var(--shadow-md);margin-top:.25rem}.member-search-item[_ngcontent-%COMP%]{padding:.75rem;cursor:pointer;border-bottom:1px solid var(--border-color);display:flex;justify-content:space-between;align-items:center;transition:background .15s}.member-search-item[_ngcontent-%COMP%]:hover{background-color:var(--bg-input)}.member-search-item[_ngcontent-%COMP%]:last-child{border-bottom:none}.member-type[_ngcontent-%COMP%]{font-size:.75rem;color:var(--text-secondary);background:var(--border-soft);padding:.25rem .5rem;border-radius:4px;font-weight:600}.selected-member[_ngcontent-%COMP%]{margin-top:.5rem;padding:.5rem;background:#e0f2fe;border-radius:6px;display:flex;align-items:center;gap:.5rem;color:#0369a1;font-size:.9rem}.selected-member[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:#22c55e}.clear-btn[_ngcontent-%COMP%]{margin-left:auto;background:none;border:none;font-size:1.2rem;cursor:pointer;color:#ef4444;padding:0;line-height:1}.image-preview[_ngcontent-%COMP%]{margin-top:.75rem}.image-preview[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-width:100%;max-height:200px;border-radius:8px;border:1px solid var(--border-color)}.details-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(2,1fr);gap:1rem}.detail-item[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.25rem}.detail-item.full-width[_ngcontent-%COMP%]{grid-column:1 / -1}.detail-item[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-weight:600;color:var(--text-secondary);font-size:.85rem}.detail-item[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:var(--text-primary)}.baptism-image[_ngcontent-%COMP%]{max-width:100%;max-height:400px;border-radius:8px;margin-top:.5rem}.invalid-section[_ngcontent-%COMP%]{background:#fee2e2;padding:1rem;border-radius:8px;border:1px solid #fca5a5}.invalid-details[_ngcontent-%COMP%]{margin-top:.75rem}.invalid-details[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:.25rem 0;font-size:.9rem}.table-container[_ngcontent-%COMP%]{flex:1;overflow:auto;border:1px solid var(--border-color);border-radius:8px;background:var(--bg-card);min-height:0}.data-table[_ngcontent-%COMP%]{width:100%;border-collapse:separate;border-spacing:0}.data-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]{position:sticky;top:0;background:var(--bg-input);z-index:10}.data-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{padding:.75rem .7rem;text-align:center;font-weight:700;color:var(--text-muted);font-size:.7rem;border-bottom:2px solid var(--border-color);text-transform:uppercase;background:var(--bg-input)}.data-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:.45rem .5rem;font-size:.8rem;border-bottom:1px solid var(--border-color);text-align:left;vertical-align:middle;background:var(--bg-card)}.data-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover, .data-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover   td[_ngcontent-%COMP%]{background-color:var(--bg-input)}.inactive-row[_ngcontent-%COMP%]{opacity:.6;pointer-events:none}.inactive-row[_ngcontent-%COMP%]   .action-dropdown[_ngcontent-%COMP%]{pointer-events:auto}.text-center[_ngcontent-%COMP%]{text-align:center}.actions-col[_ngcontent-%COMP%]{width:80px;text-align:center}.action-dropdown[_ngcontent-%COMP%]{position:relative}.action-btn[_ngcontent-%COMP%]{background:none;border:none;cursor:pointer;padding:.5rem;color:var(--text-secondary);transition:color .2s}.action-btn[_ngcontent-%COMP%]:hover{color:var(--primary)}.action-menu[_ngcontent-%COMP%]{position:absolute;right:0;top:100%;background:var(--bg-card);border:1px solid var(--border-color);border-radius:6px;box-shadow:var(--shadow-md);z-index:1000;min-width:150px;margin-top:.25rem}.action-menu[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;width:100%;padding:.75rem;border:none;background:none;cursor:pointer;text-align:left;font-size:.85rem;transition:background .15s}.action-menu[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background-color:var(--bg-input)}.badge[_ngcontent-%COMP%]{padding:.25rem .75rem;border-radius:12px;font-size:.75rem;font-weight:600}.badge-success[_ngcontent-%COMP%]{background:var(--success-bg);color:var(--success-text)}.badge-danger[_ngcontent-%COMP%]{background:var(--danger-bg);color:var(--danger-text)}.bautismos-footer[_ngcontent-%COMP%]{border-top:1px solid var(--border-color);padding:.75rem 1rem;display:flex;justify-content:space-between;align-items:center;background:var(--bg-card);border-bottom-left-radius:12px;border-bottom-right-radius:12px;min-height:52px;flex-shrink:0;margin:0 -1.25rem -1.25rem;width:calc(100% + 2.5rem);box-sizing:border-box}.pagination-mini[_ngcontent-%COMP%]{display:flex;align-items:center;gap:1rem;font-size:.85rem;color:var(--text-muted);font-weight:500}.form-control[_ngcontent-%COMP%]{width:100%;padding:.75rem;border:1.5px solid var(--border-color);border-radius:8px;font-size:.9rem;font-family:Inter,sans-serif;transition:all .2s;background:var(--bg-input);color:var(--text-main)}.form-control[_ngcontent-%COMP%]:focus{outline:none;border-color:var(--primary);background:var(--bg-card);box-shadow:0 0 0 3px #3b82f61a}textarea.form-control[_ngcontent-%COMP%]{resize:vertical;min-height:80px}@media(max-width:768px){.details-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}.desktop-only[_ngcontent-%COMP%]{display:none!important}.search-box-mini[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{min-width:150px}.full-card[_ngcontent-%COMP%]{padding:.5rem}.header-section[_ngcontent-%COMP%]{padding:.5rem;gap:.5rem;margin-bottom:.5rem}}.modal-overlay[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;background:#00000080;display:flex;align-items:center;justify-content:center;z-index:9999;animation:_ngcontent-%COMP%_fadeIn .2s ease-out;-webkit-backdrop-filter:blur(4px);backdrop-filter:blur(4px)}.modal-content[_ngcontent-%COMP%]{background:var(--bg-card);border-radius:16px;width:90%;max-width:600px;max-height:90vh;overflow:hidden;display:flex;flex-direction:column;box-shadow:var(--shadow-md);animation:_ngcontent-%COMP%_slideUp .3s ease-out;position:relative}.modal-content.modal-sm[_ngcontent-%COMP%]{max-width:450px}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0}to{opacity:1}}@keyframes _ngcontent-%COMP%_slideUp{0%{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}.modal-header[_ngcontent-%COMP%]{padding:1.5rem;border-bottom:1px solid var(--border-color);display:flex;align-items:center;justify-content:space-between;flex-shrink:0}.modal-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0;font-size:1.25rem;font-weight:700;color:var(--text-primary)}.close-btn[_ngcontent-%COMP%]{background:none;border:none;font-size:1.75rem;line-height:1;color:var(--text-secondary);cursor:pointer;padding:0;width:32px;height:32px;display:flex;align-items:center;justify-content:center;border-radius:6px;transition:all .2s}.close-btn[_ngcontent-%COMP%]:hover{background:var(--bg-input);color:var(--text-primary)}.modal-body[_ngcontent-%COMP%]{padding:1.5rem;overflow-y:auto;flex:1}.modal-footer[_ngcontent-%COMP%]{padding:1rem 1.5rem;border-top:1px solid var(--border-color);display:flex;align-items:center;justify-content:flex-end;gap:.75rem;flex-shrink:0}.form-group[_ngcontent-%COMP%]{margin-bottom:1.25rem}.form-group[_ngcontent-%COMP%]:last-child{margin-bottom:0}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;margin-bottom:.5rem;font-weight:600;font-size:.9rem;color:var(--text-primary)}.form-group[_ngcontent-%COMP%]   input[type=file][_ngcontent-%COMP%]{padding:.5rem}@media(max-width:768px){.modal-content[_ngcontent-%COMP%]{width:95%;max-height:95vh}.modal-header[_ngcontent-%COMP%], .modal-body[_ngcontent-%COMP%]{padding:1rem}.modal-footer[_ngcontent-%COMP%]{padding:.75rem 1rem}}@media(max-width:768px){.btn-action-soft[_ngcontent-%COMP%]{padding:0;width:36px;justify-content:center}.header-section[_ngcontent-%COMP%]{padding:.5rem;gap:.5rem}.search-center[_ngcontent-%COMP%]   .soft-input[_ngcontent-%COMP%]{font-size:.8rem}}.modal-sm[_ngcontent-%COMP%]{max-width:400px;width:90%}.full-viewport-loading[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100vw;height:100vh;background:var(--bg-card-tp);display:flex;align-items:center;justify-content:center;z-index:10000;animation:_ngcontent-%COMP%_fadeInBautismos .2s ease-out;-webkit-backdrop-filter:blur(2px);backdrop-filter:blur(2px)}.spinner-wrapper[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;gap:1rem}.spinner-circle[_ngcontent-%COMP%]{width:40px;height:40px;border:3px solid #f3f3f3;border-top:3px solid var(--primary);border-radius:50%;animation:_ngcontent-%COMP%_spin-bautismos 1s linear infinite}@keyframes _ngcontent-%COMP%_spin-bautismos{0%{transform:rotate(0)}to{transform:rotate(360deg)}}@keyframes _ngcontent-%COMP%_fadeInBautismos{0%{opacity:0}to{opacity:1}}"]})};var Vu=class t{http=Ce(Ai);baseUrl=`${Ti.baseUrl}/category-rules`;findAll(){return this.http.get(this.baseUrl)}create(r){return this.http.post(this.baseUrl,r)}update(r,e){return this.http.put(`${this.baseUrl}/${r}`,e)}updateActive(r,e){return this.http.patch(`${this.baseUrl}/${r}?state=${e}`,{})}delete(r){return this.http.delete(`${this.baseUrl}/${r}`)}static \u0275fac=function(e){return new(e||t)};static \u0275prov=nr({token:t,factory:t.\u0275fac,providedIn:"root"})};function II(t,r){if(t&1){let e=Pe();d(0,"div",36)(1,"div",23),j(2,"span",37),d(3,"span",38),_(4),u()(),d(5,"div",26)(6,"button",39),L("click",function(){let i=D(e).$implicit,a=C(2).$implicit,o=C(2);return N(o.openSubCategoryModal(a.id,i))}),j(7,"i",30),u(),d(8,"button",40),L("click",function(){let i=D(e).$implicit,a=C(4);return N(a.deleteSubCategory(i))}),j(9,"i",32),u()()()}if(t&2){let e=r.$implicit;g(2),Ft("background-color",e.color),g(2),be(e.name)}}function FI(t,r){if(t&1&&(d(0,"div",34),fe(1,II,10,3,"div",35),u()),t&2){let e=C().$implicit;g(),P("ngForOf",e.subCategories)}}function DI(t,r){if(t&1){let e=Pe();d(0,"div",21)(1,"div",22)(2,"div",23),j(3,"span",24),d(4,"span",25),_(5),u()(),d(6,"div",26)(7,"button",27),L("click",function(){let i=D(e).$implicit,a=C(2);return N(a.openSubCategoryModal(i.id))}),j(8,"i",28),u(),d(9,"button",29),L("click",function(){let i=D(e).$implicit,a=C(2);return N(a.openCategoryModal(i))}),j(10,"i",30),u(),d(11,"button",31),L("click",function(){let i=D(e).$implicit,a=C(2);return N(a.deleteCategory(i))}),j(12,"i",32),u()()(),fe(13,FI,2,1,"div",33),u()}if(t&2){let e=r.$implicit;g(3),Ft("background-color",e.color),g(2),be(e.name),g(8),P("ngIf",e.subCategories&&e.subCategories.length>0)}}function NI(t,r){t&1&&(d(0,"div",41),j(1,"i",42),d(2,"p"),_(3,"No hay categor\xEDas registradas"),u()())}function RI(t,r){if(t&1&&(d(0,"div",18),fe(1,DI,14,4,"div",19)(2,NI,4,0,"div",20),u()),t&2){let e=C();g(),P("ngForOf",e.categories),g(),P("ngIf",e.categories.length===0)}}function LI(t,r){t&1&&(d(0,"div",43),j(1,"div",44),d(2,"div"),_(3,"Cargando categor\xEDas..."),u()())}function BI(t,r){if(t&1){let e=Pe();d(0,"div",22)(1,"div",23),j(2,"span",24),d(3,"span",25),_(4),u()(),d(5,"div",26)(6,"button",29),L("click",function(){let i=D(e).$implicit,a=C(2);return N(a.openTypeModal(i))}),j(7,"i",30),u(),d(8,"button",31),L("click",function(){let i=D(e).$implicit,a=C(2);return N(a.deleteType(i))}),j(9,"i",32),u()()()}if(t&2){let e=r.$implicit;g(2),Ft("background-color",e.color),g(2),be(e.name)}}function UI(t,r){t&1&&(d(0,"div",41),j(1,"i",42),d(2,"p"),_(3,"No hay tipos registrados"),u()())}function VI(t,r){if(t&1&&(d(0,"div",18),fe(1,BI,10,3,"div",45)(2,UI,4,0,"div",20),u()),t&2){let e=C();g(),P("ngForOf",e.types),g(),P("ngIf",e.types.length===0)}}function zI(t,r){t&1&&(d(0,"div",43),j(1,"div",44),d(2,"div"),_(3,"Cargando tipos..."),u()())}function jI(t,r){if(t&1&&(d(0,"span"),j(1,"i",55),_(2),u()),t&2){let e=C().$implicit;g(2),p0(" ",e.minAge," - ",e.maxAge," a\xF1os")}}function HI(t,r){if(t&1&&(d(0,"span"),j(1,"i",55),_(2),u()),t&2){let e=C().$implicit;g(2),je(" Mayor de ",e.minAge," a\xF1os")}}function WI(t,r){if(t&1&&(d(0,"span"),j(1,"i",55),_(2),u()),t&2){let e=C().$implicit;g(2),je(" Hasta ",e.maxAge," a\xF1os")}}function qI(t,r){t&1&&(d(0,"span"),j(1,"i",55),_(2," Cualquier Edad"),u())}function GI(t,r){if(t&1&&(d(0,"span"),j(1,"i",56),_(2),Cr(3,"titlecase"),u()),t&2){let e=C().$implicit;g(),P("ngClass",e.gender==="HOMBRE"?"fa-mars":"fa-venus"),g(),je(" ",xs(3,2,e.gender))}}function $I(t,r){t&1&&(d(0,"span"),j(1,"i",57),_(2," Ambos"),u())}function XI(t,r){if(t&1){let e=Pe();d(0,"div",22)(1,"div",47)(2,"div",48),j(3,"span",24),d(4,"span",25),_(5),u()(),d(6,"small",49),fe(7,jI,3,2,"span",50)(8,HI,3,1,"span",50)(9,WI,3,1,"span",50)(10,qI,3,0,"span",50)(11,GI,4,4,"span",50)(12,$I,3,0,"span",50),d(13,"span"),j(14,"i",51),_(15),u()()(),d(16,"div",26)(17,"label",52)(18,"input",53),L("change",function(){let i=D(e).$implicit,a=C(2);return N(a.toggleRuleStatus(i))}),u(),j(19,"span",54),u(),d(20,"button",29),L("click",function(){let i=D(e).$implicit,a=C(2);return N(a.openRuleModal(i))}),j(21,"i",30),u(),d(22,"button",31),L("click",function(){let i=D(e).$implicit,a=C(2);return N(a.deleteRule(i))}),j(23,"i",32),u()()()}if(t&2){let e=r.$implicit;g(3),Ft("background-color",e.category.color),g(2),p0("",e.category.name," ",e.subCategory?"("+e.subCategory.name+")":""),g(2),P("ngIf",e.minAge!==null&&e.maxAge!==null),g(),P("ngIf",e.minAge!==null&&e.maxAge===null),g(),P("ngIf",e.minAge===null&&e.maxAge!==null),g(),P("ngIf",e.minAge===null&&e.maxAge===null),g(),P("ngIf",e.gender),g(),P("ngIf",!e.gender),g(3),je(" Prioridad: ",e.priority),g(3),P("checked",e.active)}}function YI(t,r){t&1&&(d(0,"div",41),j(1,"i",42),d(2,"p"),_(3,"No hay reglas registradas"),u()())}function KI(t,r){if(t&1&&(d(0,"div",46),fe(1,XI,24,12,"div",45)(2,YI,4,0,"div",20),u()),t&2){let e=C();g(),P("ngForOf",e.categoryRules),g(),P("ngIf",e.categoryRules.length===0)}}function ZI(t,r){t&1&&(d(0,"div",43),j(1,"div",44),d(2,"div"),_(3,"Cargando reglas..."),u()())}function JI(t,r){t&1&&(d(0,"div",76)(1,"div",77),j(2,"div",78),d(3,"p"),_(4,"Procesando..."),u()()())}function QI(t,r){if(t&1){let e=Pe();d(0,"div",58),L("click",function(){D(e);let i=C();return N(i.closeCategoryModal())}),d(1,"div",59),L("click",function(i){return D(e),N(i.stopPropagation())}),d(2,"div",60)(3,"h2"),_(4),u(),d(5,"button",61),L("click",function(){D(e);let i=C();return N(i.closeCategoryModal())}),_(6,"\xD7"),u()(),fe(7,JI,5,0,"div",62),d(8,"div",63)(9,"form",64),L("submit",function(){D(e);let i=C();return N(i.saveCategory())}),d(10,"div",65)(11,"label",66),_(12,"Nombre de la Categor\xEDa"),u(),d(13,"div",67),j(14,"i",68)(15,"input",69),u()(),d(16,"div",65)(17,"label",66),_(18,"Color de Identificaci\xF3n"),u(),d(19,"div",70),j(20,"input",71),d(21,"span",72),_(22),u()()(),d(23,"div",73)(24,"button",74),L("click",function(){D(e);let i=C();return N(i.closeCategoryModal())}),_(25," Cancelar "),u(),d(26,"button",75),j(27,"i",56),_(28),u()()()()()()}if(t&2){let e,n,i=C();g(4),be(i.isEditingCategory?"Editar Categor\xEDa":"Nueva Categor\xEDa"),g(3),P("ngIf",i.isSavingCategory),g(2),P("formGroup",i.categoryForm),g(12),Ft("background-color",(e=i.categoryForm.get("color"))==null?null:e.value),g(),je(" ",(n=i.categoryForm.get("color"))==null?null:n.value," "),g(2),P("disabled",i.isSavingCategory),g(2),P("disabled",i.categoryForm.invalid||i.isSavingCategory),g(),P("ngClass",i.isSavingCategory?"fa-spinner fa-spin":"fa-save"),g(),je(" ",i.isSavingCategory?"Guardando...":"Guardar"," ")}}function eF(t,r){t&1&&(d(0,"div",76)(1,"div",77),j(2,"div",78),d(3,"p"),_(4,"Procesando..."),u()()())}function tF(t,r){if(t&1){let e=Pe();d(0,"div",58),L("click",function(){D(e);let i=C();return N(i.closeTypeModal())}),d(1,"div",59),L("click",function(i){return D(e),N(i.stopPropagation())}),d(2,"div",60)(3,"h2"),_(4),u(),d(5,"button",61),L("click",function(){D(e);let i=C();return N(i.closeTypeModal())}),_(6,"\xD7"),u()(),fe(7,eF,5,0,"div",62),d(8,"div",63)(9,"form",64),L("submit",function(){D(e);let i=C();return N(i.saveType())}),d(10,"div",65)(11,"label",66),_(12,"Nombre del Tipo"),u(),d(13,"div",67),j(14,"i",79)(15,"input",80),u()(),d(16,"div",65)(17,"label",66),_(18,"Color de Identificaci\xF3n"),u(),d(19,"div",70),j(20,"input",71),d(21,"span",72),_(22),u()()(),d(23,"div",73)(24,"button",74),L("click",function(){D(e);let i=C();return N(i.closeTypeModal())}),_(25," Cancelar "),u(),d(26,"button",75),j(27,"i",56),_(28),u()()()()()()}if(t&2){let e,n,i=C();g(4),be(i.isEditingType?"Editar Tipo":"Nuevo Tipo"),g(3),P("ngIf",i.isSavingType),g(2),P("formGroup",i.typeForm),g(12),Ft("background-color",(e=i.typeForm.get("color"))==null?null:e.value),g(),je(" ",(n=i.typeForm.get("color"))==null?null:n.value," "),g(2),P("disabled",i.isSavingType),g(2),P("disabled",i.typeForm.invalid||i.isSavingType),g(),P("ngClass",i.isSavingType?"fa-spinner fa-spin":"fa-save"),g(),je(" ",i.isSavingType?"Guardando...":"Guardar"," ")}}function rF(t,r){t&1&&(d(0,"div",76)(1,"div",77),j(2,"div",78),d(3,"p"),_(4,"Procesando..."),u()()())}function nF(t,r){if(t&1){let e=Pe();d(0,"div",58),L("click",function(){D(e);let i=C();return N(i.closeSubCategoryModal())}),d(1,"div",59),L("click",function(i){return D(e),N(i.stopPropagation())}),d(2,"div",60)(3,"h2"),_(4),u(),d(5,"button",61),L("click",function(){D(e);let i=C();return N(i.closeSubCategoryModal())}),_(6,"\xD7"),u()(),fe(7,rF,5,0,"div",62),d(8,"div",63)(9,"form",64),L("submit",function(){D(e);let i=C();return N(i.saveSubCategory())}),d(10,"div",65)(11,"label",66),_(12,"Nombre de la Sub-categor\xEDa"),u(),d(13,"div",67),j(14,"i",68)(15,"input",81),u()(),d(16,"div",65)(17,"label",66),_(18,"Color de Identificaci\xF3n"),u(),d(19,"div",70),j(20,"input",71),d(21,"span",72),_(22),u()()(),d(23,"div",73)(24,"button",74),L("click",function(){D(e);let i=C();return N(i.closeSubCategoryModal())}),_(25," Cancelar "),u(),d(26,"button",75),j(27,"i",56),_(28),u()()()()()()}if(t&2){let e,n,i=C();g(4),be(i.isEditingSubCategory?"Editar Sub-categor\xEDa":"Nueva Sub-categor\xEDa"),g(3),P("ngIf",i.isSavingSubCategory),g(2),P("formGroup",i.subCategoryForm),g(12),Ft("background-color",(e=i.subCategoryForm.get("color"))==null?null:e.value),g(),je(" ",(n=i.subCategoryForm.get("color"))==null?null:n.value," "),g(2),P("disabled",i.isSavingSubCategory),g(2),P("disabled",i.subCategoryForm.invalid||i.isSavingSubCategory),g(),P("ngClass",i.isSavingSubCategory?"fa-spinner fa-spin":"fa-save"),g(),je(" ",i.isSavingSubCategory?"Guardando...":"Guardar"," ")}}function iF(t,r){t&1&&(d(0,"div",76)(1,"div",77),j(2,"div",78),d(3,"p"),_(4,"Procesando..."),u()()())}function aF(t,r){if(t&1&&(d(0,"option",98),_(1),u()),t&2){let e=r.$implicit;P("value",e.id),g(),be(e.name)}}function oF(t,r){if(t&1&&(d(0,"option",98),_(1),u()),t&2){let e=r.$implicit;P("value",e.id),g(),be(e.name)}}function sF(t,r){if(t&1&&(d(0,"div",65)(1,"label",66),_(2,"Sub-categor\xEDa (Opcional)"),u(),d(3,"div",67),j(4,"i",99),d(5,"select",100)(6,"option",93),_(7,"Cualquiera"),u(),fe(8,oF,2,2,"option",84),u()()()),t&2){let e=C(2);g(8),P("ngForOf",e.subCategoriesForSelectedRuleCategory)}}function lF(t,r){if(t&1){let e=Pe();d(0,"div",58),L("click",function(){D(e);let i=C();return N(i.closeRuleModal())}),d(1,"div",59),L("click",function(i){return D(e),N(i.stopPropagation())}),d(2,"div",60)(3,"h2"),_(4),u(),d(5,"button",61),L("click",function(){D(e);let i=C();return N(i.closeRuleModal())}),_(6,"\xD7"),u()(),fe(7,iF,5,0,"div",62),d(8,"div",63)(9,"form",64),L("submit",function(){D(e);let i=C();return N(i.saveRule())}),d(10,"div",65)(11,"label",66),_(12,"Categor\xEDa *"),u(),d(13,"div",67),j(14,"i",68),d(15,"select",82)(16,"option",83),_(17,"Seleccione una categor\xEDa"),u(),fe(18,aF,2,2,"option",84),u()()(),fe(19,sF,9,1,"div",85),d(20,"div",86)(21,"div",65)(22,"label",66),_(23,"Edad M\xEDnima (Opcional)"),u(),d(24,"div",67),j(25,"i",87)(26,"input",88),u()(),d(27,"div",65)(28,"label",66),_(29,"Edad M\xE1xima (Opcional)"),u(),d(30,"div",67),j(31,"i",89)(32,"input",90),u()()(),d(33,"div",65)(34,"label",66),_(35,"G\xE9nero (Opcional)"),u(),d(36,"div",67),j(37,"i",91),d(38,"select",92)(39,"option",93),_(40,"Cualquier G\xE9nero"),u(),d(41,"option",94),_(42,"Hombre"),u(),d(43,"option",95),_(44,"Mujer"),u()()()(),d(45,"div",65)(46,"label",66),_(47,"Prioridad (Mayor n\xFAmero = menor prioridad) *"),u(),d(48,"div",67),j(49,"i",96)(50,"input",97),u()(),d(51,"div",73)(52,"button",74),L("click",function(){D(e);let i=C();return N(i.closeRuleModal())}),_(53," Cancelar "),u(),d(54,"button",75),j(55,"i",56),_(56),u()()()()()()}if(t&2){let e=C();g(4),be(e.isEditingRule?"Editar Regla":"Nueva Regla"),g(3),P("ngIf",e.isSavingRule),g(2),P("formGroup",e.ruleForm),g(9),P("ngForOf",e.categories),g(),P("ngIf",e.subCategoriesForSelectedRuleCategory.length>0),g(33),P("disabled",e.isSavingRule),g(2),P("disabled",e.ruleForm.invalid||e.isSavingRule),g(),P("ngClass",e.isSavingRule?"fa-spinner fa-spin":"fa-save"),g(),je(" ",e.isSavingRule?"Guardando...":"Guardar"," ")}}var zu=class t{fb=Ce(ks);configService=Ce(wa);notificationService=Ce(Kr);confirmationService=Ce(Ni);categoryRulesService=Ce(Vu);categories=[];types=[];categoryRules=[];isLoadingCategories=!0;isLoadingTypes=!0;isLoadingRules=!0;showCategoryModal=!1;showTypeModal=!1;showSubCategoryModal=!1;showRuleModal=!1;isEditingCategory=!1;isEditingType=!1;isEditingSubCategory=!1;isEditingRule=!1;editingCategoryId;editingTypeId;editingSubCategoryId;editingRuleId;selectedCategoryIdForSub;categoryForm;typeForm;subCategoryForm;ruleForm;isSavingCategory=!1;isSavingType=!1;isSavingSubCategory=!1;isSavingRule=!1;ngOnInit(){this.initForms(),this.loadCategories(),this.loadTypes(),this.loadRules()}initForms(){this.categoryForm=this.fb.group({name:["",[or.required,or.minLength(2)]],color:["#3b82f6",or.required]}),this.typeForm=this.fb.group({name:["",[or.required,or.minLength(2)]],color:["#10b981",or.required]}),this.subCategoryForm=this.fb.group({name:["",[or.required,or.minLength(2)]],color:["#3b82f6",or.required],categoryId:["",or.required]}),this.ruleForm=this.fb.group({memberCategoryId:["",or.required],subCategoryId:[""],minAge:[null,[or.min(0)]],maxAge:[null,[or.min(0)]],gender:[""],priority:[0,[or.required,or.min(0)]]}),this.ruleForm.get("memberCategoryId")?.valueChanges.subscribe(()=>{this.ruleForm.patchValue({subCategoryId:""})})}loadCategories(){this.isLoadingCategories=!0,this.configService.getCategories().subscribe({next:r=>{this.categories=r,this.isLoadingCategories=!1},error:()=>{this.isLoadingCategories=!1,this.notificationService.error("Error al cargar categor\xEDas")}})}openCategoryModal(r){r?(this.isEditingCategory=!0,this.editingCategoryId=r.id,this.categoryForm.patchValue({name:r.name,color:r.color})):(this.isEditingCategory=!1,this.editingCategoryId=void 0,this.categoryForm.reset({color:"#3b82f6"})),this.showCategoryModal=!0}closeCategoryModal(){this.showCategoryModal=!1,this.categoryForm.reset(),this.isEditingCategory=!1,this.editingCategoryId=void 0}saveCategory(){if(this.categoryForm.invalid)return;this.isSavingCategory=!0;let r=this.categoryForm.value;(this.isEditingCategory&&this.editingCategoryId?this.configService.updateCategory(this.editingCategoryId,r):this.configService.createCategory(r)).subscribe({next:()=>{this.notificationService.success(this.isEditingCategory?"Categor\xEDa actualizada":"Categor\xEDa creada"),this.loadCategories(),this.closeCategoryModal(),this.isSavingCategory=!1},error:()=>{this.notificationService.error("Error al guardar categor\xEDa"),this.isSavingCategory=!1}})}deleteCategory(r){return Cn(this,null,function*(){(yield this.confirmationService.confirm({title:"Eliminar Categor\xEDa",message:`\xBFEst\xE1 seguro de eliminar la categor\xEDa "${r.name}"?`,type:"danger",confirmText:"Eliminar"}))&&this.configService.deleteCategory(r.id).subscribe({next:()=>{this.notificationService.success("Categor\xEDa eliminada"),this.loadCategories()},error:()=>{this.notificationService.error("Error al eliminar categor\xEDa")}})})}openSubCategoryModal(r,e){this.selectedCategoryIdForSub=r,e?(this.isEditingSubCategory=!0,this.editingSubCategoryId=e.id,this.subCategoryForm.patchValue({name:e.name,color:e.color,categoryId:r})):(this.isEditingSubCategory=!1,this.editingSubCategoryId=void 0,this.subCategoryForm.reset({color:"#3b82f6",categoryId:r})),this.showSubCategoryModal=!0}closeSubCategoryModal(){this.showSubCategoryModal=!1,this.subCategoryForm.reset(),this.isEditingSubCategory=!1,this.editingSubCategoryId=void 0,this.selectedCategoryIdForSub=void 0}saveSubCategory(){if(this.subCategoryForm.invalid)return;this.isSavingSubCategory=!0;let r=this.subCategoryForm.value;(this.isEditingSubCategory&&this.editingSubCategoryId?this.configService.updateSubCategory(this.editingSubCategoryId,r):this.configService.createSubCategory(r)).subscribe({next:()=>{this.notificationService.success(this.isEditingSubCategory?"Sub-categor\xEDa actualizada":"Sub-categor\xEDa creada"),this.loadCategories(),this.closeSubCategoryModal(),this.isSavingSubCategory=!1},error:()=>{this.notificationService.error("Error al guardar sub-categor\xEDa"),this.isSavingSubCategory=!1}})}deleteSubCategory(r){return Cn(this,null,function*(){(yield this.confirmationService.confirm({title:"Eliminar Sub-categor\xEDa",message:`\xBFEst\xE1 seguro de eliminar la sub-categor\xEDa "${r.name}"?`,type:"danger",confirmText:"Eliminar"}))&&this.configService.deleteSubCategory(r.id).subscribe({next:()=>{this.notificationService.success("Sub-categor\xEDa eliminada"),this.loadCategories()},error:()=>{this.notificationService.error("Error al eliminar sub-categor\xEDa")}})})}loadTypes(){this.isLoadingTypes=!0,this.configService.getTypes().subscribe({next:r=>{this.types=r,this.isLoadingTypes=!1},error:()=>{this.isLoadingTypes=!1,this.notificationService.error("Error al cargar tipos")}})}openTypeModal(r){r?(this.isEditingType=!0,this.editingTypeId=r.id,this.typeForm.patchValue({name:r.name,color:r.color})):(this.isEditingType=!1,this.editingTypeId=void 0,this.typeForm.reset({color:"#10b981"})),this.showTypeModal=!0}closeTypeModal(){this.showTypeModal=!1,this.typeForm.reset(),this.isEditingType=!1,this.editingTypeId=void 0}saveType(){if(this.typeForm.invalid)return;this.isSavingType=!0;let r=this.typeForm.value;(this.isEditingType&&this.editingTypeId?this.configService.updateType(this.editingTypeId,r):this.configService.createType(r)).subscribe({next:()=>{this.notificationService.success(this.isEditingType?"Tipo actualizado":"Tipo creado"),this.loadTypes(),this.closeTypeModal(),this.isSavingType=!1},error:()=>{this.notificationService.error("Error al guardar tipo"),this.isSavingType=!1}})}deleteType(r){return Cn(this,null,function*(){(yield this.confirmationService.confirm({title:"Eliminar Tipo",message:`\xBFEst\xE1 seguro de eliminar el tipo "${r.name}"?`,type:"danger",confirmText:"Eliminar"}))&&this.configService.deleteType(r.id).subscribe({next:()=>{this.notificationService.success("Tipo eliminado"),this.loadTypes()},error:()=>{this.notificationService.error("Error al eliminar tipo")}})})}get subCategoriesForSelectedRuleCategory(){let r=this.ruleForm.get("memberCategoryId")?.value;return r?this.categories.find(n=>n.id===r)?.subCategories||[]:[]}loadRules(){this.isLoadingRules=!0,this.categoryRulesService.findAll().subscribe({next:r=>{this.categoryRules=r,this.isLoadingRules=!1},error:()=>{this.isLoadingRules=!1,this.notificationService.error("Error al cargar reglas de categor\xEDa")}})}openRuleModal(r){r?(this.isEditingRule=!0,this.editingRuleId=r.id,this.ruleForm.patchValue({memberCategoryId:r.category.id,subCategoryId:r.subCategory?r.subCategory.id:"",minAge:r.minAge!==void 0?r.minAge:null,maxAge:r.maxAge!==void 0?r.maxAge:null,gender:r.gender||"",priority:r.priority})):(this.isEditingRule=!1,this.editingRuleId=void 0,this.ruleForm.reset({minAge:null,maxAge:null,priority:0,gender:""})),this.showRuleModal=!0}closeRuleModal(){this.showRuleModal=!1,this.ruleForm.reset(),this.isEditingRule=!1,this.editingRuleId=void 0}saveRule(){if(this.ruleForm.invalid)return;this.isSavingRule=!0;let r=this.ruleForm.value,e={memberCategoryId:r.memberCategoryId,subCategoryId:r.subCategoryId||void 0,minAge:r.minAge!==""?r.minAge:null,maxAge:r.maxAge!==""?r.maxAge:null,gender:r.gender?r.gender:null,priority:r.priority};(this.isEditingRule&&this.editingRuleId?this.categoryRulesService.update(this.editingRuleId,e):this.categoryRulesService.create(e)).subscribe({next:()=>{this.notificationService.success(this.isEditingRule?"Regla actualizada":"Regla creada"),this.loadRules(),this.closeRuleModal(),this.isSavingRule=!1},error:()=>{this.notificationService.error("Error al guardar la regla"),this.isSavingRule=!1}})}toggleRuleStatus(r){let e=!r.active;this.categoryRulesService.updateActive(r.id,e).subscribe({next:()=>{r.active=e,this.notificationService.success(`Regla ${e?"activada":"desactivada"} correctamente`)},error:()=>{r.active=!e,this.notificationService.error("Error al cambiar el estado de la regla")}})}deleteRule(r){return Cn(this,null,function*(){(yield this.confirmationService.confirm({title:"Eliminar Regla",message:"\xBFEst\xE1 seguro de eliminar esta regla?",type:"danger",confirmText:"Eliminar"}))&&this.categoryRulesService.delete(r.id).subscribe({next:()=>{this.notificationService.success("Regla eliminada"),this.loadRules()},error:()=>{this.notificationService.error("Error al eliminar la regla")}})})}static \u0275fac=function(e){return new(e||t)};static \u0275cmp=ir({type:t,selectors:[["app-configuracion"]],decls:43,vars:10,consts:[[1,"config-container"],[1,"config-card"],[1,"page-title"],[1,"fa-solid","fa-gear"],[1,"config-grid"],[1,"config-section"],[1,"section-header"],[1,"fa-solid","fa-tag"],[1,"btn","btn-primary","btn-sm",3,"click"],[1,"fa-solid","fa-plus"],[1,"btn-text"],["class","items-list",4,"ngIf"],["class","loading-container",4,"ngIf"],[1,"fa-solid","fa-users"],[1,"config-section",2,"grid-column","1 / -1"],[1,"fa-solid","fa-scale-balanced"],["class","items-list rules-list",4,"ngIf"],["class","modal-overlay",3,"click",4,"ngIf"],[1,"items-list"],["class","item-card-container",4,"ngFor","ngForOf"],["class","empty-state",4,"ngIf"],[1,"item-card-container"],[1,"item-card"],[1,"item-info"],[1,"color-badge"],[1,"item-name"],[1,"item-actions"],["title","Agregar Sub-categor\xEDa",1,"action-btn","add-sub",3,"click"],[1,"fa-solid","fa-plus-circle"],["title","Editar",1,"action-btn","edit",3,"click"],[1,"fa-solid","fa-pen"],["title","Eliminar",1,"action-btn","delete",3,"click"],[1,"fa-solid","fa-trash"],["class","sub-items-list",4,"ngIf"],[1,"sub-items-list"],["class","sub-item-card",4,"ngFor","ngForOf"],[1,"sub-item-card"],[1,"color-badge","sub"],[1,"item-name","sub"],["title","Editar Sub-categor\xEDa",1,"action-btn","edit",3,"click"],["title","Eliminar Sub-categor\xEDa",1,"action-btn","delete",3,"click"],[1,"empty-state"],[1,"fa-solid","fa-inbox"],[1,"loading-container"],[1,"loading-spinner"],["class","item-card",4,"ngFor","ngForOf"],[1,"items-list","rules-list"],[1,"item-info",2,"display","flex","flex-direction","column","gap","0.25rem","align-items","flex-start"],[2,"display","flex","align-items","center","gap","0.5rem"],[2,"color","var(--text-muted)","font-size","0.8rem","display","flex","gap","0.75rem"],[4,"ngIf"],[1,"fa-solid","fa-arrow-up-9-1"],["title","Activar/Desactivar",1,"switch",2,"margin-right","0.5rem"],["type","checkbox",3,"change","checked"],[1,"slider","round"],[1,"fa-solid","fa-user-clock"],[1,"fa-solid",3,"ngClass"],[1,"fa-solid","fa-venus-mars"],[1,"modal-overlay",3,"click"],[1,"modal-content",3,"click"],[1,"modal-header"],[1,"close-btn",3,"click"],["class","modal-loading-overlay",4,"ngIf"],[1,"modal-body"],[3,"submit","formGroup"],[1,"soft-input-group"],[1,"soft-label"],[1,"soft-input-wrapper"],[1,"fa-solid","fa-tag","soft-input-icon"],["type","text","formControlName","name","placeholder","Ej: Adultos, J\xF3venes, Ni\xF1os...","required","",1,"soft-input"],[1,"color-input-wrapper"],["type","color","formControlName","color","required","",1,"color-input"],[1,"color-preview"],[1,"modal-footer"],["type","button",1,"btn","btn-muted",3,"click","disabled"],["type","submit",1,"btn","btn-primary",3,"disabled"],[1,"modal-loading-overlay"],[1,"spinner-wrapper"],[1,"spinner-circle"],[1,"fa-solid","fa-users","soft-input-icon"],["type","text","formControlName","name","placeholder","Ej: Miembro, Visitante, L\xEDder...","required","",1,"soft-input"],["type","text","formControlName","name","placeholder","Ej: Staff, Invitados, etc...","required","",1,"soft-input"],["formControlName","memberCategoryId","required","",1,"soft-input"],["value","","disabled","","selected",""],[3,"value",4,"ngFor","ngForOf"],["class","soft-input-group",4,"ngIf"],[2,"display","grid","grid-template-columns","1fr 1fr","gap","1rem"],[1,"fa-solid","fa-user-minus","soft-input-icon"],["type","number","formControlName","minAge","min","0","placeholder","Ej: 18",1,"soft-input"],[1,"fa-solid","fa-user-plus","soft-input-icon"],["type","number","formControlName","maxAge","min","0","placeholder","Ej: 30",1,"soft-input"],[1,"fa-solid","fa-venus-mars","soft-input-icon"],["formControlName","gender",1,"soft-input"],["value",""],["value","HOMBRE"],["value","MUJER"],[1,"fa-solid","fa-arrow-up-9-1","soft-input-icon"],["type","number","formControlName","priority","min","0","required","",1,"soft-input"],[3,"value"],[1,"fa-solid","fa-tags","soft-input-icon"],["formControlName","subCategoryId",1,"soft-input"]],template:function(e,n){e&1&&(d(0,"div",0)(1,"div",1)(2,"h1",2),j(3,"i",3),_(4," Configuraci\xF3n General "),u(),d(5,"div",4)(6,"div",5)(7,"div",6)(8,"h2"),j(9,"i",7),_(10," Categor\xEDas de Miembros "),u(),d(11,"button",8),L("click",function(){return n.openCategoryModal()}),j(12,"i",9),d(13,"span",10),_(14,"Nueva Categor\xEDa"),u()()(),fe(15,RI,3,2,"div",11)(16,LI,4,0,"div",12),u(),d(17,"div",5)(18,"div",6)(19,"h2"),j(20,"i",13),_(21," Tipos de Miembros "),u(),d(22,"button",8),L("click",function(){return n.openTypeModal()}),j(23,"i",9),d(24,"span",10),_(25,"Nuevo Tipo"),u()()(),fe(26,VI,3,2,"div",11)(27,zI,4,0,"div",12),u(),d(28,"div",14)(29,"div",6)(30,"h2"),j(31,"i",15),_(32," Reglas de Categor\xEDa "),u(),d(33,"button",8),L("click",function(){return n.openRuleModal()}),j(34,"i",9),d(35,"span",10),_(36,"Nueva Regla"),u()()(),fe(37,KI,3,2,"div",16)(38,ZI,4,0,"div",12),u()()()(),fe(39,QI,29,10,"div",17)(40,tF,29,10,"div",17)(41,nF,29,10,"div",17)(42,lF,57,9,"div",17)),e&2&&(g(15),P("ngIf",!n.isLoadingCategories),g(),P("ngIf",n.isLoadingCategories),g(10),P("ngIf",!n.isLoadingTypes),g(),P("ngIf",n.isLoadingTypes),g(10),P("ngIf",!n.isLoadingRules),g(),P("ngIf",n.isLoadingRules),g(),P("ngIf",n.showCategoryModal),g(),P("ngIf",n.showTypeModal),g(),P("ngIf",n.showSubCategoryModal),g(),P("ngIf",n.showRuleModal))},dependencies:[gr,Tr,rn,mr,on,xa,Fi,Di,nn,Gl,Ii,an,va,Xl,$l,Es,Ss,Cs,m1],styles:['[_nghost-%COMP%]{display:block;height:100%;width:100%}.config-container[_ngcontent-%COMP%]{height:100%;width:100%;padding:1.5rem}.config-card[_ngcontent-%COMP%]{background:var(--bg-card);border-radius:12px;box-shadow:var(--shadow-sm);padding:2rem;height:100%;overflow:auto}.page-title[_ngcontent-%COMP%]{font-size:1.75rem;font-weight:700;color:var(--text-primary);margin:0 0 2rem;display:flex;align-items:center;gap:.75rem}.page-title[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:var(--primary)}.config-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:2rem}@media(max-width:768px){.config-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}}.config-section[_ngcontent-%COMP%]{background:var(--bg-input);border-radius:12px;padding:1.5rem;border:1px solid var(--border-color)}.section-header[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;margin-bottom:1.5rem;flex-wrap:wrap;gap:1rem}.section-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:1.25rem;font-weight:700;color:var(--text-primary);margin:0;display:flex;align-items:center;gap:.5rem}.section-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:var(--primary)}.items-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.75rem}.item-card[_ngcontent-%COMP%]{background:var(--bg-card);border:1px solid var(--border-color);border-radius:8px;padding:1rem;display:flex;align-items:center;justify-content:space-between;transition:all .2s}.item-card[_ngcontent-%COMP%]:hover{box-shadow:0 2px 8px #00000014;transform:translateY(-1px)}.item-info[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.75rem}.color-badge[_ngcontent-%COMP%]{width:32px;height:32px;border-radius:8px;border:2px solid rgba(0,0,0,.1);box-shadow:0 2px 4px #0000001a}.item-name[_ngcontent-%COMP%]{font-weight:600;color:var(--text-primary);font-size:.95rem}.item-actions[_ngcontent-%COMP%]{display:flex;gap:.5rem}.action-btn[_ngcontent-%COMP%]{width:32px;height:32px;border-radius:6px;border:none;background:var(--border-color);color:var(--text-muted);display:flex;align-items:center;justify-content:center;cursor:pointer;transition:all .2s;font-size:.85rem}.action-btn[_ngcontent-%COMP%]:hover{transform:scale(1.05)}.action-btn.edit[_ngcontent-%COMP%]:hover{background:#e0e7ff;color:var(--primary)}.action-btn.delete[_ngcontent-%COMP%]:hover{background:#fee2e2;color:#ef4444}.empty-state[_ngcontent-%COMP%]{text-align:center;padding:3rem 1rem;color:#94a3b8}.empty-state[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:3rem;margin-bottom:1rem;display:block;opacity:.5}.empty-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;font-size:.9rem}.modal-overlay[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;background:#00000080;display:flex;align-items:center;justify-content:center;z-index:9999;-webkit-backdrop-filter:blur(4px);backdrop-filter:blur(4px);animation:_ngcontent-%COMP%_fadeIn .2s}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0}to{opacity:1}}.modal-content[_ngcontent-%COMP%]{background:var(--bg-card);border-radius:16px;width:90%;max-width:500px;max-height:90vh;overflow:hidden;box-shadow:var(--shadow-md);animation:_ngcontent-%COMP%_slideUp .3s;display:flex;flex-direction:column}@keyframes _ngcontent-%COMP%_slideUp{0%{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}.modal-header[_ngcontent-%COMP%]{padding:1.5rem;border-bottom:1px solid var(--border-color);display:flex;align-items:center;justify-content:space-between;background:var(--bg-input);flex-shrink:0}.modal-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0;font-size:1.25rem;font-weight:700;color:var(--text-primary)}.close-btn[_ngcontent-%COMP%]{background:none;border:none;font-size:1.75rem;color:var(--text-secondary);cursor:pointer;width:32px;height:32px;display:flex;align-items:center;justify-content:center;border-radius:8px;transition:all .2s}.close-btn[_ngcontent-%COMP%]:hover{background:var(--border-color);color:var(--text-primary)}.modal-body[_ngcontent-%COMP%]{padding:1.5rem;overflow-y:auto;flex:1}.modal-footer[_ngcontent-%COMP%]{display:flex;gap:.75rem;justify-content:flex-end;margin-top:1.5rem;padding-top:1.5rem;border-top:1px solid var(--border-color)}.color-input-wrapper[_ngcontent-%COMP%]{display:flex;align-items:center;gap:1rem;padding:.75rem 1rem;background:var(--bg-input);border:1.5px solid var(--border-color);border-radius:8px;transition:all .2s}.color-input-wrapper[_ngcontent-%COMP%]:focus-within{border-color:var(--primary);box-shadow:0 0 0 3px rgba(var(--primary-rgb),.1)}.color-input[_ngcontent-%COMP%]{width:60px;height:40px;border:none;border-radius:6px;cursor:pointer}.color-preview[_ngcontent-%COMP%]{flex:1;padding:.5rem 1rem;background:var(--bg-card);border-radius:6px;font-family:monospace;font-size:.9rem;font-weight:600;color:#fff;text-align:center;text-shadow:0 1px 2px rgba(0,0,0,.3);border:1px solid rgba(0,0,0,.1)}.sub-items-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.5rem;padding:.5rem 0 .5rem 1.5rem;border-left:2px solid var(--border-color);margin-left:1rem}.sub-item-card[_ngcontent-%COMP%]{background:var(--bg-card);border:1px solid var(--border-color);border-radius:6px;padding:.6rem .75rem;display:flex;align-items:center;justify-content:space-between;font-size:.85rem;transition:all .2s}.sub-item-card[_ngcontent-%COMP%]:hover{background:var(--bg-input);transform:translate(2px)}.color-badge.sub[_ngcontent-%COMP%]{width:20px;height:20px;border-radius:4px}.item-name.sub[_ngcontent-%COMP%]{font-size:.9rem;font-weight:500}.item-card-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.25rem}.action-btn.add-sub[_ngcontent-%COMP%]:hover{background:#dcfce7;color:#16a34a}@media(max-width:480px){.config-container[_ngcontent-%COMP%]{padding:.5rem}.config-card[_ngcontent-%COMP%], .config-section[_ngcontent-%COMP%]{padding:.75rem}.section-header[_ngcontent-%COMP%]{gap:.5rem;margin-bottom:1rem}.section-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:1.1rem}.btn-text[_ngcontent-%COMP%]{display:none}.item-card[_ngcontent-%COMP%]{padding:.5rem;gap:.5rem}.color-badge[_ngcontent-%COMP%]{width:24px;height:24px;border-radius:6px;flex-shrink:0}.item-actions[_ngcontent-%COMP%]{gap:.25rem}.action-btn[_ngcontent-%COMP%]{width:28px;height:28px;font-size:.75rem;flex-shrink:0}.item-info[_ngcontent-%COMP%]{min-width:0;flex:1;gap:.5rem}.item-name[_ngcontent-%COMP%]{font-size:.85rem;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.sub-items-list[_ngcontent-%COMP%]{padding:.25rem 0 .25rem .5rem;margin-left:.5rem;border-left-width:2px}.sub-item-card[_ngcontent-%COMP%]{padding:.5rem}.color-badge.sub[_ngcontent-%COMP%]{width:16px;height:16px}.item-name.sub[_ngcontent-%COMP%]{font-size:.8rem}}.modal-content.role-modal[_ngcontent-%COMP%]{max-width:800px}.form-section[_ngcontent-%COMP%]{margin-bottom:2rem}.section-label[_ngcontent-%COMP%]{display:block;font-size:.85rem;font-weight:800;color:var(--text-muted);text-transform:uppercase;letter-spacing:.05em;margin-bottom:1.5rem;border-left:4px solid var(--primary);padding-left:.75rem}.perms-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(300px,1fr));gap:1.5rem}.perm-category[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:.95rem;font-weight:700;margin-bottom:1rem;color:var(--text-primary)}.perm-item[_ngcontent-%COMP%]{display:flex;align-items:flex-start;gap:1rem;padding:.75rem;border-radius:12px;background:var(--bg-input);border:1px solid transparent;cursor:pointer;transition:all .2s;margin-bottom:.75rem}.perm-item[_ngcontent-%COMP%]:hover{background:var(--bg-card);border-color:var(--primary);box-shadow:0 2px 4px #0000000d}.perm-item.active[_ngcontent-%COMP%]{background:#3b82f60d;border-color:var(--primary)}.perm-checkbox[_ngcontent-%COMP%]{width:20px;height:20px;border-radius:6px;border:2px solid #cbd5e1;display:flex;align-items:center;justify-content:center;flex-shrink:0;margin-top:2px;background:var(--bg-card)}.perm-item.active[_ngcontent-%COMP%]   .perm-checkbox[_ngcontent-%COMP%]{background:var(--primary);border-color:var(--primary);color:#fff}.perm-info[_ngcontent-%COMP%]{display:flex;flex-direction:column}.perm-name[_ngcontent-%COMP%]{font-size:.9rem;font-weight:700;color:var(--text-primary)}.perm-desc[_ngcontent-%COMP%]{font-size:.75rem;color:var(--text-muted);line-height:1.3}.switch[_ngcontent-%COMP%]{position:relative;display:inline-block;width:44px;height:24px}.switch[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{opacity:0;width:0;height:0}.slider[_ngcontent-%COMP%]{position:absolute;cursor:pointer;inset:0;background-color:#cbd5e1;transition:.4s}.slider[_ngcontent-%COMP%]:before{position:absolute;content:"";height:18px;width:18px;left:3px;bottom:3px;background-color:#fff;transition:.4s}input[_ngcontent-%COMP%]:checked + .slider[_ngcontent-%COMP%]{background-color:var(--primary)}input[_ngcontent-%COMP%]:checked + .slider[_ngcontent-%COMP%]:before{transform:translate(20px)}.slider.round[_ngcontent-%COMP%]{border-radius:34px}.slider.round[_ngcontent-%COMP%]:before{border-radius:50%}']})};var ju=class t{http=Ce(Ai);baseUrl=`${Ti.baseUrl}/dashboards`;getDashboardData(){return this.http.post(this.baseUrl,{})}static \u0275fac=function(e){return new(e||t)};static \u0275prov=nr({token:t,factory:t.\u0275fac,providedIn:"root"})};function cF(t,r){if(t&1){let e=Pe();d(0,"div",8)(1,"div",9)(2,"div",10),j(3,"i",11),u(),d(4,"div",12)(5,"span",13),_(6,"Total Integrantes"),u(),d(7,"h2",14),_(8),Cr(9,"number"),u(),d(10,"span",15),_(11,"Registrados activamente"),u()()(),d(12,"div",16),L("click",function(){D(e);let i=C();return N(i.openBirthdayModal())}),d(13,"div",17),j(14,"i",18),u(),d(15,"div",12)(16,"span",13),_(17,"Cumplea\xF1os del Mes"),u(),d(18,"h2",14),_(19),u(),d(20,"span",15),_(21,"Click para ver la lista \u{1F382}"),u()(),d(22,"div",19),j(23,"i",20),u()(),d(24,"div",9)(25,"div",10),j(26,"i",21),u(),d(27,"div",12)(28,"span",13),_(29,"Total Bautismos"),u(),d(30,"h2",14),_(31),u(),d(32,"span",15),_(33,"Miembros bautizados"),u()()()()}if(t&2){let e=C();g(8),be(xs(9,3,e.data.totalMember)),g(11),be(e.data.membersBirthdays.length),g(12),be(e.data.totalBaptisms)}}function dF(t,r){if(t&1){let e=Pe();d(0,"div",40),L("click",function(i){let a=D(e).$implicit,o=C(2).$implicit,s=C().$implicit;return C(2).openAttendanceDetails(s,o,a),N(i.stopPropagation())}),d(1,"span"),_(2),u(),d(3,"span"),_(4),u()()}if(t&2){let e=r.$implicit;g(2),be(e.name),g(2),be(e.total)}}function fF(t,r){if(t&1&&(d(0,"div",38),fe(1,dF,5,2,"div",39),u()),t&2){let e=C().$implicit;g(),P("ngForOf",e.subCategories)}}function uF(t,r){if(t&1){let e=Pe();d(0,"div",33)(1,"div",34),L("click",function(){let i=D(e).$implicit,a=C().$implicit,o=C(2);return N(o.openAttendanceDetails(a,i))}),d(2,"span",35),_(3),u(),d(4,"span",36),_(5),u()(),fe(6,fF,2,1,"div",37),u()}if(t&2){let e=r.$implicit;g(3),be(e.name),g(2),be(e.total),g(),P("ngIf",e.subCategories&&e.subCategories.length>0)}}function hF(t,r){if(t&1&&(d(0,"div",28)(1,"div",29)(2,"h3"),_(3),u(),d(4,"span",30),_(5),u()(),d(6,"div",31),fe(7,uF,7,3,"div",32),u()()),t&2){let e=r.$implicit;g(3),be(e.name),g(2),be(e.total),g(2),P("ngForOf",e.categories)}}function pF(t,r){if(t&1&&(d(0,"div",22)(1,"div",23),j(2,"i",24),d(3,"div")(4,"h2"),_(5,"Asistencia de Hoy"),u(),d(6,"span",25),_(7,"Desglose por Sede y Categor\xEDa"),u()()(),d(8,"div",26),fe(9,hF,8,3,"div",27),u()()),t&2){let e=C();g(9),P("ngForOf",e.todayAttendance)}}function mF(t,r){t&1&&(d(0,"div",23),j(1,"i",41),d(2,"h2"),_(3,"Accesos R\xE1pidos"),u()())}function gF(t,r){t&1&&(d(0,"div",42)(1,"a",43)(2,"div",44),j(3,"i",45),u(),d(4,"div",46)(5,"h3"),_(6,"Gestionar Integrantes"),u(),d(7,"p"),_(8,"Ver o registrar nuevos asistentes."),u()()(),d(9,"a",47)(10,"div",48),j(11,"i",49),u(),d(12,"div",46)(13,"h3"),_(14,"Tomar Asistencia"),u(),d(15,"p"),_(16,"Registrar presencia en el culto."),u()()()())}function _F(t,r){if(t&1&&(d(0,"div",50)(1,"div",51)(2,"div",52)(3,"h3"),j(4,"i",53),_(5," Asistencia Semanal"),u(),d(6,"span",54),_(7,"Resumen de los \xFAltimos cultos"),u()(),d(8,"div",55),j(9,"apx-chart",56),u()()()),t&2){let e=C();g(9),P("series",e.chartOptions.series)("chart",e.chartOptions.chart)("xaxis",e.chartOptions.xaxis)("yaxis",e.chartOptions.yaxis)("plotOptions",e.chartOptions.plotOptions)("legend",e.chartOptions.legend)("fill",e.chartOptions.fill)("tooltip",e.chartOptions.tooltip)("colors",e.chartOptions.colors)}}function vF(t,r){t&1&&(d(0,"div",57),j(1,"div",58),d(2,"p"),_(3,"Preparando tu dashboard..."),u()())}function xF(t,r){if(t&1){let e=Pe();d(0,"div",67),j(1,"img",68),d(2,"div",69)(3,"span",70),_(4),u(),d(5,"span",71),_(6),Cr(7,"date"),u()(),d(8,"button",72),L("click",function(){let i=D(e).$implicit,a=C(2);return N(a.viewMember(i))}),j(9,"i",73),u()()}if(t&2){let e=r.$implicit,n=C(2);g(),P("src",e.pictureProfileUrl||"https://ui-avatars.com/api/?name="+e.completeName+"&background=random",pn),g(3),be(e.completeName),g(2),p0("",Qr(7,4,e.birthdate,"longDate")," (",n.calculateAge(e.birthdate)," a\xF1os)")}}function bF(t,r){t&1&&(d(0,"div",74),_(1," No hay cumplea\xF1os registrados este mes. "),u())}function wF(t,r){if(t&1){let e=Pe();d(0,"div",59),L("click",function(){D(e);let i=C();return N(i.closeBirthdayModal())}),d(1,"div",60),L("click",function(i){return D(e),N(i.stopPropagation())}),d(2,"div",61)(3,"h2"),j(4,"i",18),_(5," Cumplea\xF1eros"),u(),d(6,"button",62),L("click",function(){D(e);let i=C();return N(i.closeBirthdayModal())}),_(7,"\xD7"),u()(),d(8,"div",63)(9,"div",64),fe(10,xF,10,7,"div",65)(11,bF,2,0,"div",66),u()()()()}if(t&2){let e=C();g(10),P("ngForOf",e.data==null?null:e.data.membersBirthdays),g(),P("ngIf",(e.data==null||e.data.membersBirthdays==null?null:e.data.membersBirthdays.length)===0)}}function yF(t,r){if(t&1&&(d(0,"div",63)(1,"div",77),j(2,"img",68),d(3,"div",78)(4,"h3"),_(5),u(),d(6,"span",79),_(7),u(),d(8,"span",80),_(9),u()()(),d(10,"div",81)(11,"div",82)(12,"label"),_(13,"C\xE9dula:"),u(),d(14,"span"),_(15),u()(),d(16,"div",82)(17,"label"),_(18,"Tel\xE9fono:"),u(),d(19,"span"),_(20),u()(),d(21,"div",83)(22,"label"),_(23,"Direcci\xF3n:"),u(),d(24,"span"),_(25),u()()()()),t&2){let e=C(2);g(2),P("src",e.selectedMember.pictureProfileUrl||"https://ui-avatars.com/api/?name="+e.selectedMember.completeName+"&size=128&background=random",pn),g(3),be(e.selectedMember.completeName),g(),Ft("background-color",e.selectedMember.category.color),P("ngClass",e.getBadgeClass(e.selectedMember.category)),g(),je(" ",e.formatCategory(e.selectedMember.category)," "),g(),Ft("border-color",e.selectedMember.type.color)("color",e.selectedMember.type.color),g(),je(" ",e.formatType(e.selectedMember.type)," "),g(6),be(e.selectedMember.cc),g(5),be(e.selectedMember.cellphone),g(5),be(e.selectedMember.address||"---")}}function CF(t,r){if(t&1){let e=Pe();d(0,"div",59),L("click",function(){D(e);let i=C();return N(i.closeMemberModal())}),d(1,"div",75),L("click",function(i){return D(e),N(i.stopPropagation())}),d(2,"div",61)(3,"h2"),_(4,"Detalles del Integrante"),u(),d(5,"button",62),L("click",function(){D(e);let i=C();return N(i.closeMemberModal())}),_(6,"\xD7"),u()(),fe(7,yF,26,14,"div",76),u()()}if(t&2){let e=C();g(7),P("ngIf",e.selectedMember)}}function SF(t,r){t&1&&(d(0,"div",88),j(1,"div",89),d(2,"span",90),_(3,"Cargando lista..."),u()())}function kF(t,r){t&1&&(d(0,"div",91),_(1," No hay asistentes registrados en esta categor\xEDa hoy. "),u())}function EF(t,r){if(t&1&&(d(0,"div",100)(1,"div",101)(2,"span",102),_(3),u(),d(4,"span",103),j(5,"i",104),_(6),Cr(7,"date"),u()()()),t&2){let e=r.$implicit;g(3),be(e.memberCompleteName),g(3),je(" ",Qr(7,2,e.attendanceDate,"shortTime")," ")}}function MF(t,r){if(t&1&&(d(0,"div",94)(1,"h3",95)(2,"span"),j(3,"i",96),_(4),u(),d(5,"span",97),_(6),Cr(7,"date"),u()(),d(8,"div",98),fe(9,EF,8,5,"div",99),u()()),t&2){let e=r.$implicit;g(4),je(" ",e.serviceName),g(2),be(Qr(7,3,e.serviceDate,"shortTime")),g(3),P("ngForOf",e.attendees)}}function PF(t,r){if(t&1&&(d(0,"div",92),fe(1,MF,10,6,"div",93),u()),t&2){let e=C(2);g(),P("ngForOf",e.attendanceDetails)}}function OF(t,r){if(t&1){let e=Pe();d(0,"div",59),L("click",function(){D(e);let i=C();return N(i.closeAttendanceDetailsModal())}),d(1,"div",75),L("click",function(i){return D(e),N(i.stopPropagation())}),d(2,"div",61)(3,"h2"),_(4),d(5,"small",84),_(6),u()(),d(7,"button",62),L("click",function(){D(e);let i=C();return N(i.closeAttendanceDetailsModal())}),_(8,"\xD7"),u()(),d(9,"div",63),fe(10,SF,4,0,"div",85)(11,kF,2,0,"div",86)(12,PF,2,1,"div",87),u()()()}if(t&2){let e=C();g(4),je("",e.selectedCategoryForDetails," "),g(2),je("(",e.selectedBranchForDetails,")"),g(4),P("ngIf",e.isLoadingDetails),g(),P("ngIf",!e.isLoadingDetails&&e.attendanceDetails.length===0),g(),P("ngIf",!e.isLoadingDetails)}}var Hu=class t{dashboardService=Ce(ju);themeService=Ce(Hs);cdr=Ce(Un);asistenciaService=Ce(no);destroy$=new Bt;data=null;isLoading=!0;showAttendanceDetailsModal=!1;isLoadingDetails=!1;attendanceDetails=[];selectedBranchForDetails="";selectedCategoryForDetails="";chartOptions;renderChart=!1;showBirthdayModal=!1;showMemberDetailsModal=!1;selectedMember=null;constructor(){ll(()=>{let r=this.themeService.isDarkMode();this.data&&this.data.lastWeekReport&&this.updateChartTheme(r)})}ngOnInit(){console.log("DASHBOARD COMPONENT LOADED - VERSION: "+new Date().toISOString()),this.loadDashboardData(),this.loadTodayAttendance(),this.startPolling()}startPolling(){Gd(2e3).pipe(ms(this.destroy$)).subscribe(()=>{this.loadTodayAttendance()})}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}loadDashboardData(){this.isLoading=!0,this.dashboardService.getDashboardData().subscribe({next:r=>{this.data=r,this.data&&this.data.membersBirthdays&&this.data.membersBirthdays.sort((e,n)=>{if(!e.birthdate)return 1;if(!n.birthdate)return-1;let i=new Date(e.birthdate),a=new Date(n.birthdate),o=i.getMonth(),s=a.getMonth();return o!==s?o-s:i.getDate()-a.getDate()}),this.prepareChart(r.lastWeekReport),this.isLoading=!1,this.cdr.detectChanges()},error:r=>{console.error("Error loading dashboard:",r),this.isLoading=!1,this.cdr.detectChanges()}})}prepareChart(r){if(!r||r.length===0){this.renderChart=!1;return}let e=new Map;r.forEach(l=>{let c=l.serviceTime||`${l.date}_${l.serviceName}`;if(!e.has(c)){let f=l.date;if(l.serviceTime&&l.serviceTime.includes("T")){let v=l.serviceTime.split("T")[1].substring(0,5);f=`${l.date} ${v}`}e.set(c,`${f} - ${l.serviceName}`)}});let n=Array.from(e.keys()).sort(),i=n.map(l=>e.get(l)),a=l=>{let c=l.category,f=l.subCategory;return f?`${c} \u2022 ${f}`:c},s=Array.from(new Set(r.map(l=>a(l)))).sort().map(l=>{let c=n.map(f=>r.filter(x=>(x.serviceTime===f||`${x.date}_${x.serviceName}`===f)&&a(x)===l).reduce((x,p)=>x+(p.total||0),0));return{name:l,data:c}});this.initializeChartOptions(s,i),this.renderChart=!0}initializeChartOptions(r,e){let n=this.themeService.isDarkMode();this.chartOptions={series:r,chart:{height:350,type:"bar",stacked:!0,toolbar:{show:!1},fontFamily:"Inter, sans-serif",background:"transparent"},theme:{mode:n?"dark":"light"},plotOptions:{bar:{borderRadius:8,columnWidth:"60%",dataLabels:{total:{enabled:!0,style:{fontWeight:900,fontSize:"12px",color:n?"#cbd5e1":"#64748b"}}}}},xaxis:{categories:e,labels:{show:!1},axisBorder:{show:!0,color:n?"rgba(255,255,255,0.1)":"rgba(0,0,0,0.1)"},axisTicks:{show:!0,color:n?"rgba(255,255,255,0.1)":"rgba(0,0,0,0.1)"}},yaxis:{title:{text:"Asistencia",style:{color:n?"#f8fafc":"#1e293b"}},labels:{style:{colors:n?"#cbd5e1":"#64748b"}}},legend:{position:"top",horizontalAlign:"left",labels:{colors:n?"#cbd5e1":"#64748b"}},grid:{borderColor:n?"rgba(255,255,255,0.1)":"#f1f5f9"},fill:{opacity:1},tooltip:{theme:n?"dark":"light",shared:!0,intersect:!1,x:{show:!0,formatter:i=>typeof i=="number"?e[i-1]||"Servicio":i}},colors:["#10b981","#3b82f6","#f472b6","#fbbf24","#6366f1"]}}updateChartTheme(r){this.chartOptions&&(this.chartOptions=Pi(Yr({},this.chartOptions),{theme:{mode:r?"dark":"light"},xaxis:Pi(Yr({},this.chartOptions.xaxis),{axisBorder:{show:!0,color:r?"rgba(255,255,255,0.1)":"rgba(0,0,0,0.1)"},axisTicks:{show:!0,color:r?"rgba(255,255,255,0.1)":"rgba(0,0,0,0.1)"}}),yaxis:Pi(Yr({},this.chartOptions.yaxis),{title:Pi(Yr({},this.chartOptions.yaxis?.title),{style:{color:r?"#f8fafc":"#1e293b"}}),labels:{style:{colors:r?"#cbd5e1":"#64748b"}}}),legend:Pi(Yr({},this.chartOptions.legend),{labels:{colors:r?"#cbd5e1":"#64748b"}}),grid:Pi(Yr({},this.chartOptions.grid),{borderColor:r?"rgba(255,255,255,0.1)":"#f1f5f9"}),tooltip:Pi(Yr({},this.chartOptions.tooltip),{theme:r?"dark":"light"}),plotOptions:Pi(Yr({},this.chartOptions.plotOptions),{bar:Pi(Yr({},this.chartOptions.plotOptions?.bar),{dataLabels:Pi(Yr({},this.chartOptions.plotOptions?.bar?.dataLabels),{total:Pi(Yr({},this.chartOptions.plotOptions?.bar?.dataLabels?.total),{style:Pi(Yr({},this.chartOptions.plotOptions?.bar?.dataLabels?.total?.style),{color:r?"#cbd5e1":"#64748b"})})})})})}),this.cdr.detectChanges())}openBirthdayModal(){this.showBirthdayModal=!0}closeBirthdayModal(){this.showBirthdayModal=!1}viewMember(r){this.selectedMember=r,this.showMemberDetailsModal=!0}closeMemberModal(){this.showMemberDetailsModal=!1,this.selectedMember=null}formatAddress(r){let e=[];return r.neighborhood&&e.push(r.neighborhood),r.city&&e.push(r.city),r.municipality&&e.push(r.municipality),e.length>0?e.join(", "):"---"}getBadgeClass(r){switch(typeof r=="string"?r:r?.name){case"DAMAS":return"badge-damas";case"CABALLEROS":return"badge-caballeros";case"JOVENES":return"badge-jovenes";case"NI\xD1OS":return"badge-ninos";default:return""}}formatCategory(r){return r?typeof r=="string"?r:r.name||"":""}formatType(r){return r?typeof r=="string"?r.replace(/_/g," "):r.name||"":""}todayAttendance=[];reporteService=Ce(Dc);loadTodayAttendance(){let r=new Date,e=new Date(r.getFullYear(),r.getMonth(),r.getDate(),0,0,0),n=new Date(r.getFullYear(),r.getMonth(),r.getDate(),23,59,59),i={startDate:this.toLocalISOString(e),endDate:this.toLocalISOString(n),groupBy:["BRANCH","CATEGORY","SUBCATEGORY"],onlyActive:!0};this.reporteService.generateReport(i).subscribe({next:a=>{this.processTodayData(a),this.cdr.detectChanges()},error:a=>console.error("Error loading today attendance:",a)})}toLocalISOString(r){let e=r.getTimezoneOffset()*6e4;return new Date(r.getTime()-e).toISOString().slice(0,16)}processTodayData(r){let e=new Map;r.forEach(n=>{let i=n.branchName||"Sin Sede";e.has(i)||e.set(i,{name:i,id:n.branchId,total:0,categories:new Map});let a=e.get(i);a.total+=n.total||0;let o=this.formatCategory(n.category)||"Sin Categor\xEDa";a.categories.has(o)||a.categories.set(o,{name:o,total:0,subCategories:[]});let s=a.categories.get(o);s.total+=n.total||0,n.subCategory&&s.subCategories.push({name:n.subCategory,total:n.total})}),this.todayAttendance=Array.from(e.values()).map(n=>Pi(Yr({},n),{categories:Array.from(n.categories.values())}))}calculateAge(r){if(!r)return 0;let e=new Date(r),n=new Date,i=n.getFullYear()-e.getFullYear(),a=n.getMonth()-e.getMonth();return(a<0||a===0&&n.getDate()<e.getDate())&&i--,i}openAttendanceDetails(r,e,n=null){this.selectedBranchForDetails=r.name,this.selectedCategoryForDetails=n?`${e.name} - ${n.name}`:e.name,this.showAttendanceDetailsModal=!0,this.isLoadingDetails=!0,console.log("Loading details..."),this.attendanceDetails=[];let i=new Date,a=new Date(i.getFullYear(),i.getMonth(),i.getDate(),0,0,0),o=new Date(i.getFullYear(),i.getMonth(),i.getDate(),23,59,59),s={startDate:this.toLocalISOString(a),endDate:this.toLocalISOString(o),category:[e.name||e],subCategory:n?[n.name||n]:[],invalid:!1};r.id&&(s.branchId=r.id),this.asistenciaService.getAttendances(s,0).subscribe({next:l=>{let c=new Map;l.data.forEach(f=>{let v=`${f.serviceDate}_${f.serviceName}`;c.has(v)||c.set(v,[]),c.get(v).push(f)}),this.attendanceDetails=Array.from(c.entries()).map(([f,v])=>{let x=v[0];return{serviceName:x.serviceName,serviceDate:x.serviceDate,attendees:v}}),this.attendanceDetails.sort((f,v)=>new Date(f.serviceDate).getTime()-new Date(v.serviceDate).getTime()),this.isLoadingDetails=!1,this.cdr.detectChanges()},error:l=>{console.error("Error details:",l),this.isLoadingDetails=!1,this.cdr.detectChanges()}})}closeAttendanceDetailsModal(){this.showAttendanceDetailsModal=!1,this.attendanceDetails=[]}static \u0275fac=function(e){return new(e||t)};static \u0275cmp=ir({type:t,selectors:[["app-dashboard"]],decls:10,vars:9,consts:[[1,"dashboard-container"],["class","metrics-grid",4,"ngIf"],["class","today-attendance-section",4,"ngIf"],["class","section-title-wrapper",4,"ngIf"],["class","quick-access-grid",4,"ngIf"],["class","chart-section-wrapper",4,"ngIf"],["class","dashboard-loading",4,"ngIf"],["class","modal-overlay",3,"click",4,"ngIf"],[1,"metrics-grid"],[1,"metric-card"],[1,"metric-icon","blue"],[1,"fa-solid","fa-users"],[1,"metric-content"],[1,"metric-label"],[1,"metric-value"],[1,"metric-sub"],[1,"metric-card","clickable",3,"click"],[1,"metric-icon","gold"],[1,"fa-solid","fa-cake-candles"],[1,"click-hint"],[1,"fa-solid","fa-chevron-right"],[1,"fa-solid","fa-water"],[1,"today-attendance-section"],[1,"section-title-wrapper"],[1,"fa-solid","fa-clock"],[1,"subtitle"],[1,"attendance-cards-grid"],["class","attendance-card",4,"ngFor","ngForOf"],[1,"attendance-card"],[1,"attendance-header"],[1,"total-badge"],[1,"attendance-body"],["class","category-item",4,"ngFor","ngForOf"],[1,"category-item"],[1,"cat-header","clickable",3,"click"],[1,"cat-name"],[1,"cat-total"],["class","sub-list",4,"ngIf"],[1,"sub-list"],["class","sub-item clickable",3,"click",4,"ngFor","ngForOf"],[1,"sub-item","clickable",3,"click"],[1,"fa-solid","fa-bolt"],[1,"quick-access-grid"],["routerLink","/integrantes",1,"quick-card"],[1,"quick-icon","purple"],[1,"fa-solid","fa-user-plus"],[1,"quick-info"],["routerLink","/asistencia",1,"quick-card"],[1,"quick-icon","teal"],[1,"fa-solid","fa-clipboard-check"],[1,"chart-section-wrapper"],[1,"chart-card"],[1,"chart-header"],[1,"fa-solid","fa-chart-simple"],[1,"chart-subtitle"],["id","chart"],[3,"series","chart","xaxis","yaxis","plotOptions","legend","fill","tooltip","colors"],[1,"dashboard-loading"],[1,"spinner"],[1,"modal-overlay",3,"click"],[1,"modal-content","bday-modal",3,"click"],[1,"modal-header"],[1,"close-btn",3,"click"],[1,"modal-body"],[1,"bday-list"],["class","bday-item",4,"ngFor","ngForOf"],["class","empty-bday",4,"ngIf"],[1,"bday-item"],["alt","",3,"src"],[1,"bday-info"],[1,"bday-name"],[1,"bday-date"],[1,"view-btn",3,"click"],[1,"fa-solid","fa-eye"],[1,"empty-bday"],[1,"modal-content","details-modal",3,"click"],["class","modal-body",4,"ngIf"],[1,"profile-header"],[1,"profile-title"],[1,"badge",3,"ngClass"],[1,"badge","badge-outline","ms-2"],[1,"details-grid"],[1,"detail-item"],[1,"detail-item","full"],[1,"branch-subtitle"],["class","loading-spinner","style",`
                display: flex !important;
                flex-direction: column !important;
                align-items: center !important;
                justify-content: center !important;
                width: 100% !important;
                min-height: 200px !important;
                background: transparent !important;
                transform: none !important;
                animation: none !important;
            `,4,"ngIf"],["class","empty-state",4,"ngIf"],["class","attendance-groups",4,"ngIf"],[1,"loading-spinner",2,"display","flex !important","flex-direction","column !important","align-items","center !important","justify-content","center !important","width","100% !important","min-height","200px !important","background","transparent !important","transform","none !important","animation","none !important"],[1,"spinner",2,"width","40px !important","height","40px !important","border","4px solid rgba(255, 255, 255, 0.1) !important","border-left-color","#3b82f6 !important","border-radius","50% !important","animation","dashboard-spin 1s linear infinite !important","margin-bottom","10px !important"],[2,"font-size","0.9rem !important","color","#94a3b8 !important","animation","none !important","transform","none !important"],[1,"empty-state"],[1,"attendance-groups"],["class","service-group",4,"ngFor","ngForOf"],[1,"service-group"],[1,"group-title"],[1,"fa-solid","fa-church"],[1,"service-time"],[1,"attendees-list"],["class","attendee-item",4,"ngFor","ngForOf"],[1,"attendee-item"],[1,"attendee-info"],[1,"name"],["title","Hora de llegada",1,"time"],[1,"fa-regular","fa-clock"]],template:function(e,n){e&1&&(d(0,"div",0),fe(1,cF,34,5,"div",1)(2,pF,10,1,"div",2)(3,mF,4,0,"div",3)(4,gF,17,0,"div",4)(5,_F,10,9,"div",5)(6,vF,4,0,"div",6),u(),fe(7,wF,12,2,"div",7)(8,CF,8,1,"div",7)(9,OF,13,5,"div",7)),e&2&&(g(),P("ngIf",!n.isLoading&&n.data),g(),P("ngIf",!n.isLoading&&n.todayAttendance&&n.todayAttendance.length>0),g(),P("ngIf",!n.isLoading),g(),P("ngIf",!n.isLoading),g(),P("ngIf",!n.isLoading&&n.renderChart),g(),P("ngIf",n.isLoading),g(),P("ngIf",n.showBirthdayModal),g(),P("ngIf",n.showMemberDetailsModal),g(),P("ngIf",n.showAttendanceDetailsModal))},dependencies:[gr,Tr,rn,mr,on,Qd,ku,Su,g1,Ji],styles:['@font-face{font-family:Inter;font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa2JL7SUc.woff2) format("woff2");unicode-range:U+0460-052F,U+1C80-1C8A,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:Inter;font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa0ZL7SUc.woff2) format("woff2");unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:Inter;font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa2ZL7SUc.woff2) format("woff2");unicode-range:U+1F00-1FFF}@font-face{font-family:Inter;font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa1pL7SUc.woff2) format("woff2");unicode-range:U+0370-0377,U+037A-037F,U+0384-038A,U+038C,U+038E-03A1,U+03A3-03FF}@font-face{font-family:Inter;font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa2pL7SUc.woff2) format("woff2");unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+0300-0301,U+0303-0304,U+0308-0309,U+0323,U+0329,U+1EA0-1EF9,U+20AB}@font-face{font-family:Inter;font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa25L7SUc.woff2) format("woff2");unicode-range:U+0100-02BA,U+02BD-02C5,U+02C7-02CC,U+02CE-02D7,U+02DD-02FF,U+0304,U+0308,U+0329,U+1D00-1DBF,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20C0,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:Inter;font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa1ZL7.woff2) format("woff2");unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:Inter;font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa2JL7SUc.woff2) format("woff2");unicode-range:U+0460-052F,U+1C80-1C8A,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:Inter;font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa0ZL7SUc.woff2) format("woff2");unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:Inter;font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa2ZL7SUc.woff2) format("woff2");unicode-range:U+1F00-1FFF}@font-face{font-family:Inter;font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa1pL7SUc.woff2) format("woff2");unicode-range:U+0370-0377,U+037A-037F,U+0384-038A,U+038C,U+038E-03A1,U+03A3-03FF}@font-face{font-family:Inter;font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa2pL7SUc.woff2) format("woff2");unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+0300-0301,U+0303-0304,U+0308-0309,U+0323,U+0329,U+1EA0-1EF9,U+20AB}@font-face{font-family:Inter;font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa25L7SUc.woff2) format("woff2");unicode-range:U+0100-02BA,U+02BD-02C5,U+02C7-02CC,U+02CE-02D7,U+02DD-02FF,U+0304,U+0308,U+0329,U+1D00-1DBF,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20C0,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:Inter;font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa1ZL7.woff2) format("woff2");unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:Inter;font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa2JL7SUc.woff2) format("woff2");unicode-range:U+0460-052F,U+1C80-1C8A,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:Inter;font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa0ZL7SUc.woff2) format("woff2");unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:Inter;font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa2ZL7SUc.woff2) format("woff2");unicode-range:U+1F00-1FFF}@font-face{font-family:Inter;font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa1pL7SUc.woff2) format("woff2");unicode-range:U+0370-0377,U+037A-037F,U+0384-038A,U+038C,U+038E-03A1,U+03A3-03FF}@font-face{font-family:Inter;font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa2pL7SUc.woff2) format("woff2");unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+0300-0301,U+0303-0304,U+0308-0309,U+0323,U+0329,U+1EA0-1EF9,U+20AB}@font-face{font-family:Inter;font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa25L7SUc.woff2) format("woff2");unicode-range:U+0100-02BA,U+02BD-02C5,U+02C7-02CC,U+02CE-02D7,U+02DD-02FF,U+0304,U+0308,U+0329,U+1D00-1DBF,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20C0,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:Inter;font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa1ZL7.woff2) format("woff2");unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:Inter;font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa2JL7SUc.woff2) format("woff2");unicode-range:U+0460-052F,U+1C80-1C8A,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:Inter;font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa0ZL7SUc.woff2) format("woff2");unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:Inter;font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa2ZL7SUc.woff2) format("woff2");unicode-range:U+1F00-1FFF}@font-face{font-family:Inter;font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa1pL7SUc.woff2) format("woff2");unicode-range:U+0370-0377,U+037A-037F,U+0384-038A,U+038C,U+038E-03A1,U+03A3-03FF}@font-face{font-family:Inter;font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa2pL7SUc.woff2) format("woff2");unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+0300-0301,U+0303-0304,U+0308-0309,U+0323,U+0329,U+1EA0-1EF9,U+20AB}@font-face{font-family:Inter;font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa25L7SUc.woff2) format("woff2");unicode-range:U+0100-02BA,U+02BD-02C5,U+02C7-02CC,U+02CE-02D7,U+02DD-02FF,U+0304,U+0308,U+0329,U+1D00-1DBF,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20C0,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:Inter;font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa1ZL7.woff2) format("woff2");unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}.dashboard-container[_ngcontent-%COMP%]{max-width:1400px;margin:0 auto}.clickable[_ngcontent-%COMP%]{cursor:pointer;transition:background-color .2s}.clickable[_ngcontent-%COMP%]:hover{background-color:#ffffff0d;border-radius:4px}.dashboard-header-main[_ngcontent-%COMP%]{margin-bottom:1.5rem}.dashboard-header-main[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:1.75rem;font-weight:800;color:var(--text-main);margin-bottom:.25rem}.dashboard-header-main[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:var(--text-muted);font-size:1rem}.metrics-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(280px,1fr));gap:1rem;margin-bottom:2rem}.metric-card[_ngcontent-%COMP%]{background:var(--bg-card);padding:1.25rem;border-radius:16px;display:flex;align-items:center;gap:1.25rem;box-shadow:var(--shadow-sm);border:1px solid var(--border-color);transition:transform .2s,box-shadow .2s;position:relative}.metric-card.clickable[_ngcontent-%COMP%]{cursor:pointer}.metric-card.clickable[_ngcontent-%COMP%]:hover{transform:translateY(-3px);box-shadow:0 12px 20px -5px #00000014}.metric-icon[_ngcontent-%COMP%]{width:48px;height:48px;border-radius:12px;display:flex;align-items:center;justify-content:center;font-size:1.25rem}.metric-icon.blue[_ngcontent-%COMP%]{background:#eff6ff;color:#3b82f6}.metric-icon.gold[_ngcontent-%COMP%]{background:#fffbeb;color:#fbbf24}.metric-icon.green[_ngcontent-%COMP%]{background:#f0fdf4;color:#10b981}.metric-content[_ngcontent-%COMP%]{flex:1}.metric-label[_ngcontent-%COMP%]{display:block;font-size:.8rem;font-weight:700;color:var(--text-muted);text-transform:uppercase;letter-spacing:.05em;margin-bottom:.15rem}.metric-value[_ngcontent-%COMP%]{font-size:1.75rem;font-weight:800;color:var(--text-main);margin:0;line-height:1.2}.metric-sub[_ngcontent-%COMP%]{font-size:.75rem;color:var(--text-muted)}.click-hint[_ngcontent-%COMP%]{color:var(--border-color);font-size:.8rem}.section-title-wrapper[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;color:var(--text-main)}.section-title-wrapper[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:#fbbf24;font-size:1rem}.section-title-wrapper[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:1.25rem;font-weight:700}.quick-access-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(260px,1fr));gap:1rem;margin-bottom:2rem}.quick-card[_ngcontent-%COMP%]{background:var(--white);padding:1rem 1.25rem;border-radius:18px;display:flex;align-items:center;gap:1.25rem;text-decoration:none;border:1px solid var(--border-color);transition:all .2s}.quick-card[_ngcontent-%COMP%]:hover{border-color:var(--primary);background:var(--bg-input);transform:scale(1.02)}.quick-icon[_ngcontent-%COMP%]{width:50px;height:50px;border-radius:12px;display:flex;align-items:center;justify-content:center;font-size:1.2rem}.quick-icon.purple[_ngcontent-%COMP%]{background:#f5f3ff;color:#8b5cf6}.quick-icon.teal[_ngcontent-%COMP%]{background:#f0fdfa;color:#14b8a6}.quick-info[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:1rem;font-weight:700;color:var(--text-main);margin-bottom:.25rem}.quick-info[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:.85rem;color:var(--text-muted);margin:0}.chart-card[_ngcontent-%COMP%]{background:var(--bg-card);padding:2rem;border-radius:24px;border:1px solid var(--border-color);box-shadow:var(--shadow-md)}.chart-header[_ngcontent-%COMP%], .today-attendance-section[_ngcontent-%COMP%]{margin-bottom:2rem}.today-attendance-section[_ngcontent-%COMP%]   .section-title-wrapper[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.75rem;margin-bottom:1.5rem;color:var(--text-primary)}.today-attendance-section[_ngcontent-%COMP%]   .section-title-wrapper[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:1.5rem;color:var(--primary, #3b82f6)}.today-attendance-section[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:1.25rem;font-weight:700;margin:0}.today-attendance-section[_ngcontent-%COMP%]   .subtitle[_ngcontent-%COMP%]{display:block;font-size:.875rem;color:var(--text-secondary);font-weight:400}.attendance-cards-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(280px,1fr));gap:1.5rem}.attendance-card[_ngcontent-%COMP%]{background:var(--bg-card);border-radius:16px;box-shadow:0 4px 6px -1px #0000000d,0 2px 4px -1px #00000008;border:1px solid var(--border-color);overflow:hidden;transition:transform .2s,box-shadow .2s}.attendance-card[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 10px 15px -3px #00000014}.attendance-header[_ngcontent-%COMP%]{background:linear-gradient(135deg,var(--primary, #3b82f6),var(--secondary, #6366f1));padding:1rem 1.25rem;display:flex;justify-content:space-between;align-items:center;color:#fff}.attendance-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;font-size:1.1rem;font-weight:600}.total-badge[_ngcontent-%COMP%]{background:#fff3;padding:.25rem .75rem;border-radius:20px;font-weight:700;font-size:.95rem;-webkit-backdrop-filter:blur(4px);backdrop-filter:blur(4px)}.attendance-body[_ngcontent-%COMP%]{padding:1rem}.category-item[_ngcontent-%COMP%]{margin-bottom:.75rem;border-bottom:1px solid var(--border-color);padding-bottom:.75rem}.category-item[_ngcontent-%COMP%]:last-child{margin-bottom:0;border-bottom:none;padding-bottom:0}.cat-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;font-weight:600;font-size:.95rem;color:var(--text-primary);margin-bottom:.25rem}.cat-total[_ngcontent-%COMP%]{background:var(--bg-hover);padding:.1rem .5rem;border-radius:6px;font-size:.85rem;color:var(--text-primary)}.sub-list[_ngcontent-%COMP%]{padding-left:.75rem;border-left:2px solid var(--border-color);margin-top:.5rem;display:flex;flex-direction:column;gap:.25rem}.sub-item[_ngcontent-%COMP%]{display:flex;justify-content:space-between;font-size:.85rem;color:var(--text-secondary)}.chart-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:1.25rem;font-weight:700;display:flex;align-items:center;gap:.75rem;margin-bottom:.25rem}.chart-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:var(--primary)}.chart-subtitle[_ngcontent-%COMP%]{font-size:.9rem;color:var(--text-muted)}.modal-overlay[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;background-color:#00000080;display:flex;align-items:center;justify-content:center;z-index:1000;-webkit-backdrop-filter:blur(4px);backdrop-filter:blur(4px);padding:1rem}.modal-content[_ngcontent-%COMP%]{background:var(--bg-card);width:100%;max-width:500px;max-height:85vh;border-radius:20px;box-shadow:var(--shadow-md);overflow:hidden;display:flex;flex-direction:column;animation:_ngcontent-%COMP%_modal-slide-up .3s cubic-bezier(.34,1.56,.64,1)}.modal-content.details-modal[_ngcontent-%COMP%]{max-width:600px}@keyframes _ngcontent-%COMP%_modal-slide-up{0%{transform:translateY(30px);opacity:0}to{transform:translateY(0);opacity:1}}.modal-header[_ngcontent-%COMP%]{padding:1.25rem 1.5rem;border-bottom:1px solid var(--border-color);display:flex;justify-content:space-between;align-items:center;background:var(--bg-input)}.modal-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:1.25rem;font-weight:700;color:var(--text-main);display:flex;align-items:center;gap:.75rem;margin:0}.modal-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:#fbbf24}.close-btn[_ngcontent-%COMP%]{background:var(--border-color);border:none;width:32px;height:32px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:1.25rem;cursor:pointer;color:var(--text-muted);transition:all .2s}.close-btn[_ngcontent-%COMP%]:hover{background:var(--text-muted);color:var(--white);transform:rotate(90deg)}.modal-body[_ngcontent-%COMP%]{padding:1.5rem .5rem 1.5rem 1.5rem;max-height:70vh;overflow-y:auto}.profile-header[_ngcontent-%COMP%]{display:flex;align-items:center;gap:1.5rem;margin-bottom:2rem;padding-bottom:1.5rem;border-bottom:1px dashed var(--border-color)}.profile-header[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:80px;height:80px;border-radius:16px;object-fit:cover;box-shadow:0 10px 15px -3px #0000001a;border:3px solid var(--bg-card)}.profile-title[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:1.5rem;font-weight:800;margin-bottom:.35rem;color:var(--text-main)}.details-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:1.25rem 1.5rem}.detail-item[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.25rem}.detail-item.full[_ngcontent-%COMP%]{grid-column:span 2}.detail-item[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:.7rem;font-weight:700;color:var(--text-muted);text-transform:uppercase;letter-spacing:.05em}.detail-item[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:.95rem;color:var(--text-main);font-weight:600}.modal-body[_ngcontent-%COMP%]{max-height:70vh;overflow-y:auto;padding-right:.5rem}.modal-body[_ngcontent-%COMP%]::-webkit-scrollbar{width:6px}.modal-body[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:var(--bg-card);border-radius:10px}.modal-body[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:var(--border-color);border-radius:10px}.modal-body[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:var(--primary)}.bday-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.75rem}.bday-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:1rem;padding:.75rem;border-radius:12px;background:var(--bg-input);border:1px solid transparent;transition:all .2s}.bday-item[_ngcontent-%COMP%]:hover{border-color:var(--primary);background:#eff6ff}.bday-item[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:45px;height:45px;border-radius:50%;object-fit:cover}.bday-info[_ngcontent-%COMP%]{flex:1;display:flex;flex-direction:column}.bday-name[_ngcontent-%COMP%]{font-weight:700;font-size:.95rem;color:var(--text-main)}.bday-date[_ngcontent-%COMP%]{font-size:.8rem;color:var(--primary);font-weight:500}.view-btn[_ngcontent-%COMP%]{background:none;border:none;color:var(--text-muted);cursor:pointer;padding:.5rem;font-size:1.1rem;transition:color .2s}.view-btn[_ngcontent-%COMP%]:hover{color:var(--primary)}.empty-bday[_ngcontent-%COMP%]{text-align:center;padding:2rem;color:var(--text-muted);font-style:italic}.dashboard-loading[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:10rem 0;color:var(--text-muted);gap:1rem}.dashboard-spinner[_ngcontent-%COMP%]{width:40px;height:40px;border:4px solid rgba(59,130,246,.1);border-left-color:var(--primary);border-radius:50%;animation:_ngcontent-%COMP%_dashboard-spin-unique 1s linear infinite;flex-shrink:0}@keyframes _ngcontent-%COMP%_dashboard-spin-unique{to{transform:rotate(360deg)}}@media(max-width:768px){.metrics-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}}.modal-loading-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:3rem;color:var(--text-muted);gap:1rem;width:100%;height:100%;min-height:200px;transform:none!important;animation:none!important}.modal-loading-container[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{transform:none!important;animation:none!important;display:block}.branch-subtitle[_ngcontent-%COMP%]{font-size:.9rem;font-weight:400;opacity:.8;margin-left:.5rem}.cat-header.clickable[_ngcontent-%COMP%]:hover, .sub-item.clickable[_ngcontent-%COMP%]:hover{background-color:#ffffff1a}.attendance-groups[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1.5rem}.service-group[_ngcontent-%COMP%]{background:#ffffff08;border-radius:8px;padding:1rem;border:1px solid rgba(255,255,255,.05)}.group-title[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;font-size:1rem;color:var(--text-primary);margin-bottom:1rem;padding-bottom:.5rem;border-bottom:1px solid rgba(255,255,255,.1)}.service-time[_ngcontent-%COMP%]{font-size:.85rem;background:#3b82f633;color:#60a5fa;padding:2px 8px;border-radius:12px}.attendees-list[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(200px,1fr));gap:.8rem}.attendee-item[_ngcontent-%COMP%]{display:flex;align-items:center;padding:.5rem;background:#ffffff05;border-radius:6px;border:1px solid rgba(255,255,255,.03)}.attendee-info[_ngcontent-%COMP%]{display:flex;flex-direction:column}.attendee-info[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{font-size:.9rem;font-weight:500;color:var(--text-primary)}.attendee-info[_ngcontent-%COMP%]   .time[_ngcontent-%COMP%]{font-size:.75rem;color:var(--text-secondary);margin-top:2px}']})};function AF(t,r){if(t&1){let e=Pe();d(0,"button",6),L("click",function(){D(e);let i=C();return N(i.openNewModal())}),j(1,"i",7),_(2," Nuevo Rol "),u()}}function TF(t,r){if(t&1){let e=Pe();d(0,"button",27),L("click",function(){D(e);let i=C().$implicit,a=C(2);return N(a.editRole(i))}),j(1,"i",28),u()}}function IF(t,r){if(t&1){let e=Pe();d(0,"button",29),L("click",function(){D(e);let i=C().$implicit,a=C(2);return N(a.deleteRole(i))}),j(1,"i",30),u()}}function FF(t,r){if(t&1&&(d(0,"span",31),_(1),Cr(2,"lowercase"),u()),t&2){let e=r.$implicit;g(),je(" ",xs(2,1,e.name.split("_").pop())," ")}}function DF(t,r){if(t&1&&(d(0,"span",32),_(1),u()),t&2){let e=C().$implicit;g(),je(" +",e.permissions.length-3," ")}}function NF(t,r){if(t&1&&(d(0,"div",10)(1,"div",11)(2,"div",12),j(3,"i",13),u(),d(4,"div",14),fe(5,TF,2,0,"button",15)(6,IF,2,0,"button",16),u()(),d(7,"div",17)(8,"h3"),_(9),u(),d(10,"p"),_(11),u(),d(12,"div",18)(13,"span",19),j(14,"i",20),_(15),u(),d(16,"span",21),j(17,"i",22),_(18),u()()(),d(19,"div",23)(20,"div",24),fe(21,FF,3,3,"span",25)(22,DF,2,1,"span",26),u()()()),t&2){let e=r.$implicit,n=C(2);Ft("border-top-color",e.color),g(2),Ft("background-color",e.color+"20")("color",e.color),g(3),P("ngIf",n.can("UPDATE_ROLE")),g(),P("ngIf",n.can("DELETE_ROLE")),g(3),be(e.name),g(2),be(e.description||"Sin descripci\xF3n"),g(4),je(" ",e.totalUsers," usuarios "),g(3),je(" ",e.permissions.length," permisos "),g(3),P("ngForOf",e.permissions.slice(0,3)),g(),P("ngIf",e.permissions.length>3)}}function RF(t,r){if(t&1&&(d(0,"div",8),fe(1,NF,23,14,"div",9),u()),t&2){let e=C();g(),P("ngForOf",e.roles)}}function LF(t,r){t&1&&(d(0,"div",33),j(1,"div",34),d(2,"p"),_(3,"Cargando roles del sistema..."),u()())}function BF(t,r){t&1&&(d(0,"div",56)(1,"div",57),j(2,"div",58),d(3,"p"),_(4,"Procesando..."),u()()())}function UF(t,r){t&1&&j(0,"i",67)}function VF(t,r){if(t&1){let e=Pe();d(0,"div",61),L("click",function(){let i=D(e).$implicit,a=C(3);return N(a.togglePermission(i.id))}),d(1,"div",62),fe(2,UF,1,0,"i",63),u(),d(3,"div",64)(4,"span",65),_(5),u(),d(6,"span",66),_(7),u()()()}if(t&2){let e=r.$implicit,n=C(3);wt("active",n.isPermissionSelected(e.id)),g(2),P("ngIf",n.isPermissionSelected(e.id)),g(3),be(e.name),g(2),be(e.description)}}function zF(t,r){if(t&1&&(d(0,"div",59)(1,"h3"),_(2),u(),fe(3,VF,8,5,"div",60),u()),t&2){let e=r.$implicit;g(2),be(e.category),g(),P("ngForOf",e.permissions)}}function jF(t,r){if(t&1&&(d(0,"div",68),_(1),u()),t&2){let e=C(2);g(),je(" ",e.errorMessage," ")}}function HF(t,r){if(t&1){let e=Pe();d(0,"div",35),L("click",function(){D(e);let i=C();return N(i.closeModal())}),d(1,"div",36),L("click",function(i){return D(e),N(i.stopPropagation())}),d(2,"div",37)(3,"h2"),_(4),u(),d(5,"button",38),L("click",function(){D(e);let i=C();return N(i.closeModal())}),_(6,"\xD7"),u()(),fe(7,BF,5,0,"div",39),d(8,"div",40)(9,"div",41)(10,"label"),_(11,"Informaci\xF3n B\xE1sica"),u(),d(12,"div",42)(13,"div",43)(14,"label"),_(15,"Nombre del Rol"),u(),d(16,"input",44),ht("ngModelChange",function(i){D(e);let a=C();return ut(a.currentRoleName,i)||(a.currentRoleName=i),N(i)}),u()(),d(17,"div",43)(18,"label"),_(19,"Color Identificador"),u(),d(20,"input",45),ht("ngModelChange",function(i){D(e);let a=C();return ut(a.currentRoleColor,i)||(a.currentRoleColor=i),N(i)}),u()(),d(21,"div",46)(22,"label"),_(23,"Descripci\xF3n"),u(),d(24,"textarea",47),ht("ngModelChange",function(i){D(e);let a=C();return ut(a.currentRoleDesc,i)||(a.currentRoleDesc=i),N(i)}),u()()()(),d(25,"div",48)(26,"label"),_(27,"Matriz de Permisos"),u(),d(28,"div",49),fe(29,zF,4,2,"div",50),u()(),fe(30,jF,2,1,"div",51),u(),d(31,"div",52)(32,"button",53),L("click",function(){D(e);let i=C();return N(i.closeModal())}),_(33,"Cancelar"),u(),d(34,"button",54),L("click",function(){D(e);let i=C();return N(i.saveRole())}),j(35,"i",55),_(36),u()()()()}if(t&2){let e=C();g(4),be(e.isEditing?"Editar Rol":"Crear Nuevo Rol"),g(),P("disabled",e.isSaving),g(2),P("ngIf",e.isSaving),g(9),ft("ngModel",e.currentRoleName),g(4),ft("ngModel",e.currentRoleColor),g(4),ft("ngModel",e.currentRoleDesc),g(5),P("ngForOf",e.groupedPermissions),g(),P("ngIf",e.errorMessage),g(2),P("disabled",e.isSaving),g(2),P("disabled",!e.currentRoleName||e.isSaving),g(),P("ngClass",e.isSaving?"fa-spinner fa-spin":"fa-save"),g(),je(" ",e.isSaving?e.isEditing?"Actualizando...":"Guardando...":e.isEditing?"Actualizar Rol":"Guardar Rol"," ")}}var Wu=class t{roleService=Ce(rf);authService=Ce(fr);cdr=Ce(Un);confirmationService=Ce(Ni);notificationService=Ce(Kr);roles=[];availablePermissions=[];groupedPermissions=[];isLoading=!0;showModal=!1;isSaving=!1;isEditing=!1;errorMessage="";currentRoleName="";currentRoleDesc="";currentRoleColor="#3b82f6";currentRolePermissions=new Set;editingRoleId=null;ngOnInit(){this.loadPermissions()}can(r){return this.authService.can(r)}loadPermissions(){this.roleService.getAvailablePermissions().subscribe(r=>{this.availablePermissions=r,this.groupPermissions(),this.loadRoles()})}loadRoles(){this.isLoading=!0,this.roleService.getRoles().subscribe({next:r=>{this.roles=r,this.isLoading=!1,this.cdr.detectChanges()},error:r=>{console.error("Error loading roles",r),this.isLoading=!1}})}groupPermissions(){let r=Array.from(new Set(this.availablePermissions.map(e=>e.category)));this.groupedPermissions=r.map(e=>({category:e,permissions:this.availablePermissions.filter(n=>n.category===e)}))}openNewModal(){this.isEditing=!1,this.editingRoleId=null,this.currentRoleName="",this.currentRoleDesc="",this.currentRoleColor="#3b82f6",this.currentRolePermissions.clear(),this.errorMessage="",this.showModal=!0}editRole(r){this.isEditing=!0,this.editingRoleId=r.id,this.currentRoleName=r.name,this.currentRoleDesc=r.description,this.currentRoleColor=r.color,this.currentRolePermissions.clear(),r.permissions&&r.permissions.forEach(e=>this.currentRolePermissions.add(e.name)),this.errorMessage="",this.showModal=!0}closeModal(){this.showModal=!1}togglePermission(r){this.currentRolePermissions.has(r)?this.currentRolePermissions.delete(r):this.currentRolePermissions.add(r)}isPermissionSelected(r){return this.currentRolePermissions.has(r)}saveRole(){if(!this.currentRoleName.trim()){this.errorMessage="El nombre del rol es obligatorio";return}if(this.isSaving)return;this.isSaving=!0;let r={name:this.currentRoleName,description:this.currentRoleDesc,color:this.currentRoleColor,permissions:Array.from(this.currentRolePermissions).map(n=>({name:n}))};(this.isEditing&&this.editingRoleId?this.roleService.updateRole(this.editingRoleId,r):this.roleService.createRole(r)).subscribe({next:()=>{this.isSaving=!1,this.loadRoles(),this.notificationService.success(this.isEditing?"Rol actualizado correctamente":"Rol creado correctamente"),this.closeModal()},error:n=>{this.isSaving=!1,console.error("Error saving role",n),this.errorMessage="Ocurri\xF3 un error al guardar el rol."}})}deleteRole(r){return Cn(this,null,function*(){(yield this.confirmationService.confirm({title:"Eliminar Rol",message:`\xBFEst\xE1s seguro de eliminar el rol "${r.name}"?`,type:"danger",confirmText:"Eliminar"}))&&this.roleService.deleteRole(r.id).subscribe({next:()=>{this.loadRoles(),this.notificationService.success("Rol eliminado correctamente")},error:n=>console.error("Error deleting role",n)})})}static \u0275fac=function(e){return new(e||t)};static \u0275cmp=ir({type:t,selectors:[["app-roles"]],decls:6,vars:4,consts:[[1,"roles-container"],[1,"page-header"],["class","btn-new-role",3,"click",4,"ngIf"],["class","roles-grid",4,"ngIf"],["class","roles-loading",4,"ngIf"],["class","modal-overlay",3,"click",4,"ngIf"],[1,"btn-new-role",3,"click"],[1,"fa-solid","fa-shield-cat"],[1,"roles-grid"],["class","role-card",3,"border-top-color",4,"ngFor","ngForOf"],[1,"role-card"],[1,"role-card-header"],[1,"role-badge"],[1,"fa-solid","fa-shield-halved"],[1,"role-actions"],["class","action-btn","title","Editar",3,"click",4,"ngIf"],["class","action-btn delete","title","Eliminar",3,"click",4,"ngIf"],[1,"role-card-body"],[1,"role-meta"],[1,"member-count"],[1,"fa-solid","fa-user-group"],[1,"perms-count"],[1,"fa-solid","fa-key"],[1,"role-card-footer"],[1,"perms-preview"],["class","perm-tag",4,"ngFor","ngForOf"],["class","perm-more",4,"ngIf"],["title","Editar",1,"action-btn",3,"click"],[1,"fa-solid","fa-pen-to-square"],["title","Eliminar",1,"action-btn","delete",3,"click"],[1,"fa-solid","fa-trash-can"],[1,"perm-tag"],[1,"perm-more"],[1,"roles-loading"],[1,"spinner"],[1,"modal-overlay",3,"click"],[1,"modal-content","role-modal",3,"click"],[1,"modal-header"],[1,"close-btn",3,"click","disabled"],["class","modal-loading-overlay",4,"ngIf"],[1,"modal-body"],[1,"form-section"],[1,"form-grid"],[1,"form-group"],["type","text","placeholder","Ej: Administrador",3,"ngModelChange","ngModel"],["type","color",3,"ngModelChange","ngModel"],[1,"form-group","full"],["rows","2","placeholder","Describa brevemente las responsabilidades de este rol",3,"ngModelChange","ngModel"],[1,"form-section","perms-section"],[1,"perms-grid"],["class","perm-category",4,"ngFor","ngForOf"],["class","error-msg","style","margin-top: 1rem; color: #ef4444;",4,"ngIf"],[1,"modal-footer"],[1,"btn-secondary",3,"click","disabled"],[1,"btn-primary-premium",3,"click","disabled"],[1,"fa-solid",3,"ngClass"],[1,"modal-loading-overlay"],[1,"spinner-wrapper"],[1,"spinner-circle"],[1,"perm-category"],["class","perm-item",3,"active","click",4,"ngFor","ngForOf"],[1,"perm-item",3,"click"],[1,"perm-checkbox"],["class","fa-solid fa-check",4,"ngIf"],[1,"perm-info"],[1,"perm-name"],[1,"perm-desc"],[1,"fa-solid","fa-check"],[1,"error-msg",2,"margin-top","1rem","color","#ef4444"]],template:function(e,n){e&1&&(d(0,"div",0)(1,"header",1),fe(2,AF,3,0,"button",2),u(),fe(3,RF,2,1,"div",3)(4,LF,4,0,"div",4),u(),fe(5,HF,37,12,"div",5)),e&2&&(g(2),P("ngIf",n.can("CREATE_ROLE")),g(),P("ngIf",!n.isLoading),g(),P("ngIf",n.isLoading),g(),P("ngIf",n.showModal))},dependencies:[gr,Tr,rn,mr,on,nn,an,Vn,p1],styles:['.roles-container[_ngcontent-%COMP%]{max-width:1400px;margin:0 auto}.page-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:2rem}.page-header[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;color:var(--text-muted);font-size:.95rem}.btn-new-role[_ngcontent-%COMP%]{background:var(--primary);color:#fff;padding:.65rem 1.25rem;border-radius:10px;border:none;display:flex;align-items:center;gap:.6rem;font-weight:600;cursor:pointer;box-shadow:0 4px 12px #2563eb4d;transition:all .2s;font-size:.9rem}.btn-new-role[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 6px 15px #2563eb66}.header-content[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:2rem;font-weight:800;color:var(--text-main);margin-bottom:.5rem}.header-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:var(--text-muted)}.btn-primary-premium[_ngcontent-%COMP%]{background:linear-gradient(135deg,var(--primary),var(--primary-dark));color:#fff;padding:.8rem 1.5rem;border-radius:12px;font-weight:600;display:flex;align-items:center;gap:.75rem;box-shadow:0 4px 12px #3b82f64d;border:none;cursor:pointer;transition:all .2s;margin-bottom:10px}.btn-primary-premium[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 6px 15px #3b82f666}.btn-primary-premium[_ngcontent-%COMP%]:disabled{opacity:.6;cursor:not-allowed;transform:none}.roles-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(320px,1fr));gap:1.5rem}.role-card[_ngcontent-%COMP%]{background:var(--bg-card);border-radius:20px;padding:1.5rem;border:1px solid var(--border-color);border-top:5px solid var(--primary);box-shadow:var(--shadow-sm);transition:all .2s;display:flex;flex-direction:column;gap:1rem}.role-card[_ngcontent-%COMP%]:hover{transform:translateY(-5px);box-shadow:0 20px 25px -5px #0000001a}.role-card-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center}.role-badge[_ngcontent-%COMP%]{width:40px;height:40px;border-radius:10px;display:flex;align-items:center;justify-content:center;font-size:1.2rem}.role-actions[_ngcontent-%COMP%]{display:flex;gap:.5rem}.action-btn[_ngcontent-%COMP%]{width:32px;height:32px;border-radius:8px;display:flex;align-items:center;justify-content:center;font-size:.9rem;color:var(--text-muted);background:var(--bg-main);transition:all .2s}.action-btn[_ngcontent-%COMP%]:hover{background:var(--primary);color:#fff}.action-btn.delete[_ngcontent-%COMP%]:hover{background:#ef4444}.role-card-body[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:1.25rem;font-weight:700;margin-bottom:.5rem;color:var(--text-main)}.role-card-body[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:.9rem;color:var(--text-muted);line-height:1.5;margin-bottom:1rem;min-height:2.7rem}.role-meta[_ngcontent-%COMP%]{display:flex;gap:1rem;font-size:.8rem;font-weight:600;color:var(--text-muted)}.role-meta[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{margin-right:.35rem}.role-card-footer[_ngcontent-%COMP%]{margin-top:auto;padding-top:1rem;border-top:1px dashed var(--border-color)}.perms-preview[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:.5rem}.perm-tag[_ngcontent-%COMP%]{font-size:.7rem;font-weight:700;text-transform:uppercase;background:var(--bg-main);color:var(--text-muted);padding:.25rem .6rem;border-radius:6px}.perm-more[_ngcontent-%COMP%]{font-size:.7rem;font-weight:700;color:var(--primary)}.modal-overlay[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;background-color:#00000080;display:flex;align-items:center;justify-content:center;z-index:1000;-webkit-backdrop-filter:blur(4px);backdrop-filter:blur(4px);padding:1rem}.modal-content[_ngcontent-%COMP%]{background:var(--bg-card);width:100%;max-width:500px;max-height:85vh;border-radius:20px;box-shadow:var(--shadow-lg);overflow:hidden;display:flex;flex-direction:column;animation:_ngcontent-%COMP%_modal-slide-up .3s cubic-bezier(.34,1.56,.64,1)}.modal-content.role-modal[_ngcontent-%COMP%]{max-width:800px}@keyframes _ngcontent-%COMP%_modal-slide-up{0%{transform:translateY(30px);opacity:0}to{transform:translateY(0);opacity:1}}.modal-header[_ngcontent-%COMP%]{padding:1.25rem 1.5rem;border-bottom:1px solid var(--border-color);display:flex;justify-content:space-between;align-items:center;background:var(--bg-main)}.modal-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:1.25rem;font-weight:700;color:var(--text-main)}.close-btn[_ngcontent-%COMP%]{background:var(--border-color);border:none;width:32px;height:32px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:1.25rem;cursor:pointer;color:var(--text-muted);transition:all .2s}.close-btn[_ngcontent-%COMP%]:hover{background:#cbd5e1;color:var(--text-main);transform:rotate(90deg)}.modal-body[_ngcontent-%COMP%]{padding:2rem;overflow-y:auto;flex:1}.form-section[_ngcontent-%COMP%]{margin-bottom:2rem}.form-section[_ngcontent-%COMP%] > label[_ngcontent-%COMP%]{display:block;font-size:.85rem;font-weight:800;color:var(--text-muted);text-transform:uppercase;letter-spacing:.05em;margin-bottom:1.5rem;border-left:4px solid var(--primary);padding-left:.75rem}.form-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:1.25rem 1.75rem}.form-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.5rem}.form-group.full[_ngcontent-%COMP%]{grid-column:span 2}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:.75rem;font-weight:700;color:var(--text-muted);text-transform:uppercase;letter-spacing:.05em}.form-group[_ngcontent-%COMP%]   input[type=text][_ngcontent-%COMP%], .form-group[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]{padding:.75rem 1rem;font-size:.95rem;border:1px solid var(--border-color);border-radius:10px;background:var(--bg-main);width:100%;transition:all .2s;font-family:inherit;color:var(--text-main)}.form-group[_ngcontent-%COMP%]   input[type=color][_ngcontent-%COMP%]{width:100%;height:42px;padding:4px;border-radius:10px;border:1px solid var(--border-color);background:var(--bg-main);cursor:pointer}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus, .form-group[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]:focus{border-color:var(--primary);background:var(--bg-card);outline:none;box-shadow:0 0 0 4px #3b82f61a}.perms-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(300px,1fr));gap:1.5rem}.perm-category[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:.95rem;font-weight:700;margin-bottom:1rem;color:var(--text-main)}.perm-item[_ngcontent-%COMP%]{display:flex;align-items:flex-start;gap:1rem;padding:.75rem;border-radius:12px;background:var(--bg-main);border:1px solid transparent;cursor:pointer;transition:all .2s;margin-bottom:.75rem}.perm-item[_ngcontent-%COMP%]:hover, .perm-item.active[_ngcontent-%COMP%]{background:#eff6ff;border-color:var(--primary)}.perm-checkbox[_ngcontent-%COMP%]{width:20px;height:20px;border-radius:6px;border:2px solid #cbd5e1;display:flex;align-items:center;justify-content:center;flex-shrink:0;margin-top:2px}.perm-item.active[_ngcontent-%COMP%]   .perm-checkbox[_ngcontent-%COMP%]{background:var(--primary);border-color:var(--primary);color:#fff}[data-theme="dark"][_nghost-%COMP%]   .perm-item[_ngcontent-%COMP%]:hover, [data-theme="dark"]   [_nghost-%COMP%]   .perm-item[_ngcontent-%COMP%]:hover, [data-theme="dark"][_nghost-%COMP%]   .perm-item.active[_ngcontent-%COMP%], [data-theme="dark"]   [_nghost-%COMP%]   .perm-item.active[_ngcontent-%COMP%]{background:#3b82f626;border-color:var(--primary)}.perm-info[_ngcontent-%COMP%]{display:flex;flex-direction:column}.perm-name[_ngcontent-%COMP%]{font-size:.9rem;font-weight:700;color:var(--text-main)}.perm-desc[_ngcontent-%COMP%]{font-size:.75rem;color:var(--text-muted);line-height:1.3}.modal-footer[_ngcontent-%COMP%]{padding:1.5rem;display:flex;justify-content:flex-end;gap:1rem;border-top:1px solid var(--border-color)}.btn-secondary[_ngcontent-%COMP%]{padding:.8rem 1.5rem;border-radius:12px;font-weight:600;border:1px solid var(--border-color);background:var(--bg-card);color:var(--text-main);cursor:pointer}.roles-loading[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:10rem 0;color:var(--text-muted)}']})};function WF(t,r){if(t&1&&(d(0,"div",27),j(1,"i",28),_(2),u()),t&2){let e=C();g(2),je(" ",e.errorMessage," ")}}function qF(t,r){t&1&&(d(0,"span"),_(1,"Iniciar Sesi\xF3n"),u())}function GF(t,r){t&1&&j(0,"div",29)}var qu=class t{currentYear=new Date().getFullYear();authService=Ce(fr);router=Ce(ro);loginData={email:"",password:""};showPassword=!1;isLoading=!1;errorMessage="";togglePassword(){this.showPassword=!this.showPassword}onSubmit(){if(!this.loginData.email||!this.loginData.password){this.errorMessage="Por favor, complete todos los campos.";return}this.isLoading=!0,this.errorMessage="",this.authService.login({username:this.loginData.email,password:this.loginData.password}).subscribe({next:()=>{let r=this.getRedirectUrl();this.router.navigate([r]),this.isLoading=!1},error:r=>{console.error("Login failed",r),this.isLoading=!1,r.status===401||r.status===403?this.errorMessage="Credenciales inv\xE1lidas. Intente de nuevo.":this.errorMessage="Ocurri\xF3 un error al iniciar sesi\xF3n. Int\xE9ntelo m\xE1s tarde."}})}getRedirectUrl(){return this.authService.can("MANAGE_DASHBOARD")?"/dashboard":this.authService.can("VIEW_MEMBER_PANEL")?"/integrantes":this.authService.can("VIEW_BAPTISM_PANEL")?"/bautismos":this.authService.can("REGISTER_ATTENDANCE")?"/asistencia":this.authService.can("MANAGE_ATTENDANCE")?"/asistencias/administrar":this.authService.can("MANAGE_REPORT")?"/reportes":this.authService.can("VIEW_ROLE_PANEL")?"/roles":this.authService.can("VIEW_USER_PANEL")?"/usuarios":this.authService.can("VIEW_SERVICE_PANEL")?"/servicios":this.authService.can("VIEW_BAPTISM_PANEL")?"/bautismos":"/dashboard"}static \u0275fac=function(e){return new(e||t)};static \u0275cmp=ir({type:t,selectors:[["app-login"]],decls:46,vars:9,consts:[["loginForm","ngForm"],[1,"login-wrapper"],[1,"login-container"],[1,"login-left"],[1,"overlay"],[1,"content"],[1,"bible-quote"],[1,"glossy-icons"],["src","img/logoicc.png","alt","Peces a Tierra",1,"login-logo"],[1,"church-name"],[1,"login-right"],[1,"form-content"],[1,"logo-section"],["src","img/logo-login.png","alt","Peces a Tierra",1,"login-logo"],[1,"login-form",3,"ngSubmit"],[1,"form-group"],[1,"input-wrapper"],["type","email","name","email","placeholder","usuarioicctba","required","",3,"ngModelChange","ngModel"],[1,"fa-solid","fa-user"],["name","password","placeholder","\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022","required","",3,"ngModelChange","type","ngModel"],["type","button",1,"toggle-password",3,"click"],[1,"fa-solid",3,"ngClass"],["class","error-msg",4,"ngIf"],["type","submit",1,"btn-login",3,"disabled"],[4,"ngIf"],["class","loader",4,"ngIf"],[1,"footer-note"],[1,"error-msg"],[1,"fa-solid","fa-circle-exclamation"],[1,"loader"]],template:function(e,n){if(e&1){let i=Pe();d(0,"div",1)(1,"div",2)(2,"div",3),j(3,"div",4),d(4,"div",5)(5,"blockquote",6),_(6," \u201CEchad la red a la derecha de la barca, y hallar\xE9is.\u201D "),d(7,"cite"),_(8,"Juan 21:6"),u()(),d(9,"div",7),j(10,"img",8),u(),d(11,"div",9)(12,"h1"),_(13,"ICC TABERN\xC0CULO"),j(14,"br"),_(15,"DE ADORACI\xD2N"),u()()()(),d(16,"div",10)(17,"div",11)(18,"div",12),j(19,"img",13),d(20,"h2"),_(21,"Peces a Tierra"),u(),d(22,"p"),_(23,"Plataforma administrativa. Ingresa tus credenciales para gestionar el sistema."),u()(),d(24,"form",14,0),L("ngSubmit",function(){return D(i),N(n.onSubmit())}),d(26,"div",15)(27,"label"),_(28,"Correo Electr\xF3nico"),u(),d(29,"div",16)(30,"input",17),ht("ngModelChange",function(o){return D(i),ut(n.loginData.email,o)||(n.loginData.email=o),N(o)}),u(),j(31,"i",18),u()(),d(32,"div",15)(33,"label"),_(34,"Contrase\xF1a"),u(),d(35,"div",16)(36,"input",19),ht("ngModelChange",function(o){return D(i),ut(n.loginData.password,o)||(n.loginData.password=o),N(o)}),u(),d(37,"button",20),L("click",function(){return D(i),N(n.togglePassword())}),j(38,"i",21),u()()(),fe(39,WF,3,1,"div",22),d(40,"button",23),fe(41,qF,2,0,"span",24)(42,GF,1,0,"div",25),u()(),d(43,"div",26)(44,"p"),_(45),u()()()()()()}e&2&&(g(30),ft("ngModel",n.loginData.email),g(6),P("type",n.showPassword?"text":"password"),ft("ngModel",n.loginData.password),g(2),P("ngClass",n.showPassword?"fa-eye-slash":"fa-eye"),g(),P("ngIf",n.errorMessage),g(),P("disabled",n.isLoading),g(),P("ngIf",!n.isLoading),g(),P("ngIf",n.isLoading),g(3),je("\xA9 ",n.currentYear," Peces a tierra. M\xF3dulo de Gesti\xF3n."))},dependencies:[gr,Tr,mr,on,xa,nn,an,va,Xl,Vn,ef],styles:['.login-wrapper[_ngcontent-%COMP%]{height:100vh;width:100vw;display:flex;align-items:center;justify-content:center;background-color:#1a1a1a;overflow:hidden}.login-container[_ngcontent-%COMP%]{display:flex;width:100%;height:100%;max-width:1600px}.login-left[_ngcontent-%COMP%]{flex:1.2;position:relative;background:url(/img/bible-login.png) no-repeat center center;background-size:cover;display:flex;align-items:center;justify-content:center;color:#fff}.login-left[_ngcontent-%COMP%]   .overlay[_ngcontent-%COMP%]{position:absolute;inset:0;background:linear-gradient(to right,#000000b3,#0006)}.login-left[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]{position:relative;z-index:2;text-align:center;padding:2rem;max-width:600px}.bible-quote[_ngcontent-%COMP%]{font-size:2rem;font-weight:700;line-height:1.3;margin-bottom:3rem;font-style:italic;text-shadow:0 4px 10px rgba(0,0,0,.5)}.bible-quote[_ngcontent-%COMP%]   cite[_ngcontent-%COMP%]{display:block;font-size:1rem;margin-top:1rem;font-weight:400;opacity:.8}.glossy-icons[_ngcontent-%COMP%]{display:flex;gap:1.5rem;justify-content:center;margin-bottom:3rem}.glossy-icons[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%}.icon-orb[_ngcontent-%COMP%]{width:80px;height:80px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:1.5rem;position:relative;box-shadow:inset 0 4px 10px #fff6,0 8px 20px #0000004d;overflow:hidden}.icon-orb[_ngcontent-%COMP%]:before{content:"";position:absolute;top:5px;left:15px;width:50px;height:25px;background:#ffffff4d;border-radius:50%;transform:rotate(-10deg)}.icon-orb.red[_ngcontent-%COMP%]{background:radial-gradient(circle at 30% 30%,#ff4d4d,#900)}.icon-orb.orange[_ngcontent-%COMP%]{background:radial-gradient(circle at 30% 30%,#fc0,#f80)}.icon-orb.blue[_ngcontent-%COMP%]{background:radial-gradient(circle at 30% 30%,#0cf,#04c)}.icon-orb.purple[_ngcontent-%COMP%]{background:radial-gradient(circle at 30% 30%,#c3f,#609)}.church-name[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:2.5rem;font-weight:900;letter-spacing:2px;line-height:1.1;text-transform:uppercase}.login-right[_ngcontent-%COMP%]{flex:.8;background:#fff;display:flex;align-items:center;justify-content:center;padding:3rem;box-shadow:-10px 0 30px #0000001a}.form-content[_ngcontent-%COMP%]{width:100%;max-width:400px}.logo-section[_ngcontent-%COMP%]{margin-bottom:3rem}.login-logo[_ngcontent-%COMP%]{width:30px}.logo-section[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:2.2rem;font-weight:800;color:#000;margin-bottom:.5rem}.logo-section[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#666;font-size:.95rem;line-height:1.4}.form-group[_ngcontent-%COMP%]{margin-bottom:1.5rem}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;font-weight:700;font-size:.9rem;margin-bottom:.5rem;color:#000}.input-wrapper[_ngcontent-%COMP%]{position:relative}.input-wrapper[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;padding:.9rem 3rem .9rem 1.2rem;background:#e2e8f0;border:none;border-radius:8px;font-size:1rem;color:#333;transition:all .2s}.input-wrapper[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{outline:none;box-shadow:0 0 0 2px var(--primary);background:#fff}.input-wrapper[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{position:absolute;right:1.25rem;top:50%;transform:translateY(-50%);color:#64748b;font-size:1.1rem}.toggle-password[_ngcontent-%COMP%]{position:absolute;right:.75rem;top:50%;transform:translateY(-50%);background:none;border:none;color:#64748b;cursor:pointer;padding:.5rem}.btn-login[_ngcontent-%COMP%]{width:100%;padding:1rem;background:linear-gradient(135deg,#60a5fa,#3b82f6);color:#fff;border:none;border-radius:8px;font-size:1rem;font-weight:700;cursor:pointer;margin-top:2rem;box-shadow:0 4px 15px #3b82f666;transition:all .2s;display:flex;justify-content:center;align-items:center}.btn-login[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 6px 20px #3b82f680}.btn-login[_ngcontent-%COMP%]:disabled{opacity:.7;cursor:not-allowed;transform:none}.error-msg[_ngcontent-%COMP%]{background:#fee2e2;color:#dc2626;padding:.75rem;border-radius:6px;font-size:.85rem;margin-top:1rem;display:flex;align-items:center;gap:.5rem}.footer-note[_ngcontent-%COMP%]{margin-top:4rem;text-align:center;border-top:1px solid #e2e8f0;padding-top:1.5rem}.footer-note[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#94a3b8;font-size:.75rem}.loader[_ngcontent-%COMP%]{width:20px;height:20px;border:3px solid rgba(255,255,255,.3);border-radius:50%;border-top-color:#fff;animation:_ngcontent-%COMP%_spin .8s linear infinite}@keyframes _ngcontent-%COMP%_spin{to{transform:rotate(360deg)}}@media(max-width:1024px){.login-left[_ngcontent-%COMP%]{display:none}.login-right[_ngcontent-%COMP%]{flex:1}}']})};var Gu=class t{http=Ce(Ai);baseUrl=`${Ti.baseUrl}/users`;getStats(){return this.http.post(`${this.baseUrl}/report`,{})}getUsers(r=0,e="",n){let i=new dl().set("page",r.toString());return e&&(i=i.set("query",e)),n&&(i=i.set("branchId",n)),this.http.get(this.baseUrl,{params:i})}searchUsers(r,e=0,n){return this.getUsers(e,r,n)}createUser(r){return this.http.post(this.baseUrl,r)}updateUser(r,e){return this.http.put(`${this.baseUrl}/${r}`,e)}deleteUser(r){return this.http.delete(`${this.baseUrl}/${r}`)}toggleActive(r,e){return this.http.patch(`${this.baseUrl}/${r}`,null,{params:{active:e.toString()}})}static \u0275fac=function(e){return new(e||t)};static \u0275prov=nr({token:t,factory:t.\u0275fac,providedIn:"root"})};function $F(t,r){if(t&1&&(d(0,"option",35),_(1),u()),t&2){let e=r.$implicit;P("value",e.id),g(),be(e.name)}}function XF(t,r){if(t&1){let e=Pe();d(0,"div",30)(1,"label",4),_(2,"Filtrar por Sede"),u(),d(3,"div",5),j(4,"i",31),d(5,"select",32),ht("ngModelChange",function(i){D(e);let a=C();return ut(a.selectedBranchId,i)||(a.selectedBranchId=i),N(i)}),L("change",function(){D(e);let i=C();return N(i.onSearch())}),d(6,"option",33),_(7,"Todas las sedes"),u(),fe(8,$F,2,2,"option",34),u()()()}if(t&2){let e=C();g(5),ft("ngModel",e.selectedBranchId),g(3),P("ngForOf",e.branches)}}function YF(t,r){if(t&1){let e=Pe();d(0,"button",36),L("click",function(){D(e);let i=C();return N(i.openNewModal())}),j(1,"i",37),d(2,"span",38),_(3,"Nuevo Usuario"),u()()}}function KF(t,r){t&1&&(d(0,"tr")(1,"td",39)(2,"div",40),j(3,"div",41),d(4,"div"),_(5,"Cargando usuarios..."),u()()()())}function ZF(t,r){if(t&1&&(d(0,"span",68),_(1),u()),t&2){let e=C().$implicit,n=C(2);Ft("border-color",e.memberResponseDto.subCategory.color)("color",e.memberResponseDto.subCategory.color),g(),je(" ",n.formatSubCategory(e.memberResponseDto.subCategory)," ")}}function JF(t,r){if(t&1&&(d(0,"span",69),_(1),u()),t&2){let e=r.$implicit;Ft("background-color",e.color?e.color+"20":"")("color",e.color||""),P("title",e.name),g(),je(" ",e.name," ")}}function QF(t,r){if(t&1){let e=Pe();d(0,"button",70),L("click",function(){D(e);let i=C().$implicit,a=C(2);return N(a.editUser(i))}),j(1,"i",71),u()}}function eD(t,r){if(t&1){let e=Pe();d(0,"button",72),L("click",function(){D(e);let i=C().$implicit,a=C(2);return N(a.deleteUser(i))}),j(1,"i",73),u()}}function tD(t,r){if(t&1){let e=Pe();d(0,"button",80),L("click",function(){D(e);let i=C(2).$implicit,a=C(2);return a.editUser(i),N(a.closeDropdown())}),j(1,"i",83),d(2,"span"),_(3,"Editar"),u()()}}function rD(t,r){if(t&1){let e=Pe();d(0,"button",84),L("click",function(){D(e);let i=C(2).$implicit,a=C(2);return a.deleteUser(i),N(a.closeDropdown())}),j(1,"i",85),d(2,"span"),_(3,"Eliminar"),u()()}}function nD(t,r){if(t&1){let e=Pe();d(0,"div",74),L("click",function(i){return D(e),N(i.stopPropagation())}),d(1,"div",75)(2,"span",76),_(3),u()(),d(4,"div",77)(5,"span",78),_(6,"Estado"),u(),d(7,"label",55),L("safeClick",function(){D(e);let i=C().$implicit,a=C(2);return N(a.toggleStatus(i))}),j(8,"input",56)(9,"span",57),u()(),j(10,"hr",79),d(11,"button",80),L("click",function(){D(e);let i=C().$implicit,a=C(2);return a.viewDetails(i),N(a.closeDropdown())}),j(12,"i",61),d(13,"span"),_(14,"Ver Detalles"),u()(),fe(15,tD,4,0,"button",81)(16,rD,4,0,"button",82),u()}if(t&2){let e=C().$implicit,n=C(2);g(3),be(e.memberResponseDto.completeName),g(5),P("checked",e.active)("disabled",!n.can("UPDATE_USER")),g(7),P("ngIf",n.can("UPDATE_USER")),g(),P("ngIf",n.can("DELETE_USER"))}}function iD(t,r){if(t&1){let e=Pe();d(0,"tr")(1,"td")(2,"div",43)(3,"div",44),j(4,"img",45),u(),d(5,"span",46),_(6),u()()(),d(7,"td",47)(8,"span",48),_(9),u(),d(10,"div",49)(11,"span",50),_(12),u(),fe(13,ZF,2,5,"span",51),u()(),d(14,"td",19)(15,"div",52),fe(16,JF,2,6,"span",53),u()(),d(17,"td",19)(18,"span",54),_(19),u()(),d(20,"td",20)(21,"label",55),L("safeClick",function(){let i=D(e).$implicit,a=C(2);return N(a.toggleStatus(i))}),j(22,"input",56)(23,"span",57),u()(),d(24,"td",21)(25,"div",58)(26,"div",59)(27,"button",60),L("click",function(){let i=D(e).$implicit,a=C(2);return N(a.viewDetails(i))}),j(28,"i",61),u(),fe(29,QF,2,0,"button",62)(30,eD,2,0,"button",63),u(),d(31,"div",64)(32,"button",65),L("click",function(i){let a=D(e).$implicit,o=C(2);return N(o.toggleDropdown(i,a.id))}),j(33,"i",66),u(),fe(34,nD,17,5,"div",67),u()()()()}if(t&2){let e=r.$implicit,n=C(2);g(4),P("src",e.memberResponseDto.pictureProfileUrl||"https://ui-avatars.com/api/?name="+e.memberResponseDto.completeName+"&background=random",pn),g(2),be(e.username),g(3),be(e.memberResponseDto.completeName),g(2),Ft("background-color",e.memberResponseDto.category.color),g(),je(" ",n.formatCategory(e.memberResponseDto.category)," "),g(),P("ngIf",e.memberResponseDto.subCategory),g(3),P("ngForOf",e.roles),g(3),be(e.branchName||"---"),g(3),P("checked",e.active)("disabled",!n.can("UPDATE_USER")),g(7),P("ngIf",n.can("UPDATE_USER")),g(),P("ngIf",n.can("DELETE_USER")),g(4),P("ngIf",n.activeDropdownId===e.id)}}function aD(t,r){if(t&1&&(Ln(0),fe(1,iD,35,14,"tr",42),Bn()),t&2){let e=C();g(),P("ngForOf",e.users)}}function oD(t,r){t&1&&(d(0,"tr")(1,"td",86),j(2,"i",87),_(3," No se encontraron usuarios "),u()())}function sD(t,r){t&1&&(d(0,"div",114)(1,"div",115),j(2,"div",116),d(3,"p"),_(4,"Procesando..."),u()()())}function lD(t,r){if(t&1&&(d(0,"span"),_(1),u()),t&2){let e=C(3);g(),je("\u2022 ",e.formatSubCategory(e.selectedMember.subCategory))}}function cD(t,r){if(t&1){let e=Pe();d(0,"div",117),j(1,"img",118),d(2,"div",119)(3,"strong"),_(4),u(),d(5,"span"),_(6),fe(7,lD,2,1,"span",22),_(8),u()(),d(9,"button",120),L("click",function(){D(e);let i=C(2);return N(i.clearSelectedMember())}),j(10,"i",121),u()()}if(t&2){let e=C(2);g(),P("src",e.selectedMember.pictureProfileUrl||"https://ui-avatars.com/api/?name="+e.selectedMember.completeName+"&background=random",pn),g(3),be(e.selectedMember.completeName),g(2),je("",e.formatCategory(e.selectedMember.category)," "),g(),P("ngIf",e.selectedMember.subCategory),g(),je(" \u2022 ",e.formatType(e.selectedMember.type))}}function dD(t,r){t&1&&j(0,"div",129)}function fD(t,r){if(t&1&&(d(0,"span"),_(1),u()),t&2){let e=C().$implicit,n=C(4);g(),je("\u2022 ",n.formatSubCategory(e.subCategory))}}function uD(t,r){if(t&1&&(d(0,"span",138),_(1),u()),t&2){let e=C().$implicit;g(),je(" \u2022 ",e.branch==null?null:e.branch.name)}}function hD(t,r){if(t&1){let e=Pe();d(0,"div",132),L("click",function(){let i=D(e).$implicit,a=C(4);return N(a.selectMember(i))}),d(1,"div",133),j(2,"img",118),u(),d(3,"div",134)(4,"div",135),_(5),u(),d(6,"div",136),_(7),fe(8,fD,2,1,"span",22),_(9),fe(10,uD,2,1,"span",137),u()()()}if(t&2){let e=r.$implicit,n=C(4);g(2),P("src",e.pictureProfileUrl||"https://ui-avatars.com/api/?name=?",pn),g(3),be(e.completeName),g(2),je(" ",n.formatCategory(e.category)," "),g(),P("ngIf",e.subCategory),g(),je(" - ",e.cc||"Sin CC"," "),g(),P("ngIf",e.branch==null?null:e.branch.name)}}function pD(t,r){if(t&1&&(d(0,"div",130),fe(1,hD,11,6,"div",131),u()),t&2){let e=C(3);g(),P("ngForOf",e.availableMembers)}}function mD(t,r){t&1&&(d(0,"div",139),_(1," No se encontraron integrantes activos con ese nombre. "),u())}function gD(t,r){if(t&1){let e=Pe();d(0,"div",122)(1,"div",123),j(2,"i",124),d(3,"input",125),ht("ngModelChange",function(i){D(e);let a=C(2);return ut(a.memberSearchQuery,i)||(a.memberSearchQuery=i),N(i)}),L("input",function(){D(e);let i=C(2);return N(i.onMemberSearch())}),u(),fe(4,dD,1,0,"div",126),u(),fe(5,pD,2,1,"div",127)(6,mD,2,0,"div",128),u()}if(t&2){let e=C(2);g(3),ft("ngModel",e.memberSearchQuery),g(),P("ngIf",e.isSearchingMembers),g(),P("ngIf",e.availableMembers.length>0),g(),P("ngIf",e.memberSearchQuery&&e.availableMembers.length===0&&!e.isSearchingMembers)}}function _D(t,r){t&1&&(d(0,"div",140),_(1,"Seleccionar roles..."),u())}function vD(t,r){if(t&1){let e=Pe();d(0,"span",141),_(1),d(2,"i",142),L("click",function(i){let a=D(e).$implicit,o=C(2);return N(o.removeRole(a,i))}),u()()}if(t&2){let e=r.$implicit,n=C(2);Ft("background-color",n.getRoleColor(e)+"20")("color",n.getRoleColor(e))("border-color",n.getRoleColor(e)),g(),je(" ",n.getRoleName(e)," ")}}function xD(t,r){if(t&1){let e=Pe();d(0,"div",143),L("click",function(){D(e);let i=C(2);return N(i.showRoleDropdown=!1)}),u()}}function bD(t,r){if(t&1&&(d(0,"span",151),_(1),u()),t&2){let e=C().$implicit;g(),be(e.description)}}function wD(t,r){if(t&1){let e=Pe();d(0,"div",80),L("click",function(){let i=D(e).$implicit,a=C(3);return N(a.toggleRole(i.id))}),d(1,"div",146),j(2,"i",147),u(),d(3,"div",148)(4,"span",149),_(5),u(),fe(6,bD,2,1,"span",150),u()()}if(t&2){let e=r.$implicit,n=C(3);g(),Ft("background-color",n.isRoleSelected(e.id)?e.color:"")("border-color",n.isRoleSelected(e.id)?e.color:""),wt("checked",n.isRoleSelected(e.id)),g(3),Ft("color",e.color),g(),be(e.name),g(),P("ngIf",e.description)}}function yD(t,r){if(t&1&&(d(0,"div",144),fe(1,wD,7,10,"div",145),u()),t&2){let e=C(2);g(),P("ngForOf",e.roles)}}function CD(t,r){if(t&1&&(d(0,"div",152),j(1,"i",153),_(2),u()),t&2){let e=C(2);g(2),je(" ",e.errorMessage," ")}}function SD(t,r){if(t&1){let e=Pe();d(0,"div",88),L("click",function(){D(e);let i=C();return N(i.closeModal())}),d(1,"div",89),L("click",function(i){return D(e),N(i.stopPropagation())}),d(2,"div",90)(3,"h2"),_(4),u(),d(5,"button",91),L("click",function(){D(e);let i=C();return N(i.closeModal())}),_(6,"\xD7"),u()(),fe(7,sD,5,0,"div",92),d(8,"div",93)(9,"div",94)(10,"div",95)(11,"label"),_(12,"Persona Relacionada *"),u(),fe(13,cD,11,5,"div",96)(14,gD,7,4,"div",97),u(),d(15,"div",98)(16,"label"),_(17,"Nombre de Usuario *"),u(),d(18,"input",99),ht("ngModelChange",function(i){D(e);let a=C();return ut(a.currentUser.username,i)||(a.currentUser.username=i),N(i)}),u()(),d(19,"div",98)(20,"label"),_(21),u(),d(22,"input",100),ht("ngModelChange",function(i){D(e);let a=C();return ut(a.currentUser.password,i)||(a.currentUser.password=i),N(i)}),u()(),d(23,"div",95)(24,"label"),_(25,"Roles del Sistema *"),u(),d(26,"div",101)(27,"div",102),L("click",function(){D(e);let i=C();return N(i.toggleRoleDropdown())}),fe(28,_D,2,0,"div",103),d(29,"div",104),fe(30,vD,3,7,"span",105),u(),j(31,"i",106),u(),fe(32,xD,1,0,"div",107)(33,yD,2,1,"div",108),u()()(),fe(34,CD,3,1,"div",109),u(),d(35,"div",110)(36,"button",111),L("click",function(){D(e);let i=C();return N(i.closeModal())}),_(37,"Cancelar"),u(),d(38,"button",112),L("click",function(){D(e);let i=C();return N(i.onSubmit())}),j(39,"i",113),_(40),u()()()()}if(t&2){let e=C();g(4),be(e.isEditing?"Editar Usuario":"Nuevo Usuario"),g(),P("disabled",e.isSaving),g(2),P("ngIf",e.isSaving),g(6),P("ngIf",e.selectedMember),g(),P("ngIf",!e.selectedMember),g(4),ft("ngModel",e.currentUser.username),g(3),je("Contrase\xF1a ",e.isEditing?"(Opcional)":"*"),g(),ft("ngModel",e.currentUser.password),g(5),wt("active",e.showRoleDropdown),g(),P("ngIf",e.currentUser.rolesId.length===0),g(2),P("ngForOf",e.currentUser.rolesId),g(2),P("ngIf",e.showRoleDropdown),g(),P("ngIf",e.showRoleDropdown),g(),P("ngIf",e.errorMessage),g(2),P("disabled",e.isSaving),g(2),P("disabled",e.isSaving),g(),P("ngClass",e.isSaving?"fa-spinner fa-spin":"fa-save"),g(),je(" ",e.isSaving?e.isEditing?"Actualizando...":"Guardando...":e.isEditing?"Actualizar":"Crear Usuario"," ")}}function kD(t,r){if(t&1&&(d(0,"span",171),j(1,"i",172),_(2),u()),t&2){let e=C(2);g(2),je(" ",e.selectedUser.branchName," ")}}function ED(t,r){if(t&1){let e=Pe();d(0,"span",173),L("click",function(){let i=D(e).$implicit,a=C(2);return N(a.copyText(i.givenBy))}),_(1),u()}if(t&2){let e=r.$implicit;Ft("border-color",e.color),P("title","Otorgado por: "+(e.givenBy||"Sistema")+" (Click para copiar)"),g(),je(" ",e.name," ")}}function MD(t,r){if(t&1&&(d(0,"div",167)(1,"label"),_(2,"Sub-categor\xEDa:"),u(),d(3,"span",169),_(4),u()()),t&2){let e=C(2);g(3),Ft("border-color",e.selectedUser.memberResponseDto.subCategory.color)("color",e.selectedUser.memberResponseDto.subCategory.color),g(),je(" ",e.formatSubCategory(e.selectedUser.memberResponseDto.subCategory)," ")}}function PD(t,r){if(t&1&&(d(0,"div",167)(1,"label"),_(2,"Actualizado:"),u(),d(3,"span"),_(4),Cr(5,"date"),u()()),t&2){let e=C(2);g(4),be(Qr(5,1,e.selectedUser.updateAt,"medium"))}}function OD(t,r){if(t&1){let e=Pe();d(0,"div",88),L("click",function(){D(e);let i=C();return N(i.closeDetailsModal())}),d(1,"div",154),L("click",function(i){return D(e),N(i.stopPropagation())}),d(2,"div",90)(3,"h2"),_(4,"Detalles del Usuario"),u(),d(5,"button",155),L("click",function(){D(e);let i=C();return N(i.closeDetailsModal())}),_(6,"\xD7"),u()(),d(7,"div",93)(8,"div",156)(9,"div",157),j(10,"img",118),u(),d(11,"div",158)(12,"h3"),_(13),u(),d(14,"span",159),_(15),u(),fe(16,kD,3,1,"span",160),d(17,"div",161),_(18),u()()(),d(19,"div",162)(20,"div",163)(21,"h4"),_(22,"Roles Asignados"),u(),d(23,"div",164),fe(24,ED,2,4,"span",165),u()(),d(25,"div",166)(26,"h4"),_(27,"Informaci\xF3n de Membres\xEDa"),u(),d(28,"div",167)(29,"label"),_(30,"Categor\xEDa:"),u(),d(31,"span",168),_(32),u()(),d(33,"div",167)(34,"label"),_(35,"Tipo:"),u(),d(36,"span",169),_(37),u()(),fe(38,MD,5,5,"div",170),d(39,"div",167)(40,"label"),_(41,"C\xE9dula:"),u(),d(42,"span"),_(43),u()()(),d(44,"div",166)(45,"h4"),_(46,"Auditor\xEDa"),u(),d(47,"div",167)(48,"label"),_(49,"Creado:"),u(),d(50,"span"),_(51),Cr(52,"date"),u()(),fe(53,PD,6,4,"div",170),u()()()()()}if(t&2){let e=C();g(10),P("src",e.selectedUser.memberResponseDto.pictureProfileUrl||"https://ui-avatars.com/api/?name="+e.selectedUser.memberResponseDto.completeName+"&size=120",pn),g(3),be(e.selectedUser.username),g(2),be(e.selectedUser.memberResponseDto.completeName),g(),P("ngIf",e.selectedUser.branchName),g(),wt("active",e.selectedUser.active),g(),je(" ",e.selectedUser.active?"Activo":"Inactivo"," "),g(6),P("ngForOf",e.selectedUser.roles),g(7),Ft("background-color",e.selectedUser.memberResponseDto.category.color),P("ngClass",e.getBadgeClass(e.selectedUser.memberResponseDto.category)),g(),je(" ",e.formatCategory(e.selectedUser.memberResponseDto.category)," "),g(4),Ft("border-color",e.selectedUser.memberResponseDto.type.color)("color",e.selectedUser.memberResponseDto.type.color),g(),je(" ",e.formatType(e.selectedUser.memberResponseDto.type)," "),g(),P("ngIf",e.selectedUser.memberResponseDto.subCategory),g(5),be(e.selectedUser.memberResponseDto.cc||"N/A"),g(8),be(Qr(52,21,e.selectedUser.createdAt,"medium")),g(2),P("ngIf",e.selectedUser.updateAt)}}var $u=class t{userService=Ce(Gu);roleService=Ce(rf);integranteService=Ce(Ri);authService=Ce(fr);cdr=Ce(Un);confirmationService=Ce(Ni);notificationService=Ce(Kr);branchService=Ce(ba);users=[];roles=[];totalUsers=0;activeUsers=0;currentPage=0;totalPages=0;totalElements=0;searchQuery="";isLoading=!0;showModal=!1;showDetailsModal=!1;activeDropdownId=null;isSaving=!1;isEditing=!1;errorMessage="";currentUser={username:"",password:"",memberId:"",rolesId:[]};availableMembers=[];selectedMember=null;memberSearchQuery="";isSearchingMembers=!1;selectedUser=null;searchSubject=new Bt;memberSearchSubject=new Bt;get isAdmin(){return this.can("ADMINISTRATOR")}ngOnInit(){this.loadStats(),this.isAdmin&&this.loadBranches(),this.setupSearchDebounce(),this.setupMemberSearchDebounce(),this.loadUsers(),this.loadRoles()}can(r){return this.authService.can(r)}loadStats(){this.userService.getStats().subscribe({next:r=>{this.totalUsers=r.totalUsers,this.activeUsers=r.totalUsersActives}})}branches=[];selectedBranchId="";loadBranches(){this.isAdmin&&this.branchService.findAll().subscribe(r=>this.branches=r)}loadUsers(){this.isLoading=!0,this.userService.getUsers(this.currentPage,this.searchQuery,this.selectedBranchId).subscribe({next:r=>{this.users=r.data,this.totalPages=r.totalPages,this.totalElements=r.totalElements,this.isLoading=!1,this.scrollToTop()},error:r=>{console.error("Error loading users:",r),this.isLoading=!1}})}loadRoles(){this.roleService.getRoles().subscribe(r=>this.roles=r)}setupSearchDebounce(){this.searchSubject.pipe(Ki(1e3),Oi()).subscribe(r=>{this.searchQuery=r,this.onSearch()})}onSearchInput(){this.searchSubject.next(this.searchQuery)}onSearch(){this.currentPage=0,this.searchQuery.trim()&&(this.isLoading=!0,this.userService.getUsers(this.currentPage,this.searchQuery,this.selectedBranchId).subscribe({next:r=>{this.users=r.data,this.totalPages=r.totalPages,this.totalElements=r.totalElements,this.isLoading=!1,this.scrollToTop()},error:r=>{console.error("Error searching users:",r),this.isLoading=!1}}))}nextPage(){this.currentPage<this.totalPages-1&&(this.currentPage++,this.searchQuery.trim()?this.onSearch():this.loadUsers())}prevPage(){this.currentPage>0&&(this.currentPage--,this.searchQuery.trim()?this.onSearch():this.loadUsers())}openNewModal(){this.isEditing=!1,this.currentUser={username:"",password:"",memberId:"",rolesId:[]},this.selectedMember=null,this.memberSearchQuery="",this.availableMembers=[],this.errorMessage="",this.showModal=!0}editUser(r){this.isEditing=!0,this._editingId=r.id,this.currentUser={username:r.username,memberId:r.memberResponseDto.id,rolesId:r.roles.map(e=>e.id)},this.selectedMember=r.memberResponseDto,this.errorMessage="",this.showModal=!0}closeModal(){this.showModal=!1}setupMemberSearchDebounce(){this.memberSearchSubject.pipe(Ki(1e3),Oi()).subscribe(r=>{if(!r.trim()){this.availableMembers=[];return}this.isSearchingMembers=!0;let e={onlyActive:!0,query:r};this.integranteService.searchMembers(e,0).subscribe({next:n=>{this.availableMembers=n.data,this.isSearchingMembers=!1},error:()=>this.isSearchingMembers=!1})})}onMemberSearch(){this.memberSearchSubject.next(this.memberSearchQuery)}selectMember(r){this.selectedMember=r,this.currentUser.memberId=r.id,this.availableMembers=[],this.memberSearchQuery=""}clearSelectedMember(){this.selectedMember=null,this.currentUser.memberId=""}showRoleDropdown=!1;toggleRoleDropdown(){this.showRoleDropdown=!this.showRoleDropdown}toggleRole(r){let e=this.currentUser.rolesId.indexOf(r);e===-1?this.currentUser.rolesId.push(r):this.currentUser.rolesId.splice(e,1)}removeRole(r,e){e&&e.stopPropagation();let n=this.currentUser.rolesId.indexOf(r);n!==-1&&this.currentUser.rolesId.splice(n,1)}isRoleSelected(r){return this.currentUser.rolesId.includes(r)}getRoleName(r){let e=this.roles.find(n=>n.id===r);return e?e.name:"Desconocido"}getRoleColor(r){let e=this.roles.find(n=>n.id===r);return e?e.color:"#3b82f6"}onSubmit(){if(!this.currentUser.memberId&&this.selectedMember,!this.isEditing&&!this.currentUser.password){this.errorMessage="La contrase\xF1a es obligatoria para nuevos usuarios";return}if(this.isSaving)return;this.isSaving=!0;let r=Yr({},this.currentUser);this.isEditing&&!r.password&&delete r.password,(this.isEditing&&this.selectedMember?this.userService.updateUser(this.editingUserId,r):this.userService.createUser(r)).subscribe({next:()=>{this.isSaving=!1,this.loadUsers(),this.loadStats(),this.notificationService.success(this.isEditing?"Usuario actualizado correctamente":"Usuario creado correctamente"),this.closeModal()},error:n=>{this.isSaving=!1,console.error(n),this.errorMessage="Error al guardar el usuario"}})}get editingUserId(){return this._editingId}_editingId="";toggleStatus(r){if(!this.can("UPDATE_USER"))return;let e=r.active,n=!e,i=this.authService.currentUser()?.username;if(r.username===i&&e===!0){this.notificationService.error("No puedes desactivar tu propio usuario."),r.active=!e,setTimeout(()=>{r.active=e,this.cdr.detectChanges()},0);return}r.active=n,this.userService.toggleActive(r.id,n).subscribe({next:a=>{r.active=a,this.loadStats(),this.notificationService.success(`Usuario ${a?"activado":"desactivado"} correctamente`)},error:a=>{r.active=e}})}deleteUser(r){return Cn(this,null,function*(){(yield this.confirmationService.confirm({title:"Eliminar Usuario",message:`\xBFEliminar usuario ${r.username}?`,type:"danger",confirmText:"Eliminar"}))&&this.userService.deleteUser(r.id).subscribe(()=>{this.loadUsers(),this.loadStats(),this.notificationService.success("Usuario eliminado correctamente")})})}viewDetails(r){this.selectedUser=r,this.showDetailsModal=!0}closeDetailsModal(){this.showDetailsModal=!1,this.selectedUser=null}toggleDropdown(r,e){r.stopPropagation(),this.activeDropdownId=this.activeDropdownId===e?null:e}closeDropdown(){this.activeDropdownId=null}copyText(r){r&&navigator.clipboard.writeText(r)}getBadgeClass(r){switch(typeof r=="string"?r:r?.name){case"DAMAS":return"badge-damas";case"CABALLEROS":return"badge-caballeros";case"JOVENES":return"badge-jovenes";case"NI\xD1OS":return"badge-ninos";default:return""}}formatType(r){return r?typeof r=="string"?r.replace(/_/g," "):r.name||"":""}formatCategory(r){return r?typeof r=="string"?r:r.name||"":""}formatSubCategory(r){return r?typeof r=="string"?r:r.name||"":""}scrollToTop(){[".page-container",".table-container",".full-table",".list-container"].forEach(e=>{let n=document.querySelector(e);n&&n.scrollTo({top:0,behavior:"smooth"})}),window.scrollTo({top:0,behavior:"smooth"})}static \u0275fac=function(e){return new(e||t)};static \u0275cmp=ir({type:t,selectors:[["app-usuarios"]],hostBindings:function(e,n){e&1&&L("click",function(){return n.closeDropdown()},to)},decls:63,vars:15,consts:[[1,"users-card"],[1,"header-section"],[1,"filters-left","desktop-only",2,"align-items","flex-end"],[1,"soft-input-group"],[1,"soft-label"],[1,"soft-input-wrapper"],[1,"soft-input",2,"width","auto","padding","0 1rem","display","flex","gap","0.5rem","align-items","center","color","var(--primary)","font-weight","600"],[1,"fa-solid","fa-users"],[1,"soft-input",2,"width","auto","padding","0 1rem","display","flex","gap","0.5rem","align-items","center","color","#10b981","font-weight","600"],[1,"fa-solid","fa-circle-check"],[1,"search-center"],[1,"fa-solid","fa-magnifying-glass","soft-input-icon"],["type","text","placeholder","Buscar por nombre o usuario...",1,"soft-input",3,"ngModelChange","keyup.enter","ngModel"],[1,"actions-right"],["class","soft-input-group branch-filter-group",4,"ngIf"],[1,"soft-label","invisible-label"],["class","btn btn-primary btn-action-soft",3,"click",4,"ngIf"],[1,"table-container"],[1,"users-table"],[1,"desktop-only"],[1,"desktop-only","text-center"],[1,"text-center"],[4,"ngIf"],[1,"pagination-footer"],[1,"pagination-mini"],[1,"pagination-buttons"],[1,"btn-icon-sm",3,"click","disabled"],[1,"fa-solid","fa-chevron-left"],[1,"fa-solid","fa-chevron-right"],["class","modal-overlay",3,"click",4,"ngIf"],[1,"soft-input-group","branch-filter-group"],[1,"fa-solid","fa-building","soft-input-icon"],[1,"soft-input","select-arrow",3,"ngModelChange","change","ngModel"],["value",""],[3,"value",4,"ngFor","ngForOf"],[3,"value"],[1,"btn","btn-primary","btn-action-soft",3,"click"],[1,"fa-solid","fa-user-plus"],[1,"desktop-only",2,"margin-left","0.5rem"],["colspan","6",2,"padding","0","border","none"],[1,"loading-container"],[1,"loading-spinner"],[4,"ngFor","ngForOf"],[1,"user-identity"],[1,"avatar"],["alt","Avatar",3,"src"],[1,"username"],[1,"desktop-only","text-min-padding"],[1,"member-name"],[1,"member-meta-mini",2,"margin-top","0.2rem","display","flex","gap","0.3rem","flex-wrap","wrap"],[1,"badge","badge-xs",2,"font-size","0.6rem","padding","0.1rem 0.35rem"],["class","badge badge-xs badge-outline","style","font-size: 0.6rem; padding: 0.1rem 0.35rem;",3,"border-color","color",4,"ngIf"],[1,"roles-badges"],["class","role-badge",3,"title","background-color","color",4,"ngFor","ngForOf"],[1,"text-muted"],["appSafeClick","",1,"status-switch",3,"safeClick"],["type","checkbox",3,"checked","disabled"],[1,"slider","round"],[1,"actions-mini"],[1,"desktop-actions","desktop-only"],["title","Ver Detalles",1,"action-btn","view",3,"click"],[1,"fa-solid","fa-eye"],["class","action-btn edit","title","Editar",3,"click",4,"ngIf"],["class","action-btn delete","title","Eliminar",3,"click",4,"ngIf"],[1,"mobile-actions-wrapper","mobile-only"],[1,"menu-trigger",3,"click"],[1,"fa-solid","fa-ellipsis-vertical"],["class","action-dropdown",3,"click",4,"ngIf"],[1,"badge","badge-xs","badge-outline",2,"font-size","0.6rem","padding","0.1rem 0.35rem"],[1,"role-badge",3,"title"],["title","Editar",1,"action-btn","edit",3,"click"],[1,"fa-solid","fa-pen"],["title","Eliminar",1,"action-btn","delete",3,"click"],[1,"fa-solid","fa-trash-can"],[1,"action-dropdown",3,"click"],[1,"dropdown-header-mobile"],[1,"member-name-small"],[1,"dropdown-item","status-row"],[1,"dropdown-label"],[1,"dropdown-divider"],[1,"dropdown-item",3,"click"],["class","dropdown-item",3,"click",4,"ngIf"],["class","dropdown-item delete-text",3,"click",4,"ngIf"],[1,"fa-solid","fa-pen","text-primary"],[1,"dropdown-item","delete-text",3,"click"],[1,"fa-solid","fa-trash-can","text-danger"],["colspan","6",2,"text-align","center","padding","2rem","color","var(--text-muted)"],[1,"fa-solid","fa-users-slash",2,"font-size","2rem","display","block","margin-bottom","0.5rem","opacity","0.4"],[1,"modal-overlay",3,"click"],[1,"modal-content","user-modal",3,"click"],[1,"modal-header"],[1,"close-btn",3,"click","disabled"],["class","modal-loading-overlay",4,"ngIf"],[1,"modal-body"],[1,"form-grid"],[1,"form-group","full-width"],["class","selected-member-card",4,"ngIf"],["class","member-search-wrapper",4,"ngIf"],[1,"form-group"],["type","text","placeholder","Ej: jperez",1,"form-control",3,"ngModelChange","ngModel"],["type","password","placeholder","\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022",1,"form-control",3,"ngModelChange","ngModel"],[1,"multi-select-container"],[1,"multi-select-display","select-box",3,"click"],["class","placeholder",4,"ngIf"],[1,"selected-tags"],["class","selected-tag",3,"background-color","color","border-color",4,"ngFor","ngForOf"],[1,"fa-solid","fa-chevron-down","arrow-icon"],["class","dropdown-overlay",3,"click",4,"ngIf"],["class","multi-select-dropdown",4,"ngIf"],["class","error-msg",4,"ngIf"],[1,"modal-footer"],[1,"btn-cancel",3,"click","disabled"],[1,"btn-save",3,"click","disabled"],[1,"fa-solid",3,"ngClass"],[1,"modal-loading-overlay"],[1,"spinner-wrapper"],[1,"spinner-circle"],[1,"selected-member-card"],["alt","",3,"src"],[1,"member-info"],["title","Cambiar Persona",1,"btn-icon-remove",3,"click"],[1,"fa-solid","fa-times"],[1,"member-search-wrapper"],[1,"input-with-icon"],[1,"fa-solid","fa-magnifying-glass"],["type","text","placeholder","Buscar integrante por nombre...",1,"form-control",3,"ngModelChange","input","ngModel"],["class","spinner-mini",4,"ngIf"],["class","search-results-list",4,"ngIf"],["class","no-results",4,"ngIf"],[1,"spinner-mini"],[1,"search-results-list"],["class","result-item",3,"click",4,"ngFor","ngForOf"],[1,"result-item",3,"click"],[1,"result-avatar"],[1,"result-text"],[1,"name"],[1,"meta"],["style","color: var(--primary); font-weight: 600;",4,"ngIf"],[2,"color","var(--primary)","font-weight","600"],[1,"no-results"],[1,"placeholder"],[1,"selected-tag"],[1,"fa-solid","fa-times",3,"click"],[1,"dropdown-overlay",3,"click"],[1,"multi-select-dropdown"],["class","dropdown-item",3,"click",4,"ngFor","ngForOf"],[1,"checkbox-custom"],[1,"fa-solid","fa-check"],[1,"role-item-info"],[1,"role-name-item"],["class","role-desc-item",4,"ngIf"],[1,"role-desc-item"],[1,"error-msg"],[1,"fa-solid","fa-circle-exclamation"],[1,"modal-content","details-modal",3,"click"],[1,"close-btn",3,"click"],[1,"user-profile-header"],[1,"large-avatar"],[1,"user-main-info"],[1,"member-badge"],["class","text-muted small d-block","style","margin-top: 0.2rem;",4,"ngIf"],[1,"status-badge"],[1,"details-grid"],[1,"detail-section","full-width"],[1,"roles-list"],["class","role-tag","style","cursor: pointer;",3,"border-color","title","click",4,"ngFor","ngForOf"],[1,"detail-section"],[1,"info-row"],[1,"badge","badge-sm",3,"ngClass"],[1,"badge","badge-sm","badge-outline"],["class","info-row",4,"ngIf"],[1,"text-muted","small","d-block",2,"margin-top","0.2rem"],[1,"fa-solid","fa-building"],[1,"role-tag",2,"cursor","pointer",3,"click","title"]],template:function(e,n){e&1&&(d(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"label",4),_(5,"Totales"),u(),d(6,"div",5)(7,"div",6),j(8,"i",7),d(9,"span"),_(10),u()()()(),d(11,"div",3)(12,"label",4),_(13,"Activos"),u(),d(14,"div",5)(15,"div",8),j(16,"i",9),d(17,"span"),_(18),u()()()()(),d(19,"div",10)(20,"div",3)(21,"label",4),_(22,"Buscar Usuario"),u(),d(23,"div",5),j(24,"i",11),d(25,"input",12),ht("ngModelChange",function(a){return ut(n.searchQuery,a)||(n.searchQuery=a),a}),L("ngModelChange",function(){return n.onSearchInput()})("keyup.enter",function(){return n.onSearch()}),u()()()(),d(26,"div",13),fe(27,XF,9,2,"div",14),d(28,"div",3)(29,"label",15),_(30,"Nuevo"),u(),fe(31,YF,4,0,"button",16),u()()(),d(32,"div",17)(33,"table",18)(34,"thead")(35,"tr")(36,"th"),_(37,"USUARIO DEL SISTEMA"),u(),d(38,"th",19),_(39,"PERSONA ENLAZADA"),u(),d(40,"th",20),_(41,"ROLES"),u(),d(42,"th",19),_(43,"SEDE"),u(),d(44,"th",20),_(45,"ESTADO"),u(),d(46,"th",21),_(47,"ACCIONES"),u()()(),d(48,"tbody"),fe(49,KF,6,0,"tr",22)(50,aD,2,1,"ng-container",22)(51,oD,4,0,"tr",22),u()()(),d(52,"div",23)(53,"div",24)(54,"span"),_(55),u(),d(56,"div",25)(57,"button",26),L("click",function(){return n.prevPage()}),j(58,"i",27),u(),d(59,"button",26),L("click",function(){return n.nextPage()}),j(60,"i",28),u()()()()(),fe(61,SD,41,19,"div",29)(62,OD,54,24,"div",29)),e&2&&(g(10),be(n.totalUsers),g(8),be(n.activeUsers),g(7),ft("ngModel",n.searchQuery),g(2),P("ngIf",n.isAdmin),g(4),P("ngIf",n.can("CREATE_USER")),g(18),P("ngIf",n.isLoading),g(),P("ngIf",!n.isLoading),g(),P("ngIf",n.users.length===0&&!n.isLoading),g(4),_a("P\xE1gina ",n.currentPage+1," de ",n.totalPages||1," (Total: ",n.totalElements,")"),g(2),P("disabled",n.currentPage===0),g(2),P("disabled",n.currentPage>=n.totalPages-1),g(2),P("ngIf",n.showModal),g(),P("ngIf",n.showDetailsModal&&n.selectedUser))},dependencies:[gr,Tr,rn,mr,on,Fi,Di,nn,Ii,an,Vn,js,Ji],styles:[`[_nghost-%COMP%]{display:flex;flex-direction:column;height:100%;width:100%;box-sizing:border-box}.user-panel-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;flex:1;height:100%;gap:.75rem;padding:1rem;background:var(--bg-main);box-shadow:var(--shadow-sm)}.header-section[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:flex-end;gap:1rem;padding:0 .5rem;margin-bottom:1rem}.pagination-footer[_ngcontent-%COMP%]{border-top:1px solid var(--border-color);padding:.75rem 1rem;display:flex;justify-content:space-between;align-items:center;background:var(--bg-card);border-bottom-left-radius:12px;border-bottom-right-radius:12px;min-height:52px;margin:0 -1.25rem -1.25rem;width:calc(100% + 2rem);box-sizing:border-box}.page-header.simple[_ngcontent-%COMP%]{margin:0;padding:0}.page-header.simple[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:.95rem;color:var(--text-muted);font-weight:500;margin:0}.stats-mini-group[_ngcontent-%COMP%]{display:flex;gap:.75rem}.search-center[_ngcontent-%COMP%]{display:flex;flex-grow:1;justify-content:flex-start;max-width:none;gap:1rem;align-items:flex-end;margin-right:1rem}.actions-right[_ngcontent-%COMP%]{display:flex;gap:1rem;align-items:flex-end}.search-center[_ngcontent-%COMP%]   .soft-input-group[_ngcontent-%COMP%]{flex:1}.select-arrow[_ngcontent-%COMP%]{appearance:none;-webkit-appearance:none;-moz-appearance:none;background-image:url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='%236b7280' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3e%3cpolyline points='6 9 12 15 18 9'%3e%3c/polyline%3e%3c/svg%3e");background-repeat:no-repeat;background-position:right .5rem center;background-size:1em;padding-right:2.5rem!important}.stat-pill[_ngcontent-%COMP%]{background:var(--bg-input);padding:.4rem .65rem;border-radius:8px;display:flex;align-items:center;gap:.5rem;box-shadow:0 1px 2px #00000005;border:1px solid var(--border-color)}.stat-pill[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:1rem;color:#6366f1}.stat-pill.active[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:#10b981}.pill-info[_ngcontent-%COMP%]{display:flex;flex-direction:column;line-height:1}.pill-info[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{font-size:.9rem;font-weight:800;color:var(--text-main)}.pill-info[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{font-size:.6rem;color:var(--text-muted);text-transform:uppercase;font-weight:700;margin-top:2px}.branch-filter-group[_ngcontent-%COMP%]{min-width:200px}.card-header-actions[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;gap:.75rem;padding-bottom:.85rem;margin-bottom:.25rem}.search-box[_ngcontent-%COMP%]{position:relative;width:100%;flex-grow:1}.search-box[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{position:absolute;left:1rem;top:50%;transform:translateY(-50%);color:var(--text-muted)}.search-box[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;padding:.5rem 1rem .5rem 2.5rem;border-radius:8px;border:1px solid var(--border-color);background:var(--bg-input);font-size:.85rem;transition:all .2s;color:var(--text-main)}.search-box[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{outline:none;border-color:var(--primary);box-shadow:0 0 0 3px #2563eb1a;background:var(--bg-card)}.btn-new-user[_ngcontent-%COMP%]{background:var(--primary);color:#fff;padding:.5rem .9rem;border-radius:8px;border:none;display:flex;align-items:center;gap:.4rem;font-weight:600;cursor:pointer;box-shadow:0 4px 10px #2563eb1a;transition:all .2s;font-size:.8rem;white-space:nowrap}.btn-new-user[_ngcontent-%COMP%]:hover{transform:translateY(-1px);box-shadow:0 4px 10px #2563eb33}.users-card[_ngcontent-%COMP%]{background:var(--bg-card);border-radius:12px;box-shadow:var(--shadow-sm);overflow:hidden;display:flex;flex-direction:column;padding:1.25rem;flex:1;min-height:0;position:relative}.table-container[_ngcontent-%COMP%]{overflow-y:auto;overflow-x:auto;flex:1;border:1px solid var(--border-color);border-radius:8px;background:var(--bg-card);min-height:0}.users-table[_ngcontent-%COMP%]{width:100%;border-collapse:separate;border-spacing:0}.users-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{text-align:center;padding:.65rem 1rem;font-size:.7rem;font-weight:700;color:var(--text-muted);text-transform:uppercase;background:var(--bg-input);position:sticky;top:0;z-index:1;border-bottom:1px solid var(--border-color)}.users-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:.6rem 1rem;border-bottom:1px solid var(--border-color);vertical-align:middle;font-size:.85rem}.text-center[_ngcontent-%COMP%]{text-align:center!important}.pagination-footer[_ngcontent-%COMP%]{border-top:1px solid var(--border-color);padding:.75rem 1rem;display:flex;justify-content:space-between;align-items:center;background:var(--bg-card);border-bottom-left-radius:12px;border-bottom-right-radius:12px;min-height:52px}.pagination-mini[_ngcontent-%COMP%]{display:flex;align-items:center;gap:1rem;font-size:.85rem;color:var(--text-muted);font-weight:500}.user-identity[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.75rem}.avatar-circle[_ngcontent-%COMP%]{width:36px;height:36px;border-radius:50%;background:var(--primary);color:#fff;display:flex;align-items:center;justify-content:center;font-weight:600;font-size:.9rem;flex-shrink:0;text-transform:uppercase}.avatar[_ngcontent-%COMP%]{width:28px;height:28px;border-radius:100%;overflow:hidden;background:#f1f5f9}.avatar[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover}.username[_ngcontent-%COMP%]{font-weight:600;color:var(--text-main);font-size:.9rem}.member-name[_ngcontent-%COMP%]{font-weight:700;color:var(--text-main);font-size:.85rem}.member-meta-mini[_ngcontent-%COMP%]{margin-top:.2rem;display:flex;gap:.3rem;flex-wrap:wrap}.text-min-padding[_ngcontent-%COMP%]{padding-top:.5rem!important;padding-bottom:.5rem!important}.roles-badges[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:.35rem;justify-content:center}.role-badge[_ngcontent-%COMP%]{padding:.15rem .4rem;background-color:#f5f3ff;color:#8b5cf6;border-radius:4px;font-size:.65rem;font-weight:700}.status-switch[_ngcontent-%COMP%]{display:inline-block;width:36px;height:20px;position:relative}.status-switch[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{opacity:0;width:0;height:0}.slider[_ngcontent-%COMP%]{position:absolute;cursor:pointer;inset:0;background-color:var(--border-color);transition:.4s}.slider[_ngcontent-%COMP%]:before{position:absolute;content:"";height:14px;width:14px;left:3px;bottom:3px;background-color:#fff;transition:.4s}input[_ngcontent-%COMP%]:checked + .slider[_ngcontent-%COMP%]{background-color:var(--primary)}input[_ngcontent-%COMP%]:checked + .slider[_ngcontent-%COMP%]:before{transform:translate(16px)}.status-switch[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:disabled + .slider[_ngcontent-%COMP%]{opacity:.6;cursor:not-allowed;background-color:#cbd5e1!important}.status-switch[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:disabled + .slider[_ngcontent-%COMP%]:before{background-color:#f1f5f9}.slider.round[_ngcontent-%COMP%]{border-radius:20px}.slider.round[_ngcontent-%COMP%]:before{border-radius:50%}.actions-mini[_ngcontent-%COMP%]{display:flex;gap:.35rem;justify-content:center}.desktop-actions[_ngcontent-%COMP%]{display:flex;gap:.35rem}.action-btn[_ngcontent-%COMP%]{width:28px;height:28px;border-radius:6px;border:none;background:var(--bg-input);color:var(--text-muted);display:flex;align-items:center;justify-content:center;cursor:pointer;transition:all .2s;font-size:.8rem}.action-btn.view[_ngcontent-%COMP%]:hover{background:#e0f2fe;color:#0ea5e9}.action-btn.edit[_ngcontent-%COMP%]:hover{background:#e0e7ff;color:#4f46e5}.action-btn.delete[_ngcontent-%COMP%]:hover{background:#fee2e2;color:#ef4444}.modal-overlay[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;background-color:#000000b3;display:flex;align-items:center;justify-content:center;z-index:1000;-webkit-backdrop-filter:blur(4px);backdrop-filter:blur(4px);padding:1rem}.modal-content[_ngcontent-%COMP%]{background:var(--bg-card);width:100%;max-width:600px;border-radius:16px;box-shadow:var(--shadow-md);overflow:hidden;display:flex;flex-direction:column;max-height:90vh;position:relative}.modal-header[_ngcontent-%COMP%]{padding:1rem 1.5rem;border-bottom:1px solid var(--border-color);display:flex;justify-content:space-between;align-items:center;background:var(--bg-input)}.modal-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:1rem;font-weight:700;color:var(--text-main);margin:0}.close-btn[_ngcontent-%COMP%]{background:transparent;border:none;width:28px;height:28px;border-radius:50%;display:flex;align-items:center;justify-content:center;cursor:pointer;color:var(--text-muted);transition:all .2s}.close-btn[_ngcontent-%COMP%]:hover{background:var(--border-color);color:var(--text-main)}.modal-body[_ngcontent-%COMP%]{padding:1.5rem 1.5rem 12rem;overflow-y:auto;flex:1}.modal-footer[_ngcontent-%COMP%]{padding:1rem 1.5rem;border-top:1px solid var(--border-color);display:flex;justify-content:flex-end;gap:.75rem;background:var(--bg-input)}.form-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:1rem}.full-width[_ngcontent-%COMP%]{grid-column:1 / -1}.form-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.35rem;position:relative}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:.7rem;font-weight:700;color:var(--text-muted);text-transform:uppercase}.form-control[_ngcontent-%COMP%]{padding:.6rem .85rem;border-radius:8px;border:1px solid var(--border-color);background:var(--bg-input);font-size:.9rem;width:100%;color:var(--text-main)}.form-control[_ngcontent-%COMP%]:focus{border-color:var(--primary);background:var(--bg-card);outline:none}.search-results-list[_ngcontent-%COMP%]{position:absolute;top:100%;left:0;width:100%;background:var(--bg-card);border:1px solid var(--border-color);border-radius:8px;margin-top:.25rem;z-index:50;box-shadow:0 10px 15px -3px #0000001a;max-height:200px;overflow-y:auto}.result-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.75rem;padding:.5rem .85rem;cursor:pointer}.result-item[_ngcontent-%COMP%]:hover{background:var(--bg-input)}.result-avatar[_ngcontent-%COMP%]{width:32px;height:32px;border-radius:50%;overflow:hidden;background:var(--border-color);flex-shrink:0}.result-text[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{font-size:.85rem;font-weight:600}.selected-member-card[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.75rem;padding:.5rem .75rem;border:1px solid var(--border-color);background:var(--bg-card);position:relative}.multi-select-container[_ngcontent-%COMP%]{position:relative;width:100%}.select-box[_ngcontent-%COMP%]{min-height:42px;padding:.4rem 2.5rem .4rem .8rem;border:1px solid var(--border-color);border-radius:8px;background:var(--bg-input);cursor:pointer;display:flex;align-items:center;position:relative;transition:all .2s;background:var(--bg-card)}.select-box[_ngcontent-%COMP%]:hover, .select-box.active[_ngcontent-%COMP%]{background:var(--bg-card);border-color:var(--primary);box-shadow:0 0 0 3px #2563eb1a}.arrow-icon[_ngcontent-%COMP%]{position:absolute;right:1rem;top:50%;transform:translateY(-50%);color:var(--text-muted);font-size:.8rem;pointer-events:none;transition:transform .2s}.select-box.active[_ngcontent-%COMP%]   .arrow-icon[_ngcontent-%COMP%]{transform:translateY(-50%) rotate(180deg)}.placeholder[_ngcontent-%COMP%]{color:#94a3b8;font-size:.9rem}.selected-tags[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:.4rem}.selected-tag[_ngcontent-%COMP%]{padding:.2rem .6rem;border-radius:6px;font-size:.75rem;font-weight:700;display:flex;align-items:center;gap:.4rem;border:1px solid transparent}.selected-tag[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{cursor:pointer;font-size:.8rem;opacity:.7;transition:opacity .2s}.selected-tag[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]:hover{opacity:1}.multi-select-dropdown[_ngcontent-%COMP%]{position:absolute;top:calc(100% + .5rem);left:0;width:100%;background:var(--bg-card);border-radius:12px;box-shadow:var(--shadow-md);border:1px solid var(--border-color);z-index:9999;max-height:250px;overflow-y:auto;padding:.5rem;animation:_ngcontent-%COMP%_fadeIn .15s ease-out}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0;transform:translateY(-5px)}to{opacity:1;transform:translateY(0)}}.dropdown-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.75rem;padding:.6rem .75rem;cursor:pointer;border-radius:8px;transition:all .2s}.dropdown-item[_ngcontent-%COMP%]:hover{background:var(--bg-input)}[data-theme="dark"][_nghost-%COMP%]   .search-results-list[_ngcontent-%COMP%], [data-theme="dark"]   [_nghost-%COMP%]   .search-results-list[_ngcontent-%COMP%], [data-theme="dark"][_nghost-%COMP%]   .multi-select-dropdown[_ngcontent-%COMP%], [data-theme="dark"]   [_nghost-%COMP%]   .multi-select-dropdown[_ngcontent-%COMP%]{background:var(--bg-card);border-color:var(--border-color)}[data-theme="dark"][_nghost-%COMP%]   .result-item[_ngcontent-%COMP%]:hover, [data-theme="dark"]   [_nghost-%COMP%]   .result-item[_ngcontent-%COMP%]:hover, [data-theme="dark"][_nghost-%COMP%]   .dropdown-item[_ngcontent-%COMP%]:hover, [data-theme="dark"]   [_nghost-%COMP%]   .dropdown-item[_ngcontent-%COMP%]:hover{background:#ffffff0d}[data-theme="dark"][_nghost-%COMP%]   .action-dropdown[_ngcontent-%COMP%], [data-theme="dark"]   [_nghost-%COMP%]   .action-dropdown[_ngcontent-%COMP%]{background:var(--bg-card);border-color:var(--border-color)}[data-theme="dark"][_nghost-%COMP%]   .dropdown-header-mobile[_ngcontent-%COMP%], [data-theme="dark"]   [_nghost-%COMP%]   .dropdown-header-mobile[_ngcontent-%COMP%]{background:var(--bg-input);border-color:var(--border-color)}[data-theme="dark"][_nghost-%COMP%]   .menu-trigger[_ngcontent-%COMP%], [data-theme="dark"]   [_nghost-%COMP%]   .menu-trigger[_ngcontent-%COMP%]{background:var(--bg-input);color:var(--text-muted)}[data-theme="dark"][_nghost-%COMP%]   .menu-trigger[_ngcontent-%COMP%]:hover, [data-theme="dark"]   [_nghost-%COMP%]   .menu-trigger[_ngcontent-%COMP%]:hover{background:var(--border-color);color:var(--text-main)}.checkbox-custom[_ngcontent-%COMP%]{width:20px;height:20px;border-radius:6px;border:2px solid var(--border-color);display:flex;align-items:center;justify-content:center;color:#fff;font-size:.7rem;transition:all .2s}.checkbox-custom.checked[_ngcontent-%COMP%]{border-color:var(--primary);background:var(--primary)}.role-item-info[_ngcontent-%COMP%]{display:flex;flex-direction:column}.role-name-item[_ngcontent-%COMP%]{font-weight:700;font-size:.85rem}.role-desc-item[_ngcontent-%COMP%]{font-size:.7rem;color:var(--text-muted)}.dropdown-overlay[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;z-index:90;cursor:default}.user-profile-header[_ngcontent-%COMP%]{display:flex;align-items:center;gap:1.25rem;margin-bottom:1.5rem;padding-bottom:1rem;border-bottom:1px solid var(--border-color)}.large-avatar[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:80px;height:80px;border-radius:50%;border:3px solid white;box-shadow:0 4px 6px -1px #0000001a}.user-main-info[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:1.25rem;font-weight:800;margin:0}.details-grid[_ngcontent-%COMP%]{display:grid;gap:1rem}.detail-section[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{font-size:.75rem;font-weight:700;margin-bottom:.5rem}.info-row[_ngcontent-%COMP%]{padding:.35rem 0;font-size:.85rem;border-bottom:1px solid #f1f5f9;display:flex;justify-content:space-between}.roles-list[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:.35rem}.role-tag[_ngcontent-%COMP%]{padding:.2rem .6rem;border:1px solid;border-radius:6px;font-size:.7rem;font-weight:700}.btn-save[_ngcontent-%COMP%]{padding:.6rem 1.25rem;border-radius:8px;border:none;background:var(--primary);color:#fff;font-weight:600;cursor:pointer}.btn-cancel[_ngcontent-%COMP%]{padding:.6rem 1.25rem;border-radius:8px;border:1px solid var(--border-color);background:#fff;font-weight:600;cursor:pointer}.desktop-actions[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem}@media(max-width:768px){.btn-new-user[_ngcontent-%COMP%]   span[_ngcontent-%COMP%], .stats-mini-group[_ngcontent-%COMP%], .desktop-actions[_ngcontent-%COMP%]{display:none}}.mobile-actions-wrapper[_ngcontent-%COMP%]{position:relative;display:inline-block}.action-dropdown[_ngcontent-%COMP%]{position:absolute;top:100%;right:0;z-index:1000;background:#fff;min-width:190px;border-radius:12px;box-shadow:0 10px 25px -5px #0000001a,0 8px 10px -6px #0000001a;border:1px solid var(--border-color);padding:.5rem 0;margin-top:.5rem;animation:_ngcontent-%COMP%_dropdown-fade-in .2s cubic-bezier(.16,1,.3,1)}@keyframes _ngcontent-%COMP%_dropdown-fade-in{0%{opacity:0;transform:translateY(-10px) scale(.95)}to{opacity:1;transform:translateY(0) scale(1)}}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0}to{opacity:1}}.dropdown-header-mobile[_ngcontent-%COMP%]{padding:.5rem 1rem;background:#f8fafc;border-bottom:1px solid var(--border-color);margin-bottom:.4rem;margin-top:-.5rem;border-radius:12px 12px 0 0}.member-name-small[_ngcontent-%COMP%]{font-size:.75rem;font-weight:700;color:var(--text-muted);display:block;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.action-dropdown[_ngcontent-%COMP%]   .dropdown-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.75rem;padding:.75rem 1rem;width:100%;border:none;background:none;cursor:pointer;font-size:.85rem;font-weight:600;color:var(--text-main);transition:all .2s;text-align:left;position:relative;z-index:1}.dropdown-label[_ngcontent-%COMP%]{flex:1}.action-dropdown[_ngcontent-%COMP%]   .dropdown-item[_ngcontent-%COMP%]:hover{background:#f1f5f9;color:var(--primary)}.action-dropdown[_ngcontent-%COMP%]   .dropdown-item[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{width:16px;text-align:center;font-size:.9rem}.status-row[_ngcontent-%COMP%]{justify-content:space-between}.dropdown-divider[_ngcontent-%COMP%]{border:0;border-top:1px solid var(--border-color);margin:.4rem 0}.delete-text[_ngcontent-%COMP%]:hover{background:#fef2f2;color:#ef4444}.text-primary[_ngcontent-%COMP%]{color:var(--primary)}.text-danger[_ngcontent-%COMP%]{color:#ef4444}.menu-trigger[_ngcontent-%COMP%]{width:28px;height:28px;border-radius:6px;background:#f1f5f9;color:var(--text-muted);display:flex;align-items:center;justify-content:center;transition:all .2s}.menu-trigger[_ngcontent-%COMP%]:hover{background:#e2e8f0;color:var(--text-main)}.empty-state[_ngcontent-%COMP%]{padding:4rem!important;text-align:center;color:#94a3b8;border:none!important}@media(max-width:768px){.header-section[_ngcontent-%COMP%]{flex-wrap:nowrap!important;gap:.5rem!important;align-items:center!important;margin-bottom:.5rem!important}.header-section[_ngcontent-%COMP%]   .search-center[_ngcontent-%COMP%]{width:auto!important;order:unset!important;flex:1 1 auto!important;margin-top:0!important;min-width:0!important}.header-section[_ngcontent-%COMP%]   .actions-right[_ngcontent-%COMP%]{order:unset!important;margin-left:0!important;flex-shrink:0!important}.header-section[_ngcontent-%COMP%]   .soft-label[_ngcontent-%COMP%], .btn-action-soft[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:none!important}.branch-filter-group[_ngcontent-%COMP%]{min-width:auto!important;flex:0 0 auto!important;width:42px!important;position:relative}.branch-filter-group[_ngcontent-%COMP%]   .soft-input-wrapper[_ngcontent-%COMP%]{width:100%;display:flex;justify-content:center}.branch-filter-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{width:100%!important;padding:0!important;color:transparent!important;background-color:var(--bg-input)!important;background-image:none!important;text-align:center;direction:rtl}.branch-filter-group[_ngcontent-%COMP%]   .soft-input-icon[_ngcontent-%COMP%]{left:50%!important;transform:translate(-50%,-50%)!important;z-index:5;pointer-events:none}.branch-filter-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]   option[_ngcontent-%COMP%]{color:var(--text-main)!important;background-color:var(--bg-card)!important;direction:ltr;text-align:left}}`]})};function AD(t,r){if(t&1){let e=Pe();d(0,"button",12),L("click",function(){D(e);let i=C();return N(i.openFormModal())}),j(1,"i",13),u()}}function TD(t,r){if(t&1){let e=Pe();d(0,"button",32),L("click",function(){D(e);let i=C(2);return N(i.resetServiceForm())}),_(1," Cancelar "),u()}}function ID(t,r){if(t&1){let e=Pe();d(0,"form",14),L("submit",function(){D(e);let i=C();return N(i.onServiceSubmit())}),d(1,"div",15)(2,"div",16)(3,"label",17),_(4,"Nombre del Servicio"),u(),d(5,"div",18),j(6,"i",19),d(7,"input",20),ht("ngModelChange",function(i){D(e);let a=C();return ut(a.serviceForm.name,i)||(a.serviceForm.name=i),N(i)}),u()()(),d(8,"div",21)(9,"label",17),_(10,"Descripci\xF3n"),u(),d(11,"div",18),j(12,"i",22),d(13,"input",23),ht("ngModelChange",function(i){D(e);let a=C();return ut(a.serviceForm.description,i)||(a.serviceForm.description=i),N(i)}),u()()()(),d(14,"div",24)(15,"div",25)(16,"label",26),_(17,"Acciones"),u(),d(18,"div",27)(19,"button",28),j(20,"i",29),d(21,"span",30),_(22),u()(),fe(23,TD,2,0,"button",31),u()()()()}if(t&2){let e=C();g(7),ft("ngModel",e.serviceForm.name),g(6),ft("ngModel",e.serviceForm.description),g(6),P("disabled",e.isSavingService),g(),P("ngClass",e.isSavingService?"fa-spinner fa-spin":e.isEditingService?"fa-save":"fa-plus"),g(2),be(e.isSavingService?e.isEditingService?"Actualizando...":"Agregando...":e.isEditingService?"Actualizar":"Agregar"),g(),P("ngIf",e.isEditingService)}}function FD(t,r){t&1&&j(0,"hr",33)}function DD(t,r){t&1&&(d(0,"tr")(1,"td",34)(2,"div",35),j(3,"div",36),d(4,"div"),_(5,"Cargando servicios..."),u()()()())}function ND(t,r){if(t&1){let e=Pe();d(0,"button",50),L("click",function(){D(e);let i=C().$implicit,a=C(2);return N(a.editService(i))}),j(1,"i",51),u()}}function RD(t,r){if(t&1){let e=Pe();d(0,"button",52),L("click",function(){D(e);let i=C().$implicit,a=C(2);return N(a.deleteService(i.id))}),j(1,"i",53),u()}}function LD(t,r){if(t&1){let e=Pe();d(0,"button",61),L("click",function(){D(e);let i=C(2).$implicit,a=C(2);return a.editService(i),N(a.closeDropdown())}),j(1,"i",62),d(2,"span"),_(3,"Editar"),u()()}}function BD(t,r){if(t&1){let e=Pe();d(0,"button",61),L("click",function(){D(e);let i=C(2).$implicit,a=C(2);return a.deleteService(i.id),N(a.closeDropdown())}),j(1,"i",63),d(2,"span",64),_(3,"Eliminar"),u()()}}function UD(t,r){if(t&1){let e=Pe();d(0,"div",54),L("click",function(i){return D(e),N(i.stopPropagation())}),d(1,"div",55)(2,"span",56),_(3),u()(),d(4,"div",57)(5,"span",58),_(6,"Estado"),u(),d(7,"label",39),L("safeClick",function(){D(e);let i=C().$implicit,a=C(2);return N(a.toggleServiceStatus(i))}),j(8,"input",40)(9,"span",41),u()(),j(10,"hr",59),fe(11,LD,4,0,"button",60)(12,BD,4,0,"button",60),u()}if(t&2){let e=C().$implicit,n=C(2);g(3),be(e.name),g(5),P("checked",e.active)("disabled",!n.can("UPDATE_SERVICE")),g(3),P("ngIf",n.can("UPDATE_SERVICE")),g(),P("ngIf",n.can("DELETE_SERVICE"))}}function VD(t,r){if(t&1){let e=Pe();d(0,"tr")(1,"td")(2,"strong"),_(3),u()(),d(4,"td",38),_(5),u(),d(6,"td",8)(7,"label",39),L("safeClick",function(){let i=D(e).$implicit,a=C(2);return N(a.toggleServiceStatus(i))}),j(8,"input",40)(9,"span",41),u()(),d(10,"td",9)(11,"div",42)(12,"div",43),fe(13,ND,2,0,"button",44)(14,RD,2,0,"button",45),u(),d(15,"div",46)(16,"button",47),L("click",function(i){let a=D(e).$implicit,o=C(2);return N(o.toggleDropdown(i,a.id))}),j(17,"i",48),u(),fe(18,UD,13,5,"div",49),u()()()()}if(t&2){let e=r.$implicit,n=C(2);wt("inactive-row",!e.active),g(3),be(e.name),g(2),be(e.description),g(3),P("checked",e.active)("disabled",!n.can("UPDATE_SERVICE")),g(5),P("ngIf",n.can("UPDATE_SERVICE")),g(),P("ngIf",n.can("DELETE_SERVICE")),g(4),P("ngIf",n.activeDropdownId===e.id)}}function zD(t,r){if(t&1&&(Ln(0),fe(1,VD,19,9,"tr",37),Bn()),t&2){let e=C();g(),P("ngForOf",e.services)}}function jD(t,r){t&1&&(d(0,"tr")(1,"td",65),j(2,"i",66),_(3," No hay servicios registrados "),u()())}function HD(t,r){t&1&&(d(0,"div",80)(1,"div",81),j(2,"div",82),d(3,"p"),_(4,"Procesando..."),u()()())}function WD(t,r){if(t&1){let e=Pe();d(0,"div",67),L("click",function(){D(e);let i=C();return N(i.closeFormModal())}),d(1,"div",68),L("click",function(i){return D(e),N(i.stopPropagation())}),d(2,"div",69)(3,"h2"),_(4),u(),d(5,"button",70),L("click",function(){D(e);let i=C();return N(i.closeFormModal())}),_(6,"\xD7"),u()(),fe(7,HD,5,0,"div",71),d(8,"div",72)(9,"form",73),L("submit",function(){D(e);let i=C();return N(i.onServiceSubmit())}),d(10,"div",74)(11,"label"),_(12,"Nombre del Servicio"),u(),d(13,"input",75),ht("ngModelChange",function(i){D(e);let a=C();return ut(a.serviceForm.name,i)||(a.serviceForm.name=i),N(i)}),u()(),d(14,"div",74)(15,"label"),_(16,"Descripci\xF3n"),u(),d(17,"input",76),ht("ngModelChange",function(i){D(e);let a=C();return ut(a.serviceForm.description,i)||(a.serviceForm.description=i),N(i)}),u()(),d(18,"div",77)(19,"button",78),L("click",function(){D(e);let i=C();return N(i.closeFormModal())}),_(20,"Cancelar"),u(),d(21,"button",79),j(22,"i",29),_(23),u()()()()()()}if(t&2){let e=C();g(4),be(e.isEditingService?"Editar Servicio":"Nuevo Servicio"),g(),P("disabled",e.isSavingService),g(2),P("ngIf",e.isSavingService),g(6),ft("ngModel",e.serviceForm.name),g(4),ft("ngModel",e.serviceForm.description),g(2),P("disabled",e.isSavingService),g(2),P("disabled",e.isSavingService),g(),P("ngClass",e.isSavingService?"fa-spinner fa-spin":e.isEditingService?"fa-save":"fa-plus"),g(),je(" ",e.isSavingService?e.isEditingService?"Actualizando...":"Agregando...":e.isEditingService?"Actualizar":"Agregar"," ")}}var Xu=class t{asistenciaService=Ce(no);authService=Ce(fr);notificationService=Ce(Kr);confirmationService=Ce(Ni);cdr=Ce(Un);services=[];serviceForm={name:"",description:""};isEditingService=!1;editingServiceId;isSavingService=!1;showFormModal=!1;activeDropdownId=null;isLoading=!1;ngOnInit(){this.loadServices()}can(r){return this.authService.can(r)}openFormModal(){this.showFormModal=!0}closeFormModal(){this.showFormModal=!1,this.resetServiceForm()}loadServices(){this.isLoading=!0,this.asistenciaService.getServices(!1).subscribe({next:r=>{this.services=r,this.isLoading=!1},error:()=>{this.isLoading=!1}})}onServiceSubmit(){!this.serviceForm.name||!this.serviceForm.description||(this.isSavingService=!0,this.isEditingService&&this.editingServiceId?this.asistenciaService.updateService(this.editingServiceId,this.serviceForm).subscribe({next:()=>{this.isSavingService=!1,this.notificationService.success("Servicio actualizado correctamente"),this.resetServiceForm(),this.loadServices(),this.closeFormModal()},error:()=>this.isSavingService=!1}):this.asistenciaService.addService(this.serviceForm).subscribe({next:()=>{this.isSavingService=!1,this.notificationService.success("Servicio creado correctamente"),this.resetServiceForm(),this.loadServices(),this.closeFormModal()},error:()=>this.isSavingService=!1}))}editService(r){this.isEditingService=!0,this.editingServiceId=r.id,this.serviceForm={name:r.name,description:r.description||""},this.openFormModal()}deleteService(r){return Cn(this,null,function*(){(yield this.confirmationService.confirm({title:"Eliminar Servicio",message:"\xBFEst\xE1 seguro de eliminar este servicio?",type:"danger",confirmText:"Eliminar"}))&&this.asistenciaService.deleteService(r).subscribe(()=>{this.loadServices(),this.notificationService.success("Servicio eliminado correctamente")})})}toggleServiceStatus(r){if(!this.can("UPDATE_SERVICE"))return;let e=!r.active;this.asistenciaService.toggleServiceStatus(r.id,e).subscribe({next:n=>{r.active=n,this.notificationService.success(`Servicio ${n?"activado":"desactivado"} correctamente`)}})}resetServiceForm(){this.serviceForm={name:"",description:""},this.isEditingService=!1,this.editingServiceId=void 0}toggleDropdown(r,e){r.stopPropagation(),this.activeDropdownId=this.activeDropdownId===e?null:e}closeDropdown(){this.activeDropdownId=null}static \u0275fac=function(e){return new(e||t)};static \u0275cmp=ir({type:t,selectors:[["app-servicios"]],hostBindings:function(e,n){e&1&&L("click",function(){return n.closeDropdown()},to)},decls:22,vars:7,consts:[["class","fab-add-service",3,"click",4,"ngIf"],[1,"servicios-container"],[1,"card","premium-card"],["class","header-section desktop-only","style","align-items: flex-end;",3,"submit",4,"ngIf"],["class","divider desktop-only",4,"ngIf"],[1,"table-container"],[1,"premium-table"],[1,"desktop-only","text-muted"],[1,"text-center","desktop-only"],[1,"text-center"],[4,"ngIf"],["class","modal-overlay",3,"click",4,"ngIf"],[1,"fab-add-service",3,"click"],[1,"fa-solid","fa-plus"],[1,"header-section","desktop-only",2,"align-items","flex-end",3,"submit"],[1,"search-center","desktop-only",2,"display","flex","gap","1rem","flex","1"],[1,"soft-input-group",2,"flex","1"],[1,"soft-label"],[1,"soft-input-wrapper"],[1,"fa-solid","fa-church","soft-input-icon"],["type","text","name","name","placeholder","Ej: Culto de Adoraci\xF3n","required","",1,"soft-input",3,"ngModelChange","ngModel"],[1,"soft-input-group",2,"flex","2"],[1,"fa-solid","fa-align-left","soft-input-icon"],["type","text","name","description","placeholder","Breve descripci\xF3n","required","",1,"soft-input",3,"ngModelChange","ngModel"],[1,"actions-right","desktop-only"],[1,"soft-input-group"],[1,"soft-label","invisible-label"],[2,"display","flex","gap","0.5rem"],["type","submit",1,"btn","btn-primary","btn-action-soft",3,"disabled"],[1,"fa-solid",3,"ngClass"],[1,"desktop-only"],["type","button","class","btn btn-muted btn-action-soft",3,"click",4,"ngIf"],["type","button",1,"btn","btn-muted","btn-action-soft",3,"click"],[1,"divider","desktop-only"],["colspan","4",2,"padding","0","border","none"],[1,"loading-container"],[1,"loading-spinner"],[3,"inactive-row",4,"ngFor","ngForOf"],[1,"text-muted","desktop-only"],["appSafeClick","",1,"status-switch",3,"safeClick"],["type","checkbox",3,"checked","disabled"],[1,"slider","round"],[1,"actions-mini","justify-center"],[1,"desktop-only","desktop-actions"],["class","action-btn-sm edit","title","Editar",3,"click",4,"ngIf"],["class","action-btn-sm delete","title","Eliminar",3,"click",4,"ngIf"],[1,"mobile-only","mobile-actions-wrapper"],[1,"menu-trigger",3,"click"],[1,"fa-solid","fa-ellipsis-vertical"],["class","action-dropdown",3,"click",4,"ngIf"],["title","Editar",1,"action-btn-sm","edit",3,"click"],[1,"fa-solid","fa-pen-to-square"],["title","Eliminar",1,"action-btn-sm","delete",3,"click"],[1,"fa-solid","fa-trash"],[1,"action-dropdown",3,"click"],[1,"dropdown-header-mobile"],[1,"member-name-small"],[1,"dropdown-item","status-row"],[1,"dropdown-label"],[1,"dropdown-divider"],["class","dropdown-item",3,"click",4,"ngIf"],[1,"dropdown-item",3,"click"],[1,"fa-solid","fa-pen","text-primary"],[1,"fa-solid","fa-trash","text-danger"],[1,"delete-text"],["colspan","4",2,"text-align","center","padding","2rem","color","var(--text-muted)"],[1,"fa-solid","fa-church",2,"font-size","2rem","display","block","margin-bottom","0.5rem","opacity","0.4"],[1,"modal-overlay",3,"click"],[1,"modal-content","service-modal",3,"click"],[1,"modal-header"],[1,"close-btn",3,"click","disabled"],["class","modal-loading-overlay",4,"ngIf"],[1,"modal-body"],[1,"service-form-modal",3,"submit"],[1,"form-group"],["type","text","name","name","placeholder","Ej: Culto de Adoraci\xF3n","required","",1,"premium-input",3,"ngModelChange","ngModel"],["type","text","name","description","placeholder","Breve descripci\xF3n","required","",1,"premium-input",3,"ngModelChange","ngModel"],[1,"modal-footer"],["type","button",1,"btn","btn-muted",3,"click","disabled"],["type","submit",1,"btn","btn-primary",3,"disabled"],[1,"modal-loading-overlay"],[1,"spinner-wrapper"],[1,"spinner-circle"]],template:function(e,n){e&1&&(fe(0,AD,2,0,"button",0),d(1,"div",1)(2,"div",2),fe(3,ID,24,6,"form",3)(4,FD,1,0,"hr",4),d(5,"div",5)(6,"table",6)(7,"thead")(8,"tr")(9,"th"),_(10,"NOMBRE"),u(),d(11,"th",7),_(12,"DESCRIPCI\xD3N"),u(),d(13,"th",8),_(14,"ESTADO"),u(),d(15,"th",9),_(16,"ACCIONES"),u()()(),d(17,"tbody"),fe(18,DD,6,0,"tr",10)(19,zD,2,1,"ng-container",10)(20,jD,4,0,"tr",10),u()()()()(),fe(21,WD,24,9,"div",11)),e&2&&(P("ngIf",n.can("CREATE_SERVICE")||n.can("UPDATE_SERVICE")),g(3),P("ngIf",n.can("CREATE_SERVICE")||n.can("UPDATE_SERVICE")),g(),P("ngIf",n.can("CREATE_SERVICE")||n.can("UPDATE_SERVICE")),g(14),P("ngIf",n.isLoading),g(),P("ngIf",!n.isLoading),g(),P("ngIf",n.services.length===0&&!n.isLoading),g(),P("ngIf",n.showFormModal))},dependencies:[gr,Tr,rn,mr,on,xa,nn,an,va,Xl,Vn,ef,js],styles:['[_nghost-%COMP%]{display:block;height:100%;width:100%}.servicios-container[_ngcontent-%COMP%]{height:100%;width:100%;display:flex;flex-direction:column}.premium-card[_ngcontent-%COMP%]{background:var(--bg-card);border-radius:12px;box-shadow:var(--shadow-sm);padding:1.5rem;height:100%;display:flex;flex-direction:column;gap:.75rem}.service-form[_ngcontent-%COMP%]{background:var(--bg-main);padding:.75rem;border-radius:12px;border:1px dashed var(--border-color)}.form-row[_ngcontent-%COMP%]{display:flex;align-items:flex-end;gap:1rem;flex-wrap:wrap}.form-group[_ngcontent-%COMP%]{flex:1;min-width:200px;display:flex;flex-direction:column;gap:.5rem}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:.75rem;font-weight:700;color:var(--text-muted);text-transform:uppercase}.premium-input[_ngcontent-%COMP%]{padding:.65rem 1rem;border:1.5px solid var(--border-color);border-radius:8px;font-size:.9rem;background:var(--bg-card);color:var(--text-main);transition:all .2s}.premium-input[_ngcontent-%COMP%]:focus{border-color:var(--primary);box-shadow:0 0 0 3px rgba(var(--primary-rgb),.1);outline:none}.btn-add-service[_ngcontent-%COMP%]{padding:.65rem 1.5rem;border-radius:8px;height:42px;display:flex;align-items:center;gap:.5rem;font-weight:600;border:none;cursor:pointer}.divider[_ngcontent-%COMP%]{border:0;border-top:1px solid var(--border-color);margin:0}.table-container[_ngcontent-%COMP%]{flex:1;overflow:auto;border:1px solid var(--border-color);border-radius:8px;background:var(--bg-main)}.premium-table[_ngcontent-%COMP%]{width:100%;border-collapse:separate;border-spacing:0}.premium-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{position:sticky;top:0;background:var(--bg-main);padding:.75rem 1rem;font-size:.7rem;font-weight:700;color:var(--text-muted);text-align:center;border-bottom:2px solid var(--border-color);text-transform:uppercase;z-index:10}.premium-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:.75rem 1rem;border-bottom:1px solid var(--border-color);vertical-align:middle;font-size:.85rem;color:var(--text-main);text-align:center}.text-center[_ngcontent-%COMP%]{text-align:center}.text-muted[_ngcontent-%COMP%]{color:var(--text-muted)}.justify-center[_ngcontent-%COMP%]{justify-content:center}.inactive-row[_ngcontent-%COMP%]{background-color:var(--bg-main);opacity:.7}.status-switch[_ngcontent-%COMP%]{display:inline-block;width:36px;height:20px;position:relative}.status-switch[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{opacity:0;width:0;height:0}.status-switch[_ngcontent-%COMP%]   .slider[_ngcontent-%COMP%]{position:absolute;cursor:pointer;inset:0;background-color:#cbd5e1;transition:.4s;border-radius:20px}.status-switch[_ngcontent-%COMP%]   .slider[_ngcontent-%COMP%]:before{position:absolute;content:"";height:14px;width:14px;left:3px;bottom:3px;background-color:#fff;transition:.4s;border-radius:50%}.status-switch[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:disabled + .slider[_ngcontent-%COMP%]{opacity:.6;cursor:not-allowed;background-color:#cbd5e1!important}.status-switch[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:disabled + .slider[_ngcontent-%COMP%]:before{background-color:#f1f5f9}.status-switch[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:checked + .slider[_ngcontent-%COMP%]{background-color:#2563eb}.status-switch[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:checked + .slider[_ngcontent-%COMP%]:before{transform:translate(16px)}.actions-mini[_ngcontent-%COMP%]{display:flex;gap:.5rem;align-items:center}.desktop-actions[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem}.action-btn-sm[_ngcontent-%COMP%]{width:28px;height:28px;border-radius:8px;border:none;background:var(--bg-main);color:var(--text-muted);display:flex;align-items:center;justify-content:center;cursor:pointer;transition:all .2s;font-size:.85rem}.action-btn-sm[_ngcontent-%COMP%]:hover{background:#e2e8f0;color:var(--primary)}.action-btn-sm.edit[_ngcontent-%COMP%]:hover{color:var(--primary);background:#e0e7ff}.action-btn-sm.delete[_ngcontent-%COMP%]:hover{color:#ef4444;background:#fee2e2}.empty-state[_ngcontent-%COMP%]{padding:4rem!important;text-align:center;color:#94a3b8}.status-badge[_ngcontent-%COMP%]{display:inline-block;padding:.25rem .75rem;border-radius:12px;font-size:.75rem;font-weight:600;background:var(--bg-main);color:var(--text-muted)}.status-badge.active[_ngcontent-%COMP%]{background:#d1fae5;color:#065f46}.fab-add-service[_ngcontent-%COMP%]{display:none;position:fixed;bottom:2rem;right:2rem;width:56px;height:56px;border-radius:50%;background:linear-gradient(135deg,var(--primary),var(--primary-dark));color:#fff;border:none;box-shadow:0 4px 12px #3b82f666;cursor:pointer;z-index:100;font-size:1.5rem;transition:all .3s ease}.fab-add-service[_ngcontent-%COMP%]:hover{transform:scale(1.1);box-shadow:0 6px 16px #3b82f680}.fab-add-service[_ngcontent-%COMP%]:active{transform:scale(.95)}@media(max-width:767px){.fab-add-service[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center}.service-form-desktop[_ngcontent-%COMP%]{display:none!important}.divider[_ngcontent-%COMP%]{display:none}.desktop-only[_ngcontent-%COMP%]{display:none!important}}@media(min-width:768px){.mobile-only[_ngcontent-%COMP%]{display:none!important}}.mobile-actions-wrapper[_ngcontent-%COMP%]{position:relative;display:inline-block}.action-dropdown[_ngcontent-%COMP%]{position:absolute;top:100%;right:0;z-index:1000;background:var(--bg-card);min-width:190px;border-radius:12px;box-shadow:var(--shadow-lg);border:1px solid var(--border-color);padding:.5rem 0;margin-top:.5rem;animation:_ngcontent-%COMP%_dropdown-fade-in .2s cubic-bezier(.16,1,.3,1)}@keyframes _ngcontent-%COMP%_dropdown-fade-in{0%{opacity:0;transform:translateY(-10px) scale(.95)}to{opacity:1;transform:translateY(0) scale(1)}}.dropdown-header-mobile[_ngcontent-%COMP%]{padding:.5rem 1rem;background:var(--bg-main);border-bottom:1px solid var(--border-color);margin-bottom:.4rem;margin-top:-.5rem;border-radius:12px 12px 0 0}.member-name-small[_ngcontent-%COMP%]{font-size:.75rem;font-weight:700;color:var(--text-muted);display:block;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;text-align:left}.action-dropdown[_ngcontent-%COMP%]   .dropdown-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.75rem;padding:.75rem 1rem;width:100%;border:none;background:none;cursor:pointer;font-size:.85rem;font-weight:600;color:var(--text-main);transition:all .2s;text-align:left;position:relative;z-index:1}.dropdown-label[_ngcontent-%COMP%]{flex:1}.action-dropdown[_ngcontent-%COMP%]   .dropdown-item[_ngcontent-%COMP%]:hover{background:#f1f5f9;color:var(--primary)}.action-dropdown[_ngcontent-%COMP%]   .dropdown-item[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{width:16px;text-align:center;font-size:.9rem}.status-row[_ngcontent-%COMP%]{justify-content:space-between}.dropdown-divider[_ngcontent-%COMP%]{border:0;border-top:1px solid var(--border-color);margin:.4rem 0}.delete-text[_ngcontent-%COMP%]:hover{background:#fef2f2;color:#ef4444}.text-primary[_ngcontent-%COMP%]{color:var(--primary)}.text-danger[_ngcontent-%COMP%]{color:#ef4444}.menu-trigger[_ngcontent-%COMP%]{width:28px;height:28px;border-radius:6px;background:var(--bg-main);color:var(--text-muted);display:flex;align-items:center;justify-content:center;transition:all .2s;border:none;cursor:pointer}.menu-trigger[_ngcontent-%COMP%]:hover{background:#e2e8f0;color:var(--text-main)}.modal-overlay[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;background:#00000080;display:flex;align-items:center;justify-content:center;z-index:1000;-webkit-backdrop-filter:blur(4px);backdrop-filter:blur(4px)}.modal-content[_ngcontent-%COMP%]{background:var(--bg-card);border-radius:16px;width:90%;max-width:500px;max-height:90vh;overflow:hidden;box-shadow:var(--shadow-lg);animation:_ngcontent-%COMP%_modalSlideIn .3s ease}@keyframes _ngcontent-%COMP%_modalSlideIn{0%{opacity:0;transform:translateY(-20px)}to{opacity:1;transform:translateY(0)}}.modal-header[_ngcontent-%COMP%]{padding:1.25rem 1.5rem;border-bottom:1px solid var(--border-color);display:flex;align-items:center;justify-content:space-between;background:var(--bg-main)}.modal-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0;font-size:1.25rem;font-weight:700;color:var(--text-main)}.close-btn[_ngcontent-%COMP%]{background:none;border:none;font-size:1.75rem;color:var(--text-muted);cursor:pointer;width:32px;height:32px;display:flex;align-items:center;justify-content:center;border-radius:8px;transition:all .2s}.close-btn[_ngcontent-%COMP%]:hover{background:#e2e8f0;color:var(--text-main)}.modal-body[_ngcontent-%COMP%]{padding:1.5rem;overflow-y:auto;max-height:calc(90vh - 140px)}.service-form-modal[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]{margin-bottom:1.25rem}.service-form-modal[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]:last-child{margin-bottom:0}.service-form-modal[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;font-size:.75rem;font-weight:700;color:var(--text-muted);text-transform:uppercase;margin-bottom:.5rem}.modal-footer[_ngcontent-%COMP%]{display:flex;gap:.75rem;justify-content:flex-end;margin-top:1.5rem;padding-top:1.5rem;border-top:1px solid var(--border-color)}.modal-footer[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{padding:.65rem 1.5rem;border-radius:8px;font-weight:600;display:flex;align-items:center;gap:.5rem}.modal-loading-overlay[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;background:var(--bg-card-tp);display:flex;align-items:center;justify-content:center;z-index:1000;animation:_ngcontent-%COMP%_fadeInServicios .2s ease-out;border-radius:16px}.spinner-wrapper[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;gap:1rem}.spinner-circle[_ngcontent-%COMP%]{width:40px;height:40px;border:3px solid #f3f3f3;border-top:3px solid var(--primary);border-radius:50%;animation:_ngcontent-%COMP%_spin-servicios 1s linear infinite}@keyframes _ngcontent-%COMP%_spin-servicios{0%{transform:rotate(0)}to{transform:rotate(360deg)}}@keyframes _ngcontent-%COMP%_fadeInServicios{0%{opacity:0}to{opacity:1}}.empty-state[_ngcontent-%COMP%]{padding:4rem!important;text-align:center;color:#94a3b8;border:none!important}']})};var x5=(t,r)=>{let e=Ce(fr),n=Ce(ro);return e.getAccessToken()?!0:(n.navigate(["/login"]),!1)};var Yu=(t,r)=>{let e=Ce(fr),n=Ce(ro);return e.isAuthenticated()?e.can("MANAGE_DASHBOARD")?n.createUrlTree(["/dashboard"]):e.can("MANAGE_REPORT")?n.createUrlTree(["/reportes"]):e.can("VIEW_MEMBER_PANEL")?n.createUrlTree(["/integrantes"]):e.can("MANAGE_ATTENDANCE")?n.createUrlTree(["/asistencias/administrar"]):e.can("REGISTER_ATTENDANCE")?n.createUrlTree(["/asistencia"]):e.can("VIEW_USER_PANEL")?n.createUrlTree(["/usuarios"]):e.can("VIEW_ROLE_PANEL")?n.createUrlTree(["/roles"]):n.createUrlTree(["/login"]):n.createUrlTree(["/login"])};var oa=(t,r)=>{let e=Ce(fr),n=t.data.permission;return!n||e.can(n)?!0:Yu(t,r)};var Ku=class t{deferredPrompt;showInstallButton=!1;constructor(){window.addEventListener("beforeinstallprompt",r=>{r.preventDefault(),this.deferredPrompt=r,this.showInstallButton=!0,console.log("beforeinstallprompt fired. PWA install is available.")}),window.addEventListener("appinstalled",()=>{this.showInstallButton=!1,this.deferredPrompt=null,console.log("PWA was installed")})}isInstalled(){return window.matchMedia("(display-mode: standalone)").matches||window.navigator.standalone===!0}addToHomeScreen(){if(!this.deferredPrompt){console.log("Installation prompt not available");return}this.deferredPrompt.prompt(),this.deferredPrompt.userChoice.then(r=>{r.outcome==="accepted"?(console.log("User accepted the install prompt"),this.showInstallButton=!1):console.log("User dismissed the install prompt"),this.deferredPrompt=null})}static \u0275fac=function(e){return new(e||t)};static \u0275prov=nr({token:t,factory:t.\u0275fac,providedIn:"root"})};var qD=t=>({"sidebar-open":t});function GD(t,r){if(t&1){let e=Pe();d(0,"a",31),L("click",function(){D(e);let i=C();return N(i.close())}),j(1,"i",32),d(2,"span"),_(3,"Dashboard"),u()()}}function $D(t,r){if(t&1){let e=Pe();d(0,"a",33),L("click",function(){D(e);let i=C();return N(i.close())}),j(1,"i",34),d(2,"span"),_(3,"Reportes"),u()()}}function XD(t,r){if(t&1){let e=Pe();d(0,"a",35),L("click",function(){D(e);let i=C();return N(i.close())}),j(1,"i",36),d(2,"span"),_(3,"Gesti\xF3n de Integrantes"),u()()}}function YD(t,r){if(t&1){let e=Pe();d(0,"a",37),L("click",function(){D(e);let i=C();return N(i.close())}),j(1,"i",38),d(2,"span"),_(3,"Gesti\xF3n de Bautismos"),u()()}}function KD(t,r){if(t&1){let e=Pe();d(0,"a",39),L("click",function(){D(e);let i=C();return N(i.close())}),j(1,"i",40),d(2,"span"),_(3,"Gesti\xF3n de Asistencia"),u()()}}function ZD(t,r){if(t&1){let e=Pe();d(0,"a",41),L("click",function(){D(e);let i=C();return N(i.close())}),j(1,"i",42),d(2,"span"),_(3,"Gesti\xF3n de Usuarios"),u()()}}function JD(t,r){if(t&1){let e=Pe();d(0,"a",43),L("click",function(){D(e);let i=C();return N(i.close())}),j(1,"i",44),d(2,"span"),_(3,"Gesti\xF3n de Roles y Permisos"),u()()}}function QD(t,r){if(t&1){let e=Pe();d(0,"a",45),L("click",function(){D(e);let i=C();return N(i.close())}),j(1,"i",5),d(2,"span"),_(3,"Gesti\xF3n de Servicios"),u()()}}function eN(t,r){if(t&1){let e=Pe();d(0,"a",46),L("click",function(){D(e);let i=C();return N(i.close())}),j(1,"i",47),d(2,"span"),_(3,"Gesti\xF3n de Eventos"),u()()}}function tN(t,r){if(t&1){let e=Pe();d(0,"a",48),L("click",function(){D(e);let i=C();return N(i.close())}),j(1,"i",49),d(2,"span"),_(3,"Gesti\xF3n de Asistencias"),u()()}}function rN(t,r){if(t&1){let e=Pe();d(0,"a",50),L("click",function(){D(e);let i=C();return N(i.close())}),j(1,"i",51),d(2,"span"),_(3,"Gesti\xF3n de Sedes"),u()()}}function nN(t,r){if(t&1){let e=Pe();d(0,"a",52),L("click",function(){D(e);let i=C();return N(i.close())}),j(1,"i",53),d(2,"span"),_(3,"Configuraci\xF3n"),u()()}}function iN(t,r){if(t&1){let e=Pe();d(0,"button",54),L("click",function(){D(e);let i=C();return N(i.installApp())}),j(1,"i",55),d(2,"span"),_(3,"Instalar App"),u()()}}function aN(t,r){if(t&1){let e=Pe();d(0,"div",71),L("click",function(i){return D(e),N(i.stopPropagation())}),d(1,"div",72),j(2,"div",73),d(3,"p"),_(4,"Cambiando contrase\xF1a..."),u()()()}}function oN(t,r){t&1&&(d(0,"small",74),_(1," M\xEDnimo 8 caracteres. "),u())}function sN(t,r){t&1&&(d(0,"small",74),_(1," Las contrase\xF1as no coinciden. "),u())}function lN(t,r){if(t&1){let e=Pe();d(0,"div",56),L("click",function(){D(e);let i=C();return N(!i.isSavingPassword&&i.closeChangePasswordModal())}),fe(1,aN,5,0,"div",57),d(2,"div",58),L("click",function(i){return D(e),N(i.stopPropagation())}),d(3,"div",59)(4,"h2"),_(5,"Cambiar Contrase\xF1a"),u(),d(6,"button",60),L("click",function(){D(e);let i=C();return N(i.closeChangePasswordModal())}),_(7,"\xD7"),u()(),d(8,"div",61)(9,"form",62),L("ngSubmit",function(){D(e);let i=C();return N(i.onSubmitChangePassword())}),d(10,"div",63)(11,"label"),_(12,"Contrase\xF1a Anterior *"),u(),j(13,"input",64),u(),d(14,"div",63)(15,"label"),_(16,"Nueva Contrase\xF1a *"),u(),j(17,"input",65),fe(18,oN,2,0,"small",66),u(),d(19,"div",63)(20,"label"),_(21,"Confirmar Nueva Contrase\xF1a *"),u(),j(22,"input",67),fe(23,sN,2,0,"small",66),u(),d(24,"div",68)(25,"button",69),L("click",function(){D(e);let i=C();return N(i.closeChangePasswordModal())}),_(26,"Cancelar"),u(),d(27,"button",70),_(28," Guardar Cambios "),u()()()()()()}if(t&2){let e,n,i=C();g(),P("ngIf",i.isSavingPassword),g(5),P("disabled",i.isSavingPassword),g(3),P("formGroup",i.changePasswordForm),g(9),P("ngIf",((e=i.changePasswordForm.get("password"))==null||e.errors==null?null:e.errors.minlength)&&((e=i.changePasswordForm.get("password"))==null?null:e.touched)),g(5),P("ngIf",i.changePasswordForm.hasError("mismatch")&&((n=i.changePasswordForm.get("confirmPassword"))==null?null:n.touched)),g(2),P("disabled",i.isSavingPassword),g(2),P("disabled",i.changePasswordForm.invalid||i.isSavingPassword)}}var Zu=class t{isOpen=!1;closeSidebar=new Fn;fb=Ce(ks);notificationService=Ce(Kr);authService=Ce(fr);pwaService=Ce(Ku);showChangePasswordModal=!1;isSavingPassword=!1;changePasswordForm;constructor(){this.changePasswordForm=this.fb.group({oldPassword:["",[or.required]],password:["",[or.required,or.minLength(8)]],confirmPassword:["",[or.required,or.minLength(8)]]},{validators:this.passwordMatchValidator})}passwordMatchValidator(r){return r.get("password")?.value===r.get("confirmPassword")?.value?null:{mismatch:!0}}close(){this.closeSidebar.emit()}logout(){this.authService.logout()}can(r){return this.authService.can(r)}installApp(){this.pwaService.addToHomeScreen()}openChangePasswordModal(){this.changePasswordForm.reset(),this.showChangePasswordModal=!0,window.innerWidth<1024&&this.close()}closeChangePasswordModal(){this.showChangePasswordModal=!1,this.isSavingPassword=!1}onSubmitChangePassword(){if(this.changePasswordForm.invalid){this.notificationService.error("Por favor, verifique los campos");return}this.isSavingPassword=!0,this.authService.changgePassword(this.changePasswordForm.value).subscribe({next:()=>{this.notificationService.success("Contrase\xF1a actualizada exitosamente"),this.closeChangePasswordModal()},error:r=>{console.error("Error changing password:",r),this.isSavingPassword=!1}})}static \u0275fac=function(e){return new(e||t)};static \u0275cmp=ir({type:t,selectors:[["app-sidebar"]],inputs:{isOpen:"isOpen"},outputs:{closeSidebar:"closeSidebar"},decls:44,vars:17,consts:[[1,"sidebar",3,"ngClass"],[1,"mobile-close-btn",3,"click"],[1,"fa-solid","fa-times"],[1,"sidebar-header"],[1,"logo"],[1,"fa-solid","fa-church"],[1,"brand"],[1,"brand-line1"],[1,"brand-line2"],[1,"sidebar-nav"],[1,"nav-section"],[1,"section-title"],["routerLink","/dashboard","routerLinkActive","active","class","nav-item",3,"click",4,"ngIf"],["routerLink","/reportes","routerLinkActive","active","class","nav-item",3,"click",4,"ngIf"],["routerLink","/integrantes","routerLinkActive","active","class","nav-item",3,"click",4,"ngIf"],["routerLink","/bautismos","routerLinkActive","active","class","nav-item",3,"click",4,"ngIf"],["routerLink","/asistencia","routerLinkActive","active","class","nav-item",3,"click",4,"ngIf"],["routerLink","/usuarios","routerLinkActive","active","class","nav-item",3,"click",4,"ngIf"],["routerLink","/roles","routerLinkActive","active","class","nav-item",3,"click",4,"ngIf"],["routerLink","/servicios","routerLinkActive","active","class","nav-item",3,"click",4,"ngIf"],["routerLink","/eventos","routerLinkActive","active","class","nav-item",3,"click",4,"ngIf"],["routerLink","/asistencias/administrar","routerLinkActive","active","class","nav-item",3,"click",4,"ngIf"],["routerLink","/sedes","routerLinkActive","active","class","nav-item",3,"click",4,"ngIf"],["routerLink","/configuracion","routerLinkActive","active","class","nav-item",3,"click",4,"ngIf"],[1,"sidebar-footer"],["class","nav-item btn-install-app",3,"click",4,"ngIf"],[1,"nav-item","password-btn",3,"click"],[1,"fa-solid","fa-key"],[1,"nav-item","logout-btn",3,"click"],[1,"fa-solid","fa-right-from-bracket"],["class","modal-overlay",3,"click",4,"ngIf"],["routerLink","/dashboard","routerLinkActive","active",1,"nav-item",3,"click"],[1,"fa-solid","fa-gauge"],["routerLink","/reportes","routerLinkActive","active",1,"nav-item",3,"click"],[1,"fa-solid","fa-chart-line"],["routerLink","/integrantes","routerLinkActive","active",1,"nav-item",3,"click"],[1,"fa-solid","fa-users"],["routerLink","/bautismos","routerLinkActive","active",1,"nav-item",3,"click"],[1,"fa-solid","fa-water"],["routerLink","/asistencia","routerLinkActive","active",1,"nav-item",3,"click"],[1,"fa-solid","fa-calendar-check"],["routerLink","/usuarios","routerLinkActive","active",1,"nav-item",3,"click"],[1,"fa-solid","fa-user-gear"],["routerLink","/roles","routerLinkActive","active",1,"nav-item",3,"click"],[1,"fa-solid","fa-user-shield"],["routerLink","/servicios","routerLinkActive","active",1,"nav-item",3,"click"],["routerLink","/eventos","routerLinkActive","active",1,"nav-item",3,"click"],[1,"fa-solid","fa-calendar-days"],["routerLink","/asistencias/administrar","routerLinkActive","active",1,"nav-item",3,"click"],[1,"fa-solid","fa-clipboard-list"],["routerLink","/sedes","routerLinkActive","active",1,"nav-item",3,"click"],[1,"fa-solid","fa-map-location-dot"],["routerLink","/configuracion","routerLinkActive","active",1,"nav-item",3,"click"],[1,"fa-solid","fa-gear"],[1,"nav-item","btn-install-app",3,"click"],[1,"fa-solid","fa-download"],[1,"modal-overlay",3,"click"],["class","modal-loading-overlay",3,"click",4,"ngIf"],[1,"modal-content","modal-sm",3,"click"],[1,"modal-header"],[1,"close-btn",3,"click","disabled"],[1,"modal-body"],[3,"ngSubmit","formGroup"],[1,"form-group"],["type","password","formControlName","oldPassword","placeholder","Ingrese su contrase\xF1a actual",1,"form-control"],["type","password","formControlName","password","placeholder","M\xEDnimo 8 caracteres",1,"form-control"],["class","text-error",4,"ngIf"],["type","password","formControlName","confirmPassword","placeholder","Repita la nueva contrase\xF1a",1,"form-control"],[1,"modal-footer"],["type","button",1,"btn","btn-muted",3,"click","disabled"],["type","submit",1,"btn","btn-primary",3,"disabled"],[1,"modal-loading-overlay",3,"click"],[1,"spinner-wrapper"],[1,"spinner-circle"],[1,"text-error"]],template:function(e,n){e&1&&(d(0,"aside",0)(1,"button",1),L("click",function(){return n.close()}),j(2,"i",2),u(),d(3,"div",3)(4,"div",4),j(5,"i",5),u(),d(6,"div",6)(7,"span",7),_(8,"I.C.C"),u(),d(9,"span",8),_(10,"TABERN\xC1CULO DE ADORACI\xD3N"),u()()(),d(11,"nav",9)(12,"div",10)(13,"h3",11),_(14,"PRINCIPAL"),u(),fe(15,GD,4,0,"a",12)(16,$D,4,0,"a",13),u(),d(17,"div",10)(18,"h3",11),_(19,"GESTI\xD3N DE INTEGRANTES"),u(),fe(20,XD,4,0,"a",14)(21,YD,4,0,"a",15)(22,KD,4,0,"a",16),u(),d(23,"div",10)(24,"h3",11),_(25,"ADMINISTRACI\xD3N"),u(),fe(26,ZD,4,0,"a",17)(27,JD,4,0,"a",18)(28,QD,4,0,"a",19)(29,eN,4,0,"a",20)(30,tN,4,0,"a",21)(31,rN,4,0,"a",22)(32,nN,4,0,"a",23),u()(),d(33,"div",24),fe(34,iN,4,0,"button",25),d(35,"button",26),L("click",function(){return n.openChangePasswordModal()}),j(36,"i",27),d(37,"span"),_(38,"Cambiar Contrase\xF1a"),u()(),d(39,"button",28),L("click",function(){return n.logout()}),j(40,"i",29),d(41,"span"),_(42,"Cerrar Sesi\xF3n"),u()()()(),fe(43,lN,29,7,"div",30)),e&2&&(P("ngClass",a1(15,qD,n.isOpen)),g(15),P("ngIf",n.can("MANAGE_DASHBOARD")),g(),P("ngIf",n.can("MANAGE_REPORT")),g(4),P("ngIf",n.can("VIEW_MEMBER_PANEL")),g(),P("ngIf",n.can("VIEW_BAPTISM_PANEL")),g(),P("ngIf",n.can("REGISTER_ATTENDANCE")),g(4),P("ngIf",n.can("VIEW_USER_PANEL")),g(),P("ngIf",n.can("VIEW_ROLE_PANEL")),g(),P("ngIf",n.can("VIEW_SERVICE_PANEL")),g(),P("ngIf",n.can("VIEW_EVENTS_PANEL")),g(),P("ngIf",n.can("MANAGE_ATTENDANCE")),g(),P("ngIf",n.can("VIEW_BRANCH_PANEL")),g(),P("ngIf",n.can("ADMINISTRATOR")),g(2),P("ngIf",n.pwaService.showInstallButton),g(9),P("ngIf",n.showChangePasswordModal))},dependencies:[Qd,y1,gr,Tr,mr,Es,xa,nn,an,va,Ss,Cs],styles:[".sidebar[_ngcontent-%COMP%]{width:var(--sidebar-width);height:100vh;height:100dvh;background-color:var(--bg-sidebar);border-right:1px solid var(--border-color);display:flex;flex-direction:column;position:fixed;left:0;top:0;z-index:1000;transition:transform .3s ease}@media(max-width:767px){.sidebar[_ngcontent-%COMP%]{transform:translate(-100%)}.sidebar.sidebar-open[_ngcontent-%COMP%]{transform:translate(0)}}.mobile-close-btn[_ngcontent-%COMP%]{display:none;position:absolute;top:1rem;right:1rem;background:var(--bg-input);border:none;width:2rem;height:2rem;border-radius:50%;align-items:center;justify-content:center;cursor:pointer;color:var(--text-muted);font-size:1.25rem;z-index:10;transition:all .2s}.mobile-close-btn[_ngcontent-%COMP%]:hover{background:var(--border-color);color:var(--text-main)}@media(max-width:767px){.mobile-close-btn[_ngcontent-%COMP%]{display:flex}}.sidebar-header[_ngcontent-%COMP%]{padding:.75rem .5rem;display:flex;flex-direction:column;align-items:center;gap:.4rem;border-bottom:1px solid var(--border-color)}.logo[_ngcontent-%COMP%]{width:2.125rem;height:2.125rem;background:linear-gradient(135deg,var(--primary),var(--primary-dark));border-radius:9px;display:flex;align-items:center;justify-content:center;color:#fff;font-size:1.1rem;box-shadow:0 4px 6px -1px #3b82f64d}.brand[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;text-align:center}.brand-line1[_ngcontent-%COMP%]{font-weight:700;font-size:1rem;color:var(--primary)}.brand-line2[_ngcontent-%COMP%]{font-size:.6rem;font-weight:600;color:var(--text-muted);line-height:1.2;margin-top:2px}.sidebar-nav[_ngcontent-%COMP%]{flex:1;padding:1rem 0 0;overflow-y:auto}.nav-section[_ngcontent-%COMP%]{margin-bottom:1.25rem}.section-title[_ngcontent-%COMP%]{padding:0 1.5rem;font-size:.65rem;font-weight:700;color:var(--text-muted);margin-bottom:.5rem;text-transform:uppercase;letter-spacing:.05em}.nav-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;padding:.4rem 1rem;color:var(--text-main);font-size:.75rem;font-weight:500;transition:all var(--transition-speed);text-decoration:none}.nav-item[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{width:16px;text-align:center;font-size:.9rem;color:var(--text-muted);transition:color var(--transition-speed)}.nav-item[_ngcontent-%COMP%]:hover{background-color:var(--bg-input);color:var(--primary)}.nav-item[_ngcontent-%COMP%]:hover   i[_ngcontent-%COMP%]{color:var(--primary)}.nav-item.active[_ngcontent-%COMP%]{background-color:var(--bg-main);color:var(--primary);border-right:3px solid var(--primary);font-weight:600}.nav-item.active[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:var(--primary)}.nav-item.disabled[_ngcontent-%COMP%]{opacity:.5;cursor:not-allowed}.sidebar-footer[_ngcontent-%COMP%]{padding:1rem;border-top:1px solid var(--border-color)}.password-btn[_ngcontent-%COMP%]{width:100%;background:none;border:none;cursor:pointer;padding:.4rem 1rem;display:flex;align-items:center;gap:.5rem;color:var(--text-main);font-size:.75rem;font-weight:500;transition:all var(--transition-speed)}.password-btn[_ngcontent-%COMP%]:hover{background-color:var(--bg-input);color:var(--primary)}.password-btn[_ngcontent-%COMP%]:hover   i[_ngcontent-%COMP%]{color:var(--primary)}.logout-btn[_ngcontent-%COMP%]{width:100%;background:none;border:none;cursor:pointer;padding:.4rem 1rem;display:flex;align-items:center;gap:.5rem;color:var(--text-main);font-size:.75rem;font-weight:500;transition:all var(--transition-speed)}.logout-btn[_ngcontent-%COMP%]:hover{background-color:var(--danger-bg);color:#ef4444}.logout-btn[_ngcontent-%COMP%]:hover   i[_ngcontent-%COMP%]{color:#ef4444}.btn-install-app[_ngcontent-%COMP%]{color:var(--primary)!important;background:var(--bg-main)!important;margin-bottom:.5rem;border-radius:8px;margin-left:.5rem;margin-right:.5rem;width:calc(100% - 1rem);justify-content:center}.btn-install-app[_ngcontent-%COMP%]:hover{background:var(--bg-input)!important}.modal-overlay[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;background:#00000080;display:flex;align-items:center;justify-content:center;z-index:9999;animation:_ngcontent-%COMP%_fadeIn .2s ease-out;-webkit-backdrop-filter:blur(4px);backdrop-filter:blur(4px)}.modal-content[_ngcontent-%COMP%]{background:var(--bg-card);border-radius:16px;width:90%;max-width:600px;max-height:90vh;overflow:hidden;display:flex;flex-direction:column;box-shadow:var(--shadow-md);animation:_ngcontent-%COMP%_slideUp .3s ease-out;position:relative;padding:0}.modal-content.modal-sm[_ngcontent-%COMP%]{max-width:450px}.modal-header[_ngcontent-%COMP%]{padding:1.25rem 1.5rem;border-bottom:1px solid var(--border-color);display:flex;justify-content:space-between;align-items:center;background:var(--bg-input)}.modal-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:1.1rem;font-weight:700;color:var(--text-main);margin:0}.close-btn[_ngcontent-%COMP%]{background:none;border:none;font-size:1.5rem;line-height:1;cursor:pointer;color:var(--text-muted);transition:color .2s;padding:.5rem}.close-btn[_ngcontent-%COMP%]:hover{color:var(--text-main)}.modal-body[_ngcontent-%COMP%]{padding:1.5rem;overflow-y:auto}.modal-footer[_ngcontent-%COMP%]{padding:1.25rem 1.5rem;border-top:1px solid var(--border-color);display:flex;justify-content:flex-end;gap:1rem;background:var(--bg-card)}.form-group[_ngcontent-%COMP%]{margin-bottom:1.25rem}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;font-size:.75rem;font-weight:700;color:var(--text-muted);text-transform:uppercase;margin-bottom:.5rem;letter-spacing:.025em}.form-control[_ngcontent-%COMP%]{width:100%;padding:.75rem 1rem;background:var(--bg-input);border:1px solid var(--border-color);border-radius:8px;font-size:.9rem;color:var(--text-main);transition:all .2s;font-family:inherit}.form-control[_ngcontent-%COMP%]:focus{outline:none;border-color:var(--primary);background:var(--bg-card);box-shadow:0 0 0 3px #3b82f61a}.text-error[_ngcontent-%COMP%]{color:#ef4444;font-size:.75rem;margin-top:.25rem;display:block}.modal-loading-overlay[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100vw;height:100vh;background:#000000b3;display:flex;align-items:center;justify-content:center;z-index:10000;-webkit-backdrop-filter:blur(4px);backdrop-filter:blur(4px);animation:_ngcontent-%COMP%_fadeIn .2s ease-out}.spinner-wrapper[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;gap:1rem}.spinner-circle[_ngcontent-%COMP%]{width:40px;height:40px;border:3px solid var(--border-color);border-top-color:var(--primary);border-radius:50%;animation:_ngcontent-%COMP%_spin .8s linear infinite}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0}to{opacity:1}}@keyframes _ngcontent-%COMP%_slideUp{0%{transform:translateY(20px);opacity:0}to{transform:translateY(0);opacity:1}}@keyframes _ngcontent-%COMP%_spin{to{transform:rotate(360deg)}}"]})};function cN(t,r){if(t&1&&(d(0,"div",8)(1,"div",9)(2,"span",10),_(3),u(),d(4,"span",11),_(5),u()(),d(6,"div",12),j(7,"img",13),u()()),t&2){let e=r.ngIf;g(3),be(e.completeName),g(2),be(e.username),g(2),P("src",e.pictureProfileUrl||"https://ui-avatars.com/api/?name="+e.completeName+"&background=3b82f6&color=fff",pn)}}var Ju=class t{toggleSidebar=new Fn;authService=Ce(fr);themeService=Ce(Hs);onToggleSidebar(){this.toggleSidebar.emit()}static \u0275fac=function(e){return new(e||t)};static \u0275cmp=ir({type:t,selectors:[["app-topbar"]],outputs:{toggleSidebar:"toggleSidebar"},decls:8,vars:3,consts:[[1,"topbar"],[1,"topbar-left"],[1,"hamburger-btn",3,"click"],[1,"fa-solid","fa-bars"],[1,"topbar-right"],[1,"theme-toggle-btn",3,"click","title"],[1,"fa-solid",3,"ngClass"],["class","user-info",4,"ngIf"],[1,"user-info"],[1,"user-text"],[1,"complete-name"],[1,"user-name"],[1,"user-avatar"],["alt","Avatar",3,"src"]],template:function(e,n){e&1&&(d(0,"header",0)(1,"div",1)(2,"button",2),L("click",function(){return n.onToggleSidebar()}),j(3,"i",3),u()(),d(4,"div",4)(5,"button",5),L("click",function(){return n.themeService.toggleTheme()}),j(6,"i",6),u(),fe(7,cN,8,3,"div",7),u()()),e&2&&(g(5),P("title",n.themeService.isDarkMode()?"Cambiar a modo claro":"Cambiar a modo oscuro"),g(),P("ngClass",n.themeService.isDarkMode()?"fa-sun":"fa-moon"),g(),P("ngIf",n.authService.currentUser()))},dependencies:[gr,Tr,mr],styles:[".topbar[_ngcontent-%COMP%]{height:var(--header-height);background-color:var(--bg-card);padding:0 2rem;display:flex;align-items:center;justify-content:space-between;box-shadow:var(--shadow-sm);position:fixed;top:0;right:0;left:var(--sidebar-width);z-index:90;transition:left .3s ease}@media(max-width:767px){.topbar[_ngcontent-%COMP%]{left:0;padding:0 1rem}}.topbar-left[_ngcontent-%COMP%]{display:flex;align-items:center}.hamburger-btn[_ngcontent-%COMP%]{display:none;background:none;border:none;font-size:1.5rem;color:var(--text-main);cursor:pointer;padding:.5rem;border-radius:8px;transition:all .2s}.hamburger-btn[_ngcontent-%COMP%]:hover{background:var(--bg-input);color:var(--primary)}@media(max-width:767px){.hamburger-btn[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center}}.page-title[_ngcontent-%COMP%]{font-size:1.5rem;font-weight:700;color:var(--text-main)}.topbar-right[_ngcontent-%COMP%]{display:flex;align-items:center;gap:1.5rem}.theme-toggle-btn[_ngcontent-%COMP%]{width:2.25rem;height:2.25rem;display:flex;align-items:center;justify-content:center;border-radius:10px;background:var(--bg-input);color:var(--text-main);font-size:1rem;transition:all .2s cubic-bezier(.4,0,.2,1);box-shadow:var(--shadow-sm)}.theme-toggle-btn[_ngcontent-%COMP%]:hover{background:var(--border-color);transform:translateY(-1px);color:var(--primary)}.theme-toggle-btn[_ngcontent-%COMP%]:active{transform:translateY(0)}.user-info[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.75rem}.user-text[_ngcontent-%COMP%]{display:flex;flex-direction:column;text-align:right}.complete-name[_ngcontent-%COMP%]{font-weight:700;font-size:.95rem;color:var(--text-main)}.user-name[_ngcontent-%COMP%]{font-weight:600;font-size:.75rem;color:var(--text-muted)}.user-role[_ngcontent-%COMP%]{font-size:.75rem;font-weight:600;color:var(--text-muted)}.user-avatar[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:2.5rem;height:2.5rem;border-radius:50%;object-fit:cover;border:2px solid var(--border-color)}"]})};function dN(t,r){if(t&1){let e=Pe();d(0,"div",5),L("click",function(){D(e);let i=C();return N(i.closeSidebar())}),u()}}var hd=class t{isSidebarOpen=!1;toggleSidebar(){this.isSidebarOpen=!this.isSidebarOpen}closeSidebar(){this.isSidebarOpen=!1}static \u0275fac=function(e){return new(e||t)};static \u0275cmp=ir({type:t,selectors:[["app-main-layout"]],decls:6,vars:2,consts:[["class","mobile-backdrop",3,"click",4,"ngIf"],[3,"closeSidebar","isOpen"],[1,"main-content"],[3,"toggleSidebar"],[1,"page-container"],[1,"mobile-backdrop",3,"click"]],template:function(e,n){e&1&&(fe(0,dN,1,0,"div",0),d(1,"app-sidebar",1),L("closeSidebar",function(){return n.closeSidebar()}),u(),d(2,"div",2)(3,"app-topbar",3),L("toggleSidebar",function(){return n.toggleSidebar()}),u(),d(4,"main",4),j(5,"router-outlet"),u()()),e&2&&(P("ngIf",n.isSidebarOpen),g(),P("isOpen",n.isSidebarOpen))},dependencies:[gr,mr,Jd,Zu,Ju],styles:[".mobile-backdrop[_ngcontent-%COMP%]{display:none;position:fixed;top:0;left:0;width:100%;height:100%;background:#00000080;z-index:999;-webkit-backdrop-filter:blur(2px);backdrop-filter:blur(2px)}@media(max-width:767px){.mobile-backdrop[_ngcontent-%COMP%]{display:block}}.main-content[_ngcontent-%COMP%]{margin-left:var(--sidebar-width);padding-top:var(--header-height);height:100vh;height:100dvh;display:flex;flex-direction:column;overflow:hidden;position:relative;transition:margin-left .3s ease}@media(max-width:767px){.main-content[_ngcontent-%COMP%]{margin-left:0}}.page-container[_ngcontent-%COMP%]{flex:1;padding:.75rem;background-color:var(--bg-main);overflow-y:auto;overflow-x:hidden;display:flex;flex-direction:column;min-height:0;-webkit-overflow-scrolling:touch}.page-container[_ngcontent-%COMP%]::-webkit-scrollbar{width:8px}.page-container[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:transparent}.page-container[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:var(--border-color);border-radius:10px;border:2px solid var(--bg-main)}.page-container[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:var(--text-muted)}"]})};var b5=[{path:"",redirectTo:"dashboard",pathMatch:"full"},{path:"login",component:qu},{path:"",component:hd,canActivate:[x5],children:[{path:"dashboard",component:Hu,canActivate:[oa],data:{permission:"MANAGE_DASHBOARD"}},{path:"integrantes",component:wu,canActivate:[oa],data:{permission:"VIEW_MEMBER_PANEL"}},{path:"bautismos",component:Uu,canActivate:[oa],data:{permission:"VIEW_BAPTISM_PANEL"}},{path:"asistencia",component:yu,canActivate:[oa],data:{permission:"REGISTER_ATTENDANCE"}},{path:"asistencias/administrar",component:Cu,canActivate:[oa],data:{permission:"MANAGE_ATTENDANCE"}},{path:"reportes",component:Ru,canActivate:[oa],data:{permission:"MANAGE_REPORT"}},{path:"usuarios",component:$u,canActivate:[oa],data:{permission:"VIEW_USER_PANEL"}},{path:"servicios",component:Xu,canActivate:[oa],data:{permission:"VIEW_SERVICE_PANEL"}},{path:"sedes",loadComponent:()=>import("./chunk-F52DAHQQ.js").then(t=>t.Sedes),canActivate:[oa],data:{permission:"VIEW_BRANCH_PANEL"}},{path:"eventos",loadComponent:()=>import("./chunk-DZCPKJLB.js").then(t=>t.Eventos),canActivate:[oa],data:{permission:"VIEW_EVENTS_PANEL"}},{path:"roles",component:Wu,canActivate:[oa],data:{permission:"VIEW_ROLE_PANEL"}},{path:"configuracion",component:zu,canActivate:[oa],data:{permission:"ADMINISTRATOR"}}]},{path:"**",canActivate:[Yu],component:hd}];var rg="Service workers are disabled or not supported by this browser",Rc=class{serviceWorker;worker;registration;events;constructor(r,e){if(this.serviceWorker=r,!r)this.worker=this.events=this.registration=new Do(n=>n.error(new ol(5601,!1)));else{let n=null,i=new Bt;this.worker=new Do(c=>(n!==null&&c.next(n),i.subscribe(f=>c.next(f))));let a=()=>{let{controller:c}=r;c!==null&&(n=c,i.next(n))};r.addEventListener("controllerchange",a),a(),this.registration=this.worker.pipe(Zi(()=>r.getRegistration().then(c=>{if(!c)throw new ol(5601,!1);return c})));let o=new Bt;this.events=o.asObservable();let s=c=>{let{data:f}=c;f?.type&&o.next(f)};r.addEventListener("message",s),e?.get(ql,null,{optional:!0})?.onDestroy(()=>{r.removeEventListener("controllerchange",a),r.removeEventListener("message",s)})}}postMessage(r,e){return new Promise(n=>{this.worker.pipe(eo(1)).subscribe(i=>{i.postMessage(Yr({action:r},e)),n()})})}postMessageWithOperation(r,e,n){let i=this.waitForOperationCompleted(n),a=this.postMessage(r,e);return Promise.all([a,i]).then(([,o])=>o)}generateNonce(){return Math.round(Math.random()*1e7)}eventsOfType(r){let e;return typeof r=="string"?e=n=>n.type===r:e=n=>r.includes(n.type),this.events.pipe(al(e))}nextEventOfType(r){return this.eventsOfType(r).pipe(eo(1))}waitForOperationCompleted(r){return new Promise((e,n)=>{this.eventsOfType("OPERATION_COMPLETED").pipe(al(i=>i.nonce===r),eo(1),No(i=>{if(i.result!==void 0)return i.result;throw new Error(i.error)})).subscribe({next:e,error:n})})}get isEnabled(){return!!this.serviceWorker}},fN=(()=>{class t{sw;messages;notificationClicks;notificationCloses;pushSubscriptionChanges;subscription;get isEnabled(){return this.sw.isEnabled}pushManager=null;subscriptionChanges=new Bt;constructor(e){if(this.sw=e,!e.isEnabled){this.messages=ps,this.notificationClicks=ps,this.notificationCloses=ps,this.pushSubscriptionChanges=ps,this.subscription=ps;return}this.messages=this.sw.eventsOfType("PUSH").pipe(No(i=>i.data)),this.notificationClicks=this.sw.eventsOfType("NOTIFICATION_CLICK").pipe(No(i=>i.data)),this.notificationCloses=this.sw.eventsOfType("NOTIFICATION_CLOSE").pipe(No(i=>i.data)),this.pushSubscriptionChanges=this.sw.eventsOfType("PUSH_SUBSCRIPTION_CHANGE").pipe(No(i=>i.data)),this.pushManager=this.sw.registration.pipe(No(i=>i.pushManager));let n=this.pushManager.pipe(Zi(i=>i.getSubscription()));this.subscription=new Do(i=>{let a=n.subscribe(i),o=this.subscriptionChanges.subscribe(i);return()=>{a.unsubscribe(),o.unsubscribe()}})}requestSubscription(e){if(!this.sw.isEnabled||this.pushManager===null)return Promise.reject(new Error(rg));let n={userVisibleOnly:!0},i=this.decodeBase64(e.serverPublicKey.replace(/_/g,"/").replace(/-/g,"+")),a=new Uint8Array(new ArrayBuffer(i.length));for(let o=0;o<i.length;o++)a[o]=i.charCodeAt(o);return n.applicationServerKey=a,new Promise((o,s)=>{this.pushManager.pipe(Zi(l=>l.subscribe(n)),eo(1)).subscribe({next:l=>{this.subscriptionChanges.next(l),o(l)},error:s})})}unsubscribe(){if(!this.sw.isEnabled)return Promise.reject(new Error(rg));let e=n=>{if(n===null)throw new ol(5602,!1);return n.unsubscribe().then(i=>{if(!i)throw new ol(5603,!1);this.subscriptionChanges.next(null)})};return new Promise((n,i)=>{this.subscription.pipe(eo(1),Zi(e)).subscribe({next:n,error:i})})}decodeBase64(e){return atob(e)}static \u0275fac=function(n){return new(n||t)(c0(Rc))};static \u0275prov=nr({token:t,factory:t.\u0275fac})}return t})(),uN=(()=>{class t{sw;versionUpdates;unrecoverable;get isEnabled(){return this.sw.isEnabled}ongoingCheckForUpdate=null;constructor(e){if(this.sw=e,!e.isEnabled){this.versionUpdates=ps,this.unrecoverable=ps;return}this.versionUpdates=this.sw.eventsOfType(["VERSION_DETECTED","VERSION_INSTALLATION_FAILED","VERSION_READY","NO_NEW_VERSION_DETECTED"]),this.unrecoverable=this.sw.eventsOfType("UNRECOVERABLE_STATE")}checkForUpdate(){if(!this.sw.isEnabled)return Promise.reject(new Error(rg));if(this.ongoingCheckForUpdate)return this.ongoingCheckForUpdate;let e=this.sw.generateNonce();return this.ongoingCheckForUpdate=this.sw.postMessageWithOperation("CHECK_FOR_UPDATES",{nonce:e},e).finally(()=>{this.ongoingCheckForUpdate=null}),this.ongoingCheckForUpdate}activateUpdate(){if(!this.sw.isEnabled)return Promise.reject(new ol(5601,!1));let e=this.sw.generateNonce();return this.sw.postMessageWithOperation("ACTIVATE_UPDATE",{nonce:e},e)}static \u0275fac=function(n){return new(n||t)(c0(Rc))};static \u0275prov=nr({token:t,factory:t.\u0275fac})}return t})(),y5=new pa("");function hN(){let t=Ce(pd);if(!("serviceWorker"in navigator&&t.enabled!==!1))return;let r=Ce(y5),e=Ce(ma),n=Ce(ql);e.runOutsideAngular(()=>{let i=navigator.serviceWorker,a=()=>i.controller?.postMessage({action:"INITIALIZE"});i.addEventListener("controllerchange",a),n.onDestroy(()=>{i.removeEventListener("controllerchange",a)})}),e.runOutsideAngular(()=>{let i,{registrationStrategy:a}=t;if(typeof a=="function")i=new Promise(o=>a().subscribe(()=>o()));else{let[o,...s]=(a||"registerWhenStable:30000").split(":");switch(o){case"registerImmediately":i=Promise.resolve();break;case"registerWithDelay":i=w5(+s[0]||0);break;case"registerWhenStable":i=Promise.race([n.whenStable(),w5(+s[0])]);break;default:throw new ol(5600,!1)}}i.then(()=>{n.destroyed||navigator.serviceWorker.register(r,{scope:t.scope,updateViaCache:t.updateViaCache,type:t.type}).catch(o=>console.error(Gg(5604,!1)))})})}function w5(t){return new Promise(r=>setTimeout(r,t))}function pN(){let t=Ce(pd),r=Ce(La),e=!0;return new Rc(e&&t.enabled!==!1?navigator.serviceWorker:void 0,r)}var pd=class{enabled;updateViaCache;type;scope;registrationStrategy};function C5(t,r={}){return $g([fN,uN,{provide:y5,useValue:t},{provide:pd,useValue:r},{provide:Rc,useFactory:pN},Qg(hN)])}function mN(t){let r=t,e=Math.floor(Math.abs(t)),n=t.toString().replace(/^[^.]*\.?/,"").length,i=parseInt(t.toString().replace(/^[^e]*(e([-+]?\d+))?/,"$2"))||0;return r===1?1:i===0&&e!==0&&e%1e6===0&&n===0||!(i>=0&&i<=5)?4:5}var S5=["es",[["a.\u202Fm.","p.\u202Fm."],void 0,["a.\xA0m.","p.\xA0m."]],void 0,[["D","L","M","X","J","V","S"],["dom","lun","mar","mi\xE9","jue","vie","s\xE1b"],["domingo","lunes","martes","mi\xE9rcoles","jueves","viernes","s\xE1bado"],["DO","LU","MA","MI","JU","VI","SA"]],void 0,[["E","F","M","A","M","J","J","A","S","O","N","D"],["ene","feb","mar","abr","may","jun","jul","ago","sept","oct","nov","dic"],["enero","febrero","marzo","abril","mayo","junio","julio","agosto","septiembre","octubre","noviembre","diciembre"]],void 0,[["a. C.","d. C."],void 0,["antes de Cristo","despu\xE9s de Cristo"]],1,[6,0],["d/M/yy","d MMM y","d 'de' MMMM 'de' y","EEEE, d 'de' MMMM 'de' y"],["H:mm","H:mm:ss","H:mm:ss z","H:mm:ss (zzzz)"],["{1}, {0}",void 0,void 0,void 0],[",",".",";","%","+","-","E","\xD7","\u2030","\u221E","NaN",":"],["#,##0.###","#,##0\xA0%","#,##0.00\xA0\xA4","#E0"],"EUR","\u20AC","euro",{AUD:[void 0,"$"],BRL:[void 0,"R$"],BYN:[void 0,"\u0440."],CAD:[void 0,"$"],CNY:[void 0,"\xA5"],EGP:[void 0,"EGP"],ESP:["\u20A7"],GBP:[void 0,"\xA3"],HKD:[void 0,"$"],ILS:[void 0,"\u20AA"],INR:[void 0,"\u20B9"],JPY:[void 0,"\xA5"],KRW:[void 0,"\u20A9"],MXN:[void 0,"$"],NZD:[void 0,"$"],PHP:[void 0,"\u20B1"],RON:[void 0,"L"],THB:["\u0E3F"],TWD:[void 0,"NT$"],USD:["US$","$"],XAF:[],XCD:[void 0,"$"],XOF:[]},"ltr",mN];_1(S5);function gN(t){return()=>t.initialize()}var k5={providers:[c1({eventCoalescing:!0}),C1(b5),b1(w1([k1,E1])),{provide:o1,useValue:"es"},{provide:Jg,useFactory:gN,deps:[fr],multi:!0},C5("ngsw-worker.js",{enabled:!d1(),registrationStrategy:"registerWhenStable:30000"})]};function _N(t,r){if(t&1&&(d(0,"div",8),j(1,"div",9),u()),t&2){let e=C().$implicit;g(),Ft("animation-duration",e.duration,"ms")}}function vN(t,r){if(t&1){let e=Pe();d(0,"div",3),L("click",function(){let i=D(e).$implicit,a=C(2);return N(a.remove(i.id))}),d(1,"div",4),j(2,"i"),u(),d(3,"div",5)(4,"p"),_(5),u()(),fe(6,_N,2,2,"div",6),d(7,"button",7),_(8,"\xD7"),u()()}if(t&2){let e=r.$implicit,n=C(2);P("ngClass",e.type),g(2),Kd(n.getIcon(e.type)),g(3),be(e.message),g(),P("ngIf",e.duration)}}function xN(t,r){if(t&1&&(d(0,"div",1),fe(1,vN,9,5,"div",2),Cr(2,"async"),u()),t&2){let e=C();g(),P("ngForOf",xs(2,1,e.toasts$))}}var Qu=class t{notificationService=Ce(Kr);router=Ce(ro);toasts$=this.notificationService.toasts$;get isLoginPage(){return this.router.url==="/login"||this.router.url==="/"}remove(r){this.notificationService.remove(r)}getIcon(r){switch(r){case"success":return"fa-solid fa-circle-check";case"error":return"fa-solid fa-circle-xmark";case"warning":return"fa-solid fa-triangle-exclamation";case"info":return"fa-solid fa-circle-info";default:return"fa-solid fa-bell"}}static \u0275fac=function(e){return new(e||t)};static \u0275cmp=ir({type:t,selectors:[["app-toast-container"]],decls:1,vars:1,consts:[["class","toast-container",4,"ngIf"],[1,"toast-container"],["class","toast-item",3,"ngClass","click",4,"ngFor","ngForOf"],[1,"toast-item",3,"click","ngClass"],[1,"toast-icon"],[1,"toast-content"],["class","toast-progress",4,"ngIf"],[1,"toast-close"],[1,"toast-progress"],[1,"progress-bar"]],template:function(e,n){e&1&&fe(0,xN,3,3,"div",0),e&2&&P("ngIf",!n.isLoginPage)},dependencies:[gr,Tr,rn,mr,h1],styles:[".toast-container[_ngcontent-%COMP%]{position:fixed;top:1.5rem;right:1.5rem;z-index:9999;display:flex;flex-direction:column;gap:.75rem;pointer-events:none}.toast-item[_ngcontent-%COMP%]{pointer-events:auto;width:320px;background:#fffffff2;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);border-radius:12px;box-shadow:0 10px 30px -5px #00000026;display:flex;align-items:center;padding:1rem;position:relative;overflow:hidden;cursor:pointer;transition:all .3s cubic-bezier(.4,0,.2,1);border:1px solid rgba(255,255,255,.3);animation:_ngcontent-%COMP%_toast-in .4s cubic-bezier(.175,.885,.32,1.275)}.toast-item[_ngcontent-%COMP%]:hover{transform:translate(-5px);filter:brightness(1.02)}@keyframes _ngcontent-%COMP%_toast-in{0%{transform:translate(100%);opacity:0}to{transform:translate(0);opacity:1}}.toast-icon[_ngcontent-%COMP%]{width:32px;height:32px;border-radius:50%;display:flex;align-items:center;justify-content:center;margin-right:.75rem;flex-shrink:0}.toast-content[_ngcontent-%COMP%]{flex:1}.toast-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;font-size:.9rem;font-weight:600;color:#1e293b;line-height:1.4}.toast-close[_ngcontent-%COMP%]{background:none;border:none;font-size:1.25rem;color:#94a3b8;cursor:pointer;padding:0 .5rem;transition:color .2s}.toast-close[_ngcontent-%COMP%]:hover{color:#64748b}.toast-item.success[_ngcontent-%COMP%]{border-left:4px solid #10b981}.toast-item.success[_ngcontent-%COMP%]   .toast-icon[_ngcontent-%COMP%]{background:#d1fae5;color:#10b981}.toast-item.error[_ngcontent-%COMP%]{border-left:4px solid #ef4444}.toast-item.error[_ngcontent-%COMP%]   .toast-icon[_ngcontent-%COMP%]{background:#fee2e2;color:#ef4444}.toast-item.warning[_ngcontent-%COMP%]{border-left:4px solid #f59e0b}.toast-item.warning[_ngcontent-%COMP%]   .toast-icon[_ngcontent-%COMP%]{background:#fef3c7;color:#f59e0b}.toast-item.info[_ngcontent-%COMP%]{border-left:4px solid #3b82f6}.toast-item.info[_ngcontent-%COMP%]   .toast-icon[_ngcontent-%COMP%]{background:#dbeafe;color:#3b82f6}.toast-progress[_ngcontent-%COMP%]{position:absolute;bottom:0;left:0;width:100%;height:3px;background:#0000000d}.progress-bar[_ngcontent-%COMP%]{height:100%;width:100%;animation:_ngcontent-%COMP%_toast-progress linear forwards}.success[_ngcontent-%COMP%]   .progress-bar[_ngcontent-%COMP%]{background:#10b981}.error[_ngcontent-%COMP%]   .progress-bar[_ngcontent-%COMP%]{background:#ef4444}.warning[_ngcontent-%COMP%]   .progress-bar[_ngcontent-%COMP%]{background:#f59e0b}.info[_ngcontent-%COMP%]   .progress-bar[_ngcontent-%COMP%]{background:#3b82f6}@keyframes _ngcontent-%COMP%_toast-progress{0%{width:100%}to{width:0%}}"]})};function bN(t,r){if(t&1){let e=Pe();d(0,"div",1),L("click",function(){D(e);let i=C();return N(i.handleCancel())}),d(1,"div",2),L("click",function(i){return D(e),N(i.stopPropagation())}),d(2,"div",3)(3,"div",4),j(4,"i"),u(),d(5,"div",5)(6,"h3"),_(7),u(),d(8,"p"),_(9),u()()(),d(10,"div",6)(11,"button",7),L("click",function(){D(e);let i=C();return N(i.handleCancel())}),_(12),u(),d(13,"button",8),L("click",function(){D(e);let i=C();return N(i.handleConfirm())}),_(14),u()()()()}if(t&2){let e=C();g(4),Kd(e.getIconClass()),g(3),be(e.options==null?null:e.options.title),g(2),be(e.options==null?null:e.options.message),g(3),je(" ",e.options==null?null:e.options.cancelText," "),g(),P("ngClass",(e.options==null?null:e.options.type)==="danger"?"btn-danger":"btn-primary"),g(),je(" ",e.options==null?null:e.options.confirmText," ")}}var eh=class t{confirmationService=Ce(Ni);router=Ce(ro);subscription;get isLoginPage(){return this.router.url==="/login"||this.router.url==="/"}show=!1;options;resolve;constructor(){this.subscription=this.confirmationService.confirmation$.subscribe(r=>{this.options=r.options,this.resolve=r.resolve,this.show=!0})}ngOnDestroy(){this.subscription.unsubscribe()}handleConfirm(){this.show=!1,this.resolve?.(!0)}handleCancel(){this.show=!1,this.resolve?.(!1)}getIconClass(){switch(this.options?.type){case"danger":return"fa-solid fa-triangle-exclamation text-danger";case"warning":return"fa-solid fa-circle-exclamation text-warning";default:return"fa-solid fa-circle-question text-primary"}}static \u0275fac=function(e){return new(e||t)};static \u0275cmp=ir({type:t,selectors:[["app-confirmation-modal"]],decls:1,vars:1,consts:[["class","modal-backdrop",3,"click",4,"ngIf"],[1,"modal-backdrop",3,"click"],[1,"confirmation-modal",3,"click"],[1,"modal-body"],[1,"icon-container"],[1,"text-content"],[1,"modal-footer"],[1,"btn","btn-secondary",3,"click"],[1,"btn",3,"click","ngClass"]],template:function(e,n){e&1&&fe(0,bN,15,7,"div",0),e&2&&P("ngIf",n.show&&!n.isLoginPage)},dependencies:[gr,Tr,mr],styles:[".modal-backdrop[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100vw;height:100vh;background:#0f172a66;-webkit-backdrop-filter:blur(8px);backdrop-filter:blur(8px);z-index:10000;display:flex;align-items:center;justify-content:center;animation:_ngcontent-%COMP%_backdrop-in .3s ease-out}@keyframes _ngcontent-%COMP%_backdrop-in{0%{opacity:0}to{opacity:1}}.confirmation-modal[_ngcontent-%COMP%]{background:#fff;width:90%;max-width:400px;border-radius:20px;box-shadow:0 25px 50px -12px #00000040;overflow:hidden;animation:_ngcontent-%COMP%_modal-in .4s cubic-bezier(.175,.885,.32,1.275)}@keyframes _ngcontent-%COMP%_modal-in{0%{transform:scale(.9) translateY(20px);opacity:0}to{transform:scale(1) translateY(0);opacity:1}}.modal-body[_ngcontent-%COMP%]{padding:2.5rem 2rem 1.5rem;text-align:center}.icon-container[_ngcontent-%COMP%]{width:64px;height:64px;border-radius:50%;background:#f8fafc;display:flex;align-items:center;justify-content:center;margin:0 auto 1.5rem}.icon-container[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:2rem}.text-content[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 .75rem;font-size:1.25rem;color:#1e293b;font-weight:700}.text-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;color:#64748b;line-height:1.6;font-size:.95rem}.modal-footer[_ngcontent-%COMP%]{padding:1.25rem 2rem 2rem;display:grid;grid-template-columns:1fr 1fr;gap:1rem}.btn[_ngcontent-%COMP%]{padding:.75rem 1.25rem;border-radius:12px;font-weight:600;font-size:.95rem;transition:all .2s;border:none;cursor:pointer}.btn-secondary[_ngcontent-%COMP%]{background:#f1f5f9;color:#475569}.btn-secondary[_ngcontent-%COMP%]:hover{background:#e2e8f0}.btn-primary[_ngcontent-%COMP%]{background:linear-gradient(135deg,var(--primary) 0%,#4338ca 100%);color:#fff}.btn-primary[_ngcontent-%COMP%]:hover{filter:brightness(1.1);transform:translateY(-1px)}.btn-danger[_ngcontent-%COMP%]{background:#ef4444;color:#fff}.btn-danger[_ngcontent-%COMP%]:hover{background:#dc2626;transform:translateY(-1px)}.text-danger[_ngcontent-%COMP%]{color:#ef4444}.text-warning[_ngcontent-%COMP%]{color:#f59e0b}.text-primary[_ngcontent-%COMP%]{color:#3b82f6}"]})};var th=class t{title=ga("icc-tda-frontend");static \u0275fac=function(e){return new(e||t)};static \u0275cmp=ir({type:t,selectors:[["app-root"]],decls:3,vars:0,template:function(e,n){e&1&&j(0,"router-outlet")(1,"app-toast-container")(2,"app-confirmation-modal")},dependencies:[Jd,Qu,eh],styles:[".page-header[_ngcontent-%COMP%]{margin-bottom:2rem;padding:.5rem .5rem 0}.page-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:1.85rem;font-weight:800;color:var(--text-main);display:flex;align-items:center;gap:.75rem;margin:0 0 .5rem}.page-header[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:1rem;color:var(--text-muted);font-weight:500;margin:0}"]})};v1(th,k5).catch(t=>console.error(t));
